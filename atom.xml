<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>æµ·åº•æé‡Œæ²¡æœ‰é±¼</title>
  
  <subtitle>å¹³å®‰å–œä¹ï¼Œä¸‡äº‹èƒœæ„ã€‚</subtitle>
  <link href="https://smileszh.github.io/atom.xml" rel="self"/>
  
  <link href="https://smileszh.github.io/"/>
  <updated>2024-04-30T12:30:20.784Z</updated>
  <id>https://smileszh.github.io/</id>
  
  <author>
    <name>æ³¡æ³¡</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Bookdownä½¿ç”¨</title>
    <link href="https://smileszh.github.io/posts/16088ba7.html"/>
    <id>https://smileszh.github.io/posts/16088ba7.html</id>
    <published>2024-04-30T14:00:00.000Z</published>
    <updated>2024-04-30T12:30:20.784Z</updated>
    
    
    
    
    <category term="ç”Ÿç‰©ä¿¡æ¯å­¦" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="Rè¯­è¨€" scheme="https://smileszh.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
    <category term="RåŒ…" scheme="https://smileszh.github.io/tags/R%E5%8C%85/"/>
    
  </entry>
  
  <entry>
    <title>ggplot2åŒ…</title>
    <link href="https://smileszh.github.io/posts/2ea551a.html"/>
    <id>https://smileszh.github.io/posts/2ea551a.html</id>
    <published>2023-08-08T00:00:00.000Z</published>
    <updated>2023-12-07T13:03:08.207Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h1><details class="folding-tag" green><summary> æ‰€éœ€RåŒ… </summary>              <div class='content'>              <p>{ggplot2}, part of the {tidyverse} package collection<br>{tidyverse} package collection, namely<br>{dplyr} for data wrangling<br>{tibble} for modern data frames<br>{tidyr} for data cleaning<br>{forcats} for handling factors<br>{corrr} for calculating correlation matrices<br>{cowplot} for composing ggplots<br>{ggforce} for sina plots and other cool stuff<br>{ggrepel} for nice text labeling<br>{ggridges} for ridge plots<br>{ggsci} for nice color palettes<br>{ggtext} for advanced text rendering<br>{ggthemes} for additional themes<br>{grid} for creating graphical objects<br>{gridExtra} for additional functions for â€œgridâ€ graphics<br>{patchwork} for multi-panel plots<br>{prismatic} for manipulating colors<br>{rcartocolor} for great color palettes<br>{scico} for perceptional uniform palettes<br>{showtext} for custom fonts<br>{shiny} for interactive apps a number of packages for interactive visualizations<br>{charter}<br>{echarts4r}<br>{ggiraph}<br>{highcharter}<br>{plotly}</p>              </div>            </details><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># install CRAN packages</span></span><br><span class="line">install.packages<span class="punctuation">(</span></span><br><span class="line">  <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;ggplot2&quot;</span><span class="punctuation">,</span> <span class="string">&quot;tibble&quot;</span><span class="punctuation">,</span> <span class="string">&quot;tidyr&quot;</span><span class="punctuation">,</span> <span class="string">&quot;forcats&quot;</span><span class="punctuation">,</span> <span class="string">&quot;purrr&quot;</span><span class="punctuation">,</span> <span class="string">&quot;prismatic&quot;</span><span class="punctuation">,</span> <span class="string">&quot;corrr&quot;</span><span class="punctuation">,</span> </span><br><span class="line">    <span class="string">&quot;cowplot&quot;</span><span class="punctuation">,</span> <span class="string">&quot;ggforce&quot;</span><span class="punctuation">,</span> <span class="string">&quot;ggrepel&quot;</span><span class="punctuation">,</span> <span class="string">&quot;ggridges&quot;</span><span class="punctuation">,</span> <span class="string">&quot;ggsci&quot;</span><span class="punctuation">,</span> <span class="string">&quot;ggtext&quot;</span><span class="punctuation">,</span> <span class="string">&quot;ggthemes&quot;</span><span class="punctuation">,</span> </span><br><span class="line">    <span class="string">&quot;grid&quot;</span><span class="punctuation">,</span> <span class="string">&quot;gridExtra&quot;</span><span class="punctuation">,</span> <span class="string">&quot;patchwork&quot;</span><span class="punctuation">,</span> <span class="string">&quot;rcartocolor&quot;</span><span class="punctuation">,</span> <span class="string">&quot;scico&quot;</span><span class="punctuation">,</span> <span class="string">&quot;showtext&quot;</span><span class="punctuation">,</span> </span><br><span class="line">    <span class="string">&quot;shiny&quot;</span><span class="punctuation">,</span> <span class="string">&quot;plotly&quot;</span><span class="punctuation">,</span> <span class="string">&quot;highcharter&quot;</span><span class="punctuation">,</span> <span class="string">&quot;echarts4r&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># install from GitHub since not on CRAN</span></span><br><span class="line">install.packages<span class="punctuation">(</span>devtools<span class="punctuation">)</span></span><br><span class="line">devtools<span class="operator">::</span>install_github<span class="punctuation">(</span><span class="string">&quot;JohnCoene/charter&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h1 id="æ•°æ®é›†"><a href="#æ•°æ®é›†" class="headerlink" title="æ•°æ®é›†"></a>æ•°æ®é›†</h1><p>æœ¬æ•™ç¨‹ä¸­ä½¿ç”¨æ¥è‡ªç©ºæ°”æ±¡æŸ“è‡´å‘ç—…ç‡å’Œæ­»äº¡ç‡ç ”ç©¶(nmaps)çš„æ•°æ®ã€‚ä¸ºäº†ä½¿ä½œå›¾æ˜“äºç®¡ç†ï¼Œæˆ‘ä»¬å°†æ•°æ®é™åˆ¶åœ¨èŠåŠ å“¥1997-2000å¹´é—´ã€‚å…³äºè¿™ä¸ªæ•°æ®é›†çš„æ›´å¤šç»†èŠ‚ï¼Œè¯·å‚è€ƒRoger Pengçš„ä¹¦<a href="https://link.springer.com/book/10.1007/978-0-387-78167-9">ã€Šç¯å¢ƒæµè¡Œç—…å­¦ä¸­çš„ç»Ÿè®¡æ–¹æ³•ã€‹</a>ã€‚</p><p>æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨<mark class="hl-label blue">{readr}</mark> åŒ…ä¸­çš„<mark class="hl-label blue">read_csv()</mark> å‡½æ•°å°†æ•°æ®å¯¼å…¥Rï¼Œå¹¶é€šè¿‡ç®­å¤´<mark class="hl-label blue"><-</mark> å°†æ•°æ®èµ‹å€¼ç»™å˜é‡<mark class="hl-label blue">chic</mark> ã€‚<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chic <span class="operator">&lt;-</span> readr<span class="operator">::</span>read_csv<span class="punctuation">(</span><span class="string">&quot;https://raw.githubusercontent.com/z3tt/ggplot-courses/main/data/chicago-nmmaps-custom.csv&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br>å…¶ä¸­ :: è¢«ç§°ä¸ºnamespaceï¼Œå¯ä»¥ä¸åŠ è½½RåŒ…å°±å¯ä»¥ä½¿ç”¨å‡½æ•°ï¼Œä¹Ÿå¯ä»¥å…ˆåŠ è½½RåŒ…<mark class="hl-label blue">library(readr)</mark> ï¼Œå†ä½¿ç”¨å‡½æ•°<mark class="hl-label blue">chic<-read.csv(...)</mark> ã€‚</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">tibble<span class="operator">::</span>glimpse<span class="punctuation">(</span>chic<span class="punctuation">)</span></span><br><span class="line">````</span><br><span class="line">```R</span><br><span class="line">## Rows: 1,461</span><br><span class="line">## Columns: 11</span><br><span class="line">## $ city          &lt;chr&gt; &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chic&quot;, &quot;chiâ€¦</span><br><span class="line">## $ date          &lt;date&gt; 1997-01-01, 1997-01-02, 1997-01-03, 1997-01-04, 1997-01-05, 1997-01-06, 1997-01-07, 1997-01-08, 1997-01-09, 1997-01-10, 1997-01-11, 1997-01-12, 1997-01-13, 1997-01-14, 1997-01-15, 1997-01-16, 1997-01-17, 1997-01-18, 1997-01-19, 1997-01-20, 1997-01-21, 1997-01-22, 1997-01-23, 1997-01-24, 1997-01-25, 1997-01-26, 1997-01-27, 1997-01-28, 1997-01-29, 1997-01-30, 1997-01-31, 1997-02-01, 1997-02-02, 1997-02-03, 1997-02-04, 1997-02-05, 1997-02-06, 1997-02-07, 1997-02-08, 1997-02-09, 1997-02-10, 1997-02-11, 1997-02-12, 1997-02-13, 1997-02-14, 1997-02-15, 1997-02-16, 1997-02-17, 1997-02-18, 1997-02-19, 1997-02-20, 1997-02-21, 1997-02-22, 1997-02-23, 1997-02-24, 1997-02-25, 199â€¦</span><br><span class="line">## $ temp          &lt;dbl&gt; 36.0, 45.0, 40.0, 51.5, 27.0, 17.0, 16.0, 19.0, 26.0, 16.0, 1.5, 1.0, 3.0, 10.0, 19.0, 9.5, -3.0, 0.0, 14.0, 31.0, 35.0, 36.5, 26.0, 32.0, 14.5, 11.0, 17.0, 2.0, 8.0, 16.5, 31.5, 35.0, 36.5, 30.0, 34.5, 30.0, 26.0, 25.5, 25.5, 26.0, 27.0, 23.5, 21.0, 20.5, 25.5, 20.0, 18.5, 30.0, 48.5, 37.5, 35.5, 36.0, 26.0, 28.0, 21.5, 25.5, 36.5, 34.5, 37.5, 45.5, 35.0, 33.5, 38.0, 33.0, 26.5, 35.5, 39.0, 37.0, 44.0, 37.0, 33.5, 37.5, 26.5, 19.0, 24.5, 45.0, 33.5, 35.5, 46.0, 53.5, 37.5, 32.5, 33.0, 40.5, 44.0, 60.5, 55.5, 43.5, 37.5, 38.5, 44.5, 53.0, 59.5, 62.5, 60.5, 45.0, 34.0, 28.5, 30.0, 30.5, 33.5, 33.5, 38.5, 41.5, 49.0, 43.0, 40.5, 40.0, 45.5, 49.0, 45.0, 43.0, 48.5, 47.5,â€¦</span><br><span class="line">## $ o3            &lt;dbl&gt; 5.659256, 5.525417, 6.288548, 7.537758, 20.760798, 14.940874, 11.920985, 8.678477, 13.355892, 10.448264, 15.866094, 15.115290, 9.381068, 8.029508, 7.066111, 20.113023, 15.363898, 12.713223, 9.616133, 16.840369, 12.758676, 21.024213, 18.665072, 7.131938, 17.167861, 9.960118, 9.167350, 13.613967, 7.945009, 7.660619, 11.882608, 16.676182, 12.032368, 21.849559, 10.887549, 14.894031, 15.957824, 14.391243, 19.749645, 12.397635, 14.193562, 20.492388, 23.091993, 20.171005, 15.453240, 19.526661, 20.019234, 17.297562, 27.013275, 19.055436, 6.890252, 16.313610, 23.015853, 24.990318, 18.939318, 12.526243, 7.962753, 13.194153, 15.178614, 13.860717, 30.992349, 29.260852, 15.413875,â€¦</span><br><span class="line">## $ dewpoint      &lt;dbl&gt; 37.50000, 47.25000, 38.00000, 45.50000, 11.25000, 5.75000, 7.00000, 17.75000, 24.00000, 5.37500, -6.62500, -8.87500, 1.50000, 11.50000, 23.25000, -9.75000, -10.37500, -4.12500, 22.62500, 27.25000, 41.62500, 20.75000, 18.75000, 29.50000, -1.37500, 17.12500, 8.37500, -6.37500, 11.00000, 16.37500, 33.75000, 29.66667, 29.62500, 28.00000, 32.00000, 24.25000, 21.87500, 23.37500, 22.50000, 21.00000, 21.75000, 19.50000, 11.60000, 16.37500, 23.00000, 15.25000, 8.12500, 32.62500, 41.37500, 27.50000, 44.12500, 29.62500, 24.25000, 14.62500, 10.87500, 27.12500, 35.00000, 30.25000, 36.00000, 44.00000, 27.37500, 29.37500, 28.87500, 28.62500, 13.37500, 35.25000, 28.25000, 32.62500, 3â€¦</span><br><span class="line">## $ pm10          &lt;dbl&gt; 13.052268, 41.948600, 27.041751, 25.072573, 15.343121, 9.364655, 20.228428, 33.134819, 12.118381, 24.761534, 18.126151, 16.013770, 34.991079, 64.945403, 26.941955, 27.022906, 18.837025, 31.859740, 30.923168, 19.894566, 27.882017, 18.508762, 11.845698, 26.687346, 16.612825, 21.641455, 22.672498, 28.101180, 51.776607, 48.741462, 24.686329, 23.784943, 27.762150, 21.600928, 17.050900, 10.157749, 15.943086, 33.010704, 14.955909, 30.410449, 23.914813, 22.972347, 12.712336, 22.719836, 35.676001, 28.373076, 15.662430, 38.744847, 27.597166, 17.612211, 29.768805, 7.340321, 7.856717, 7.908915, 17.834350, 41.124012, 34.052583, 19.749350, 26.126759, 28.129506, 9.940940, 15.980970,â€¦</span><br><span class="line">## $ season        &lt;chr&gt; &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winter&quot;, &quot;Winteâ€¦</span><br><span class="line">## $ yday          &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157,â€¦</span><br><span class="line">## $ month         &lt;chr&gt; &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Jan&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Mar&quot;, &quot;Apr&quot;, &quot;Apr&quot;, &quot;Apr&quot;, &quot;Apr&quot;, &quot;Apr&quot;, &quot;Apr&quot;, &quot;Aprâ€¦</span><br><span class="line">## $ month_numeric &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8â€¦</span><br><span class="line">## $ year          &lt;dbl&gt; 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997, 1997â€¦</span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">head<span class="punctuation">(</span>chic<span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## # A tibble: 10 Ã— 11</span></span><br><span class="line"><span class="comment">##    city  date        temp    o3 dewpoint  pm10 season  yday month month_numeric  year</span></span><br><span class="line"><span class="comment">##    &lt;chr&gt; &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt;</span></span><br><span class="line"><span class="comment">##  1 chic  1997-01-01  36    5.66    37.5  13.1  Winter     1 Jan               1  1997</span></span><br><span class="line"><span class="comment">##  2 chic  1997-01-02  45    5.53    47.2  41.9  Winter     2 Jan               1  1997</span></span><br><span class="line"><span class="comment">##  3 chic  1997-01-03  40    6.29    38    27.0  Winter     3 Jan               1  1997</span></span><br><span class="line"><span class="comment">##  4 chic  1997-01-04  51.5  7.54    45.5  25.1  Winter     4 Jan               1  1997</span></span><br><span class="line"><span class="comment">##  5 chic  1997-01-05  27   20.8     11.2  15.3  Winter     5 Jan               1  1997</span></span><br><span class="line"><span class="comment">##  6 chic  1997-01-06  17   14.9      5.75  9.36 Winter     6 Jan               1  1997</span></span><br><span class="line"><span class="comment">##  7 chic  1997-01-07  16   11.9      7    20.2  Winter     7 Jan               1  1997</span></span><br><span class="line"><span class="comment">##  8 chic  1997-01-08  19    8.68    17.8  33.1  Winter     8 Jan               1  1997</span></span><br><span class="line"><span class="comment">##  9 chic  1997-01-09  26   13.4     24    12.1  Winter     9 Jan               1  1997</span></span><br><span class="line"><span class="comment">## 10 chic  1997-01-10  16   10.4      5.38 24.8  Winter    10 Jan               1  1997</span></span><br></pre></td></tr></table></figure><h1 id="ggplotåŒ…"><a href="#ggplotåŒ…" class="headerlink" title="ggplotåŒ…"></a>ggplotåŒ…</h1><blockquote><p>ggplotæ˜¯ä¸€ä¸ªåŸºäºå›¾å½¢è¯­æ³•çš„å£°æ˜å¼åˆ›å»ºå›¾å½¢ç³»ç»Ÿã€‚ä½ æä¾›æ•°æ®ï¼Œå‘Šè¯‰ggplotå¦‚ä½•å°†ggplotæ˜ å°„å˜é‡åˆ°ç¾å­¦(aestheics)ï¼Œä½¿ç”¨å“ªäº›åŸºæœ¬å›¾å½¢åŸºå…ƒï¼Œå®ƒå¤„ç†ç»†èŠ‚ã€‚</p></blockquote><details class="folding-tag" green><summary> ggplotåŸºæœ¬å…ƒç´  </summary>              <div class='content'>              <p>Data: æƒ³å»ç”»å›¾çš„åŸå§‹æ•°æ®ã€‚<br>Geometries geom<em>: æ•°æ®å‘ˆç°çš„å‡ ä½•å½¢çŠ¶ã€‚<br>Aesthetics aes(): å‡ ä½•å’Œç»Ÿè®¡å¯¹è±¡çš„ç¾å­¦ï¼Œä¾‹å¦‚ä½ç½®ã€é¢œè‰²ã€å¤§å°ã€å½¢çŠ¶ã€é€æ˜åº¦ã€‚<br>Scales scale</em>: æ•°æ®å’Œç¾å­¦ç»´åº¦çš„æ˜ å°„ï¼Œä¾‹å¦‚ä»æ•°æ®èŒƒå›´åˆ°å›¾å½¢å®½åº¦ã€å› å­åˆ°å›¾å½¢é¢œè‰²ã€‚<br>Statistical transformations stat<em>: æ•°æ®å¨ç»Ÿè®¡ï¼Œä¾‹å¦‚ç™¾åˆ†ä½ã€æ‹Ÿåˆæ›²çº¿ã€åŠ å’Œã€‚<br>Coordinate system coord</em>: æ•°æ®çš„è½¬æ¢ã€‚<br>Facets facet_: æ•°æ®å›¾è¡¨çš„æ’åˆ—ã€‚<br>Visual themes theme(): ä¸»é¢˜çš„è§†è§‰é»˜è®¤å€¼ï¼Œä¾‹å¦‚èƒŒæ™¯ã€ç½‘æ ¼ã€è½´ã€é»˜è®¤å­—ä½“ã€å¤§å°ã€é¢œè‰²ã€‚</p>              </div>            </details><h1 id="ggplotåŸºç¡€"><a href="#ggplotåŸºç¡€" class="headerlink" title="ggplotåŸºç¡€"></a>ggplotåŸºç¡€</h1><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦åŠ è½½<mark class="hl-label blue">ggplot2</mark> ï¼Œå¦å¤–ä¹Ÿèƒ½ä½¿ç”¨<mark class="hl-label blue">tidyverseåŒ…</mark> è¿›è¡ŒåŠ è½½ã€‚<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># library(tidyverse)</span></span><br></pre></td></tr></table></figure><br>ggplot2çš„è¯­æ³•æ˜¯ä¸åŒäºbase Rï¼Œé»˜è®¤çš„ggplotéœ€è¦ä¸‰æ ·ä¸œè¥¿ï¼šæ•°æ®(data)ã€ç¾å­¦(aesthetics)å’Œå‡ ä½•å›¾å½¢(geometry)ã€‚æˆ‘ä»¬æ€»æ˜¯é€šè¿‡ggplot(data = df)å»å®šä¹‰ä¸€ä¸ªå›¾å½¢å¯¹è±¡ï¼Œå‘Šè¯‰ggplotæˆ‘ä»¬è¦ä½¿ç”¨è¿™ä¸ªæ•°æ®è¿›è¡Œå·¥ä½œã€‚å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½æƒ³ç”»ä¸¤ä¸ªå˜é‡ï¼Œä¸€ä¸ªXè½´ã€ä¸€ä¸ªYè½´ã€‚è¿™äº›æ˜¯ä½ç½®ç¾å­¦ï¼Œå› æ­¤æˆ‘ä»¬æ·»åŠ aes(x = var1, y = var2)åˆ°ggplot(æ˜¯çš„ï¼Œaesä»£è¡¨ç¾å­¦)ã€‚ç„¶è€Œï¼Œæœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦æŒ‡å®šä¸€ä¸ªæˆ–ä¸‰ä¸ªåŠä»¥ä¸Šä¸ªå˜é‡ã€‚</p><p><strong>ğŸ’¡æˆ‘ä»¬åœ¨aes()å¤–éƒ¨æŒ‡å®šæ•°æ®ï¼Œåœ¨å†…éƒ¨æ˜ å°„å˜é‡</strong></p><p>åœ¨æ­¤ï¼Œæˆ‘ä»¬å°†å˜é‡dateæ˜ å°„åˆ°Xè½´ï¼Œå°†å˜é‡tempæ˜ å°„åˆ°Yè½´ï¼Œç„¶åï¼Œæˆ‘ä»¬ä¹Ÿèƒ½å°†å˜é‡æ˜ å°„åˆ°å…¶ä»–ç¾å­¦ï¼Œæ¯”å¦‚é¢œè‰²ã€å¤§å°å’Œå½¢çŠ¶ã€‚</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">(</span>g <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/08/08/64d1b586568f1.png" style="width:600px;"/></div></div><p>å•Šï¼ä»…ä»…åˆ›å»ºäº†ä¸€ä¸ªé¢æ¿ã€‚ä¸ºä»€ä¹ˆï¼Ÿè¿™æ˜¯å› ä¸ºggolot2ä¸çŸ¥é“å¦‚ä½•å»ç”»è¿™ä¸ªå›¾å½¢â€”-æˆ‘ä»¬éœ€è¦æŒ‡å®šä¸€ä¸ªå‡ ä½•å›¾å½¢ã€‚<br>ggplotå…è®¸ä½ å°†æœ€è¿‘åˆ›å»ºçš„ggobjictèµ‹å€¼ç»™ä¸€ä¸ªè‡ªå®šä¹‰å˜é‡ï¼Œæœ¬ä¾‹ä¸­ç§°ä¸ºgï¼Œä½ ä¹Ÿèƒ½å°†è¿™ä¸ªggobjectæ·»åŠ å…¶ä»–çš„å±‚ï¼Œè¦ä¹ˆä¸€æ¬¡æ€§æ·»åŠ æ‰€æœ‰å±‚ï¼Œè¦ä¹ˆèµ‹å€¼å®ƒç»™ç›¸åŒæˆ–ä¸åŒçš„å˜é‡è¿›è€Œåˆ†å¤šæ¬¡æ·»åŠ ã€‚</p><p><strong>ğŸ’¡å°†ä¸€ä¸ªå›¾å½¢åˆ†é…ç»™å¯¹è±¡æ—¶ï¼Œé»˜è®¤ä½¿ç”¨æ‹¬å·ï¼Œè¿™ä¸ªå›¾å½¢ä¼šç«‹åˆ»æ˜¾ç¤ºå‡ºæ¥ã€‚å³ä½¿ç”¨(g &lt;- ggplot(â€¦))ä»£æ›¿g &lt;- ggplot()ã€‚</strong></p><p>æœ‰å¾ˆå¤šå¾ˆå¤šçš„<a href="https://ggplot2.tidyverse.org/reference/">å‡ ä½•å›¾å½¢</a>ï¼ˆç§°ä¸ºgeomsï¼Œå› ä¸ºæ¯ä¸€ä¸ªå‡½æ•°éƒ½ä»¥geom_å¼€å¤´ï¼‰é»˜è®¤èƒ½å¤Ÿæ·»åŠ åˆ°ggplotï¼Œç”šè‡³è¿˜æœ‰å¾ˆå¤šçš„<a href="https://exts.ggplot2.tidyverse.org/">æ‰©å±•åŒ…</a>å¯ä»¥è¢«æ·»åŠ ã€‚è®©æˆ‘ä»¬å‘Šè¯‰ggplotæˆ‘ä»¬æƒ³ä½¿ç”¨å“ªç§é£æ ¼çš„å›¾å½¢å§ï¼Œä¾‹å¦‚ä½¿ç”¨geom_point()åˆ›å»ºä¸€ä¸ªæ•£ç‚¹å›¾ã€‚</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span> geom_point<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/08/08/64d1b587f39ea.png" style="width:600px;"/></div></div><p>éå¸¸å¥½ï¼æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å›¾å½¢å˜ä¸ºçº¿å½¢ï¼ˆä¸æ˜¯æœ€å¥½çš„ï¼Œä½†äººæ€»æ˜¯è¿™æ ·ï¼‰ï¼Œæ‰€ä»¥ä½¿ç”¨geom_line()æ¥çœ‹çœ‹å§ã€‚</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span> geom_line<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/08/08/64d1b591a5f63.png" style="width:600px;"/></div></div><p>æˆ‘ä»¬ä¹Ÿèƒ½ç»“åˆå‡ ä¸ªå‡ ä½•å›¾å½¢å±‚â€”-è¿™å°†æ˜¯ç¥å¥‡å’Œæœ‰è¶£çš„å¼€å§‹ã€‚<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span> geom_line<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> geom_point<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/08/08/64d1b593ee125.png" style="width:600px;"/></div></div></p><h2 id="è°ƒæ•´å‡ ä½•å›¾å½¢çš„å±æ€§"><a href="#è°ƒæ•´å‡ ä½•å›¾å½¢çš„å±æ€§" class="headerlink" title="è°ƒæ•´å‡ ä½•å›¾å½¢çš„å±æ€§"></a>è°ƒæ•´å‡ ä½•å›¾å½¢çš„å±æ€§</h2><p>åœ¨<mark class="hl-label blue">geom_*</mark> å‘½ä»¤ä¸­å¯ä»¥ç†Ÿç»ƒæ“ä½œè§†è§‰ç¾å­¦ï¼Œä¾‹å¦‚ç‚¹çš„é¢œè‰²ã€å½¢çŠ¶ã€å¤§å°ã€‚è®©æˆ‘ä»¬å°†æ‰€æœ‰çš„ç‚¹è½¬åŒ–ä¸ºå¤§å¤§ç«çº¢è‰²é’»çŸ³ï¼<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span> geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">,</span> shape <span class="operator">=</span> <span class="string">&quot;diamond&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/08/08/64d1b58ebe275.png" style="width:600px;"/></div></div><br><strong>ğŸ’¡ ggplot èƒ½å¤ŸåŒæ—¶è¯†åˆ«colorå’Œcolourï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç®€å†™ç‰ˆæœ¬colã€‚</strong></p><p>ä½ èƒ½ä½¿ç”¨<a href="http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf">é¢„è®¾é¢œè‰²</a>æˆ–<a href="https://www.techopedia.com/definition/29788/color-hex-code">åå…­è¿›åˆ¶é¢œè‰²ä»£ç </a>ï¼Œå¯ä»¥åŒæ—¶ä½¿ç”¨ï¼Œç”šè‡³å¯ä»¥é€šè¿‡rgb()å‡½æ•°ä½¿ç”¨RGB/RGBAé¢œè‰²ã€‚</p><p>æ¯ä¸ªgeoméƒ½æœ‰è‡ªå·±çš„å±æ€§(ç§°ä¸ºå‚æ•°)ï¼Œç›¸åŒçš„å‚æ•°å¯èƒ½å¯¼è‡´ä¸åŒçš„å˜åŒ–ï¼Œè¿™å–å†³äºä½ ä½¿ç”¨çš„geomã€‚</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span> geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">,</span> shape <span class="operator">=</span> <span class="string">&quot;diamond&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    geom_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="string">&quot;dotted&quot;</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">.3</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/08/08/64d1b58fd46ad.png" style="width:600px;"/></div></div><h2 id="ggploté»˜è®¤ä¸»é¢˜æ›¿æ¢"><a href="#ggploté»˜è®¤ä¸»é¢˜æ›¿æ¢" class="headerlink" title="ggploté»˜è®¤ä¸»é¢˜æ›¿æ¢"></a>ggploté»˜è®¤ä¸»é¢˜æ›¿æ¢</h2><p>ä¸ºäº†è¿›ä¸€æ­¥è¯´æ˜ggplotçš„å¤šç”¨é€”æ€§ï¼Œè®©æˆ‘ä»¬é€šè¿‡è®¾ç½®ä¸€ä¸ªä¸åŒçš„å†…ç½®ä¸»é¢˜(ä¾‹å¦‚theme_bw())æ¥æ‘†è„±ç°è‰²çš„é»˜è®¤ggplot2å¤–è§‚â€”-é€šè¿‡è°ƒç”¨theme_set()ã€‚</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">theme_set<span class="punctuation">(</span>theme_bw<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">g <span class="operator">+</span> geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/08/08/64d1b5916b13f.png" style="width:600px;"/></div></div><p><strong>ğŸ’¡ theme()æ˜¯ä¸€ä¸ª<a href="https://ggplot2.tidyverse.org/reference/theme.html">åŸºæœ¬çš„å‘½ä»¤</a>ï¼Œèƒ½å¤Ÿä¿®æ”¹æ‰€æœ‰çš„ä¸»é¢˜å‚æ•°ï¼ˆæ–‡æœ¬ã€çŸ©å½¢å’Œçº¿ï¼‰ã€‚</strong></p><h1 id="åæ ‡è½´"><a href="#åæ ‡è½´" class="headerlink" title="åæ ‡è½´"></a>åæ ‡è½´</h1><h2 id="è°ƒæ•´åæ ‡è½´æ ‡é¢˜"><a href="#è°ƒæ•´åæ ‡è½´æ ‡é¢˜" class="headerlink" title="è°ƒæ•´åæ ‡è½´æ ‡é¢˜"></a>è°ƒæ•´åæ ‡è½´æ ‡é¢˜</h2><p>æˆ‘ä»¬ä½¿ç”¨<mark class="hl-label blue">labs()</mark> ä¸ºåæ ‡è½´ï¼ˆè¿™é‡Œæ˜¯xå’Œyï¼‰æŒ‡å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ¥è°ƒæ•´åæ ‡è½´æ ‡é¢˜ã€‚<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/08/27/64ea31e0b3611.png" style="width:600px;"/></div></div></p><details class="folding-tag" green><summary> ğŸ§‘â€ğŸ„ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ xlab() æˆ– ylab() åˆ†åˆ«å¯¹åæ ‡è½´æ ‡é¢˜è¿›è¡Œä¿®æ”¹ã€‚ </summary>              <div class='content'>              <figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  xlab<span class="punctuation">(</span><span class="string">&quot;Year&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  ylab<span class="punctuation">(</span><span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/08/27/64ea31e0b3611.png" style="width:600px;"/></div></div>              </div>            </details><p>é€šå¸¸ä½ ä¹Ÿå¯ä»¥é€šè¿‡æ·»åŠ ç¬¦å·æœ¬èº«æ¥æŒ‡å®šç¬¦å·(è¿™é‡Œæ˜¯â€œÂ°â€)ï¼Œä½†ä¸‹é¢çš„ä»£ç ä¸ä»…å…è®¸æ·»åŠ ç¬¦å·ï¼Œè¿˜å¯ä»¥æ·»åŠ ä¸Šæ ‡:<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="built_in">expression</span><span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&quot;Temperature (&quot;</span><span class="punctuation">,</span> degree <span class="operator">~</span> <span class="built_in">F</span><span class="punctuation">,</span> <span class="string">&quot;)&quot;</span><span class="operator">^</span><span class="string">&quot;(Hey, why should we use metric units?!)&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/08/27/64ea368f32830.png" style="width:600px;"/></div></div></p><h2 id="å¢åŠ åæ ‡è½´å’Œåæ ‡è½´æ ‡é¢˜ä¹‹é—´çš„è·ç¦»"><a href="#å¢åŠ åæ ‡è½´å’Œåæ ‡è½´æ ‡é¢˜ä¹‹é—´çš„è·ç¦»" class="headerlink" title="å¢åŠ åæ ‡è½´å’Œåæ ‡è½´æ ‡é¢˜ä¹‹é—´çš„è·ç¦»"></a>å¢åŠ åæ ‡è½´å’Œåæ ‡è½´æ ‡é¢˜ä¹‹é—´çš„è·ç¦»</h2><mark class="hl-label blue">theme()</mark> æ˜¯ä¿®æ”¹ç‰¹å®šä¸»é¢˜å…ƒç´ ï¼ˆæ–‡æœ¬ã€æ ‡é¢˜ã€æ–¹æ¡†ã€ç¬¦å·ã€èƒŒæ™¯ï¼Œ...ï¼‰çš„åŸºæœ¬å‘½ä»¤ã€‚æˆ‘ä»¬ä¼šç»å¸¸ä½¿ç”¨ä»–ä»¬ï¼ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨theme()è°ƒç”¨ä¸­è¦†ç›–é»˜è®¤çš„element_text()æ¥æ”¹å˜æ‰€æœ‰æˆ–ç‰¹å®šæ–‡æœ¬å…ƒç´ çš„å±æ€§(è¿™é‡Œæ˜¯è½´æ ‡é¢˜):<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.title.x <span class="operator">=</span> element_text<span class="punctuation">(</span>vjust <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">15</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.title.y <span class="operator">=</span> element_text<span class="punctuation">(</span>vjust <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">15</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/08/29/64ed4d91d9118.png" style="width:600px;"/></div></div><mark class="hl-label blue">vjust</mark> ä»…æŒ‡å‚ç›´å¯¹é½ï¼Œå…¶èŒƒå›´é€šå¸¸åœ¨0åˆ°1ä¹‹é—´ï¼Œä½†æ‚¨ä¹Ÿå¯ä»¥æŒ‡å®šè¶…å‡ºè¯¥èŒƒå›´çš„å€¼ã€‚è¯·æ³¨æ„ï¼Œå³ä½¿æˆ‘ä»¬åœ¨yè½´ä¸Šæ°´å¹³ç§»åŠ¨è½´æ ‡é¢˜ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦æŒ‡å®š<mark class="hl-label blue">vjust</mark> (ä»æ ‡ç­¾çš„è§’åº¦æ¥çœ‹è¿™æ˜¯æ­£ç¡®çš„)ã€‚ä½ ä¹Ÿå¯ä»¥é€šè¿‡æŒ‡å®šä¸¤ä¸ªæ–‡æœ¬å…ƒç´ çš„è¾¹è·æ¥æ”¹å˜è·ç¦»:<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.title.x <span class="operator">=</span> element_text<span class="punctuation">(</span>margin <span class="operator">=</span> margin<span class="punctuation">(</span>t <span class="operator">=</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">15</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.title.y <span class="operator">=</span> element_text<span class="punctuation">(</span>margin <span class="operator">=</span> margin<span class="punctuation">(</span>r <span class="operator">=</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">15</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/08/29/64ed4ed54be34.png" style="width:600px;"/></div></div><p>margin()å¯¹è±¡ä¸­çš„æ ‡ç­¾tå’Œråˆ†åˆ«æŒ‡å‘é¡¶éƒ¨å’Œå³ä¾§ã€‚æ‚¨è¿˜å¯ä»¥å°†å››ä¸ªè¾¹è·æŒ‡å®šä¸ºmargin(t, r, b, l)ã€‚è¯·æ³¨æ„ï¼Œæˆ‘ä»¬ç°åœ¨å¿…é¡»æ›´æ”¹å³è¾¹è·æ¥ä¿®æ”¹yè½´ä¸Šçš„ç©ºé—´ï¼Œè€Œä¸æ˜¯åº•éƒ¨è¾¹è·ã€‚</p><p><strong>ğŸ’¡è®°ä½è¾¹é¡ºåºçš„ä¸€ä¸ªå¥½æ–¹æ³•æ˜¯â€˜t-r-ou-b-l-eâ€™ã€‚</strong></p><h2 id="æ”¹å˜åæ ‡è½´æ ‡é¢˜ç¾å­¦"><a href="#æ”¹å˜åæ ‡è½´æ ‡é¢˜ç¾å­¦" class="headerlink" title="æ”¹å˜åæ ‡è½´æ ‡é¢˜ç¾å­¦"></a>æ”¹å˜åæ ‡è½´æ ‡é¢˜ç¾å­¦</h2><p>åŒæ ·ï¼Œæˆ‘ä»¬ä½¿ç”¨ <mark class="hl-label blue">theme()</mark>  å‡½æ•°ä¿®æ”¹å…ƒç´  <mark class="hl-label blue">axis.title</mark>  å’Œ/æˆ–ä¸‹çº§å…ƒç´  <mark class="hl-label blue">axis.title.x</mark> å’Œ<mark class="hl-label blue">axis.title.y</mark> ã€‚åœ¨<mark class="hl-label blue">element_text()</mark>  ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¦†ç›–é»˜è®¤çš„<mark class="hl-label blue">size</mark> ã€<mark class="hl-label blue">color</mark> å’Œ<mark class="hl-label blue">face</mark> ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.title <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">15</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                  face <span class="operator">=</span> <span class="string">&quot;italic&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/08/29/64ed51de0a726.png" style="width:600px;"/></div></div></p><mark class="hl-label blue">face</mark> å‚æ•°èƒ½ä½¿å­—ä½“<mark class="hl-label blue">bold</mark> ã€<mark class="hl-label blue">italic</mark> ç”šè‡³æ˜¯<mark class="hl-label blue">bold.italic</mark> ã€‚<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.title.x <span class="operator">=</span> element_text<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;sienna&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">15</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.title.y <span class="operator">=</span> element_text<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;orangered&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">15</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/08/29/64ed52fa92bd3.png" style="width:600px;"/></div></div><details class="folding-tag" green><summary> ğŸ§ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨axis.ttileå’Œaxis.title.yã€‚å› ä¸ºaxis.title.xä¼šä½¿ç”¨æ¥è‡ªaxis.titleçš„å€¼ã€‚å±•å¼€æŸ¥çœ‹ç¤ºä¾‹: </summary>              <div class='content'>              <figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.title <span class="operator">=</span> element_text<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;sienna&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">15</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.title.y <span class="operator">=</span> element_text<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;orangered&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">15</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/08/29/64ed52fa92bd3.png" style="width:600px;"/></div></div>              </div>            </details><p>åæ ‡è½´æ ‡é¢˜å’Œå…¶ä»–å±æ€§å¯ä»¥ä¸€æ¬¡æ€§ä¿®æ”¹ï¼Œä¹Ÿå¯ä»¥å•ç‹¬è¿›è¡Œä¿®æ”¹ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.title <span class="operator">=</span> element_text<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;sienna&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">15</span><span class="punctuation">,</span> face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.title.y <span class="operator">=</span> element_text<span class="punctuation">(</span>face <span class="operator">=</span> <span class="string">&quot;bold.italic&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/08/29/64ed569dd1805.png" style="width:600px;"/></div></div></p><h2 id="æ”¹å˜åæ ‡è½´æ–‡æœ¬ç¾å­¦"><a href="#æ”¹å˜åæ ‡è½´æ–‡æœ¬ç¾å­¦" class="headerlink" title="æ”¹å˜åæ ‡è½´æ–‡æœ¬ç¾å­¦"></a>æ”¹å˜åæ ‡è½´æ–‡æœ¬ç¾å­¦</h2><p>åŒæ ·ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨<mark class="hl-label blue">axis.text</mark> å’Œ/æˆ–ä¸‹çº§å…ƒç´ <mark class="hl-label blue">axis.text.x</mark> å’Œ<mark class="hl-label default">axis.text.y</mark> å»æ”¹å˜åæ ‡è½´æ–‡æœ¬çš„å¤–è§‚ï¼ˆè¿™é‡Œæ˜¯æ•°å­—ï¼‰ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.text <span class="operator">=</span> element_text<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;dodgerblue&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">12</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.text.x <span class="operator">=</span> element_text<span class="punctuation">(</span>face <span class="operator">=</span> <span class="string">&quot;italic&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/01/64f1ab438115b.png" style="width:600px;"/></div></div></p><h2 id="æ—‹è½¬åæ ‡è½´æ–‡æœ¬"><a href="#æ—‹è½¬åæ ‡è½´æ–‡æœ¬" class="headerlink" title="æ—‹è½¬åæ ‡è½´æ–‡æœ¬"></a>æ—‹è½¬åæ ‡è½´æ–‡æœ¬</h2><p>é€šè¿‡æŒ‡å®šè§’åº¦ï¼Œå¯ä»¥æ—‹è½¬ä»»ä½•æ–‡æœ¬å…ƒç´ ã€‚ä½¿ç”¨ hjust å’Œ vjust å¯ä»¥è°ƒæ•´ä¹‹åæ–‡æœ¬çš„æ°´å¹³ä½ç½®ï¼ˆ0 = å·¦ï¼Œ1 = å³ï¼‰å’Œå‚ç›´ä½ç½®ï¼ˆ0 = ä¸Šï¼Œ1 = ä¸‹ï¼‰ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.text.x <span class="operator">=</span> element_text<span class="punctuation">(</span>angle <span class="operator">=</span> <span class="number">50</span><span class="punctuation">,</span> vjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">12</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/01/64f1acc26110c.png" style="width:600px;"/></div></div></p><h2 id="ç§»é™¤åæ ‡è½´æ–‡æœ¬å’Œåˆ»åº¦çº¿"><a href="#ç§»é™¤åæ ‡è½´æ–‡æœ¬å’Œåˆ»åº¦çº¿" class="headerlink" title="ç§»é™¤åæ ‡è½´æ–‡æœ¬å’Œåˆ»åº¦çº¿"></a>ç§»é™¤åæ ‡è½´æ–‡æœ¬å’Œåˆ»åº¦çº¿</h2><p>ä¹Ÿè®¸å¾ˆå°‘æœ‰ç†ç”±è¿™ä¹ˆåšï¼Œä½†å¯èƒ½å°±æ˜¯è¿™æ ·ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.ticks.y <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.text.y <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/01/64f1adaa19659.png" style="width:600px;"/></div></div></p><p>ğŸ’¡<strong>å¦‚æœä½ æƒ³å»æ‰ä¸€ä¸ªä¸»é¢˜å…ƒç´ ï¼Œæ€»æ˜¯ä½¿ç”¨<mark class="hl-label blue">element_bank()</mark> ã€‚</strong></p><h2 id="ç§»é™¤åæ ‡è½´æ ‡é¢˜"><a href="#ç§»é™¤åæ ‡è½´æ ‡é¢˜" class="headerlink" title="ç§»é™¤åæ ‡è½´æ ‡é¢˜"></a>ç§»é™¤åæ ‡è½´æ ‡é¢˜</h2><p>æˆ‘ä»¬èƒ½å¤Ÿå†æ¬¡ä½¿ç”¨<mark class="hl-label blue">theme_blank()</mark> ï¼Œä½†æ˜¯ä½¿ç”¨<mark class="hl-label blue">labs()</mark> ï¼ˆ<mark class="hl-label blue">xlab()</mark> ï¼‰èƒ½å¤Ÿæ›´ç®€å•çš„ç§»é™¤æ ‡ç­¾ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/01/64f1d48b9c9ac.png" style="width:600px;"/></div></div></p><p>ğŸ’¡<strong>è¯·æ³¨æ„ï¼Œ<mark class="hl-label blue">NULL</mark>  ä¼šåˆ é™¤å…ƒç´ ï¼ˆä¸ <mark class="hl-label blue">element_blank()</mark> ç±»ä¼¼ï¼‰ï¼Œè€Œç©ºå¼•å·â€â€å°†ä¿ç•™è½´æ ‡é¢˜çš„é—´è·ï¼Œå¹¶ä¸”ä¸ä¼šæ‰“å°ä»»ä½•å†…å®¹ã€‚</strong></p><h2 id="é™åˆ¶åæ ‡è½´åŒºé—´"><a href="#é™åˆ¶åæ ‡è½´åŒºé—´" class="headerlink" title="é™åˆ¶åæ ‡è½´åŒºé—´"></a>é™åˆ¶åæ ‡è½´åŒºé—´</h2><p>æœ‰æ—¶ï¼Œæ‚¨æƒ³æ”¾å¤§æ•°æ®ï¼Œä»”ç»†è§‚å¯Ÿæ•°æ®çš„æŸä¸ªèŒƒå›´ã€‚æ‚¨å¯ä»¥åœ¨ä¸å¯¹æ•°æ®è¿›è¡Œå–å­é›†çš„æƒ…å†µä¸‹åšåˆ°è¿™ä¸€ç‚¹ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  ylim<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">50</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/01/64f1d5da6b0e2.png" style="width:600px;"/></div></div></p><p>æˆ–è€…ä½ èƒ½ä½¿ç”¨<mark class="hl-label blue">scale_y_continuous(limits=c(0,50))</mark> æˆ–è€…<mark class="hl-label blue">coord_cartesian(ylim=c(0,50))</mark> ã€‚å‰è€…åˆ é™¤åŒºåŸŸå¤–çš„æ‰€æœ‰ç‚¹ï¼Œç¬¬äºŒç§è°ƒæ•´å¯è§åŒºåŸŸï¼Œå’Œ<mark class="hl-label blue">ylim(c(0,50))</mark> ç±»ä¼¼ã€‚ä½ å¯èƒ½ä¼šæƒ³ï¼šä¸¤ä¸ªç»“æœæœ€åæ˜¯ä¸€æ ·çš„å—ï¼Ÿå…¶å®æ˜¯ä¸ä¸€æ ·çš„ï¼Œä¼šæœ‰ä¸€ä¸ªé‡è¦çš„ä¸åŒã€‚æ¯”è¾ƒæ¥ä¸‹æ¥çš„ä¸¤å¼ å›¾ï¼š<br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/01/64f1d91b7bea0.png" style="width:600px;"/></div></div></p><p>æ‚¨å¯èƒ½å·²ç»å‘ç°ï¼Œåœ¨å·¦ä¾§Yæé™å‘¨å›´æœ‰ä¸€äº›ç©ºçš„ç¼“å†²åŒºï¼Œè€Œåœ¨å³ä¾§ï¼Œç»˜åˆ¶çš„ç‚¹ä¸€ç›´å»¶ä¼¸åˆ°è¾¹ç•Œç”šè‡³æ›´è¿œã€‚è¿™å®Œç¾åœ°è¯´æ˜äº†å­é›†ï¼ˆå·¦ï¼‰ä¸ç¼©æ”¾ï¼ˆå³ï¼‰çš„å…³ç³»ã€‚ä¸ºäº†è¯´æ˜è¿™ä¸€ç‚¹çš„é‡è¦æ€§ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦ä¸€ç§å›¾è¡¨ç±»å‹â€”ç®±å½¢å›¾ï¼š<br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/01/64f1d9a1a655c.png" style="width:600px;"/></div></div><br>å‘ƒï¼Œè¿™æ˜¯å› ä¸º<mark class="hl-label blue">scale_x|y_continuous()</mark> å…ˆå¯¹æ•°æ®å–å­é›†ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šå¾—åˆ°å®Œå…¨ä¸åŒçš„ï¼ˆè€Œä¸”æ˜¯é”™è¯¯çš„ï¼Œè‡³å°‘å¦‚æœè¿™ä¸æ˜¯ä½ çš„ç›®çš„çš„è¯ï¼‰çš„ç›’å›¾ä¼°è®¡å€¼ï¼æˆ‘å¸Œæœ›æ‚¨ç°åœ¨ä¸å¿…å†å›åˆ°æ‚¨çš„æ—§è„šæœ¬ï¼Œæ£€æŸ¥æ‚¨æ˜¯å¦åœ¨ç»˜å›¾æ—¶ç¯¡æ”¹äº†æ•°æ®ï¼Œå¹¶åœ¨æ‚¨çš„æŠ¥å‘Šã€è®ºæ–‡æˆ–æ¯•ä¸šè®ºæ–‡ä¸­æŠ¥å‘Šäº†é”™è¯¯çš„ç»Ÿè®¡æ‘˜è¦â€¦</p><h2 id="å¼ºåˆ¶ä»åŸç‚¹å¼€å§‹ç»˜å›¾"><a href="#å¼ºåˆ¶ä»åŸç‚¹å¼€å§‹ç»˜å›¾" class="headerlink" title="å¼ºåˆ¶ä»åŸç‚¹å¼€å§‹ç»˜å›¾"></a>å¼ºåˆ¶ä»åŸç‚¹å¼€å§‹ç»˜å›¾</h2><p>ä¸æ­¤ç›¸å…³ï¼Œæ‚¨å¯ä»¥å¼ºåˆ¶Rä»åŸç‚¹å¼€å§‹ç»˜åˆ¶å›¾è¡¨ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">chic_high <span class="operator">&lt;-</span> dplyr<span class="operator">::</span>filter<span class="punctuation">(</span>chic<span class="punctuation">,</span> temp <span class="operator">&gt;</span> <span class="number">25</span><span class="punctuation">,</span> o3 <span class="operator">&gt;</span> <span class="number">20</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>chic_high<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> temp<span class="punctuation">,</span> y <span class="operator">=</span> o3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;darkcyan&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature higher than 25Â°F&quot;</span><span class="punctuation">,</span></span><br><span class="line">       y <span class="operator">=</span> <span class="string">&quot;Ozone higher than 20 ppb&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  expand_limits<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/01/64f1dc754f54f.png" style="width:600px;"/></div></div></p><details class="folding-tag" green><summary> ğŸ§‘â€ğŸ„ä½¿ç”¨coord_cartesianä¹Ÿä¼šäº§ç”Ÿç›¸åŒçš„ç»“æœã€‚å±•å¼€æŸ¥çœ‹ç¤ºä¾‹ï¼š </summary>              <div class='content'>              <figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">chic_high <span class="operator">&lt;-</span> dplyr<span class="operator">::</span>filter<span class="punctuation">(</span>chic<span class="punctuation">,</span> temp <span class="operator">&gt;</span> <span class="number">25</span><span class="punctuation">,</span> o3 <span class="operator">&gt;</span> <span class="number">20</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>chic_high<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> temp<span class="punctuation">,</span> y <span class="operator">=</span> o3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;darkcyan&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature higher than 25Â°F&quot;</span><span class="punctuation">,</span></span><br><span class="line">       y <span class="operator">=</span> <span class="string">&quot;Ozone higher than 20 ppb&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  coord_cartesian<span class="punctuation">(</span>xlim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="literal">NA</span><span class="punctuation">)</span><span class="punctuation">,</span> ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="literal">NA</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/01/64f1dc754f54f.png" style="width:600px;"/></div></div>              </div>            </details><p>æˆ‘ä»¬ä¹Ÿèƒ½çœŸæ­£çš„å¼ºåˆ¶ä»åŸç‚¹å¼€å§‹<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic_high<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> temp<span class="punctuation">,</span> y <span class="operator">=</span> o3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;darkcyan&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature higher than 25Â°F&quot;</span><span class="punctuation">,</span></span><br><span class="line">       y <span class="operator">=</span> <span class="string">&quot;Ozone higher than 20 ppb&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  expand_limits<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  coord_cartesian<span class="punctuation">(</span>expand <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> clip <span class="operator">=</span> <span class="string">&quot;off&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/01/64f1df43685a8.png" style="width:600px;"/></div></div></p><p><strong>ğŸ’¡ åœ¨ä»»ä½•åæ ‡ç³»ä¸­ï¼Œå‚æ•° clip = â€œoffâ€æ€»æ˜¯ä»¥ coord_* å¼€å§‹ï¼Œå…è®¸åœ¨é¢æ¿åŒºåŸŸå¤–ç»˜åˆ¶ã€‚</strong></p><p>åœ¨è¿™é‡Œï¼Œæˆ‘è°ƒç”¨å®ƒæ¥ç¡®ä¿ c(0, 0) å¤„çš„åˆ»åº¦çº¿ä¸ä¼šè¢«å‰ªåˆ‡ã€‚æ›´å¤šè¯¦æƒ…ï¼Œè¯·å‚é˜… Claus Wilkeåœ¨<a href="https://twitter.com/clauswilke/status/991542952802619392?lang=en">Twitter</a>ä¸Šå‘å¸ƒçš„ä¸»é¢˜ã€‚</p><h2 id="ç›¸åŒç¼©æ”¾æ¯”ä¾‹çš„åæ ‡è½´"><a href="#ç›¸åŒç¼©æ”¾æ¯”ä¾‹çš„åæ ‡è½´" class="headerlink" title="ç›¸åŒç¼©æ”¾æ¯”ä¾‹çš„åæ ‡è½´"></a>ç›¸åŒç¼©æ”¾æ¯”ä¾‹çš„åæ ‡è½´</h2><p>ä¸ºäº†æ¼”ç¤ºï¼Œè®©æˆ‘ä»¬ç»˜åˆ¶å¸¦æœ‰éšæœºå™ªéŸ³çš„æ¸©åº¦ä¸æ¸©åº¦çš„å¯¹æ¯”å›¾ã€‚<mark class="hl-label blue">coord_equal()</mark> æ˜¯ä¸€ä¸ªå…·æœ‰æŒ‡å®šæ¯”ç‡çš„åæ ‡ç³»ï¼Œè¯¥æ¯”ç‡è¡¨ç¤º y è½´ä¸Šçš„å•ä½æ•°ç›¸å½“äº x è½´ä¸Šçš„ä¸€ä¸ªå•ä½æ•°ã€‚é»˜è®¤å€¼ä¸º ratio = 1ï¼Œç¡®ä¿ x è½´ä¸Šçš„ä¸€ä¸ªå•ä½ä¸ y è½´ä¸Šçš„ä¸€ä¸ªå•ä½é•¿åº¦ç›¸åŒï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> temp<span class="punctuation">,</span> y <span class="operator">=</span> temp <span class="operator">+</span> rnorm<span class="punctuation">(</span>nrow<span class="punctuation">(</span>chic<span class="punctuation">)</span><span class="punctuation">,</span> sd <span class="operator">=</span> <span class="number">20</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;sienna&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F) + random noise&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  xlim<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">100</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> ylim<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">150</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  coord_fixed<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/01/64f1e298722ba.png" style="width:600px;"/></div></div></p><p>æ¯”å€¼å¤§äº 1 æ—¶ï¼Œy è½´ä¸Šçš„å•ä½æ¯” x è½´ä¸Šçš„å•ä½é•¿ï¼Œåä¹‹äº¦ç„¶ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> temp<span class="punctuation">,</span> y <span class="operator">=</span> temp <span class="operator">+</span> rnorm<span class="punctuation">(</span>nrow<span class="punctuation">(</span>chic<span class="punctuation">)</span><span class="punctuation">,</span> sd <span class="operator">=</span> <span class="number">20</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;sienna&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F) + random noise&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  xlim<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">100</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> ylim<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">150</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  coord_fixed<span class="punctuation">(</span>ratio <span class="operator">=</span> <span class="number">1</span><span class="operator">/</span><span class="number">5</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/01/64f1e39998309.png" style="width:600px;"/></div></div></p><h2 id="ä½¿ç”¨å‡½æ•°æ›´æ”¹æ ‡ç­¾"><a href="#ä½¿ç”¨å‡½æ•°æ›´æ”¹æ ‡ç­¾" class="headerlink" title="ä½¿ç”¨å‡½æ•°æ›´æ”¹æ ‡ç­¾"></a>ä½¿ç”¨å‡½æ•°æ›´æ”¹æ ‡ç­¾</h2><p>æœ‰æ—¶ï¼Œå¯¹æ ‡ç­¾ç¨ä½œæ”¹åŠ¨ä¼šå¾ˆæ–¹ä¾¿ï¼Œæ¯”å¦‚æ·»åŠ å•ä½æˆ–ç™¾åˆ†å·ï¼Œè€Œä¸ç”¨å°†å®ƒä»¬æ·»åŠ åˆ°æ•°æ®ä¸­ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å‡½æ•°ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_y_continuous<span class="punctuation">(</span>label <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">)</span> <span class="punctuation">&#123;</span><span class="built_in">return</span><span class="punctuation">(</span>paste<span class="punctuation">(</span>x<span class="punctuation">,</span> <span class="string">&quot;Degrees Fahrenheit&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">&#125;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/01/64f1e4c3af9b5.png" style="width:600px;"/></div></div></p><h1 id="æ ‡é¢˜"><a href="#æ ‡é¢˜" class="headerlink" title="æ ‡é¢˜"></a>æ ‡é¢˜</h1><h2 id="æ·»åŠ ä¸€ä¸ªæ ‡é¢˜"><a href="#æ·»åŠ ä¸€ä¸ªæ ‡é¢˜" class="headerlink" title="æ·»åŠ ä¸€ä¸ªæ ‡é¢˜"></a>æ·»åŠ ä¸€ä¸ªæ ‡é¢˜</h2><p>æˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡<mark class="hl-label blue">ggtitle()</mark> å‡½æ•°æ·»åŠ ä¸€ä¸ªæ ‡é¢˜<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  ggtitle<span class="punctuation">(</span><span class="string">&quot;Temperatures in Chicago&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/01/64f1e95c9039b.png" style="width:600px;"/></div></div></p><p>æˆ–è€…ï¼Œä½ ä¹Ÿèƒ½ä½¿ç”¨<mark class="hl-label blue">labs()</mark> ã€‚åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥æ·»åŠ å¤šä¸ªå‚æ•°ï¼Œä¾‹å¦‚é¢å¤–çš„å‰¯æ ‡é¢˜ã€æ ‡é¢˜å’Œæ ‡ç­¾ï¼ˆä»¥åŠä¹‹å‰æ˜¾ç¤ºçš„è½´æ ‡é¢˜ï¼‰ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span></span><br><span class="line">       title <span class="operator">=</span> <span class="string">&quot;Temperatures in Chicago&quot;</span><span class="punctuation">,</span></span><br><span class="line">       subtitle <span class="operator">=</span> <span class="string">&quot;Seasonal pattern of daily temperatures from 1997 to 2001&quot;</span><span class="punctuation">,</span></span><br><span class="line">       caption <span class="operator">=</span> <span class="string">&quot;Data: NMMAPS&quot;</span><span class="punctuation">,</span></span><br><span class="line">       tag <span class="operator">=</span> <span class="string">&quot;Fig. 1&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/01/64f1ec0d1b55b.png" style="width:600px;"/></div></div></p><h2 id="æ ‡é¢˜åŠ ç²—å¹¶åœ¨åº•çº¿å¤„æ·»åŠ ç©ºæ ¼"><a href="#æ ‡é¢˜åŠ ç²—å¹¶åœ¨åº•çº¿å¤„æ·»åŠ ç©ºæ ¼" class="headerlink" title="æ ‡é¢˜åŠ ç²—å¹¶åœ¨åº•çº¿å¤„æ·»åŠ ç©ºæ ¼"></a>æ ‡é¢˜åŠ ç²—å¹¶åœ¨åº•çº¿å¤„æ·»åŠ ç©ºæ ¼</h2><p>åŒæ ·ï¼Œç”±äºæˆ‘ä»¬è¦ä¿®æ”¹ä¸»é¢˜å…ƒç´ çš„å±æ€§ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨<mark class="hl-label blue">theme()</mark> å‡½æ•°ï¼Œå¹¶å¯¹æ–‡æœ¬å…ƒç´ <mark class="hl-label blue">axis.title</mark> å’Œ<mark class="hl-label blue">axis.text</mark> ä¿®æ”¹å­—ä½“å’Œè¾¹è·ã€‚ä»¥ä¸‹å¯¹ä¸»é¢˜å…ƒç´ çš„æ‰€æœ‰ä¿®æ”¹ä¸ä»…é€‚ç”¨äºæ ‡é¢˜ï¼Œä¹Ÿé€‚ç”¨äºæ‰€æœ‰å…¶ä»–æ ‡ç­¾ï¼Œå¦‚<mark class="hl-label blue">plot.subtitle</mark> ã€<mark class="hl-label blue">plot.caption</mark> ã€<mark class="hl-label blue">plot.tag</mark> ã€<mark class="hl-label blue">legend.title</mark> ã€<mark class="hl-label blue">legend.text</mark>  ä»¥åŠ <mark class="hl-label blue">axis.title</mark>  å’Œ <mark class="hl-label blue">axis.text</mark> ã€‚</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span></span><br><span class="line">       title <span class="operator">=</span> <span class="string">&quot;Temperatures in Chicago&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span>face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                  margin <span class="operator">=</span> margin<span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                                  size <span class="operator">=</span> <span class="number">14</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/01/64f1ef76a5798.png" style="width:600px;"/></div></div><p><strong>ğŸ’¡ è¦è®°ä½è¾¹çº¿å‚æ•°çš„é¡ºåºï¼Œä¸€ä¸ªå¾ˆå¥½çš„æ–¹æ³•æ˜¯ â€œt-r-oub-l-eâ€ï¼Œå®ƒç±»ä¼¼äºå››è¾¹çš„ç¬¬ä¸€ä¸ªå­—æ¯ã€‚</strong></p><h2 id="è°ƒæ•´æ ‡é¢˜ä½ç½®"><a href="#è°ƒæ•´æ ‡é¢˜ä½ç½®" class="headerlink" title="è°ƒæ•´æ ‡é¢˜ä½ç½®"></a>è°ƒæ•´æ ‡é¢˜ä½ç½®</h2><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œå¯¹é½ï¼ˆå·¦ã€ä¸­ã€å³ï¼‰æ˜¯é€šè¿‡<mark class="hl-label blue">hjust</mark> ï¼ˆä»£è¡¨æ°´å¹³è°ƒæ•´ï¼‰è¿›è¡Œè°ƒèŠ‚ã€‚<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">       title <span class="operator">=</span> <span class="string">&quot;Temperatures in Chicago&quot;</span><span class="punctuation">,</span></span><br><span class="line">       caption <span class="operator">=</span> <span class="string">&quot;Data: NMMAPS&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span>hjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">16</span><span class="punctuation">,</span> face <span class="operator">=</span> <span class="string">&quot;bold.italic&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/01/64f1f2864d2d4.png" style="width:600px;"/></div></div></p><p>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰å¯èƒ½è¿›è¡Œå‚ç›´æ–¹å‘çš„è°ƒæ•´ï¼Œå…¶ä½¿ç”¨<mark class="hl-label blue">vjust</mark> è¿›è¡Œè°ƒæ•´ã€‚</p><p>è‡ª 2019 å¹´èµ·ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®é¢æ¿åŒºåŸŸï¼ˆé»˜è®¤ï¼‰æˆ– <mark class="hl-label blue">plot.title.position</mark> å’Œ<mark class="hl-label blue">plot.caption.position</mark> æŒ‡å®šæ ‡é¢˜ã€å‰¯æ ‡é¢˜å’Œæ ‡é¢˜çš„å¯¹é½æ–¹å¼ã€‚å®é™…ä¸Šï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåè€…åœ¨è®¾è®¡ä¸Šæ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œè®¸å¤šäººå¯¹è¿™é¡¹æ–°åŠŸèƒ½æ„Ÿåˆ°éå¸¸é«˜å…´ï¼Œå› ä¸ºå°¤å…¶æ˜¯å¯¹äºå¾ˆé•¿çš„ Y è½´æ ‡ç­¾ï¼Œå¯¹é½æ–¹å¼çœ‹èµ·æ¥éå¸¸ç³Ÿç³•ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">(</span>g <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_y_continuous<span class="punctuation">(</span>label <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">)</span> <span class="punctuation">&#123;</span><span class="built_in">return</span><span class="punctuation">(</span>paste<span class="punctuation">(</span>x<span class="punctuation">,</span> <span class="string">&quot;Degrees Fahrenheit&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">&#125;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">       title <span class="operator">=</span> <span class="string">&quot;Temperatures in Chicago between 1997 and 2001 in Degrees Fahrenheit&quot;</span><span class="punctuation">,</span></span><br><span class="line">       caption <span class="operator">=</span> <span class="string">&quot;Data: NMMAPS&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">14</span><span class="punctuation">,</span> face <span class="operator">=</span> <span class="string">&quot;bold.italic&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        plot.caption <span class="operator">=</span> element_text<span class="punctuation">(</span>hjust <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/01/64f1f482804b7.png" style="width:600px;"/></div></div></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span> theme<span class="punctuation">(</span>plot.title.position <span class="operator">=</span> <span class="string">&quot;plot&quot;</span><span class="punctuation">,</span></span><br><span class="line">          plot.caption.position <span class="operator">=</span> <span class="string">&quot;plot&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/01/64f1f4bbc9ff2.png" style="width:600px;"/></div></div><h2 id="æ ‡é¢˜ä¸­ä½¿ç”¨éä¼ ç»Ÿå­—ä½“"><a href="#æ ‡é¢˜ä¸­ä½¿ç”¨éä¼ ç»Ÿå­—ä½“" class="headerlink" title="æ ‡é¢˜ä¸­ä½¿ç”¨éä¼ ç»Ÿå­—ä½“"></a>æ ‡é¢˜ä¸­ä½¿ç”¨éä¼ ç»Ÿå­—ä½“</h2><p>æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ä¸åŒçš„å­—ä½“ï¼Œè€Œä¸ä»…ä»…æ˜¯ ggplot æä¾›çš„é»˜è®¤å­—ä½“ï¼ˆä¸åŒæ“ä½œç³»ç»Ÿæä¾›çš„å­—ä½“ä¹Ÿä¸åŒï¼‰ã€‚æœ‰å‡ ä¸ªè½¯ä»¶åŒ…å¯ä»¥å¸®åŠ©æ‚¨ä½¿ç”¨å®‰è£…åœ¨æœºå™¨ä¸Šçš„å­—ä½“ï¼ˆæ‚¨å¯èƒ½ä¼šåœ¨åŠå…¬ç¨‹åºä¸­ä½¿ç”¨è¿™äº›å­—ä½“ï¼‰ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä½¿ç”¨äº†<a href="https://github.com/yixuan/showtext">showtext</a>è½¯ä»¶åŒ…ï¼Œå®ƒå¯ä»¥è®©æˆ‘ä»¬åœ¨Rç»˜å›¾ä¸­è½»æ¾ä½¿ç”¨å„ç§ç±»å‹çš„å­—ä½“ï¼ˆTrueTypeã€OpenTypeã€Type 1ã€web fontsç­‰ï¼‰ã€‚åŠ è½½è½¯ä»¶åŒ…åï¼Œä½ è¿˜éœ€è¦å¯¼å…¥å®‰è£…åœ¨è®¾å¤‡ä¸Šçš„å­—ä½“ã€‚æˆ‘ç»å¸¸ä½¿ç”¨Googleå­—ä½“ï¼Œè¿™äº›å­—ä½“å¯ä»¥é€šè¿‡å‡½æ•°<mark class="hl-label blue">font_add_google()</mark> å¯¼å…¥ï¼Œä½†ä¹Ÿå¯ä»¥é€šè¿‡<mark class="hl-label blue">font_add()</mark> æ·»åŠ å…¶ä»–å­—ä½“ã€‚è¯·æ³¨æ„ï¼Œå³ä½¿ä½¿ç”¨<a href="https://fonts.google.com/">Googleå­—ä½“</a>ï¼Œä¹Ÿå¿…é¡»å®‰è£…å­—ä½“å¹¶é‡å¯Rstudioæ‰èƒ½ä½¿ç”¨ã€‚<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>showtext<span class="punctuation">)</span></span><br><span class="line">font_add_google<span class="punctuation">(</span><span class="string">&quot;Gochi Hand&quot;</span><span class="punctuation">,</span> <span class="string">&quot;gochi&quot;</span><span class="punctuation">)</span></span><br><span class="line">font_add_google<span class="punctuation">(</span><span class="string">&quot;Schoolbell&quot;</span><span class="punctuation">,</span> <span class="string">&quot;bell&quot;</span><span class="punctuation">)</span></span><br><span class="line">font_add_google<span class="punctuation">(</span><span class="string">&quot;Covered By Your Grace&quot;</span><span class="punctuation">,</span> <span class="string">&quot;grace&quot;</span><span class="punctuation">)</span></span><br><span class="line">font_add_google<span class="punctuation">(</span><span class="string">&quot;Rock Salt&quot;</span><span class="punctuation">,</span> <span class="string">&quot;rock&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure></p><p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨â€”æ˜¯çš„ï¼Œä½ çŒœå¯¹äº†â€”<mark class="hl-label blue">theme()</mark> æ¥ä½¿ç”¨è¿™äº›å­—ä½“å®¶æ—ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span></span><br><span class="line">       title <span class="operator">=</span> <span class="string">&quot;Temperatures in Chicago&quot;</span><span class="punctuation">,</span></span><br><span class="line">       subtitle <span class="operator">=</span> <span class="string">&quot;Daily temperatures in Â°F from 1997 to 2001&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span>family <span class="operator">=</span> <span class="string">&quot;gochi&quot;</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">25</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        plot.subtitle <span class="operator">=</span> element_text<span class="punctuation">(</span>family <span class="operator">=</span> <span class="string">&quot;bell&quot;</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">15</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/02/64f217823270c.png" style="width:600px;"/></div></div></p><p>æ‚¨ä¹Ÿå¯ä»¥ä¸ºç»˜å›¾ä¸­çš„æ‰€æœ‰æ–‡æœ¬å…ƒç´ è®¾ç½®éé»˜è®¤å­—ä½“ï¼Œè¯¦æƒ…è¯·å‚é˜… â€œä¸»é¢˜ â€œéƒ¨åˆ†ã€‚æˆ‘å°†ä½¿ç”¨ Roboto Condensed ä½œä¸ºä»¥ä¸‹æ‰€æœ‰ç»˜å›¾çš„æ–°å­—ä½“ã€‚<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">font_add_google<span class="punctuation">(</span><span class="string">&quot;Roboto Condensed&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Roboto Condensed&quot;</span><span class="punctuation">)</span></span><br><span class="line">theme_set<span class="punctuation">(</span>theme_bw<span class="punctuation">(</span>base_size <span class="operator">=</span> <span class="number">12</span><span class="punctuation">,</span> base_family <span class="operator">=</span> <span class="string">&quot;Roboto Condensed&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br>(ä¹‹å‰ï¼Œæœ¬æ•™ç¨‹ä½¿ç”¨çš„æ˜¯{extrafont}è½¯ä»¶åŒ…ï¼Œå®ƒåœ¨å»å¹´ä¹‹å‰ä¸€ç›´åšå¾—å¾ˆå¥½ã€‚çªç„¶é—´ï¼Œæˆ‘å†ä¹Ÿä¸èƒ½æ·»åŠ ä»»ä½•æ–°å­—ä½“äº†ï¼Œè€Œä¸”åœ¨æ¢äº†æ–°ç¬”è®°æœ¬ç”µè„‘åï¼Œè½¯ä»¶åŒ…æ ¹æœ¬æ‰¾ä¸åˆ°ä»»ä½•å­—ä½“â€¦â€¦ç°åœ¨æˆ‘é€šå¸¸å»ºè®®ä½¿ç”¨{ragg}è½¯ä»¶åŒ…ã€‚ä¸è¿‡ï¼Œæˆ‘æ²¡èƒ½è®©å®ƒåœ¨æˆ‘çš„ä¸»é¡µä¸Šå‘æŒ¥ä½œç”¨ï¼Œæ‰€ä»¥æˆ‘ä½¿ç”¨äº†{showtext}è½¯ä»¶åŒ…ï¼Œå®ƒä¹Ÿå¾ˆä¸é”™ï¼Œå”¯ä¸€çš„ä¸»è¦åŒºåˆ«æ˜¯ï¼Œä½ éœ€è¦ç”¨{showtext}æ˜ç¡®å¯¼å…¥ä½ æƒ³ä½¿ç”¨çš„å­—ä½“ã€‚ä¸è¿‡ï¼Œ{showtext}ä¼¼ä¹å¹¶ä¸èƒ½å¾ˆå¥½åœ°è§£å†³ä¸€äº›<a href="https://twitter.com/thomasp85/status/1355083725156077571">æŠ€æœ¯ç»†èŠ‚é—®é¢˜</a>ï¼Œæ‰€ä»¥ä½ å¯èƒ½ä¼šåœ¨ä¸‡ä¸å¾—å·²çš„æƒ…å†µä¸‹æ‰ä½¿ç”¨è¿™ä¸ªè½¯ä»¶åŒ…ï¼ˆ)ã€‚</p><h2 id="æ›´æ”¹å¤šè¡Œæ–‡æœ¬çš„é—´è·"><a href="#æ›´æ”¹å¤šè¡Œæ–‡æœ¬çš„é—´è·" class="headerlink" title="æ›´æ”¹å¤šè¡Œæ–‡æœ¬çš„é—´è·"></a>æ›´æ”¹å¤šè¡Œæ–‡æœ¬çš„é—´è·</h2><p>ä½ å¯ä»¥ä½¿ç”¨<mark class="hl-label blue">lineheight</mark> å‚æ•°æ¥æ”¹å˜è¡Œé—´è·ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘å°†è¡Œè·å‹ç¼©åˆ°äº†ä¸€èµ·ï¼ˆlineheight &lt; 1ï¼‰ã€‚<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  ggtitle<span class="punctuation">(</span><span class="string">&quot;Temperatures in Chicago\nfrom 1997 to 2001&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span>lineheight <span class="operator">=</span> <span class="number">.8</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">16</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/02/64f219cf18c24.png" style="width:600px;"/></div></div></p><h1 id="å›¾ä¾‹"><a href="#å›¾ä¾‹" class="headerlink" title="å›¾ä¾‹"></a>å›¾ä¾‹</h1><p>æˆ‘ä»¬å°†æ ¹æ®å­£èŠ‚å¯¹ç»˜å›¾è¿›è¡Œé¢œè‰²ç¼–ç ã€‚æˆ–è€…ç”¨æ›´åƒggplotçš„æ–¹å¼æ¥è¡¨è¿°ï¼šæˆ‘ä»¬å°†seasonå˜é‡æ˜ å°„ä¸ºç¾å­¦é¢œè‰²ã€‚{ggplot2}çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯ï¼Œåœ¨å°†å˜é‡æ˜ å°„åˆ°ç¾å­¦é¢œè‰²æ—¶ï¼Œå®ƒä¼šé»˜è®¤æ·»åŠ ä¸€ä¸ªå›¾ä¾‹ã€‚ä½ å¯ä»¥çœ‹åˆ°ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå›¾ä¾‹æ ‡é¢˜æ˜¯æˆ‘ä»¬åœ¨é¢œè‰²å‚æ•°ä¸­æŒ‡å®šçš„ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span></span><br><span class="line">       aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/02/64f286b8c8e27.png" style="width:600px;"/></div></div></p><h2 id="å…³é—­å›¾ä¾‹"><a href="#å…³é—­å›¾ä¾‹" class="headerlink" title="å…³é—­å›¾ä¾‹"></a>å…³é—­å›¾ä¾‹</h2><p>ç¬¬ä¸€ä¸ªé—®é¢˜æ€»æ˜¯ï¼šâ€å¦‚ä½•æ‰èƒ½å»æ‰å›¾ä¾‹ï¼Ÿ</p><p>å®ƒæ˜¯å¾ˆç®€å•çš„ï¼Œæ€»æ˜¯ä½¿ç”¨<mark class="hl-label blue">theme(legend.position=none)</mark> <br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span></span><br><span class="line">       aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/02/64f287a48a20b.png" style="width:600px;"/></div></div></p><p>ä½ ä¹Ÿèƒ½æ ¹æ®å®é™…æƒ…å†µä½¿ç”¨<mark class="hl-label blue">guides(color=none)</mark> æˆ–è€…<mark class="hl-label blue">scale_color_discrete(guide=none)</mark> ã€‚æ›´æ”¹ä¸»é¢˜å…ƒç´ ä¼šä¸€æ¬¡æ€§åˆ é™¤æ‰€æœ‰å›¾ä¾‹ï¼Œè€Œä½¿ç”¨åä¸€ç§é€‰é¡¹åˆ™å¯ä»¥åˆ é™¤ç‰¹å®šå›¾ä¾‹ï¼ŒåŒæ—¶ä¿ç•™å…¶ä»–ä¸€äº›å›¾ä¾‹ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span></span><br><span class="line">       aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span></span><br><span class="line">           color <span class="operator">=</span> season<span class="punctuation">,</span> shape <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  guides<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/02/64f28b94170db.png" style="width:600px;"/></div></div></p><p>ä¾‹å¦‚ï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¿ç•™äº†å½¢çŠ¶çš„å›¾ä¾‹ï¼Œè€Œä¸¢å¼ƒäº†é¢œè‰²çš„å›¾ä¾‹ã€‚</p><h2 id="ç§»é™¤å›¾ä¾‹æ ‡é¢˜"><a href="#ç§»é™¤å›¾ä¾‹æ ‡é¢˜" class="headerlink" title="ç§»é™¤å›¾ä¾‹æ ‡é¢˜"></a>ç§»é™¤å›¾ä¾‹æ ‡é¢˜</h2><p>æˆ‘ä»¬æ—©å·²å­¦åˆ°çš„ï¼Œä½¿ç”¨<mark class="hl-label blue">element_blank()</mark> :<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/02/64f28f3be91d3.png" style="width:600px;"/></div></div></p><details class="folding-tag" green><summary> ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å›¾ä¾‹åä¸ºNULLæ¥å®ç°ç›¸åŒçš„æ•ˆæœï¼Œé€šè¿‡scale_color_discrete(name=NULL)æˆ–labs(color = NULL)ã€‚å±•å¼€æŸ¥çœ‹ç¤ºä¾‹ï¼š </summary>              <div class='content'>              <figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_color_discrete<span class="punctuation">(</span>name <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/02/64f28f3be91d3.png" style="width:600px;"/></div></div><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>color <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/02/64f28f3be91d3.png" style="width:600px;"/></div></div>              </div>            </details><h2 id="æ”¹å˜å›¾ä¾‹ä½ç½®"><a href="#æ”¹å˜å›¾ä¾‹ä½ç½®" class="headerlink" title="æ”¹å˜å›¾ä¾‹ä½ç½®"></a>æ”¹å˜å›¾ä¾‹ä½ç½®</h2><p>å¦‚æœä¸æƒ³å°†å›¾ä¾‹æ”¾åœ¨å³ä¾§ï¼Œå¯ä»¥ä½¿ç”¨ legend.position ä½œä¸ºä¸»é¢˜å‚æ•°ã€‚å¯èƒ½çš„ä½ç½®æœ‰ â€œé¡¶éƒ¨â€ã€â€å³ä¾§â€ï¼ˆé»˜è®¤ï¼‰ã€â€åº•éƒ¨ â€œå’Œ â€œå·¦ä¾§â€ã€‚<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&quot;top&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/02/64f29179cb8a8.png" style="width:600px;"/></div></div></p><p>æ‚¨ä¹Ÿå¯ä»¥é€šè¿‡æŒ‡å®šä¸€ä¸ªå…·æœ‰ç›¸å¯¹ x å’Œ y åæ ‡çš„å‘é‡ï¼Œå°†å›¾ä¾‹ç½®äºé¢æ¿å†…éƒ¨ï¼Œè¯¥å‘é‡çš„èŒƒå›´ä¸º 0ï¼ˆå·¦ä¾§æˆ–åº•éƒ¨ï¼‰åˆ° 1ï¼ˆå³ä¾§æˆ–é¡¶éƒ¨ï¼‰ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span></span><br><span class="line">       color <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">.15</span><span class="punctuation">,</span> <span class="number">.15</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;transparent&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/02/64f29239a481c.png" style="width:600px;"/></div></div><br>åœ¨è¿™é‡Œï¼Œæˆ‘è¿˜ç”¨é€æ˜å¡«å……è¦†ç›–äº†é»˜è®¤çš„ç™½è‰²å›¾ä¾‹èƒŒæ™¯ï¼Œä»¥ç¡®ä¿å›¾ä¾‹ä¸ä¼šéšè—ä»»ä½•æ•°æ®ç‚¹ã€‚</p><h2 id="æ”¹å˜å›¾ä¾‹æ–¹å‘"><a href="#æ”¹å˜å›¾ä¾‹æ–¹å‘" class="headerlink" title="æ”¹å˜å›¾ä¾‹æ–¹å‘"></a>æ”¹å˜å›¾ä¾‹æ–¹å‘</h2><p>å¦‚æ‚¨æ‰€è§ï¼Œå›¾ä¾‹æ–¹å‘é»˜è®¤ä¸ºå‚ç›´ï¼Œä½†é€‰æ‹© â€œé¡¶éƒ¨ â€œæˆ– â€œåº•éƒ¨ â€œä½ç½®æ—¶ï¼Œå›¾ä¾‹æ–¹å‘åˆ™ä¸ºæ°´å¹³ã€‚ä¸è¿‡ï¼Œæ‚¨ä¹Ÿå¯ä»¥éšæ„åˆ‡æ¢æ–¹å‘ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">.5</span><span class="punctuation">,</span> <span class="number">.97</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;transparent&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  guides<span class="punctuation">(</span>color <span class="operator">=</span> guide_legend<span class="punctuation">(</span>direction <span class="operator">=</span> <span class="string">&quot;horizontal&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/02/64f293426b80e.png" style="width:600px;"/></div></div></p><h2 id="æ”¹å˜å›¾ä¾‹æ ‡é¢˜é£æ ¼"><a href="#æ”¹å˜å›¾ä¾‹æ ‡é¢˜é£æ ¼" class="headerlink" title="æ”¹å˜å›¾ä¾‹æ ‡é¢˜é£æ ¼"></a>æ”¹å˜å›¾ä¾‹æ ‡é¢˜é£æ ¼</h2><p>ä½ ä¹Ÿå¯ä»¥é€šè¿‡ä¸»é¢˜å…ƒç´ <mark class="hl-label blue">legend.title</mark> è°ƒæ•´å›¾ä¾‹æ ‡é¢˜å¤–è§‚ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.title <span class="operator">=</span> element_text<span class="punctuation">(</span>family <span class="operator">=</span> <span class="string">&quot;Playfair&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                    color <span class="operator">=</span> <span class="string">&quot;chocolate&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                    size <span class="operator">=</span> <span class="number">14</span><span class="punctuation">,</span> face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/02/64f2952244f16.png" style="width:600px;"/></div></div></p><h2 id="æ”¹å˜å›¾ä¾‹æ ‡é¢˜"><a href="#æ”¹å˜å›¾ä¾‹æ ‡é¢˜" class="headerlink" title="æ”¹å˜å›¾ä¾‹æ ‡é¢˜"></a>æ”¹å˜å›¾ä¾‹æ ‡é¢˜</h2><p>æ›´æ”¹å›¾ä¾‹æ ‡é¢˜çš„æœ€ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨<mark class="hl-label blue">labs()</mark>  å›¾å±‚ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span></span><br><span class="line">       color <span class="operator">=</span> <span class="string">&quot;Seasons\nindicated\nby colors:&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.title <span class="operator">=</span> element_text<span class="punctuation">(</span>family <span class="operator">=</span> <span class="string">&quot;Playfair&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                    color <span class="operator">=</span> <span class="string">&quot;chocolate&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                    size <span class="operator">=</span> <span class="number">14</span><span class="punctuation">,</span> face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/02/64f295d3ac4ad.png" style="width:600px;"/></div></div></p><p>å¯é€šè¿‡ scale_color_discrete(name = â€œtitleâ€) æˆ– guides(color = guide_legend(â€œtitleâ€))æ›´æ”¹å›¾ä¾‹ç»†èŠ‚ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.title <span class="operator">=</span> element_text<span class="punctuation">(</span>family <span class="operator">=</span> <span class="string">&quot;Playfair&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                    color <span class="operator">=</span> <span class="string">&quot;chocolate&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                    size <span class="operator">=</span> <span class="number">14</span><span class="punctuation">,</span> face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_color_discrete<span class="punctuation">(</span>name <span class="operator">=</span> <span class="string">&quot;Seasons\nindicated\nby colors:&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/02/64f295d3ac4ad.png" style="width:600px;"/></div></div></p><h2 id="æ”¹å˜å›¾ä¾‹é¡ºåº"><a href="#æ”¹å˜å›¾ä¾‹é¡ºåº" class="headerlink" title="æ”¹å˜å›¾ä¾‹é¡ºåº"></a>æ”¹å˜å›¾ä¾‹é¡ºåº</h2><p>æˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡æ”¹å˜<mark class="hl-label blue">season</mark> levelså®Œæˆè¿™ä¸ªç›®çš„ã€‚<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">chic<span class="operator">$</span>season <span class="operator">&lt;-</span></span><br><span class="line">  factor<span class="punctuation">(</span>chic<span class="operator">$</span>season<span class="punctuation">,</span></span><br><span class="line">         levels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Winter&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Spring&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Summer&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Autumn&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/02/64f2979bd495a.png" style="width:600px;"/></div></div></p><h2 id="æ”¹å˜å›¾ä¾‹æ ‡ç­¾"><a href="#æ”¹å˜å›¾ä¾‹æ ‡ç­¾" class="headerlink" title="æ”¹å˜å›¾ä¾‹æ ‡ç­¾"></a>æ”¹å˜å›¾ä¾‹æ ‡ç­¾</h2><p>æˆ‘ä»¬å°†é€šè¿‡åœ¨<mark class="hl-label blue">scale_color_discrete()</mark> è°ƒç”¨ä¸­æä¾›ä¸€ä¸ªåç§°å‘é‡ï¼Œç”¨monthsæ¥æ›¿æ¢seasonsï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_color_discrete<span class="punctuation">(</span></span><br><span class="line">    name <span class="operator">=</span> <span class="string">&quot;Seasons:&quot;</span><span class="punctuation">,</span></span><br><span class="line">    labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Marâ€”May&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Junâ€”Aug&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Sepâ€”Nov&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Decâ€”Feb&quot;</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.title <span class="operator">=</span> element_text<span class="punctuation">(</span></span><br><span class="line">    family <span class="operator">=</span> <span class="string">&quot;Playfair&quot;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;chocolate&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">14</span><span class="punctuation">,</span> face <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">  <span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/02/64f2997c0ac6e.png" style="width:600px;"/></div></div></p><h2 id="æ›´æ”¹å›¾ä¾‹ä¸­çš„èƒŒæ™¯æ¡†"><a href="#æ›´æ”¹å›¾ä¾‹ä¸­çš„èƒŒæ™¯æ¡†" class="headerlink" title="æ›´æ”¹å›¾ä¾‹ä¸­çš„èƒŒæ™¯æ¡†"></a>æ›´æ”¹å›¾ä¾‹ä¸­çš„èƒŒæ™¯æ¡†</h2><p>è¦æ›´æ”¹å›¾ä¾‹é”®çš„èƒŒæ™¯é¢œè‰²ï¼ˆå¡«å……ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦è°ƒæ•´ä¸»é¢˜å…ƒç´ <mark class="hl-label blue">legend.key</mark> çš„è®¾ç½®ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.key <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;darkgoldenrod1&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.title <span class="operator">=</span> element_text<span class="punctuation">(</span>family <span class="operator">=</span> <span class="string">&quot;Playfair&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                    color <span class="operator">=</span> <span class="string">&quot;chocolate&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                    size <span class="operator">=</span> <span class="number">14</span><span class="punctuation">,</span> face <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_color_discrete<span class="punctuation">(</span><span class="string">&quot;Seasons:&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/02/64f29a3869684.png" style="width:600px;"/></div></div></p><p>å¦‚æœæƒ³å®Œå…¨æ¶ˆé™¤å®ƒä»¬ï¼Œè¯·ä½¿ç”¨<mark class="hl-label blue">fill=NA</mark> æˆ–<mark class="hl-label blue">fill=â€œtransparentâ€</mark> ã€‚</p><h2 id="æ›´æ”¹å›¾ä¾‹ç¬¦å·çš„å¤§å°"><a href="#æ›´æ”¹å›¾ä¾‹ç¬¦å·çš„å¤§å°" class="headerlink" title="æ›´æ”¹å›¾ä¾‹ç¬¦å·çš„å¤§å°"></a>æ›´æ”¹å›¾ä¾‹ç¬¦å·çš„å¤§å°</h2><p>å¦‚æœä½¿ç”¨é»˜è®¤å°ºå¯¸ï¼Œå›¾ä¾‹ä¸­çš„ç‚¹å¯èƒ½ä¼šæœ‰ç‚¹æ¨¡ç³Šï¼Œå°¤å…¶æ˜¯åœ¨æ²¡æœ‰æ–¹æ¡†çš„æƒ…å†µä¸‹ã€‚è¦è¦†ç›–é»˜è®¤å€¼ï¼Œå¯ä»¥å†æ¬¡ä½¿ç”¨<mark class="hl-label blue">guides</mark> ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.key <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.title <span class="operator">=</span> element_text<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;chocolate&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                    size <span class="operator">=</span> <span class="number">14</span><span class="punctuation">,</span> face <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_color_discrete<span class="punctuation">(</span><span class="string">&quot;Seasons:&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  guides<span class="punctuation">(</span>color <span class="operator">=</span> guide_legend<span class="punctuation">(</span>override.aes <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">6</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/04/64f4ad8b9d657.png" style="width:600px;"/></div></div></p><h2 id="åŒå±‚å›¾ä¾‹"><a href="#åŒå±‚å›¾ä¾‹" class="headerlink" title="åŒå±‚å›¾ä¾‹"></a>åŒå±‚å›¾ä¾‹</h2><p>æ¯”æ–¹è¯´ï¼Œæ‚¨æœ‰ä¸¤ä¸ªä¸åŒçš„å‡ ä½•å½¢çŠ¶æ˜ å°„åˆ°åŒä¸€ä¸ªå˜é‡ã€‚ä¾‹å¦‚ï¼ŒåŒä¸€æ•°æ®çš„ç‚¹å›¾å±‚å’Œè½´é¡»å›¾å±‚éƒ½ä»¥é¢œè‰²ä¸ºç¾å­¦ç‰¹å¾ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç‚¹å’Œ â€œçº¿â€éƒ½ä¼šè¿™æ ·å‡ºç°åœ¨å›¾ä¾‹ä¸­ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_rug<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/04/64f4afd06f76f.png" style="width:600px;"/></div></div></p><p>ä½ å¯ä»¥ä½¿ç”¨<mark class="hl-label blue">show.legend=FALSE</mark> å»æ‰ä¸€å±‚å›¾ä¾‹<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_rug<span class="punctuation">(</span>show.legend <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/04/64f4b0c765830.png" style="width:600px;"/></div></div></p><h2 id="æ‰‹åŠ¨æ·»åŠ å›¾ä¾‹æ¡ç›®"><a href="#æ‰‹åŠ¨æ·»åŠ å›¾ä¾‹æ¡ç›®" class="headerlink" title="æ‰‹åŠ¨æ·»åŠ å›¾ä¾‹æ¡ç›®"></a>æ‰‹åŠ¨æ·»åŠ å›¾ä¾‹æ¡ç›®</h2><p>{ggplot2}ä¸ä¼šè‡ªåŠ¨æ·»åŠ å›¾ä¾‹ï¼Œé™¤éä½ å°†ç¾å­¦ï¼ˆé¢œè‰²ã€å¤§å°ç­‰ï¼‰æ˜ å°„åˆ°å˜é‡ä¸Šã€‚ä¸è¿‡ï¼Œæœ‰æ—¶å€™æˆ‘è¿˜æ˜¯å¸Œæœ›æ·»åŠ ä¸€ä¸ªå›¾ä¾‹ï¼Œè¿™æ ·å°±èƒ½æ¸…æ¥šåœ°çŸ¥é“ä½ åœ¨ç»˜åˆ¶ä»€ä¹ˆã€‚<br>è¿™é‡Œæ˜¯é»˜è®¤å›¾ï¼š<br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/04/64f4b180521cf.png" style="width:600px;"/></div></div></p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†guideæ˜ å°„åˆ°å˜é‡æ¥å¼ºåˆ¶ç”Ÿæˆå›¾ä¾‹ã€‚æˆ‘ä»¬ä½¿ç”¨<mark class="hl-label blue">aes()</mark> å¯¹çº¿æ¡å’Œç‚¹è¿›è¡Œæ˜ å°„ï¼Œè€Œä¸”ä¸æ˜¯æ˜ å°„åˆ°æ•°æ®é›†ä¸­çš„å˜é‡ï¼Œè€Œæ˜¯æ˜ å°„åˆ°å•ä¸ªå­—ç¬¦ä¸²ï¼ˆè¿™æ ·æˆ‘ä»¬å°±èƒ½ä¸ºæ¯ä¸ªå­—ç¬¦ä¸²é€‰æ‹©ä¸€ç§é¢œè‰²ï¼‰ã€‚<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> o3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_line<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;line&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;points&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Ozone&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_color_discrete<span class="punctuation">(</span><span class="string">&quot;Type:&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/04/64f4b33745040.png" style="width:600px;"/></div></div></p><p>æˆ‘ä»¬å¿«æˆåŠŸäº†ï¼Œä½†è¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚æˆ‘ä»¬æƒ³è¦ç°è‰²å’Œçº¢è‰²ï¼è¦æ”¹å˜é¢œè‰²ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<mark class="hl-label blue">scale_color_manual()</mark> ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨<mark class="hl-label blue">guides()</mark> å‡½æ•°è¦†ç›–å›¾ä¾‹ç¾å­¦ã€‚</p><p>å¥½äº†ï¼ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»ç»˜åˆ¶äº†ä¸€å¹…å›¾ï¼Œå›¾ä¾‹ç¬¦å·ä¸ºç°è‰²çº¿å’Œçº¢è‰²ç‚¹ï¼Œä»¥åŠä¸€æ¡ç°è‰²çº¿å’Œä¸€ä¸ªçº¢è‰²ç‚¹ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> o3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_line<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;line&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;points&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Ozone&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_color_manual<span class="punctuation">(</span>name <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">                     guide <span class="operator">=</span> <span class="string">&quot;legend&quot;</span><span class="punctuation">,</span></span><br><span class="line">                     values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;points&quot;</span> <span class="operator">=</span> <span class="string">&quot;darkorange2&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="string">&quot;line&quot;</span> <span class="operator">=</span> <span class="string">&quot;gray&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  guides<span class="punctuation">(</span>color <span class="operator">=</span> guide_legend<span class="punctuation">(</span>override.aes <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span>linetype <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                                                  shape <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="literal">NA</span><span class="punctuation">,</span> <span class="number">16</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/04/64f4b4af787ed.png" style="width:600px;"/></div></div></p><h2 id="ä½¿ç”¨å…¶ä»–é£æ ¼çš„å›¾ä¾‹"><a href="#ä½¿ç”¨å…¶ä»–é£æ ¼çš„å›¾ä¾‹" class="headerlink" title="ä½¿ç”¨å…¶ä»–é£æ ¼çš„å›¾ä¾‹"></a>ä½¿ç”¨å…¶ä»–é£æ ¼çš„å›¾ä¾‹</h2><p>å­£èŠ‚ç­‰åˆ†ç±»å˜é‡çš„é»˜è®¤å›¾ä¾‹æ˜¯<mark class="hl-label blue">guide_legend()</mark> ï¼Œè¿™åœ¨ä¹‹å‰çš„å‡ ä¸ªç¤ºä¾‹ä¸­éƒ½æœ‰æ‰€ä½“ç°ã€‚å¦‚æœå°†è¿ç»­å˜é‡æ˜ å°„ä¸ºå®¡ç¾å˜é‡ï¼Œ{ggplot2} é»˜è®¤ä¸ä½¿ç”¨ guide_legend()ï¼Œè€Œæ˜¯ä½¿ç”¨<mark class="hl-label blue">guide_colorbar()</mark> (æˆ–<mark class="hl-label blue">guide_colourbar()</mark> </p><p>ä¸è¿‡ï¼Œé€šè¿‡ä½¿ç”¨<mark class="hl-label blue">guide_legend()</mark> ï¼Œæ‚¨å¯ä»¥å¼ºåˆ¶å›¾ä¾‹æ˜¾ç¤ºç»™å®šæ–­ç‚¹æ•°çš„ç¦»æ•£é¢œè‰²ï¼Œå°±åƒåˆ†ç±»å˜é‡ä¸€æ ·ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span></span><br><span class="line">       aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  guides<span class="punctuation">(</span>color <span class="operator">=</span> guide_legend<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/04/64f4b6920d593.png" style="width:600px;"/></div></div></p><p>æ‚¨è¿˜å¯ä»¥ä½¿ç”¨åˆ†æ¡£åˆ»åº¦ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span></span><br><span class="line">       aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  guides<span class="punctuation">(</span>color <span class="operator">=</span> guide_bins<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/04/64f4b7351f809.png" style="width:600px;"/></div></div></p><p>â€¦â€¦æˆ–ä½œä¸ºç¦»æ•£è‰²æ¡çš„åˆ†é€‰æ ‡å°ºï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span></span><br><span class="line">       aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  guides<span class="punctuation">(</span>color <span class="operator">=</span> guide_colorsteps<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/04/64f4b7d258723.png" style="width:600px;"/></div></div></p><h1 id="èƒŒæ™¯å’Œç½‘æ ¼çº¿"><a href="#èƒŒæ™¯å’Œç½‘æ ¼çº¿" class="headerlink" title="èƒŒæ™¯å’Œç½‘æ ¼çº¿"></a>èƒŒæ™¯å’Œç½‘æ ¼çº¿</h1><p>æœ‰ä¸€äº›æ–¹æ³•å¯ä»¥é€šè¿‡ä¸€ä¸ªå‡½æ•°æ”¹å˜æ•´ä¸ªç»˜å›¾çš„å¤–è§‚ï¼ˆè§ä¸‹æ–‡ â€œä¸»é¢˜ â€œéƒ¨åˆ†ï¼‰ï¼Œä½†å¦‚æœæ‚¨åªæƒ³æ”¹å˜ä¸€äº›å…ƒç´ çš„é¢œè‰²ï¼Œä¹Ÿå¯ä»¥è¿™æ ·åšã€‚</p><h2 id="æ›´æ”¹é¢æ¿èƒŒæ™¯é¢œè‰²"><a href="#æ›´æ”¹é¢æ¿èƒŒæ™¯é¢œè‰²" class="headerlink" title="æ›´æ”¹é¢æ¿èƒŒæ™¯é¢œè‰²"></a>æ›´æ”¹é¢æ¿èƒŒæ™¯é¢œè‰²</h2><p>è¦æ›´æ”¹é¢æ¿åŒºåŸŸï¼ˆå³ç»˜åˆ¶æ•°æ®çš„åŒºåŸŸï¼‰çš„èƒŒæ™¯è‰²ï¼ˆå¡«å……è‰²ï¼‰ï¼Œéœ€è¦è°ƒæ•´ä¸»é¢˜å…ƒç´ <mark class="hl-label blue">panel.background</mark> ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;#1D8565&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span></span><br><span class="line">    fill <span class="operator">=</span> <span class="string">&quot;#64D2AA&quot;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;#64D2AA&quot;</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/04/64f4b9aff10ca.png" style="width:600px;"/></div></div></p><p>è¯·æ³¨æ„ï¼Œå³ä½¿æˆ‘ä»¬æŒ‡å®šäº†çœŸæ­£çš„é¢œè‰²â€”é¢æ¿èƒŒæ™¯çš„è½®å»“â€”ä¹Ÿæ²¡æœ‰æ”¹å˜ã€‚è¿™æ˜¯å› ä¸ºåœ¨<mark class="hl-label blue">panel.background</mark> çš„é¡¶éƒ¨è¿˜æœ‰ä¸€ä¸ªå±‚ï¼Œå³<mark class="hl-label blue">panel.border</mark> ã€‚ä¸è¿‡ï¼Œè¯·ç¡®ä¿åœ¨è¿™é‡Œä½¿ç”¨é€æ˜å¡«å……ï¼Œå¦åˆ™æ‚¨çš„æ•°æ®å°±ä¼šéšè—åœ¨è¿™ä¸€å±‚åé¢ã€‚åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä½¿ç”¨åŠé€æ˜çš„åå…­è¿›åˆ¶é¢œè‰²ä½œä¸º<mark class="hl-label blue">element_rect</mark> ä¸­çš„å¡«å……å‚æ•°æ¥è¯´æ˜è¿™ä¸€ç‚¹ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;#1D8565&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.border <span class="operator">=</span> element_rect<span class="punctuation">(</span></span><br><span class="line">    fill <span class="operator">=</span> <span class="string">&quot;#64D2AA99&quot;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;#64D2AA&quot;</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/04/64f4ba915e750.png" style="width:600px;"/></div></div></p><h2 id="æ”¹å˜ç½‘æ ¼çº¿"><a href="#æ”¹å˜ç½‘æ ¼çº¿" class="headerlink" title="æ”¹å˜ç½‘æ ¼çº¿"></a>æ”¹å˜ç½‘æ ¼çº¿</h2><p>ç½‘æ ¼çº¿æœ‰ä¸¤ç§ç±»å‹ï¼šè¡¨ç¤ºåˆ»åº¦çº¿çš„ä¸»è¦ç½‘æ ¼çº¿å’Œä¸»è¦åˆ»åº¦çº¿ä¹‹é—´çš„æ¬¡è¦ç½‘æ ¼çº¿ã€‚æ‚¨å¯ä»¥é€šè¿‡è¦†ç›–<mark class="hl-label blue">panel.grid</mark> çš„é»˜è®¤å€¼æˆ–åˆ†åˆ«è¦†ç›–<mark class="hl-label blue">panel.grid.major</mark> å’Œ<mark class="hl-label blue">panel.grid.minor</mark> æ¯ç»„ç½‘æ ¼çº¿çš„é»˜è®¤å€¼æ¥æ›´æ”¹æ‰€æœ‰ç½‘æ ¼çº¿ã€‚<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.grid.major <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;gray10&quot;</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        panel.grid.minor <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;gray70&quot;</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">.25</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/04/64f4bc1cd5718.png" style="width:600px;"/></div></div></p><p>æ‚¨ç”šè‡³å¯ä»¥æŒ‡å®šæ‰€æœ‰å››ä¸ªä¸åŒçº§åˆ«çš„è®¾ç½®ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.grid.major <span class="operator">=</span> element_line<span class="punctuation">(</span>linewidth <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="string">&quot;dashed&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        panel.grid.minor <span class="operator">=</span> element_line<span class="punctuation">(</span>linewidth <span class="operator">=</span> <span class="number">.25</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="string">&quot;dotted&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        panel.grid.major.x <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;red1&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        panel.grid.major.y <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;blue1&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        panel.grid.minor.x <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;red4&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        panel.grid.minor.y <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;blue4&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/04/64f4bd15c46b1.png" style="width:600px;"/></div></div></p><p>å½“ç„¶ï¼Œå¦‚æœä½ æ„¿æ„ï¼Œä¹Ÿå¯ä»¥ç§»é™¤éƒ¨åˆ†æˆ–å…¨éƒ¨ç½‘æ ¼çº¿ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.grid.minor <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/04/64f4bdff69271.png" style="width:600px;"/></div></div></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/04/64f4be52d3357.png" style="width:600px;"/></div></div><h2 id="æ›´æ”¹ç½‘æ ¼çº¿é—´è·"><a href="#æ›´æ”¹ç½‘æ ¼çº¿é—´è·" class="headerlink" title="æ›´æ”¹ç½‘æ ¼çº¿é—´è·"></a>æ›´æ”¹ç½‘æ ¼çº¿é—´è·</h2><p>æ­¤å¤–ï¼Œæ‚¨è¿˜å¯ä»¥å®šä¹‰ä¸»ç½‘æ ¼çº¿å’Œæ¬¡ç½‘æ ¼çº¿ä¹‹é—´çš„åˆ†éš”ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_y_continuous<span class="punctuation">(</span>breaks <span class="operator">=</span> seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">100</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                     minor_breaks <span class="operator">=</span> seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">100</span><span class="punctuation">,</span> <span class="number">2.5</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/04/64f4bf0c2ed43.png" style="width:600px;"/></div></div></p><h2 id="æ›´æ”¹ç»˜å›¾èƒŒæ™¯é¢œè‰²"><a href="#æ›´æ”¹ç»˜å›¾èƒŒæ™¯é¢œè‰²" class="headerlink" title="æ›´æ”¹ç»˜å›¾èƒŒæ™¯é¢œè‰²"></a>æ›´æ”¹ç»˜å›¾èƒŒæ™¯é¢œè‰²</h2><p>åŒæ ·ï¼Œè¦æ›´æ”¹ç»˜å›¾åŒºåŸŸçš„èƒŒæ™¯é¢œè‰²ï¼ˆå¡«å……ï¼‰ï¼Œéœ€è¦ä¿®æ”¹ä¸»é¢˜å…ƒç´ <mark class="hl-label blue">plot.background</mark> ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>plot.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;gray60&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                       color <span class="operator">=</span> <span class="string">&quot;gray30&quot;</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/04/64f4bfebabe40.png" style="width:600px;"/></div></div></p><p>æ‚¨å¯ä»¥åœ¨<mark class="hl-label blue">panel.background</mark> å’Œ<mark class="hl-label blue">plot.background</mark> ä¸­è®¾ç½®ç›¸åŒçš„é¢œè‰²ï¼Œæˆ–è€…å°†é¢æ¿çš„èƒŒæ™¯å¡«å……è®¾ç½®ä¸º â€œâ€transparentâ€ â€œæˆ– NAï¼Œä»è€Œè·å¾—ç‹¬ç‰¹çš„èƒŒæ™¯é¢œè‰²ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        plot.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;gray60&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                       color <span class="operator">=</span> <span class="string">&quot;gray30&quot;</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/04/64f4c16e5ede2.png" style="width:600px;"/></div></div></p><h1 id="è¾¹è·"><a href="#è¾¹è·" class="headerlink" title="è¾¹è·"></a>è¾¹è·</h1><p>æœ‰æ—¶ï¼Œç»™ç»˜å›¾è¾¹è·å¢åŠ ä¸€ç‚¹ç©ºé—´ä¹Ÿå¾ˆæœ‰ç”¨ã€‚ä¸å‰é¢çš„ä¾‹å­ç±»ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <mark class="hl-label blue">theme()</mark> å‡½æ•°çš„ä¸€ä¸ªå‚æ•°ã€‚æœ¬ä¾‹ä¸­çš„å‚æ•°æ˜¯<mark class="hl-label blue">plot.margin</mark> ã€‚åœ¨ä¸Šä¸€ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å·²ç»é€šè¿‡<mark class="hl-label blue">plot.background</mark> æ›´æ”¹èƒŒæ™¯é¢œè‰²æ¥è¯´æ˜é»˜è®¤è¾¹è·ã€‚</p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬åœ¨å·¦ä¾§å’Œå³ä¾§æ·»åŠ é¢å¤–çš„ç©ºé—´ã€‚å‚æ•°<mark class="hl-label blue">plot.margin</mark> å¯ä»¥å¤„ç†å„ç§ä¸åŒçš„å•ä½ï¼ˆå˜ç±³cmã€è‹±å¯¸inchesç­‰ï¼‰ï¼Œä½†éœ€è¦ä½¿ç”¨è½¯ä»¶åŒ…<mark class="hl-label blue">grid</mark> ä¸­çš„å‡½æ•°<mark class="hl-label blue">unit</mark> æ¥æŒ‡å®šå•ä½ã€‚æ‚¨å¯ä»¥ä¸ºæ‰€æœ‰è¾¹æä¾›ç›¸åŒçš„å€¼ï¼ˆæœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨rep(x,4)ï¼‰ï¼Œä¹Ÿå¯ä»¥ä¸ºæ¯ä¸ªè¾¹æä¾›ç‰¹å®šçš„è·ç¦»ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘åœ¨é¡¶éƒ¨å’Œåº•éƒ¨ä½¿ç”¨äº†1å˜ç±³çš„è¾¹è·ï¼Œåœ¨å³ä¾§ä½¿ç”¨äº†3å˜ç±³çš„è¾¹è·ï¼Œåœ¨å·¦ä¾§ä½¿ç”¨äº†8å˜ç±³çš„è¾¹è·ã€‚<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>plot.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;gray60&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        plot.margin <span class="operator">=</span> margin<span class="punctuation">(</span>t <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> r <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span> b <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> l <span class="operator">=</span> <span class="number">8</span><span class="punctuation">,</span> unit <span class="operator">=</span> <span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/04/64f5faa97c389.png" style="width:600px;"/></div></div></p><details class="folding-tag" green><summary> ğŸ§™â€â™€ï¸ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨unit()ä»£æ›¿margin()ã€‚ </summary>              <div class='content'>              <figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>plot.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;gray60&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        plot.margin <span class="operator">=</span> unit<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="number">8</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/04/64f5faa97c389.png" style="width:600px;"/></div></div>              </div>            </details><p>he</p><h1 id="å¤šé¢æ¿å›¾"><a href="#å¤šé¢æ¿å›¾" class="headerlink" title="å¤šé¢æ¿å›¾"></a>å¤šé¢æ¿å›¾</h1><p>{ggplot2}è½¯ä»¶åŒ…æœ‰ä¸¤ä¸ªåˆ›å»ºå¤šé¢æ¿ç»˜å›¾çš„å¥½å‡½æ•°ï¼Œç§°ä¸ºåˆ‡é¢ã€‚å®ƒä»¬ç›¸äº’å…³è”ï¼Œä½†åˆç•¥æœ‰ä¸åŒï¼š<mark class="hl-label blue">facet_wrap</mark> ä¸»è¦æ˜¯æ ¹æ®å•ä¸€å˜é‡åˆ›å»ºå›¾å½¢å¸¦ï¼Œè€Œ<mark class="hl-label blue">facet_grid</mark> åˆ™æ˜¯è·¨è¶Šä¸¤ä¸ªå˜é‡çš„ç½‘æ ¼ã€‚</p><h2 id="åŸºäºä¸¤ä¸ªå˜é‡åˆ›å»ºå¤šé¢ç‰ˆå›¾"><a href="#åŸºäºä¸¤ä¸ªå˜é‡åˆ›å»ºå¤šé¢ç‰ˆå›¾" class="headerlink" title="åŸºäºä¸¤ä¸ªå˜é‡åˆ›å»ºå¤šé¢ç‰ˆå›¾"></a>åŸºäºä¸¤ä¸ªå˜é‡åˆ›å»ºå¤šé¢ç‰ˆå›¾</h2><p>å¦‚æœæœ‰ä¸¤ä¸ªå˜é‡ï¼Œåˆ™ç”±<mark class="hl-label blue">faceet_grid</mark> æ¥å®Œæˆã€‚åœ¨è¿™é‡Œï¼Œå˜é‡çš„é¡ºåºå†³å®šäº†è¡Œæ•°å’Œåˆ—æ•°ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;orangered&quot;</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">.3</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.text.x <span class="operator">=</span> element_text<span class="punctuation">(</span>angle <span class="operator">=</span> <span class="number">45</span><span class="punctuation">,</span> vjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  facet_grid<span class="punctuation">(</span>year <span class="operator">~</span> season<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/04/64f5fe36ad23d.png" style="width:600px;"/></div></div></p><p>ä½ èƒ½å°†<mark class="hl-label blue">facet_grid(year~season)</mark> æ”¹ä¸º<mark class="hl-label blue">hefacet_grid(season~year)</mark> ï¼Œä»è€Œå°†è¡Œæ’åˆ—æ”¹ä¸ºåˆ—ã€‚</p><h2 id="åŸºäºä¸€ä¸ªå˜é‡åˆ›å»ºå¤šé¢æ¿å›¾"><a href="#åŸºäºä¸€ä¸ªå˜é‡åˆ›å»ºå¤šé¢æ¿å›¾" class="headerlink" title="åŸºäºä¸€ä¸ªå˜é‡åˆ›å»ºå¤šé¢æ¿å›¾"></a>åŸºäºä¸€ä¸ªå˜é‡åˆ›å»ºå¤šé¢æ¿å›¾</h2><mark class="hl-label blue">facet_wrap</mark> å¯ä»¥åˆ›å»ºå•ä¸ªå˜é‡çš„å¤šé¢æ¿å›¾ï¼Œåœ¨å‰é¢åŠ ä¸Šæ³¢æµªå·ï¼š<mark class="hl-label blue">facet_wrap(~variable)</mark> ã€‚è¿™äº›å­å›¾çš„å¤–è§‚ç”±å‚æ•°<mark class="hl-label blue">ncol</mark> å’Œ<mark class="hl-label blue">nrow</mark> æ§åˆ¶ï¼š<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">&lt;-</span></span><br><span class="line">  ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;chartreuse4&quot;</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">.3</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    theme<span class="punctuation">(</span>axis.text.x <span class="operator">=</span> element_text<span class="punctuation">(</span>angle <span class="operator">=</span> <span class="number">45</span><span class="punctuation">,</span> vjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">g <span class="operator">+</span> facet_wrap<span class="punctuation">(</span><span class="operator">~</span> year<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/05/64f60151d5dba.png" style="width:600px;"/></div></div><p>å› æ­¤ï¼Œæ‚¨å¯ä»¥æŒ‰ç…§è‡ªå·±çš„å–œå¥½æ’åˆ—å›¾å—ï¼Œè€Œä¸æ˜¯ä»¥ä¸€è¡ŒçŸ©é˜µçš„å½¢å¼â€¦<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span> facet_wrap<span class="punctuation">(</span><span class="operator">~</span> year<span class="punctuation">,</span> nrow <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/05/64f601e38914b.png" style="width:600px;"/></div></div></p><p>â€¦â€¦ç”šè‡³æ˜¯ä¸å¯¹ç§°çš„ç½‘æ ¼å—ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span> facet_wrap<span class="punctuation">(</span><span class="operator">~</span> year<span class="punctuation">,</span> ncol <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span> <span class="operator">+</span> theme<span class="punctuation">(</span>axis.title.x <span class="operator">=</span> element_text<span class="punctuation">(</span>hjust <span class="operator">=</span> <span class="number">.15</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/05/64f602bed7993.png" style="width:600px;"/></div></div></p><h2 id="å…è®¸åæ ‡è½´è‡ªç”±å®šä¹‰æ¯”ä¾‹"><a href="#å…è®¸åæ ‡è½´è‡ªç”±å®šä¹‰æ¯”ä¾‹" class="headerlink" title="å…è®¸åæ ‡è½´è‡ªç”±å®šä¹‰æ¯”ä¾‹"></a>å…è®¸åæ ‡è½´è‡ªç”±å®šä¹‰æ¯”ä¾‹</h2><p>{ggplot2}ä¸­çš„å¤šé¢æ¿å›¾é»˜è®¤åœ¨æ¯ä¸ªé¢æ¿ä¸­ä½¿ç”¨ç­‰æ•ˆæ¯”ä¾‹ã€‚ä½†æœ‰æ—¶æ‚¨å¸Œæœ›è®©é¢æ¿è‡ªèº«çš„æ•°æ®æ¥å†³å®šæ¯”ä¾‹ã€‚è¿™é€šå¸¸ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œå› ä¸ºå®ƒå¯èƒ½ä¼šç»™ç”¨æˆ·ç•™ä¸‹é”™è¯¯çš„æ•°æ®å°è±¡ã€‚ä½†æœ‰æ—¶è¿™ç¡®å®æ˜¯æœ‰ç”¨çš„ï¼Œä¸ºæ­¤æ‚¨å¯ä»¥è®¾ç½® <mark class="hl-label blue">scales=free</mark> ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span> facet_wrap<span class="punctuation">(</span><span class="operator">~</span> year<span class="punctuation">,</span> nrow <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> scales <span class="operator">=</span> <span class="string">&quot;free&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/05/64f6044c52e6d.png" style="width:600px;"/></div></div><br>è¯·æ³¨æ„ï¼ŒX è½´å’Œ Y è½´çš„èŒƒå›´ä¸åŒï¼</p><h2 id="å½“ä¸¤ä¸ªå˜é‡æ—¶ä½¿ç”¨"><a href="#å½“ä¸¤ä¸ªå˜é‡æ—¶ä½¿ç”¨" class="headerlink" title="å½“ä¸¤ä¸ªå˜é‡æ—¶ä½¿ç”¨"></a>å½“ä¸¤ä¸ªå˜é‡æ—¶ä½¿ç”¨<mark class="hl-label blue">facet_wrap</mark> </h2><p>å‡½æ•°<mark class="hl-label blue">facet_wrap</mark> ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸¤ä¸ªå˜é‡ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span> facet_wrap<span class="punctuation">(</span>year <span class="operator">~</span> season<span class="punctuation">,</span> nrow <span class="operator">=</span> <span class="number">4</span><span class="punctuation">,</span> scales <span class="operator">=</span> <span class="string">&quot;free_x&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/05/64f60682b16c4.png" style="width:600px;"/></div></div></p><p>ä½¿ç”¨<mark class="hl-label blue">facet_wrap</mark> æ—¶ï¼Œä½ ä»ç„¶å¯ä»¥æ§åˆ¶ç½‘æ ¼è®¾è®¡ï¼šä½ å¯ä»¥é‡æ–°æ’åˆ—æ¯è¡Œå’Œæ¯åˆ—çš„ç»˜å›¾æ•°é‡ï¼Œä¹Ÿå¯ä»¥è®©æ‰€æœ‰åæ ‡è½´è‡ªç”±ç§»åŠ¨ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œ<mark class="hl-label blue">facet_grid</mark> ä¹Ÿä¼šæ¥å—ä¸€ä¸ªè‡ªç”±å‚æ•°ï¼Œä½†åªèƒ½è®©å®ƒåœ¨æ¯åˆ—æˆ–æ¯è¡Œè‡ªç”±ç§»åŠ¨ï¼š</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/05/64f6089573e19.png" style="width:600px;"/></div></div><h2 id="ä¿®æ”¹å¸¦çŠ¶æ–‡æœ¬çš„é£æ ¼"><a href="#ä¿®æ”¹å¸¦çŠ¶æ–‡æœ¬çš„é£æ ¼" class="headerlink" title="ä¿®æ”¹å¸¦çŠ¶æ–‡æœ¬çš„é£æ ¼"></a>ä¿®æ”¹å¸¦çŠ¶æ–‡æœ¬çš„é£æ ¼</h2><p>é€šè¿‡ä½¿ç”¨ä¸»é¢˜ï¼Œæ‚¨å¯ä»¥ä¿®æ”¹æ¡çŠ¶æ–‡æœ¬ï¼ˆå³æ¯ä¸ªé¢çš„æ ‡é¢˜ï¼‰å’Œæ¡çŠ¶æ–‡æœ¬æ¡†çš„å¤–è§‚ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span> facet_wrap<span class="punctuation">(</span><span class="operator">~</span> year<span class="punctuation">,</span> nrow <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> scales <span class="operator">=</span> <span class="string">&quot;free_x&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>strip.text <span class="operator">=</span> element_text<span class="punctuation">(</span>face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;chartreuse4&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                  hjust <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">20</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        strip.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;chartreuse3&quot;</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="string">&quot;dotted&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/05/64f609c7dbaba.png" style="width:600px;"/></div></div></p><p>ä»¥ä¸‹<a href="https://stackoverflow.com/questions/60332202/conditionally-fill-ggtext-text-boxes-in-facet-wrap">ä¸¤ä¸ªå‡½æ•°</a>æ”¹ç¼–è‡ª{ggtext}è½¯ä»¶åŒ…çš„ä½œè€…Claus Wilkeï¼Œå¯ä»¥ä¸<a href="https://wilkelab.org/ggtext/">{ggtext}</a>æä¾›çš„<mark class="hl-label blue">element_textbox()</mark> ç»“åˆä½¿ç”¨ï¼Œçªå‡ºæ˜¾ç¤ºç‰¹å®šæ ‡ç­¾ã€‚<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>ggtext<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>purrr<span class="punctuation">)</span> <span class="comment">## for %||%</span></span><br><span class="line"></span><br><span class="line">element_textbox_highlight <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>...<span class="punctuation">,</span> hi.labels <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> hi.fill <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">                                      hi.col <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> hi.box.col <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> hi.family <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  structure<span class="punctuation">(</span></span><br><span class="line">    <span class="built_in">c</span><span class="punctuation">(</span>element_textbox<span class="punctuation">(</span>...<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">      <span class="built_in">list</span><span class="punctuation">(</span>hi.labels <span class="operator">=</span> hi.labels<span class="punctuation">,</span> hi.fill <span class="operator">=</span> hi.fill<span class="punctuation">,</span> hi.col <span class="operator">=</span> hi.col<span class="punctuation">,</span> hi.box.col <span class="operator">=</span> hi.box.col<span class="punctuation">,</span> hi.family <span class="operator">=</span> hi.family<span class="punctuation">)</span></span><br><span class="line">    <span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    <span class="built_in">class</span> <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;element_textbox_highlight&quot;</span><span class="punctuation">,</span> <span class="string">&quot;element_textbox&quot;</span><span class="punctuation">,</span> <span class="string">&quot;element_text&quot;</span><span class="punctuation">,</span> <span class="string">&quot;element&quot;</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">element_grob.element_textbox_highlight <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>element<span class="punctuation">,</span> label <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> ...<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="keyword">if</span> <span class="punctuation">(</span>label <span class="operator">%in%</span> element<span class="operator">$</span>hi.labels<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">    element<span class="operator">$</span>fill <span class="operator">&lt;-</span> element<span class="operator">$</span>hi.fill <span class="operator">%||%</span> element<span class="operator">$</span>fill</span><br><span class="line">    element<span class="operator">$</span>colour <span class="operator">&lt;-</span> element<span class="operator">$</span>hi.col <span class="operator">%||%</span> element<span class="operator">$</span>colour</span><br><span class="line">    element<span class="operator">$</span>box.colour <span class="operator">&lt;-</span> element<span class="operator">$</span>hi.box.col <span class="operator">%||%</span> element<span class="operator">$</span>box.colour</span><br><span class="line">    element<span class="operator">$</span>family <span class="operator">&lt;-</span> element<span class="operator">$</span>hi.family <span class="operator">%||%</span> element<span class="operator">$</span>family</span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line">  NextMethod<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><br>ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å®ƒæ¥æŒ‡å®šæ‰€æœ‰æ–‡æœ¬æ¡ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span> facet_wrap<span class="punctuation">(</span>year <span class="operator">~</span> season<span class="punctuation">,</span> nrow <span class="operator">=</span> <span class="number">4</span><span class="punctuation">,</span> scales <span class="operator">=</span> <span class="string">&quot;free_x&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span></span><br><span class="line">    strip.background <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    strip.text <span class="operator">=</span> element_textbox_highlight<span class="punctuation">(</span></span><br><span class="line">      family <span class="operator">=</span> <span class="string">&quot;Arial&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">12</span><span class="punctuation">,</span> face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">,</span></span><br><span class="line">      fill <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> box.color <span class="operator">=</span> <span class="string">&quot;chartreuse4&quot;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;chartreuse4&quot;</span><span class="punctuation">,</span></span><br><span class="line">      halign <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> r <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span> <span class="string">&quot;pt&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> width <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="string">&quot;npc&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">      padding <span class="operator">=</span> margin<span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span> margin <span class="operator">=</span> margin<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">      hi.labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;1997&quot;</span><span class="punctuation">,</span> <span class="string">&quot;1998&quot;</span><span class="punctuation">,</span> <span class="string">&quot;1999&quot;</span><span class="punctuation">,</span> <span class="string">&quot;2000&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">      hi.fill <span class="operator">=</span> <span class="string">&quot;chartreuse4&quot;</span><span class="punctuation">,</span> hi.box.col <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> hi.col <span class="operator">=</span> <span class="string">&quot;white&quot;</span></span><br><span class="line">    <span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/05/64f60f8e349a9.png" style="width:600px;"/></div></div></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> season <span class="operator">==</span> <span class="string">&quot;Summer&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">.3</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  facet_wrap<span class="punctuation">(</span><span class="operator">~</span> season<span class="punctuation">,</span> nrow <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_color_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;gray40&quot;</span><span class="punctuation">,</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> guide <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span></span><br><span class="line">    axis.text.x <span class="operator">=</span> element_text<span class="punctuation">(</span>angle <span class="operator">=</span> <span class="number">45</span><span class="punctuation">,</span> vjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    strip.background <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    strip.text <span class="operator">=</span> element_textbox_highlight<span class="punctuation">(</span></span><br><span class="line">      size <span class="operator">=</span> <span class="number">12</span><span class="punctuation">,</span> face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">,</span></span><br><span class="line">      fill <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> box.color <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;gray40&quot;</span><span class="punctuation">,</span></span><br><span class="line">      halign <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> r <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="string">&quot;pt&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> width <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="string">&quot;npc&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">      padding <span class="operator">=</span> margin<span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span> margin <span class="operator">=</span> margin<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">      hi.labels <span class="operator">=</span> <span class="string">&quot;Summer&quot;</span><span class="punctuation">,</span> hi.family <span class="operator">=</span> <span class="string">&quot;Arial&quot;</span><span class="punctuation">,</span></span><br><span class="line">      hi.fill <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">,</span> hi.box.col <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">,</span> hi.col <span class="operator">=</span> <span class="string">&quot;white&quot;</span></span><br><span class="line">    <span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/05/64f610572f767.png" style="width:600px;"/></div></div><h2 id="ä¸€ä¸ªé¢æ¿ä¸¤ä¸ªå›¾å½¢"><a href="#ä¸€ä¸ªé¢æ¿ä¸¤ä¸ªå›¾å½¢" class="headerlink" title="ä¸€ä¸ªé¢æ¿ä¸¤ä¸ªå›¾å½¢"></a>ä¸€ä¸ªé¢æ¿ä¸¤ä¸ªå›¾å½¢</h2><p>æœ‰å‡ ç§æ–¹æ³•å¯ä»¥ç»„åˆå›¾å½¢ã€‚æˆ‘è®¤ä¸ºæœ€ç®€å•çš„æ–¹æ³•æ˜¯æ‰˜é©¬æ–¯-æ—-ä½©å¾·æ£®ï¼ˆThomas Lin Pedersenï¼‰çš„<a href="https://github.com/thomasp85/patchwork">{patchwork}</a>è½¯ä»¶åŒ…ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">p1 <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span></span><br><span class="line">                       color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">        geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">        geom_rug<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">        labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">p2 <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> o3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">        geom_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;gray&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">        geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;darkorange2&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">        labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Ozone&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">library<span class="punctuation">(</span>patchwork<span class="punctuation">)</span></span><br><span class="line">p1 <span class="operator">+</span> p2</span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/05/64f611b453417.png" style="width:600px;"/></div></div></p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ â€œåˆ†å‰² â€œä¸¤ä¸ªå›¾æ¥æ”¹å˜é¡ºåºï¼ˆæ³¨æ„ï¼Œå³ä½¿ä¸€ä¸ªæœ‰å›¾ä¾‹ï¼Œä¸€ä¸ªæ²¡æœ‰å›¾ä¾‹ï¼Œä¹Ÿè¦å¯¹é½ï¼ï¼‰ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p1 <span class="operator">/</span> p2</span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/05/64f61221a92cd.png" style="width:600px;"/></div></div></p><p>è¿˜å¯ä»¥åµŒå¥—ç»˜å›¾ï¼<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">(</span>g <span class="operator">+</span> p2<span class="punctuation">)</span> <span class="operator">/</span> p1</span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/05/64f612b46fa82.png" style="width:600px;"/></div></div></p><p>(è¯·æ³¨æ„ï¼Œå°½ç®¡åªæœ‰ä¸€å¹…å›¾åŒ…å«å›¾ä¾‹ï¼Œä½†è¿™äº›å›¾è¿˜æ˜¯ä¿æŒäº†ä¸€è‡´)ã€‚</p><p>å¦å¤–ï¼ŒClaus Wilke çš„<a href="https://wilkelab.org/cowplot/articles/introduction.html">{cowplot}</a>è½¯ä»¶åŒ…æä¾›äº†åˆå¹¶å¤šä¸ªç»˜å›¾çš„åŠŸèƒ½ï¼ˆè¿˜æœ‰å¾ˆå¤šå…¶ä»–å®ç”¨å·¥å…·ï¼‰ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>cowplot<span class="punctuation">)</span></span><br><span class="line">plot_grid<span class="punctuation">(</span>plot_grid<span class="punctuation">(</span>g<span class="punctuation">,</span> p1<span class="punctuation">)</span><span class="punctuation">,</span> p2<span class="punctuation">,</span> ncol <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/05/64f613d619ff5.png" style="width:600px;"/></div></div></p><p>â€¦<a href="https://cran.r-project.org/web/packages/gridExtra/vignettes/arrangeGrob.html">{gridExtra}</a>è½¯ä»¶åŒ…ä¹Ÿæ˜¯å¦‚æ­¤ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>gridExtra<span class="punctuation">)</span></span><br><span class="line">grid.arrange<span class="punctuation">(</span>g<span class="punctuation">,</span> p1<span class="punctuation">,</span> p2<span class="punctuation">,</span></span><br><span class="line">             layout_matrix <span class="operator">=</span> rbind<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/05/64f6148191b10.png" style="width:600px;"/></div></div></p><p>å®šä¹‰å¸ƒå±€çš„æƒ³æ³•åŒæ ·é€‚ç”¨äº{patchwork}ï¼Œå®ƒå¯ä»¥åˆ›å»ºå¤æ‚çš„ç»„åˆï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">layout <span class="operator">&lt;-</span> <span class="string">&quot;</span></span><br><span class="line"><span class="string">AABBBB#</span></span><br><span class="line"><span class="string">AACCDDE</span></span><br><span class="line"><span class="string">##CCDD#</span></span><br><span class="line"><span class="string">##CC###</span></span><br><span class="line"><span class="string">&quot;</span></span><br><span class="line"></span><br><span class="line">p2 <span class="operator">+</span> p1 <span class="operator">+</span> p1 <span class="operator">+</span> g <span class="operator">+</span> p2 <span class="operator">+</span></span><br><span class="line">  plot_layout<span class="punctuation">(</span>design <span class="operator">=</span> layout<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/05/64f6154475eef.png" style="width:600px;"/></div></div></p><h1 id="é¢œè‰²"><a href="#é¢œè‰²" class="headerlink" title="é¢œè‰²"></a>é¢œè‰²</h1><p>åœ¨{ggplot2}ä¸­ï¼Œå¯¹äºç®€å•çš„åº”ç”¨æ¥è¯´ï¼Œä½¿ç”¨é¢œè‰²éå¸¸ç®€å•ã€‚å¦‚æœæƒ³äº†è§£æ›´é«˜çº§çš„å¤„ç†æ–¹æ³•ï¼Œä½ å¯èƒ½åº”è¯¥å»çœ‹çœ‹<a href="https://link.springer.com/book/10.1007/978-0-387-98141-3#otherversion=9780387981406">Hadleyçš„ä¹¦</a>ï¼Œé‡Œé¢æœ‰å¾ˆå¥½çš„ä»‹ç»ã€‚å…¶ä»–æœ‰ç”¨çš„èµ„æ–™åŒ…æ‹¬R Cookbookã€‹å’ŒYan Holtzæ‰€è‘—<a href="https://r-graph-gallery.com/ggplot2-color.html">ã€ŠR Graph Galleryã€‹</a>ä¸­çš„ â€œcolor â€œéƒ¨åˆ†ã€‚</p><p>{ggplot2}ä¸­çš„é¢œè‰²æœ‰ä¸¤ä¸ªä¸»è¦åŒºåˆ«ã€‚<mark class="hl-label blue">color</mark> å’Œ<mark class="hl-label blue">fill</mark> è¿™ä¸¤ä¸ªå‚æ•°éƒ½å¯ä»¥</p><ol><li>æŒ‡å®šä¸ºå•ä¸€é¢œè‰²</li><li>æŒ‡å®šä¸ºå˜é‡</li></ol><p>æ­£å¦‚ä½ åœ¨æœ¬æ•™ç¨‹å¼€å¤´å·²ç»çœ‹åˆ°çš„ï¼Œåœ¨<mark class="hl-label blue">aes</mark> å†…éƒ¨çš„å˜é‡æ˜¯ç”±å˜é‡ç¼–ç çš„ï¼Œè€Œåœ¨ç¾å­¦èŒƒå›´å¤–çš„å˜é‡åˆ™æ˜¯ä¸å˜é‡æ— å…³çš„å±æ€§ã€‚è¿™å¹…æ˜¾ç¤ºæ¯å¹´å’Œæ¯å­£è®°å½•æ•°çš„å®Œå…¨æ— æ„ä¹‰çš„å›¾å°±è¯´æ˜äº†è¿™ä¸€äº‹å®ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>year<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_bar<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;grey&quot;</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Observations&quot;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&quot;Season:&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f75dc052a88.png" style="width:600px;"/></div></div></p><h2 id="æŒ‡å®šå•ä¸€é¢œè‰²"><a href="#æŒ‡å®šå•ä¸€é¢œè‰²" class="headerlink" title="æŒ‡å®šå•ä¸€é¢œè‰²"></a>æŒ‡å®šå•ä¸€é¢œè‰²</h2><p>é™æ€å•ä¸€é¢œè‰²çš„ä½¿ç”¨å¾ˆç®€å•ã€‚æˆ‘ä»¬å¯ä»¥ä¸ºä¸€ä¸ªå›¾å½¢æŒ‡å®šå•ä¸€é¢œè‰²ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;steelblue&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f75e7b804e4.png" style="width:600px;"/></div></div></p><p>â€¦ å¦‚æœåŒæ—¶æä¾›<mark class="hl-label blue">color</mark> ï¼ˆè½®å»“é¢œè‰²ï¼‰å’Œ<mark class="hl-label blue">fill</mark> ï¼ˆå¡«å……é¢œè‰²ï¼‰ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>shape <span class="operator">=</span> <span class="number">21</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> stroke <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">             color <span class="operator">=</span> <span class="string">&quot;#3cc08f&quot;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&quot;#c08f3c&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f75f1cbfb75.png" style="width:600px;"/></div></div></p><p>å“¥ä¼¦æ¯”äºšå¤§å­¦çš„ Tian Zheng åˆ¶ä½œäº†ä¸€ä»½æœ‰ç”¨çš„<a href="http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf">Ré¢œè‰²PDF</a>ã€‚å½“ç„¶ï¼Œæ‚¨ä¹Ÿå¯ä»¥æŒ‡å®šåå…­è¿›åˆ¶é¢œè‰²ä»£ç ï¼ˆå¦‚ä¸Šä¾‹ä¸­çš„å­—ç¬¦ä¸²ï¼‰ä»¥åŠRGBæˆ–RGBAå€¼ï¼ˆé€šè¿‡<mark class="hl-label blue">rgb()</mark> å‡½æ•°ï¼šrgb(red, green, blue, alpha)ï¼‰ã€‚</p><h2 id="ä¸ºå˜é‡æŒ‡å®šé¢œè‰²"><a href="#ä¸ºå˜é‡æŒ‡å®šé¢œè‰²" class="headerlink" title="ä¸ºå˜é‡æŒ‡å®šé¢œè‰²"></a>ä¸ºå˜é‡æŒ‡å®šé¢œè‰²</h2><p>åœ¨ {ggplot2} ä¸­ï¼Œé€šè¿‡<mark class="hl-label blue">scale_color_*</mark> å’Œ<mark class="hl-label blue">scale_fill_*</mark> å‡½æ•°å¯ä»¥ä¿®æ”¹åˆ†é…ç»™å˜é‡çš„é¢œè‰²ã€‚è¦åœ¨æ•°æ®ä¸­ä½¿ç”¨é¢œè‰²ï¼Œæœ€é‡è¦çš„æ˜¯è¦çŸ¥é“æ‰€å¤„ç†çš„æ˜¯åˆ†ç±»å˜é‡è¿˜æ˜¯è¿ç»­å˜é‡ã€‚è°ƒè‰²æ¿çš„é€‰æ‹©åº”å–å†³äºå˜é‡çš„ç±»å‹ï¼Œè¿ç»­å˜é‡åº”ä½¿ç”¨è¿ç»­è°ƒè‰²æ¿æˆ–å‘æ•£è°ƒè‰²æ¿ï¼Œåˆ†ç±»å˜é‡åº”ä½¿ç”¨å®šæ€§è°ƒè‰²æ¿ï¼š</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f7612f417ec.png" style="width:600px;"/></div></div><center>*Source: â€œHands-On Data Visualizationâ€ by Jack Dougherty & Ilya Ilyankou*</center><h2 id="å®šæ€§å˜é‡"><a href="#å®šæ€§å˜é‡" class="headerlink" title="å®šæ€§å˜é‡"></a>å®šæ€§å˜é‡</h2><p>å®šæ€§å˜é‡æˆ–åˆ†ç±»å˜é‡ä»£è¡¨å¯åˆ’åˆ†ä¸ºä¸åŒç»„ï¼ˆç±»åˆ«ï¼‰çš„æ•°æ®ç±»å‹ã€‚å˜é‡è¿˜å¯è¿›ä¸€æ­¥åˆ†ä¸ºåä¹‰å˜é‡ã€é¡ºåºå˜é‡å’ŒäºŒå…ƒå˜é‡ï¼ˆäºŒåˆ†å˜é‡ï¼‰ã€‚å®šæ€§/åˆ†ç±»å˜é‡çš„ä¾‹å­æœ‰:<br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f7653bac30e.png" style="width:600px;"/></div></div></p><center>*Artwork by Allison Horst*</center><p>é»˜è®¤çš„åˆ†ç±»è°ƒè‰²æ¿å¦‚ä¸‹æ‰€ç¤ºï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">(</span>ga <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f766e7e9c8a.png" style="width:600px;"/></div></div></p><h2 id="æ‰‹åŠ¨é€‰æ‹©å®šæ€§é¢œè‰²"><a href="#æ‰‹åŠ¨é€‰æ‹©å®šæ€§é¢œè‰²" class="headerlink" title="æ‰‹åŠ¨é€‰æ‹©å®šæ€§é¢œè‰²"></a>æ‰‹åŠ¨é€‰æ‹©å®šæ€§é¢œè‰²</h2><p>æ‚¨å¯ä»¥é€šè¿‡<mark class="hl-label blue">scale_*_manual()</mark> å‡½æ•°ï¼ˆ<mark class="hl-label blue">*</mark> å¯ä»¥æ˜¯<mark class="hl-label blue">color</mark> ã€<mark class="hl-label blue">colour</mark> æˆ–<mark class="hl-label blue">fill</mark> ï¼‰è‡ªè¡Œé€‰æ‹©ä¸€ç»„é¢œè‰²å¹¶å°†å…¶åˆ†é…ç»™åˆ†ç±»å˜é‡ã€‚æŒ‡å®šé¢œè‰²çš„æ•°é‡å¿…é¡»ä¸ç±»åˆ«çš„æ•°é‡ç›¸åŒ¹é…ï¼š</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ga <span class="operator">+</span> scale_color_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;dodgerblue4&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                   <span class="string">&quot;darkolivegreen4&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                   <span class="string">&quot;darkorchid3&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                   <span class="string">&quot;goldenrod1&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f769a12e7bf.png" style="width:600px;"/></div></div><h2 id="ä½¿ç”¨å†…ç½®å®šæ€§è°ƒè‰²æ¿"><a href="#ä½¿ç”¨å†…ç½®å®šæ€§è°ƒè‰²æ¿" class="headerlink" title="ä½¿ç”¨å†…ç½®å®šæ€§è°ƒè‰²æ¿"></a>ä½¿ç”¨å†…ç½®å®šæ€§è°ƒè‰²æ¿</h2><p><a href="https://colorbrewer2.org/#type=sequential&amp;scheme=BuGn&amp;n=3">ColorBrewer</a>è°ƒè‰²æ¿æ˜¯ä¸€ç§ç”¨äºé€‰æ‹©åœ°å›¾é…è‰²æ–¹æ¡ˆçš„æµè¡Œåœ¨çº¿å·¥å…·ã€‚æˆ‘ä»¬è®¾è®¡äº†ä¸åŒçš„é¢œè‰²é›†ï¼Œä»¥äº§ç”Ÿå¤–è§‚ç›¸ä¼¼ã€æå…·å¸å¼•åŠ›çš„é¢œè‰²æ–¹æ¡ˆï¼Œé¢œè‰²èŒƒå›´ä»ä¸‰ç§åˆ°åäºŒç§ä¸ç­‰ã€‚è¿™äº›è°ƒè‰²æ¿å¯ä½œä¸º {ggplot2} è½¯ä»¶åŒ…çš„å†…ç½®å‡½æ•°ï¼Œé€šè¿‡è°ƒç”¨<mark class="hl-label blue">scale_*_brewer()</mark> æ¥åº”ç”¨ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ga <span class="operator">+</span> scale_color_brewer<span class="punctuation">(</span>palette <span class="operator">=</span> <span class="string">&quot;Set1&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f76b375b2ae.png" style="width:600px;"/></div></div></p><p><strong>ğŸ’¡ æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æŸ¥çœ‹æ‰€æœ‰å¯ç”¨è®¡åˆ’</strong><br><mark class="hl-label blue">RColorBrewer::display.brewer.all()</mark> </p><h2 id="ä½¿ç”¨æ‰©å±•è½¯ä»¶åŒ…ä¸­çš„å®šæ€§è°ƒè‰²æ¿"><a href="#ä½¿ç”¨æ‰©å±•è½¯ä»¶åŒ…ä¸­çš„å®šæ€§è°ƒè‰²æ¿" class="headerlink" title="ä½¿ç”¨æ‰©å±•è½¯ä»¶åŒ…ä¸­çš„å®šæ€§è°ƒè‰²æ¿"></a>ä½¿ç”¨æ‰©å±•è½¯ä»¶åŒ…ä¸­çš„å®šæ€§è°ƒè‰²æ¿</h2><p>æœ‰è®¸å¤šæ‰©å±•è½¯ä»¶åŒ…å¯ä»¥æä¾›é¢å¤–çš„è°ƒè‰²æ¿ã€‚å®ƒä»¬çš„ç”¨é€”å› è½¯ä»¶åŒ…çš„è®¾è®¡æ–¹å¼è€Œå¼‚ã€‚å…³äº R ä¸­å¯ç”¨è°ƒè‰²æ¿çš„å¹¿æ³›æ¦‚è¿°ï¼Œè¯·æŸ¥çœ‹<a href="https://github.com/EmilHvitfeldt/r-color-palettes/blob/master/README.md#comprehensive-list-of-color-palettes-in-r">Emil Hvitfeldt</a>æä¾›çš„é›†åˆã€‚æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ä»–çš„<a href="https://github.com/EmilHvitfeldt/paletteer">{paletteer}</a>è½¯ä»¶åŒ…ï¼Œè¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ç»Ÿä¸€è¯­æ³•çš„ R è‰²æ¿ç»¼åˆé›†åˆã€‚</p><p><strong>ä¾‹å¦‚</strong><br>ä¾‹å¦‚ï¼Œ<a href="https://jrnold.github.io/ggthemes/">{ggthemes}</a>è½¯ä»¶åŒ…å¯ä»¥è®© R ç”¨æˆ·è®¿é—® Tableau é¢œè‰²ã€‚Tableau æ˜¯ä¸€æ¬¾è‘—åçš„å¯è§†åŒ–è½¯ä»¶ï¼Œæ‹¥æœ‰<a href="https://www.tableau.com/de-de/blog/colors-upgrade-tableau-10-56782">ä¼—æ‰€å‘¨çŸ¥çš„è°ƒè‰²æ¿</a>ã€‚<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>ggthemes<span class="punctuation">)</span></span><br><span class="line">ga <span class="operator">+</span> scale_color_tableau<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f76d6da04bb.png" style="width:600px;"/></div></div></p><p><a href="https://nanx.me/ggsci/articles/ggsci.html">{ggsci}</a>è½¯ä»¶åŒ…æä¾›ç§‘å­¦æ‚å¿—å’Œç§‘å¹»ä¸»é¢˜è°ƒè‰²æ¿ã€‚æƒ³è®©æƒ…èŠ‚çš„è‰²å½©çœ‹èµ·æ¥åƒå‘è¡¨åœ¨ã€Šç§‘å­¦ã€‹æˆ–ã€Šè‡ªç„¶ã€‹æ‚å¿—ä¸Šçš„æ–‡ç« å—ï¼Ÿç»™ä½ ï¼<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>ggsci<span class="punctuation">)</span></span><br><span class="line">g1 <span class="operator">&lt;-</span> ga <span class="operator">+</span> scale_color_aaas<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">g2 <span class="operator">&lt;-</span> ga <span class="operator">+</span> scale_color_npg<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">library<span class="punctuation">(</span>patchwork<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">(</span>g1 <span class="operator">+</span> g2<span class="punctuation">)</span> <span class="operator">*</span> theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&quot;top&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f76e13a597f.png" style="width:600px;"/></div></div></p><h2 id="å®šé‡å˜é‡"><a href="#å®šé‡å˜é‡" class="headerlink" title="å®šé‡å˜é‡"></a>å®šé‡å˜é‡</h2><p>å®šé‡å˜é‡ä»£è¡¨ä¸€ä¸ªå¯æµ‹é‡çš„é‡ï¼Œå› æ­¤æ˜¯æ•°å€¼å‹çš„ã€‚å®šé‡æ•°æ®è¿˜å¯è¿›ä¸€æ­¥åˆ†ä¸ºè¿ç»­æ•°æ®ï¼ˆå¯ä½¿ç”¨æµ®ç‚¹æ•°ï¼‰å’Œç¦»æ•£æ•°æ®ï¼ˆä»…é™æ•´æ•°ï¼‰ï¼š<br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f76ed3833ea.png" style="width:600px;"/></div></div></p><center>*Artwork by Allison Horst*</center><p>åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†æŠŠè¦ç€è‰²çš„å˜é‡æ”¹ä¸ºè‡­æ°§ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸æ¸©åº¦å¯†åˆ‡ç›¸å…³çš„è¿ç»­å˜é‡ï¼ˆæ¸©åº¦è¶Šé«˜ï¼Œè‡­æ°§è¶Šé«˜ï¼‰ã€‚å‡½æ•°<mark class="hl-label blue">scale_*_gradient()</mark> æ˜¯é¡ºåºæ¢¯åº¦ï¼Œè€Œ<mark class="hl-label blue">scale_*_gradient2()</mark> æ˜¯å‘æ•£æ¢¯åº¦ã€‚</p><p>ä¸‹é¢æ˜¯è¿ç»­å˜é‡çš„é»˜è®¤ {ggplot2} åºåˆ—é¢œè‰²æ–¹æ¡ˆï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gb <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F):&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">gb <span class="operator">+</span> scale_color_continuous<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f76fec63d04.png" style="width:600px;"/></div></div></p><p>è¯¥ä»£ç å¯ç”Ÿæˆç›¸åŒçš„æ›²çº¿å›¾ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gb <span class="operator">+</span> scale_color_gradient<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f76fec63d04.png" style="width:600px;"/></div></div></p><p>ä¸‹é¢æ˜¯ä¸åŒçš„é»˜è®¤é…è‰²æ–¹æ¡ˆï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mid <span class="operator">&lt;-</span> mean<span class="punctuation">(</span>chic<span class="operator">$</span>temp<span class="punctuation">)</span>  <span class="comment">## midpoint</span></span><br><span class="line"></span><br><span class="line">gb <span class="operator">+</span> scale_color_gradient2<span class="punctuation">(</span>midpoint <span class="operator">=</span> mid<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f770f184b18.png" style="width:600px;"/></div></div></p><h2 id="æ‰‹åŠ¨è®¾ç½®åºåˆ—é¢œè‰²æ–¹æ¡ˆ"><a href="#æ‰‹åŠ¨è®¾ç½®åºåˆ—é¢œè‰²æ–¹æ¡ˆ" class="headerlink" title="æ‰‹åŠ¨è®¾ç½®åºåˆ—é¢œè‰²æ–¹æ¡ˆ"></a>æ‰‹åŠ¨è®¾ç½®åºåˆ—é¢œè‰²æ–¹æ¡ˆ</h2><p>æ‚¨å¯ä»¥é€šè¿‡<mark class="hl-label blue">scale_*_gradient()</mark> æ‰‹åŠ¨ä¸ºè¿ç»­å˜é‡è®¾ç½®é€æ¸å˜åŒ–çš„è°ƒè‰²æ¿ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gb <span class="operator">+</span> scale_color_gradient<span class="punctuation">(</span>low <span class="operator">=</span> <span class="string">&quot;darkkhaki&quot;</span><span class="punctuation">,</span></span><br><span class="line">                          high <span class="operator">=</span> <span class="string">&quot;darkgreen&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f771f0b7424.png" style="width:600px;"/></div></div></p><p>æ¸©åº¦æ•°æ®æ˜¯æ­£æ€åˆ†å¸ƒçš„ï¼Œå› æ­¤é‡‡ç”¨å‘æ•£é¢œè‰²æ–¹æ¡ˆï¼ˆè€Œä¸æ˜¯é¡ºåºé¢œè‰²ï¼‰å¦‚ä½•â€¦â€¦å¯¹äºå‘æ•£é¢œè‰²ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨<mark class="hl-label blue">scale_*_gradient2()</mark> å‡½æ•°ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gb <span class="operator">+</span> scale_color_gradient2<span class="punctuation">(</span>midpoint <span class="operator">=</span> mid<span class="punctuation">,</span> low <span class="operator">=</span> <span class="string">&quot;#dd8a0b&quot;</span><span class="punctuation">,</span></span><br><span class="line">                           mid <span class="operator">=</span> <span class="string">&quot;grey92&quot;</span><span class="punctuation">,</span> high <span class="operator">=</span> <span class="string">&quot;#32a676&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f773087a9e3.png" style="width:600px;"/></div></div></p><h2 id="ç¾ä¸½çš„-Viridis-è°ƒè‰²æ¿"><a href="#ç¾ä¸½çš„-Viridis-è°ƒè‰²æ¿" class="headerlink" title="ç¾ä¸½çš„ Viridis è°ƒè‰²æ¿"></a>ç¾ä¸½çš„ Viridis è°ƒè‰²æ¿</h2><p><a href="https://sjmgarnier.github.io/viridis/articles/intro-to-viridis.html">viridisè°ƒè‰²æ¿</a>ä¸ä»…èƒ½è®©æ‚¨çš„ç»˜å›¾çœ‹èµ·æ¥æ¼‚äº®ã€æ˜“äºæ„ŸçŸ¥ï¼Œè¿˜èƒ½è®©è‰²ç›²ç—‡æ‚£è€…æ›´å®¹æ˜“é˜…è¯»ï¼Œå¹¶èƒ½å¾ˆå¥½åœ°è¿›è¡Œç°åº¦æ‰“å°ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ {dichromat} è½¯ä»¶åŒ…æµ‹è¯•å„ç§è‰²ç›²æƒ…å†µä¸‹çš„ç»˜å›¾æ•ˆæœã€‚</p><p>ç°åœ¨ï¼Œå®ƒä»¬ä¹Ÿä¸ {ggplot2} ä¸€èµ·æä¾›ï¼ä¸‹é¢çš„å¤šé¢æ¿å›¾å±•ç¤ºäº†å››ç§ viridis è°ƒè‰²æ¿ä¸­çš„ä¸‰ç§ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">p1 <span class="operator">&lt;-</span> gb <span class="operator">+</span> scale_color_viridis_c<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> ggtitle<span class="punctuation">(</span><span class="string">&quot;&#x27;viridis&#x27; (default)&quot;</span><span class="punctuation">)</span></span><br><span class="line">p2 <span class="operator">&lt;-</span> gb <span class="operator">+</span> scale_color_viridis_c<span class="punctuation">(</span>option <span class="operator">=</span> <span class="string">&quot;inferno&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> ggtitle<span class="punctuation">(</span><span class="string">&quot;&#x27;inferno&#x27;&quot;</span><span class="punctuation">)</span></span><br><span class="line">p3 <span class="operator">&lt;-</span> gb <span class="operator">+</span> scale_color_viridis_c<span class="punctuation">(</span>option <span class="operator">=</span> <span class="string">&quot;plasma&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> ggtitle<span class="punctuation">(</span><span class="string">&quot;&#x27;plasma&#x27;&quot;</span><span class="punctuation">)</span></span><br><span class="line">p4 <span class="operator">&lt;-</span> gb <span class="operator">+</span> scale_color_viridis_c<span class="punctuation">(</span>option <span class="operator">=</span> <span class="string">&quot;cividis&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> ggtitle<span class="punctuation">(</span><span class="string">&quot;&#x27;cividis&#x27;&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">library<span class="punctuation">(</span>patchwork<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">(</span>p1 <span class="operator">+</span> p2 <span class="operator">+</span> p3 <span class="operator">+</span> p4<span class="punctuation">)</span> <span class="operator">*</span> theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&quot;bottom&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f7743b39b4a.png" style="width:600px;"/></div></div></p><p>ç¦»æ•£å˜é‡ä¹Ÿå¯ä»¥ä½¿ç”¨ viridis è°ƒè‰²æ¿ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ga <span class="operator">+</span> scale_color_viridis_d<span class="punctuation">(</span>guide <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f774f45e4e0.png,width=600px"/></div></div></p><h2 id="ä½¿ç”¨æ‰©å±•è½¯ä»¶åŒ…ä¸­çš„å®šé‡è°ƒè‰²æ¿"><a href="#ä½¿ç”¨æ‰©å±•è½¯ä»¶åŒ…ä¸­çš„å®šé‡è°ƒè‰²æ¿" class="headerlink" title="ä½¿ç”¨æ‰©å±•è½¯ä»¶åŒ…ä¸­çš„å®šé‡è°ƒè‰²æ¿"></a>ä½¿ç”¨æ‰©å±•è½¯ä»¶åŒ…ä¸­çš„å®šé‡è°ƒè‰²æ¿</h2><p>è®¸å¤šæ‰©å±•è½¯ä»¶åŒ…ä¸ä»…æä¾›äº†é¢å¤–çš„åˆ†ç±»è°ƒè‰²æ¿ï¼Œè¿˜æä¾›äº†é¡ºåºã€å‘æ•£ç”šè‡³å¾ªç¯è°ƒè‰²æ¿ã€‚åœ¨æ­¤ï¼Œæˆ‘å†æ¬¡å‘æ‚¨æ¨è<a href="https://github.com/EmilHvitfeldt/r-color-palettes/blob/master/README.md#comprehensive-list-of-color-palettes-in-r">Emil Hvitfeldt</a>æä¾›çš„å¤§é‡èµ„æ–™ï¼Œä¾›æ‚¨äº†è§£æ¦‚å†µã€‚</p><p><strong>ä¾‹å¦‚</strong><br><a href="https://github.com/Nowosad/rcartocolor">{rcartocolors}</a>åŒ…å°†æ¼‚äº®çš„<a href="https://carto.com/carto-colors/">CARTOcolors</a>ç§»æ¤åˆ° {ggplot2}ï¼Œå¹¶åŒ…å«äº†æˆ‘æœ€å¸¸ç”¨çš„å‡ ä¸ªè°ƒè‰²æ¿ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>rcartocolor<span class="punctuation">)</span></span><br><span class="line">g1 <span class="operator">&lt;-</span> gb <span class="operator">+</span> scale_color_carto_c<span class="punctuation">(</span>palette <span class="operator">=</span> <span class="string">&quot;BurgYl&quot;</span><span class="punctuation">)</span></span><br><span class="line">g2 <span class="operator">&lt;-</span> gb <span class="operator">+</span> scale_color_carto_c<span class="punctuation">(</span>palette <span class="operator">=</span> <span class="string">&quot;Earth&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">(</span>g1 <span class="operator">+</span> g2<span class="punctuation">)</span> <span class="operator">*</span> theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&quot;bottom&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f7771489c54.png" style="width:600px;"/></div></div></p><p>é€šè¿‡<a href="https://github.com/thomasp85/scico">{scico}</a>è½¯ä»¶åŒ…ï¼Œå¯ä»¥è®¿é—®<a href="https://www.fabiocrameri.ch/colourmaps/">Fabio Crameriå¼€å‘çš„è°ƒè‰²æ¿</a>ã€‚è¿™äº›è°ƒè‰²æ¿ä¸ä»…ç¾è§‚å¤§æ–¹ï¼Œè€Œä¸”å¾€å¾€ä¸ä¼—ä¸åŒï¼Œæ˜¯ä¸€ç§å¾ˆå¥½çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒä»¬åœ¨æ„ŸçŸ¥ä¸Šæ˜¯ç»Ÿä¸€æœ‰åºçš„ã€‚æ­¤å¤–ï¼Œå®ƒä»¬è¿˜é€‚ç”¨äºè‰²è§‰ç¼ºé™·è€…å’Œç°åº¦ç”¨æˆ·ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>scico<span class="punctuation">)</span></span><br><span class="line">g1 <span class="operator">&lt;-</span> gb <span class="operator">+</span> scale_color_scico<span class="punctuation">(</span>palette <span class="operator">=</span> <span class="string">&quot;berlin&quot;</span><span class="punctuation">)</span></span><br><span class="line">g2 <span class="operator">&lt;-</span> gb <span class="operator">+</span> scale_color_scico<span class="punctuation">(</span>palette <span class="operator">=</span> <span class="string">&quot;hawaii&quot;</span><span class="punctuation">,</span> direction <span class="operator">=</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">(</span>g1 <span class="operator">+</span> g2<span class="punctuation">)</span> <span class="operator">*</span> theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&quot;bottom&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f77818961de.png" style="width:600px;"/></div></div></p><h2 id="äº‹åä¿®æ”¹è°ƒè‰²æ¿"><a href="#äº‹åä¿®æ”¹è°ƒè‰²æ¿" class="headerlink" title="äº‹åä¿®æ”¹è°ƒè‰²æ¿"></a>äº‹åä¿®æ”¹è°ƒè‰²æ¿</h2><p>è‡ª ggplot2 3.0.0 å‘å¸ƒä»¥æ¥ï¼Œäººä»¬å¯ä»¥åœ¨å°†å›¾å±‚æ˜ å°„åˆ°æ•°æ®åä¿®æ”¹å›¾å±‚çš„ç¾è§‚åº¦ã€‚æˆ–è€…æŒ‰ç…§ {ggplot2} çš„è¯´æ³• â€œä½¿ç”¨<mark class="hl-label blue">after_scale()</mark> æ ‡è®°æ•°æ®ç¼©æ”¾åçš„æ˜ å°„è¯„ä¼°â€ã€‚</p><p>é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆä¸é¦–å…ˆä½¿ç”¨ä¿®æ”¹åçš„é¢œè‰²å‘¢ï¼Ÿç”±äº{ggplot2}åªèƒ½å¤„ç†ä¸€ç§<mark class="hl-label blue">color</mark> å’Œä¸€ç§<mark class="hl-label blue">fill</mark> æ¯”ä¾‹ï¼Œå› æ­¤è¿™æ˜¯ä¸€ä¸ªæœ‰è¶£çš„åŠŸèƒ½ã€‚è¯·çœ‹ä¸‹é¢çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†<a href="https://emilhvitfeldt.github.io/prismatic/">{prismatic}</a>è½¯ä»¶åŒ…ä¸­çš„<mark class="hl-label blue">clr_negate()</mark> ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>prismatic<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>date<span class="punctuation">,</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> temp<span class="punctuation">,</span></span><br><span class="line">                 color <span class="operator">=</span> after_scale<span class="punctuation">(</span>clr_negate<span class="punctuation">(</span>color<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">             size <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_color_scico<span class="punctuation">(</span>palette <span class="operator">=</span> <span class="string">&quot;hawaii&quot;</span><span class="punctuation">,</span> guide <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f779e4d2409.png" style="width:600px;"/></div></div></p><p>ä½¿ç”¨{prismatic}è½¯ä»¶åŒ…ä¸­çš„<mark class="hl-label blue">clr_negate()</mark> ã€<mark class="hl-label blue">clr_lighten()</mark> ã€<mark class="hl-label blue">clr_darken()</mark> å’Œ<mark class="hl-label blue">clr_desaturate()</mark> ç­‰å‡½æ•°ï¼Œäº‹åæ›´æ”¹é…è‰²æ–¹æ¡ˆå°¤å…¶æœ‰è¶£ã€‚ä½ ç”šè‡³å¯ä»¥å°†è¿™äº›å‡½æ•°ç»„åˆä½¿ç”¨ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ç»˜åˆ¶ä¸€ä¸ªåŒæ—¶æ‹¥æœ‰<mark class="hl-label blue">color</mark> å’Œ<mark class="hl-label blue">fill</mark> ä¸¤ä¸ªå‚æ•°çš„æ–¹æ¡†å›¾ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>prismatic<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>date<span class="punctuation">,</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_boxplot<span class="punctuation">(</span></span><br><span class="line">    aes<span class="punctuation">(</span>color <span class="operator">=</span> season<span class="punctuation">,</span></span><br><span class="line">        fill <span class="operator">=</span> after_scale<span class="punctuation">(</span>clr_desaturate<span class="punctuation">(</span>clr_lighten<span class="punctuation">(</span>color<span class="punctuation">,</span> <span class="number">.6</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">.6</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    linewidth <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_color_brewer<span class="punctuation">(</span>palette <span class="operator">=</span> <span class="string">&quot;Dark2&quot;</span><span class="punctuation">,</span> guide <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f77c2724ccc.png" style="width:600px;"/></div></div></p><p>è¯·æ³¨æ„ï¼Œæ‚¨éœ€è¦åœ¨ç›¸åº”çš„<mark class="hl-label blue">geom_*()</mark> æˆ–<mark class="hl-label blue">stat_*()</mark> çš„<mark class="hl-label blue">aes()</mark> ä¸­æŒ‡å®š<mark class="hl-label blue">color</mark> å’Œ/æˆ–<mark class="hl-label blue">fill</mark> ï¼Œæ‰èƒ½ä½¿<mark class="hl-label blue">after_scale()</mark> æ­£å¸¸å·¥ä½œã€‚</p><p><strong>ğŸ’¡ ç°åœ¨çœ‹æ¥è¿™æœ‰ç‚¹å¤æ‚â€”å¯ä»¥ç®€å•åœ°åŒæ—¶ä½¿ç”¨<mark class="hl-label blue">color</mark> å’Œ<mark class="hl-label blue">fill</mark> æ¯”ä¾‹ã€‚æ˜¯çš„ï¼Œè¿™æ²¡é”™ï¼Œä½†æƒ³æƒ³åœ¨ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦å¤šä¸ª<mark class="hl-label blue">color</mark> å’Œ/æˆ–<mark class="hl-label blue">fill</mark> åˆ»åº¦ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”¨<mark class="hl-label blue">color</mark> è°ƒè‰²æ¿çš„ç¨æš—ç‰ˆæœ¬æ¥å ç”¨<mark class="hl-label blue">fill</mark> åˆ»åº¦æ˜¯æ¯«æ— æ„ä¹‰çš„ã€‚</strong></p><h1 id="ä¸»é¢˜"><a href="#ä¸»é¢˜" class="headerlink" title="ä¸»é¢˜"></a>ä¸»é¢˜</h1><h2 id="æ›´æ”¹æ€»ä½“ç»˜å›¾é£æ ¼"><a href="#æ›´æ”¹æ€»ä½“ç»˜å›¾é£æ ¼" class="headerlink" title="æ›´æ”¹æ€»ä½“ç»˜å›¾é£æ ¼"></a>æ›´æ”¹æ€»ä½“ç»˜å›¾é£æ ¼</h2><p>æ‚¨å¯ä»¥ä½¿ç”¨ä¸»é¢˜æ¥æ”¹å˜ç»˜å›¾çš„æ•´ä½“å¤–è§‚ã€‚{ggplot2}å†…ç½®äº†å…«ä¸ªä¸»é¢˜ï¼š<br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f89d24dc27e.png" style="width:600px;"/></div></div></p><p>æœ‰å‡ ä¸ªè½¯ä»¶åŒ…æä¾›äº†é¢å¤–çš„ä¸»é¢˜ï¼Œæœ‰äº›ç”šè‡³å¸¦æœ‰ä¸åŒçš„é»˜è®¤è°ƒè‰²æ¿ã€‚ä¾‹å¦‚ï¼Œæ°å¼—é‡Œ-é˜¿è¯ºå¾·ï¼ˆJeffrey Arnoldï¼‰åˆ›å»ºäº†{ggthemes}åº“ï¼Œå…¶ä¸­åŒ…å«å¤šä¸ªæ¨¡ä»¿æµè¡Œè®¾è®¡çš„è‡ªå®šä¹‰ä¸»é¢˜ã€‚æœ‰å…³åˆ—è¡¨ï¼Œè¯·è®¿é—®<a href="https://github.com/jrnold/ggthemes">{ggthemes}</a>è½¯ä»¶åŒ…ç½‘ç«™ã€‚æ— éœ€ç¼–å†™ä»»ä½•ä»£ç ï¼Œä½ å°±å¯ä»¥æ”¹ç¼–å‡ ç§é£æ ¼ï¼Œå…¶ä¸­ä¸€äº›ä»¥é£æ ¼å’Œç¾å­¦è‘—ç§°ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨<mark class="hl-label blue">theme_economist()</mark> å’Œ<mark class="hl-label blue">scale_color_economist()</mark>  å¤åˆ¶<a href="https://www.economist.com/">ã€Šç»æµå­¦äººã€‹</a>æ‚å¿—ç»˜å›¾é£æ ¼çš„ç¤ºä¾‹ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>ggthemes<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  ggtitle<span class="punctuation">(</span><span class="string">&quot;Ups and Downs of Chicago&#x27;s Daily Temperatures&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_economist<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_color_economist<span class="punctuation">(</span>name <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f8a096d1a65.png" style="width:600px;"/></div></div></p><p>å¦ä¸€ä¸ªä¾‹å­æ˜¯ Tufte çš„ç»˜å›¾é£æ ¼ï¼Œè¿™æ˜¯ä¸€ç§åŸºäºçˆ±å¾·å-å¡”å¤«ç‰¹ï¼ˆEdward Tufteï¼‰çš„ã€Šé‡åŒ–ä¿¡æ¯çš„å¯è§†åŒ–æ˜¾ç¤ºã€‹ä¸€ä¹¦çš„æç®€æ°´å¢¨ä¸»é¢˜ã€‚æ­£æ˜¯è¿™æœ¬ä¹¦å°†ç±³çº³å°”æç»˜æ‹¿ç ´ä»‘è¿›å†›ä¿„å›½çš„å›¾è¡¨æ¨å¹¿ä¸ºæœ‰å²ä»¥æ¥æœ€å¥½çš„ç»Ÿè®¡å›¾ä¹‹ä¸€ã€‚å¡”å¤«ç‰¹çš„å›¾è¡¨å› å…¶çº¯ç²¹çš„é£æ ¼è€Œé—»åäºä¸–ã€‚ä½†ä½ è‡ªå·±çœ‹çœ‹å§ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>dplyr<span class="punctuation">)</span></span><br><span class="line">chic_2000 <span class="operator">&lt;-</span> filter<span class="punctuation">(</span>chic<span class="punctuation">,</span> year <span class="operator">==</span> <span class="number">2000</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>chic_2000<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> temp<span class="punctuation">,</span> y <span class="operator">=</span> o3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Ozone&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  ggtitle<span class="punctuation">(</span><span class="string">&quot;Temperature and Ozone Levels During the Year 2000 in Chicago&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_tufte<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/06/64f8a18503cbf.png" style="width:600px;"/></div></div></p><p>æˆ‘åœ¨è¿™é‡Œå‡å°‘äº†æ•°æ®ç‚¹çš„æ•°é‡ï¼Œåªæ˜¯ä¸ºäº†é€‚åº”Tufteçš„æç®€ä¸»ä¹‰é£æ ¼ã€‚å¦‚æœä½ å–œæ¬¢è¿™ç§ç»˜å›¾æ–¹å¼ï¼Œå¯ä»¥çœ‹çœ‹è¿™ç¯‡<a href="http://motioninsocial.com/tufte/">åšå®¢æ–‡ç« </a>ï¼Œåœ¨ R ä¸­ç»˜åˆ¶å‡ å¹… Tufte å›¾ã€‚</p><p>Bob Rudis åˆ¶ä½œçš„<a href="https://github.com/hrbrmstr/hrbrthemes">{hrbrthemes}</a>è½¯ä»¶åŒ…æ˜¯å¦ä¸€æ¬¾å…·æœ‰ç°ä»£ä¸»é¢˜å’Œéé»˜è®¤å­—ä½“é¢„è®¾çš„è½¯ä»¶åŒ…ï¼Œå…¶ä¸­åŒ…å«å¤šä¸ªæµ…è‰²å’Œæ·±è‰²ä¸»é¢˜ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>hrbrthemes<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> temp<span class="punctuation">,</span> y <span class="operator">=</span> o3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> dewpoint<span class="punctuation">)</span><span class="punctuation">,</span> show.legend <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Ozone&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  ggtitle<span class="punctuation">(</span><span class="string">&quot;Temperature and Ozone Levels in Chicago&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/07/64f8a2e3a3f7b.png" style="width:600px;"/></div></div></p><h2 id="æ›´æ”¹æ‰€æœ‰æ–‡æœ¬å…ƒç´ çš„å­—ä½“"><a href="#æ›´æ”¹æ‰€æœ‰æ–‡æœ¬å…ƒç´ çš„å­—ä½“" class="headerlink" title="æ›´æ”¹æ‰€æœ‰æ–‡æœ¬å…ƒç´ çš„å­—ä½“"></a>æ›´æ”¹æ‰€æœ‰æ–‡æœ¬å…ƒç´ çš„å­—ä½“</h2><p>è¦ä¸€æ¬¡æ€§æ›´æ”¹æ‰€æœ‰æ–‡æœ¬å…ƒç´ çš„è®¾ç½®ï¼Œç®€ç›´æ˜“å¦‚åæŒã€‚æ‰€æœ‰ä¸»é¢˜éƒ½æœ‰ä¸€ä¸ªåä¸º<mark class="hl-label blue">base_family</mark> çš„å‚æ•°ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span></span><br><span class="line">       title <span class="operator">=</span> <span class="string">&quot;Temperatures in Chicago&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">g <span class="operator">+</span> theme_bw<span class="punctuation">(</span>base_family <span class="operator">=</span> <span class="string">&quot;sans&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/07/64f8b0ecdf9f8.png" style="width:600px;"/></div></div></p><h2 id="æ›´æ”¹æ‰€æœ‰æ–‡æœ¬å…ƒç´ çš„å¤§å°"><a href="#æ›´æ”¹æ‰€æœ‰æ–‡æœ¬å…ƒç´ çš„å¤§å°" class="headerlink" title="æ›´æ”¹æ‰€æœ‰æ–‡æœ¬å…ƒç´ çš„å¤§å°"></a>æ›´æ”¹æ‰€æœ‰æ–‡æœ¬å…ƒç´ çš„å¤§å°</h2><p>æ­¤å¤–ï¼Œ<mark class="hl-label blue">theme_*()</mark> å‡½æ•°è¿˜æä¾›äº†å…¶ä»–å‡ ä¸ª<mark class="hl-label blue">base_*</mark> å‚æ•°ã€‚å¦‚æœä»”ç»†è§‚å¯Ÿä¸€ä¸‹é»˜è®¤ä¸»é¢˜ï¼ˆå‚è§ä¸‹æ–‡ â€œåˆ›å»ºå¹¶ä½¿ç”¨è‡ªå®šä¹‰ä¸»é¢˜ â€œä¸€ç« ï¼‰ï¼Œä½ ä¼šå‘ç°æ‰€æœ‰å…ƒç´ çš„å¤§å°éƒ½æ˜¯ç›¸å¯¹äº<mark class="hl-label blue">base_size</mark> çš„<mark class="hl-label blue">ï¼ˆrel()ï¼‰</mark> ã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨æƒ³æé«˜ç»˜å›¾çš„å¯è¯»æ€§ï¼Œåªéœ€æ›´æ”¹åŸºå°ºå¯¸å³å¯ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span> theme_bw<span class="punctuation">(</span>base_size <span class="operator">=</span> <span class="number">30</span><span class="punctuation">,</span> base_family <span class="operator">=</span> <span class="string">&quot;Roboto Condensed&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/07/64f8b4ab1a238.png" style="width:600px;"/></div></div></p><h2 id="æ›´æ”¹æ‰€æœ‰çº¿æ¡å’ŒçŸ©å½¢å…ƒç´ çš„å¤§å°"><a href="#æ›´æ”¹æ‰€æœ‰çº¿æ¡å’ŒçŸ©å½¢å…ƒç´ çš„å¤§å°" class="headerlink" title="æ›´æ”¹æ‰€æœ‰çº¿æ¡å’ŒçŸ©å½¢å…ƒç´ çš„å¤§å°"></a>æ›´æ”¹æ‰€æœ‰çº¿æ¡å’ŒçŸ©å½¢å…ƒç´ çš„å¤§å°</h2><p>åŒæ ·ï¼Œæ‚¨ä¹Ÿå¯ä»¥æ›´æ”¹æ‰€æœ‰<mark class="hl-label blue">line</mark> å’Œ<mark class="hl-label blue">rect</mark> ç±»å‹å…ƒç´ çš„å¤§å°ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span> theme_bw<span class="punctuation">(</span>base_line_size <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> base_rect_size <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/07/64f8b5f16f62c.png" style="width:600px;"/></div></div></p><h2 id="åˆ›å»ºè‡ªå·±çš„ä¸»é¢˜"><a href="#åˆ›å»ºè‡ªå·±çš„ä¸»é¢˜" class="headerlink" title="åˆ›å»ºè‡ªå·±çš„ä¸»é¢˜"></a>åˆ›å»ºè‡ªå·±çš„ä¸»é¢˜</h2><p>å¦‚æœè¦æ›´æ”¹æ•´ä¸ªä¼šè¯çš„ä¸»é¢˜ï¼Œå¯ä»¥ä½¿ç”¨<mark class="hl-label blue">theme_set</mark> ï¼Œå¦‚<mark class="hl-label blue">theme_set(theme_bw())</mark> ã€‚é»˜è®¤ä¸»é¢˜ä¸º<mark class="hl-label blue">theme_gray</mark> ã€‚å¦‚æœä½ æƒ³åˆ›å»ºè‡ªå·±çš„è‡ªå®šä¹‰ä¸»é¢˜ï¼Œå¯ä»¥ç›´æ¥ä»ç°è‰²ä¸»é¢˜ä¸­æå–ä»£ç å¹¶ä¿®æ”¹ã€‚è¯·æ³¨æ„ï¼Œ<mark class="hl-label blue">rel()</mark> å‡½æ•°ä¼šæ”¹å˜ç›¸å¯¹äº<mark class="hl-label blue">base_size</mark> çš„å°ºå¯¸ã€‚<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">theme_gray</span><br></pre></td></tr></table></figure><br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## function (base_size = 11, base_family = &quot;&quot;, base_line_size = base_size/22, </span></span><br><span class="line"><span class="comment">##     base_rect_size = base_size/22) </span></span><br><span class="line"><span class="comment">## &#123;</span></span><br><span class="line"><span class="comment">##     half_line &lt;- base_size/2</span></span><br><span class="line"><span class="comment">##     t &lt;- theme(line = element_line(colour = &quot;black&quot;, linewidth = base_line_size, </span></span><br><span class="line"><span class="comment">##         linetype = 1, lineend = &quot;butt&quot;), rect = element_rect(fill = &quot;white&quot;, </span></span><br><span class="line"><span class="comment">##         colour = &quot;black&quot;, linewidth = base_rect_size, linetype = 1), </span></span><br><span class="line"><span class="comment">##         text = element_text(family = base_family, face = &quot;plain&quot;, </span></span><br><span class="line"><span class="comment">##             colour = &quot;black&quot;, size = base_size, lineheight = 0.9, </span></span><br><span class="line"><span class="comment">##             hjust = 0.5, vjust = 0.5, angle = 0, margin = margin(), </span></span><br><span class="line"><span class="comment">##             debug = FALSE), axis.line = element_blank(), axis.line.x = NULL, </span></span><br><span class="line"><span class="comment">##         axis.line.y = NULL, axis.text = element_text(size = rel(0.8), </span></span><br><span class="line"><span class="comment">##             colour = &quot;grey30&quot;), axis.text.x = element_text(margin = margin(t = 0.8 * </span></span><br><span class="line"><span class="comment">##             half_line/2), vjust = 1), axis.text.x.top = element_text(margin = margin(b = 0.8 * </span></span><br><span class="line"><span class="comment">##             half_line/2), vjust = 0), axis.text.y = element_text(margin = margin(r = 0.8 * </span></span><br><span class="line"><span class="comment">##             half_line/2), hjust = 1), axis.text.y.right = element_text(margin = margin(l = 0.8 * </span></span><br><span class="line"><span class="comment">##             half_line/2), hjust = 0), axis.ticks = element_line(colour = &quot;grey20&quot;), </span></span><br><span class="line"><span class="comment">##         axis.ticks.length = unit(half_line/2, &quot;pt&quot;), axis.ticks.length.x = NULL, </span></span><br><span class="line"><span class="comment">##         axis.ticks.length.x.top = NULL, axis.ticks.length.x.bottom = NULL, </span></span><br><span class="line"><span class="comment">##         axis.ticks.length.y = NULL, axis.ticks.length.y.left = NULL, </span></span><br><span class="line"><span class="comment">##         axis.ticks.length.y.right = NULL, axis.title.x = element_text(margin = margin(t = half_line/2), </span></span><br><span class="line"><span class="comment">##             vjust = 1), axis.title.x.top = element_text(margin = margin(b = half_line/2), </span></span><br><span class="line"><span class="comment">##             vjust = 0), axis.title.y = element_text(angle = 90, </span></span><br><span class="line"><span class="comment">##             margin = margin(r = half_line/2), vjust = 1), axis.title.y.right = element_text(angle = -90, </span></span><br><span class="line"><span class="comment">##             margin = margin(l = half_line/2), vjust = 0), legend.background = element_rect(colour = NA), </span></span><br><span class="line"><span class="comment">##         legend.spacing = unit(2 * half_line, &quot;pt&quot;), legend.spacing.x = NULL, </span></span><br><span class="line"><span class="comment">##         legend.spacing.y = NULL, legend.margin = margin(half_line, </span></span><br><span class="line"><span class="comment">##             half_line, half_line, half_line), legend.key = element_rect(fill = &quot;grey95&quot;, </span></span><br><span class="line"><span class="comment">##             colour = NA), legend.key.size = unit(1.2, &quot;lines&quot;), </span></span><br><span class="line"><span class="comment">##         legend.key.height = NULL, legend.key.width = NULL, legend.text = element_text(size = rel(0.8)), </span></span><br><span class="line"><span class="comment">##         legend.text.align = NULL, legend.title = element_text(hjust = 0), </span></span><br><span class="line"><span class="comment">##         legend.title.align = NULL, legend.position = &quot;right&quot;, </span></span><br><span class="line"><span class="comment">##         legend.direction = NULL, legend.justification = &quot;center&quot;, </span></span><br><span class="line"><span class="comment">##         legend.box = NULL, legend.box.margin = margin(0, 0, 0, </span></span><br><span class="line"><span class="comment">##             0, &quot;cm&quot;), legend.box.background = element_blank(), </span></span><br><span class="line"><span class="comment">##         legend.box.spacing = unit(2 * half_line, &quot;pt&quot;), panel.background = element_rect(fill = &quot;grey92&quot;, </span></span><br><span class="line"><span class="comment">##             colour = NA), panel.border = element_blank(), panel.grid = element_line(colour = &quot;white&quot;), </span></span><br><span class="line"><span class="comment">##         panel.grid.minor = element_line(linewidth = rel(0.5)), </span></span><br><span class="line"><span class="comment">##         panel.spacing = unit(half_line, &quot;pt&quot;), panel.spacing.x = NULL, </span></span><br><span class="line"><span class="comment">##         panel.spacing.y = NULL, panel.ontop = FALSE, strip.background = element_rect(fill = &quot;grey85&quot;, </span></span><br><span class="line"><span class="comment">##             colour = NA), strip.clip = &quot;inherit&quot;, strip.text = element_text(colour = &quot;grey10&quot;, </span></span><br><span class="line"><span class="comment">##             size = rel(0.8), margin = margin(0.8 * half_line, </span></span><br><span class="line"><span class="comment">##                 0.8 * half_line, 0.8 * half_line, 0.8 * half_line)), </span></span><br><span class="line"><span class="comment">##         strip.text.x = NULL, strip.text.y = element_text(angle = -90), </span></span><br><span class="line"><span class="comment">##         strip.text.y.left = element_text(angle = 90), strip.placement = &quot;inside&quot;, </span></span><br><span class="line"><span class="comment">##         strip.placement.x = NULL, strip.placement.y = NULL, strip.switch.pad.grid = unit(half_line/2, </span></span><br><span class="line"><span class="comment">##             &quot;pt&quot;), strip.switch.pad.wrap = unit(half_line/2, </span></span><br><span class="line"><span class="comment">##             &quot;pt&quot;), plot.background = element_rect(colour = &quot;white&quot;), </span></span><br><span class="line"><span class="comment">##         plot.title = element_text(size = rel(1.2), hjust = 0, </span></span><br><span class="line"><span class="comment">##             vjust = 1, margin = margin(b = half_line)), plot.title.position = &quot;panel&quot;, </span></span><br><span class="line"><span class="comment">##         plot.subtitle = element_text(hjust = 0, vjust = 1, margin = margin(b = half_line)), </span></span><br><span class="line"><span class="comment">##         plot.caption = element_text(size = rel(0.8), hjust = 1, </span></span><br><span class="line"><span class="comment">##             vjust = 1, margin = margin(t = half_line)), plot.caption.position = &quot;panel&quot;, </span></span><br><span class="line"><span class="comment">##         plot.tag = element_text(size = rel(1.2), hjust = 0.5, </span></span><br><span class="line"><span class="comment">##             vjust = 0.5), plot.tag.position = &quot;topleft&quot;, plot.margin = margin(half_line, </span></span><br><span class="line"><span class="comment">##             half_line, half_line, half_line), complete = TRUE)</span></span><br><span class="line"><span class="comment">##     ggplot_global$theme_all_null %+replace% t</span></span><br><span class="line"><span class="comment">## &#125;</span></span><br><span class="line"><span class="comment">## &lt;bytecode: 0x7fb89d268170&gt;</span></span><br><span class="line"><span class="comment">## &lt;environment: namespace:ggplot2&gt;</span></span><br></pre></td></tr></table></figure></p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä¿®æ”¹é»˜è®¤ä¸»é¢˜åŠŸèƒ½ï¼Œçœ‹çœ‹ç»“æœå¦‚ä½•ï¼š</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">theme_custom <span class="operator">&lt;-</span> <span class="keyword">function</span> <span class="punctuation">(</span>base_size <span class="operator">=</span> <span class="number">12</span><span class="punctuation">,</span> base_family <span class="operator">=</span> <span class="string">&quot;Roboto Condensed&quot;</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  half_line <span class="operator">&lt;-</span> base_size<span class="operator">/</span><span class="number">2</span></span><br><span class="line">  theme<span class="punctuation">(</span></span><br><span class="line">    line <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">,</span></span><br><span class="line">                        linetype <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> lineend <span class="operator">=</span> <span class="string">&quot;butt&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    rect <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        linewidth <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    text <span class="operator">=</span> element_text<span class="punctuation">(</span>family <span class="operator">=</span> base_family<span class="punctuation">,</span> face <span class="operator">=</span> <span class="string">&quot;plain&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> base_size<span class="punctuation">,</span></span><br><span class="line">                        lineheight <span class="operator">=</span> <span class="number">.9</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">,</span> vjust <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">,</span></span><br><span class="line">                        angle <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> margin <span class="operator">=</span> margin<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> debug <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.line <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.line.x <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">    axis.line.y <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">    axis.text <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> base_size <span class="operator">*</span> <span class="number">1.1</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;gray30&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.text.x <span class="operator">=</span> element_text<span class="punctuation">(</span>margin <span class="operator">=</span> margin<span class="punctuation">(</span>t <span class="operator">=</span> <span class="number">.8</span> <span class="operator">*</span> half_line<span class="operator">/</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                               vjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.text.x.top <span class="operator">=</span> element_text<span class="punctuation">(</span>margin <span class="operator">=</span> margin<span class="punctuation">(</span>b <span class="operator">=</span> <span class="number">.8</span> <span class="operator">*</span> half_line<span class="operator">/</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                                   vjust <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.text.y <span class="operator">=</span> element_text<span class="punctuation">(</span>margin <span class="operator">=</span> margin<span class="punctuation">(</span>r <span class="operator">=</span> <span class="number">.8</span> <span class="operator">*</span> half_line<span class="operator">/</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                               hjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.text.y.right <span class="operator">=</span> element_text<span class="punctuation">(</span>margin <span class="operator">=</span> margin<span class="punctuation">(</span>l <span class="operator">=</span> <span class="number">.8</span> <span class="operator">*</span> half_line<span class="operator">/</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                                     hjust <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.ticks <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;gray30&quot;</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">.7</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.ticks.length <span class="operator">=</span> unit<span class="punctuation">(</span>half_line <span class="operator">/</span> <span class="number">1.5</span><span class="punctuation">,</span> <span class="string">&quot;pt&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.ticks.length.x <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">    axis.ticks.length.x.top <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">    axis.ticks.length.x.bottom <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">    axis.ticks.length.y <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">    axis.ticks.length.y.left <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">    axis.ticks.length.y.right <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">    axis.title.x <span class="operator">=</span> element_text<span class="punctuation">(</span>margin <span class="operator">=</span> margin<span class="punctuation">(</span>t <span class="operator">=</span> half_line<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                                vjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> size <span class="operator">=</span> base_size <span class="operator">*</span> <span class="number">1.3</span><span class="punctuation">,</span></span><br><span class="line">                                face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.title.x.top <span class="operator">=</span> element_text<span class="punctuation">(</span>margin <span class="operator">=</span> margin<span class="punctuation">(</span>b <span class="operator">=</span> half_line<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                                    vjust <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.title.y <span class="operator">=</span> element_text<span class="punctuation">(</span>angle <span class="operator">=</span> <span class="number">90</span><span class="punctuation">,</span> vjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">                                margin <span class="operator">=</span> margin<span class="punctuation">(</span>r <span class="operator">=</span> half_line<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                                size <span class="operator">=</span> base_size <span class="operator">*</span> <span class="number">1.3</span><span class="punctuation">,</span> face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.title.y.right <span class="operator">=</span> element_text<span class="punctuation">(</span>angle <span class="operator">=</span> <span class="operator">-</span><span class="number">90</span><span class="punctuation">,</span> vjust <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">                                      margin <span class="operator">=</span> margin<span class="punctuation">(</span>l <span class="operator">=</span> half_line<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    legend.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    legend.spacing <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">.4</span><span class="punctuation">,</span> <span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    legend.spacing.x <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">    legend.spacing.y <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">    legend.margin <span class="operator">=</span> margin<span class="punctuation">(</span><span class="number">.2</span><span class="punctuation">,</span> <span class="number">.2</span><span class="punctuation">,</span> <span class="number">.2</span><span class="punctuation">,</span> <span class="number">.2</span><span class="punctuation">,</span> <span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    legend.key <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;gray95&quot;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    legend.key.size <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">1.2</span><span class="punctuation">,</span> <span class="string">&quot;lines&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    legend.key.height <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">    legend.key.width <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">    legend.text <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> rel<span class="punctuation">(</span><span class="number">.8</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    legend.text.align <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">    legend.title <span class="operator">=</span> element_text<span class="punctuation">(</span>hjust <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    legend.title.align <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">    legend.position <span class="operator">=</span> <span class="string">&quot;right&quot;</span><span class="punctuation">,</span></span><br><span class="line">    legend.direction <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">    legend.justification <span class="operator">=</span> <span class="string">&quot;center&quot;</span><span class="punctuation">,</span></span><br><span class="line">    legend.box <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">    legend.box.margin <span class="operator">=</span> margin<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    legend.box.background <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    legend.box.spacing <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">.4</span><span class="punctuation">,</span> <span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    panel.border <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;gray30&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                fill <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">.7</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    panel.grid.major <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;gray90&quot;</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    panel.grid.minor <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;gray90&quot;</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">,</span></span><br><span class="line">                                    linetype <span class="operator">=</span> <span class="string">&quot;dashed&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    panel.spacing <span class="operator">=</span> unit<span class="punctuation">(</span>base_size<span class="punctuation">,</span> <span class="string">&quot;pt&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    panel.spacing.x <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">    panel.spacing.y <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">    panel.ontop <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span></span><br><span class="line">    strip.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;gray30&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    strip.text <span class="operator">=</span> element_text<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> base_size<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    strip.text.x <span class="operator">=</span> element_text<span class="punctuation">(</span>margin <span class="operator">=</span> margin<span class="punctuation">(</span>t <span class="operator">=</span> half_line<span class="punctuation">,</span></span><br><span class="line">                                                b <span class="operator">=</span> half_line<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    strip.text.y <span class="operator">=</span> element_text<span class="punctuation">(</span>angle <span class="operator">=</span> <span class="operator">-</span><span class="number">90</span><span class="punctuation">,</span></span><br><span class="line">                                margin <span class="operator">=</span> margin<span class="punctuation">(</span>l <span class="operator">=</span> half_line<span class="punctuation">,</span></span><br><span class="line">                                                r <span class="operator">=</span> half_line<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    strip.text.y.left <span class="operator">=</span> element_text<span class="punctuation">(</span>angle <span class="operator">=</span> <span class="number">90</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    strip.placement <span class="operator">=</span> <span class="string">&quot;inside&quot;</span><span class="punctuation">,</span></span><br><span class="line">    strip.placement.x <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">    strip.placement.y <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">    strip.switch.pad.grid <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.1</span><span class="punctuation">,</span> <span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    strip.switch.pad.wrap <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.1</span><span class="punctuation">,</span> <span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    plot.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> base_size <span class="operator">*</span> <span class="number">1.8</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">,</span></span><br><span class="line">                              vjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">,</span></span><br><span class="line">                              margin <span class="operator">=</span> margin<span class="punctuation">(</span>b <span class="operator">=</span> half_line <span class="operator">*</span> <span class="number">1.2</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    plot.title.position <span class="operator">=</span> <span class="string">&quot;panel&quot;</span><span class="punctuation">,</span></span><br><span class="line">    plot.subtitle <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> base_size <span class="operator">*</span> <span class="number">1.3</span><span class="punctuation">,</span></span><br><span class="line">                                 hjust <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">,</span> vjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">                                 margin <span class="operator">=</span> margin<span class="punctuation">(</span>b <span class="operator">=</span> half_line <span class="operator">*</span> <span class="number">.9</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    plot.caption <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> rel<span class="punctuation">(</span><span class="number">0.9</span><span class="punctuation">)</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> vjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">                                margin <span class="operator">=</span> margin<span class="punctuation">(</span>t <span class="operator">=</span> half_line <span class="operator">*</span> <span class="number">.9</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    plot.caption.position <span class="operator">=</span> <span class="string">&quot;panel&quot;</span><span class="punctuation">,</span></span><br><span class="line">    plot.tag <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> rel<span class="punctuation">(</span><span class="number">1.2</span><span class="punctuation">)</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">,</span> vjust <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    plot.tag.position <span class="operator">=</span> <span class="string">&quot;topleft&quot;</span><span class="punctuation">,</span></span><br><span class="line">    plot.margin <span class="operator">=</span> margin<span class="punctuation">(</span><span class="built_in">rep</span><span class="punctuation">(</span>base_size<span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    complete <span class="operator">=</span> <span class="literal">TRUE</span></span><br><span class="line">  <span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>ğŸ’¡ æ‚¨åªèƒ½è¦†ç›–æ‰€æœ‰è¦æ›´æ”¹çš„å…ƒç´ çš„é»˜è®¤å€¼ã€‚æˆ‘åœ¨è¿™é‡Œåˆ—å‡ºäº†æ‰€æœ‰å…ƒç´ ï¼Œè¿™æ ·ä½ å°±å¯ä»¥çœ‹åˆ°ä½ å¯ä»¥æ›´æ”¹æ‰€æœ‰å…ƒç´ ï¼</strong></p><p>é¢æ¿ã€ç½‘æ ¼çº¿ä»¥åŠåæ ‡è½´åˆ»åº¦ã€æ–‡æœ¬å’Œæ ‡é¢˜éƒ½é‡‡ç”¨äº†æ–°çš„ç¾å­¦è®¾è®¡ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">theme_set<span class="punctuation">(</span>theme_custom<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> guides<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/07/64f8b8488d019.png" style="width:600px;"/></div></div></p><p>å¼ºçƒˆæ¨èä½¿ç”¨è¿™ç§æ–¹å¼æ›´æ”¹åœ°å—è®¾è®¡ï¼åªéœ€æ›´æ”¹ä¸€æ¬¡ï¼Œæ‚¨å°±å¯ä»¥å¿«é€Ÿæ›´æ”¹ç»˜å›¾ä¸­çš„ä»»ä½•å…ƒç´ ã€‚æ‚¨å¯ä»¥åœ¨å‡ ç§’é’Ÿå†…å°†æ‰€æœ‰ç»“æœç»˜åˆ¶æˆé£æ ¼ä¸€è‡´çš„å›¾è¡¨ï¼Œå¹¶æ ¹æ®å…¶ä»–éœ€è¦è¿›è¡Œè°ƒæ•´ï¼ˆä¾‹å¦‚ï¼Œåœ¨æ¼”ç¤ºæ–‡ç¨¿ä¸­ä½¿ç”¨æ›´å¤§çš„å­—ä½“æˆ–æ»¡è¶³æœŸåˆŠè¦æ±‚ï¼‰ã€‚</p><h2 id="æ›´æ–°å½“å‰ä¸»é¢˜"><a href="#æ›´æ–°å½“å‰ä¸»é¢˜" class="headerlink" title="æ›´æ–°å½“å‰ä¸»é¢˜"></a>æ›´æ–°å½“å‰ä¸»é¢˜</h2><p>æ‚¨è¿˜å¯ä»¥ä½¿ç”¨<mark class="hl-label blue">theme_update()</mark> è®¾ç½®å¿«é€Ÿæ›´æ”¹ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">theme_custom <span class="operator">&lt;-</span> theme_update<span class="punctuation">(</span>panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;gray60&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> guides<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/07/64f8b901903cf.png" style="width:600px;"/></div></div></p><p>åœ¨è¿›ä¸€æ­¥çš„ç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è‡ªå·±çš„ä¸»é¢˜ï¼Œä½¿ç”¨ç™½è‰²å¡«å……ï¼Œä¸ä½¿ç”¨å°ç½‘æ ¼çº¿ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">theme_custom <span class="operator">&lt;-</span> theme_update<span class="punctuation">(</span></span><br><span class="line">  panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  panel.grid.major <span class="operator">=</span> element_line<span class="punctuation">(</span>linewidth <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  panel.grid.minor <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">)</span></span><br></pre></td></tr></table></figure></p><h1 id="çº¿æ¡"><a href="#çº¿æ¡" class="headerlink" title="çº¿æ¡"></a>çº¿æ¡</h1><h2 id="æ·»åŠ æ°´å¹³æˆ–å‚ç›´çº¿"><a href="#æ·»åŠ æ°´å¹³æˆ–å‚ç›´çº¿" class="headerlink" title="æ·»åŠ æ°´å¹³æˆ–å‚ç›´çº¿"></a>æ·»åŠ æ°´å¹³æˆ–å‚ç›´çº¿</h2><p>æ‚¨å¯èƒ½å¸Œæœ›çªå‡ºæ˜¾ç¤ºç»™å®šçš„èŒƒå›´æˆ–é˜ˆå€¼ï¼Œè¿™å¯ä»¥ä½¿ç”¨<mark class="hl-label blue">geom_hline()</mark> ï¼ˆç”¨äº â€œæ°´å¹³çº¿â€ï¼‰æˆ– <mark class="hl-label blue">geom_vline()</mark> ï¼ˆç”¨äº â€œå‚ç›´çº¿â€ï¼‰åœ¨å®šä¹‰çš„åæ ‡ä¸Šç»˜åˆ¶ä¸€æ¡çº¿ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> o3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_hline<span class="punctuation">(</span>yintercept <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">73</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64f9f99a0b6df.png" style="width:600px;"/></div></div></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> temp<span class="punctuation">,</span> y <span class="operator">=</span> dewpoint<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;dodgerblue&quot;</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Dewpoint&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">g <span class="operator">+</span></span><br><span class="line">  geom_vline<span class="punctuation">(</span>aes<span class="punctuation">(</span>xintercept <span class="operator">=</span> median<span class="punctuation">(</span>temp<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">1.5</span><span class="punctuation">,</span></span><br><span class="line">             color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="string">&quot;dashed&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_hline<span class="punctuation">(</span>aes<span class="punctuation">(</span>yintercept <span class="operator">=</span> median<span class="punctuation">(</span>dewpoint<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">1.5</span><span class="punctuation">,</span></span><br><span class="line">             color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="string">&quot;dashed&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64f9f9f9cb3bc.png" style="width:600px;"/></div></div><p>å¦‚æœè¦æ·»åŠ æ–œç‡ä¸æ˜¯ 0 æˆ– 1 çš„ç›´çº¿ï¼Œåˆ™éœ€è¦ä½¿ç”¨<mark class="hl-label blue">geom_abline()</mark> ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¦ä½¿ç”¨æˆªè·å’Œæ–œç‡å‚æ•°æ·»åŠ å›å½’çº¿ï¼Œå°±éœ€è¦ä½¿ç”¨<mark class="hl-label blue">geom_abline()</mark> ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">reg <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>dewpoint <span class="operator">~</span> temp<span class="punctuation">,</span> data <span class="operator">=</span> chic<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">g <span class="operator">+</span></span><br><span class="line">  geom_abline<span class="punctuation">(</span>intercept <span class="operator">=</span> coefficients<span class="punctuation">(</span>reg<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">              slope <span class="operator">=</span> coefficients<span class="punctuation">(</span>reg<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">              color <span class="operator">=</span> <span class="string">&quot;darkorange2&quot;</span><span class="punctuation">,</span> </span><br><span class="line">              linewidth <span class="operator">=</span> <span class="number">1.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>title <span class="operator">=</span> paste<span class="punctuation">(</span><span class="string">&quot;y = &quot;</span><span class="punctuation">,</span> <span class="built_in">round</span><span class="punctuation">(</span>coefficients<span class="punctuation">(</span>reg<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                      <span class="string">&quot; * x + &quot;</span><span class="punctuation">,</span> <span class="built_in">round</span><span class="punctuation">(</span>coefficients<span class="punctuation">(</span>reg<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64f9fa124152e.png" style="width:60px;"/></div></div></p><p>ç¨åï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨<mark class="hl-label blue">stat_smooth(method=lm)</mark> å‘½ä»¤æ·»åŠ çº¿æ€§æ‹Ÿåˆã€‚ä¸è¿‡ï¼Œå¯èƒ½è¿˜æœ‰å…¶ä»–åŸå› éœ€è¦æ·»åŠ ä¸€æ¡å…·æœ‰ç»™å®šæ–œç‡çš„ç›´çº¿ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åšğŸ§œğŸ»â€â™‚ï¸ã€‚</p><h2 id="åœ¨å›¾ä¸­æ·»åŠ çº¿"><a href="#åœ¨å›¾ä¸­æ·»åŠ çº¿" class="headerlink" title="åœ¨å›¾ä¸­æ·»åŠ çº¿"></a>åœ¨å›¾ä¸­æ·»åŠ çº¿</h2><p>ä»¥å‰çš„æ–¹æ³•æ€»æ˜¯è¦†ç›–ç»˜å›¾é¢æ¿çš„æ•´ä¸ªèŒƒå›´ï¼Œä½†æœ‰æ—¶äººä»¬åªæƒ³çªå‡ºæ˜¾ç¤ºæŸä¸ªåŒºåŸŸæˆ–ä½¿ç”¨çº¿æ¡è¿›è¡Œæ³¨é‡Šã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<mark class="hl-label blue">geom_linerange()</mark> å°±èƒ½å¸®ä¸Šå¿™ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span></span><br><span class="line">  <span class="comment">## vertical line</span></span><br><span class="line">  geom_linerange<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">50</span><span class="punctuation">,</span> ymin <span class="operator">=</span> <span class="number">20</span><span class="punctuation">,</span> ymax <span class="operator">=</span> <span class="number">55</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                 color <span class="operator">=</span> <span class="string">&quot;steelblue&quot;</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  <span class="comment">## horizontal line</span></span><br><span class="line">  geom_linerange<span class="punctuation">(</span>aes<span class="punctuation">(</span>xmin <span class="operator">=</span> <span class="operator">-</span><span class="literal">Inf</span><span class="punctuation">,</span> xmax <span class="operator">=</span> <span class="number">25</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                 color <span class="operator">=</span> <span class="string">&quot;red&quot;</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64f9faa48a1a8.png" style="width:600px;"/></div></div></p><p>æˆ–è€…ä½¿ç”¨<mark class="hl-label blue">annotate(geom=segment)</mark> æ¥ç»˜åˆ¶æ–œç‡åœ¨ 0 å’Œ 1 ä¹‹é—´çš„ç›´çº¿ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span></span><br><span class="line">  annotate<span class="punctuation">(</span>geom <span class="operator">=</span> <span class="string">&quot;segment&quot;</span><span class="punctuation">,</span> </span><br><span class="line">           x <span class="operator">=</span> <span class="number">50</span><span class="punctuation">,</span> xend <span class="operator">=</span> <span class="number">75</span><span class="punctuation">,</span></span><br><span class="line">                   y <span class="operator">=</span> <span class="number">20</span><span class="punctuation">,</span> yend <span class="operator">=</span> <span class="number">45</span><span class="punctuation">,</span></span><br><span class="line">               color <span class="operator">=</span> <span class="string">&quot;purple&quot;</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64f9fb9613872.png" style="width:600px;"/></div></div></p><h2 id="åœ¨ç»˜å›¾ä¸­æ·»åŠ æ›²çº¿å’Œç®­å¤´"><a href="#åœ¨ç»˜å›¾ä¸­æ·»åŠ æ›²çº¿å’Œç®­å¤´" class="headerlink" title="åœ¨ç»˜å›¾ä¸­æ·»åŠ æ›²çº¿å’Œç®­å¤´"></a>åœ¨ç»˜å›¾ä¸­æ·»åŠ æ›²çº¿å’Œç®­å¤´</h2><mark class="hl-label blue">annotate(geom=curve)</mark> æ·»åŠ æ›²çº¿ã€‚å¦‚æœä½ å–œæ¬¢ï¼Œä¹Ÿå¯ä»¥æ·»åŠ ç›´çº¿ï¼š<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span></span><br><span class="line">  annotate<span class="punctuation">(</span>geom <span class="operator">=</span> <span class="string">&quot;curve&quot;</span><span class="punctuation">,</span>x <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">60</span><span class="punctuation">,</span> xend <span class="operator">=</span> <span class="number">75</span><span class="punctuation">,</span> yend <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">             color <span class="operator">=</span> <span class="string">&quot;tan&quot;</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  annotate<span class="punctuation">(</span>geom <span class="operator">=</span> <span class="string">&quot;curve&quot;</span><span class="punctuation">,</span> </span><br><span class="line">           x <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">60</span><span class="punctuation">,</span> xend <span class="operator">=</span> <span class="number">75</span><span class="punctuation">,</span> yend <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">             curvature <span class="operator">=</span> <span class="operator">-</span><span class="number">0.7</span><span class="punctuation">,</span> angle <span class="operator">=</span> <span class="number">45</span><span class="punctuation">,</span></span><br><span class="line">             color <span class="operator">=</span> <span class="string">&quot;darkgoldenrod1&quot;</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  annotate<span class="punctuation">(</span>geom <span class="operator">=</span> <span class="string">&quot;curve&quot;</span><span class="punctuation">,</span> x <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">60</span><span class="punctuation">,</span> xend <span class="operator">=</span> <span class="number">75</span><span class="punctuation">,</span> yend <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">             curvature <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">1.5</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64f9fd96af76b.png" style="width:600px;"/></div></div><p>åŒæ ·çš„å‡ ä½•å›¾å½¢ä¹Ÿå¯ä»¥ç”¨æ¥ç”»ç®­å¤´ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span></span><br><span class="line">  annotate<span class="punctuation">(</span>geom <span class="operator">=</span> <span class="string">&quot;curve&quot;</span><span class="punctuation">,</span> x <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">60</span><span class="punctuation">,</span> xend <span class="operator">=</span> <span class="number">75</span><span class="punctuation">,</span> yend <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">             color <span class="operator">=</span> <span class="string">&quot;tan&quot;</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> </span><br><span class="line">             arrow <span class="operator">=</span> arrow<span class="punctuation">(</span><span class="built_in">length</span> <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.07</span><span class="punctuation">,</span> <span class="string">&quot;npc&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  annotate<span class="punctuation">(</span>geom <span class="operator">=</span> <span class="string">&quot;curve&quot;</span><span class="punctuation">,</span> x <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">55</span><span class="punctuation">,</span> xend <span class="operator">=</span> <span class="number">70</span><span class="punctuation">,</span> yend <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span></span><br><span class="line">             curvature <span class="operator">=</span> <span class="operator">-</span><span class="number">0.7</span><span class="punctuation">,</span> angle <span class="operator">=</span> <span class="number">45</span><span class="punctuation">,</span></span><br><span class="line">             color <span class="operator">=</span> <span class="string">&quot;darkgoldenrod1&quot;</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">             arrow <span class="operator">=</span> arrow<span class="punctuation">(</span><span class="built_in">length</span> <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.03</span><span class="punctuation">,</span> <span class="string">&quot;npc&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                           type <span class="operator">=</span> <span class="string">&quot;closed&quot;</span><span class="punctuation">,</span></span><br><span class="line">                           ends <span class="operator">=</span> <span class="string">&quot;both&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64f9fe0990aac.png" style="width:600px;"/></div></div></p><h1 id="æ–‡æœ¬"><a href="#æ–‡æœ¬" class="headerlink" title="æ–‡æœ¬"></a>æ–‡æœ¬</h1><h2 id="ä¸ºæ•°æ®æ·»åŠ æ ‡ç­¾"><a href="#ä¸ºæ•°æ®æ·»åŠ æ ‡ç­¾" class="headerlink" title="ä¸ºæ•°æ®æ·»åŠ æ ‡ç­¾"></a>ä¸ºæ•°æ®æ·»åŠ æ ‡ç­¾</h2><p>æœ‰æ—¶ï¼Œæˆ‘ä»¬æƒ³ç»™æ•°æ®ç‚¹è´´æ ‡ç­¾ã€‚ä¸ºäº†é¿å…æ–‡æœ¬æ ‡ç­¾çš„å åŠ å’ŒæŒ¤å ï¼Œæˆ‘ä»¬ä½¿ç”¨åŸå§‹æ•°æ®çš„ 1% æ ·æœ¬ï¼Œå¹³å‡ä»£è¡¨å››ä¸ªå­£èŠ‚ã€‚æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨<mark class="hl-label blue">geom_label()</mark> ï¼Œå®ƒå¸¦æœ‰ä¸€ä¸ªåä¸º<mark class="hl-label blue">label</mark> çš„æ–°ç¾å­¦ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">set.seed<span class="punctuation">(</span><span class="number">2020</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">sample <span class="operator">&lt;-</span> chic <span class="operator">|&gt;</span></span><br><span class="line">  dplyr<span class="operator">::</span>group_by<span class="punctuation">(</span>season<span class="punctuation">)</span> <span class="operator">|&gt;</span></span><br><span class="line">  dplyr<span class="operator">::</span>sample_frac<span class="punctuation">(</span><span class="number">0.01</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## code without pipes:</span></span><br><span class="line"><span class="comment">## sample &lt;- sample_frac(group_by(chic, season), .01)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>sample<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_label<span class="punctuation">(</span>aes<span class="punctuation">(</span>label <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">,</span> vjust <span class="operator">=</span> <span class="operator">-</span><span class="number">.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  xlim<span class="punctuation">(</span>as.Date<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;1997-01-01&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;2000-12-31&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  ylim<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">90</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64f9ff95ced6f.png" style="width:600px;"/></div></div></p><p>å¥½å§ï¼Œé¿å…æ ‡ç­¾é‡å çš„æ–¹æ³•å¹¶ä¸å¥æ•ˆã€‚ä¸è¿‡åˆ«æ‹…å¿ƒï¼Œæˆ‘ä»¬é©¬ä¸Šå°±èƒ½è§£å†³ï¼</p><details class="folding-tag" green><summary> ğŸ’å¦‚æœä¸å–œæ¬¢æ ‡ç­¾å‘¨å›´çš„æ–¹æ¡†ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ geom_text()ã€‚å±•å¼€æŸ¥çœ‹ç¤ºä¾‹ã€‚ </summary>              <div class='content'>              <figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>sample<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_text<span class="punctuation">(</span>aes<span class="punctuation">(</span>label <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">,</span> fontface <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">,</span></span><br><span class="line">            hjust <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">,</span> vjust <span class="operator">=</span> <span class="operator">-</span><span class="number">.25</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  xlim<span class="punctuation">(</span>as.Date<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;1997-01-01&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;2000-12-31&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  ylim<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">90</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa00533e3bc.png" style="width:600px;"/></div></div>              </div>            </details><p>{ggrepel}è½¯ä»¶åŒ…ä¸º{ggplot2}æä¾›äº†ä¸€äº›å¾ˆæ£’çš„å®ç”¨å·¥å…·ï¼Œå¦‚ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œå®ƒä¸º{ggplot2}æä¾›äº†<mark class="hl-label blue">geom</mark> ï¼Œç”¨äºæ’æ–¥é‡å çš„æ–‡æœ¬ã€‚æˆ‘ä»¬åªéœ€å°†<mark class="hl-label blue">geom_text()</mark> æ›¿æ¢ä¸º<mark class="hl-label blue">geom_text_repel()</mark> ï¼Œå°†<mark class="hl-label blue">geom_label()</mark> æ›¿æ¢ä¸º<mark class="hl-label blue">geom_label_repel()</mark> å³å¯ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>ggrepel<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>sample<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_label_repel<span class="punctuation">(</span>aes<span class="punctuation">(</span>label <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">,</span> fontface <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa0159c8dec.png" style="width:600px;"/></div></div></p><p>å¡«å……åçš„æ–¹æ¡†å¯èƒ½çœ‹èµ·æ¥æ›´æ¼‚äº®ï¼Œå› æ­¤æˆ‘ä»¬å°†<mark class="hl-label blue">season</mark> æ˜ å°„ä¸º<mark class="hl-label blue">fill</mark> ï¼Œè€Œä¸æ˜¯<mark class="hl-label blue">color</mark> ï¼Œå¹¶ä¸ºæ–‡æœ¬è®¾ç½®ç™½è‰²ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>sample<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>data <span class="operator">=</span> chic<span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">1.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_label_repel<span class="punctuation">(</span>aes<span class="punctuation">(</span>label <span class="operator">=</span> season<span class="punctuation">,</span> fill <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                   color <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> fontface <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">,</span></span><br><span class="line">                   segment.color <span class="operator">=</span> <span class="string">&quot;grey30&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa024f6bc5c.png" style="width:600px;"/></div></div></p><p>é€šè¿‡ä½¿ç”¨<mark class="hl-label blue">geom_text_repel()</mark> ï¼Œè¿™ä¹Ÿé€‚ç”¨äºçº¯æ–‡æœ¬æ ‡ç­¾ã€‚è¯·æŸ¥çœ‹æ‰€æœ‰<a href="https://ggrepel.slowkow.com/articles/examples.html">ä½¿ç”¨ç¤ºä¾‹</a>ã€‚</p><h2 id="æ·»åŠ æ–‡æœ¬æ³¨é‡Š"><a href="#æ·»åŠ æ–‡æœ¬æ³¨é‡Š" class="headerlink" title="æ·»åŠ æ–‡æœ¬æ³¨é‡Š"></a>æ·»åŠ æ–‡æœ¬æ³¨é‡Š</h2><p>åœ¨ ggplot ä¸­æ·»åŠ æ³¨é‡Šæœ‰å¤šç§æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥å†æ¬¡ä½¿ç”¨<mark class="hl-label blue">annotate(geom=text)</mark> ã€<mark class="hl-label blue">annotate(geom=label)</mark> ã€<mark class="hl-label blue">geom_text()</mark> æˆ–<mark class="hl-label blue">geom_label()</mark> <br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">&lt;-</span></span><br><span class="line">  ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> temp<span class="punctuation">,</span> y <span class="operator">=</span> dewpoint<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>alpha <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Dewpoint&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">g <span class="operator">+</span> </span><br><span class="line">  annotate<span class="punctuation">(</span>geom <span class="operator">=</span> <span class="string">&quot;text&quot;</span><span class="punctuation">,</span> x <span class="operator">=</span> <span class="number">25</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">60</span><span class="punctuation">,</span> fontface <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">,</span> </span><br><span class="line">                label <span class="operator">=</span> <span class="string">&quot;This is a useful annotation&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa03797a923.png" style="width:600px;"/></div></div></p><p>ä½†æ˜¯ï¼Œç°åœ¨ ggplot ä¸ºæ¯ä¸ªæ•°æ®ç‚¹ç»˜åˆ¶äº†ä¸€ä¸ªæ–‡æœ¬æ ‡ç­¾â€”å³ 1,461 ä¸ªæ ‡ç­¾ï¼Œä½ åªèƒ½çœ‹åˆ°ä¸€ä¸ªï¼æ‚¨å¯ä»¥å°†<mark class="hl-label blue">stat</mark> å‚æ•°è®¾ç½®ä¸º<mark class="hl-label blue">unique</mark> æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span></span><br><span class="line">  geom_text<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">25</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">60</span><span class="punctuation">,</span></span><br><span class="line">                label <span class="operator">=</span> <span class="string">&quot;This is a useful annotation&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">            stat <span class="operator">=</span> <span class="string">&quot;unique&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa042aa9074.png" style="width:600px;"/></div></div></p><p>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ›´æ”¹æ˜¾ç¤ºæ–‡æœ¬çš„å±æ€§ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span></span><br><span class="line">  geom_text<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">25</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">60</span><span class="punctuation">,</span></span><br><span class="line">                label <span class="operator">=</span> <span class="string">&quot;This is a useful annotation&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">            stat <span class="operator">=</span> <span class="string">&quot;unique&quot;</span><span class="punctuation">,</span> family <span class="operator">=</span> <span class="string">&quot;Bangers&quot;</span><span class="punctuation">,</span></span><br><span class="line">            size <span class="operator">=</span> <span class="number">7</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;darkcyan&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa092518481.png" style="width:600px;"/></div></div></p><p>å¦‚æœæ‚¨ä½¿ç”¨å…¶ä¸­ä¸€ä¸ªé¢å‡½æ•°æ¥å¯è§†åŒ–æ•°æ®ï¼Œå¯èƒ½ä¼šé‡åˆ°éº»çƒ¦ã€‚é¦–å…ˆï¼Œæ‚¨å¯èƒ½åªæƒ³åŒ…å«ä¸€æ¬¡æ³¨é‡Šï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ann <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span></span><br><span class="line">  o3 <span class="operator">=</span> <span class="number">30</span><span class="punctuation">,</span></span><br><span class="line">  temp <span class="operator">=</span> <span class="number">20</span><span class="punctuation">,</span></span><br><span class="line">  season <span class="operator">=</span> factor<span class="punctuation">(</span><span class="string">&quot;Summer&quot;</span><span class="punctuation">,</span> levels <span class="operator">=</span> levels<span class="punctuation">(</span>chic<span class="operator">$</span>season<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  label <span class="operator">=</span> <span class="string">&quot;Here is enough space\nfor some annotations.&quot;</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">g <span class="operator">&lt;-</span></span><br><span class="line">  ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> o3<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Ozone&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">g <span class="operator">+</span></span><br><span class="line">  geom_text<span class="punctuation">(</span>data <span class="operator">=</span> ann<span class="punctuation">,</span> aes<span class="punctuation">(</span>label <span class="operator">=</span> label<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">            size <span class="operator">=</span> <span class="number">7</span><span class="punctuation">,</span> fontface <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">,</span></span><br><span class="line">            family <span class="operator">=</span> <span class="string">&quot;Roboto Condensed&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  facet_wrap<span class="punctuation">(</span><span class="operator">~</span>season<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa0ddec9d51.png" style="width:600px;"/></div></div></p><p>å¦ä¸€ä¸ªæŒ‘æˆ˜æ˜¯åˆ†é¢ä¸è‡ªç”±åˆ»åº¦çš„ç»“åˆï¼Œè¿™å¯èƒ½ä¼šå‰Šå‡ä½ çš„æ–‡å­—ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span></span><br><span class="line">  geom_text<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">23</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">97</span><span class="punctuation">,</span></span><br><span class="line">                label <span class="operator">=</span> <span class="string">&quot;This is not a useful annotation&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">            size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> fontface <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_y_continuous<span class="punctuation">(</span>limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="literal">NA</span><span class="punctuation">,</span> <span class="number">100</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  facet_wrap<span class="punctuation">(</span><span class="operator">~</span>season<span class="punctuation">,</span> scales <span class="operator">=</span> <span class="string">&quot;free_x&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa0eae47fd5.png" style="width:600px;"/></div></div></p><p>ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯äº‹å…ˆè®¡ç®—å‡ºåæ ‡è½´çš„ä¸­ç‚¹ï¼Œè¿™é‡Œæ˜¯<mark class="hl-label blue">x</mark> ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ann <span class="operator">&lt;-</span></span><br><span class="line">  chic <span class="operator">|&gt;</span></span><br><span class="line">  dplyr<span class="operator">::</span>group_by<span class="punctuation">(</span>season<span class="punctuation">)</span> <span class="operator">|&gt;</span></span><br><span class="line">  dplyr<span class="operator">::</span>summarize<span class="punctuation">(</span></span><br><span class="line">    o3 <span class="operator">=</span> <span class="built_in">min</span><span class="punctuation">(</span>o3<span class="punctuation">,</span> na.rm <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">          <span class="punctuation">(</span><span class="built_in">max</span><span class="punctuation">(</span>o3<span class="punctuation">,</span> na.rm <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> <span class="operator">-</span> <span class="built_in">min</span><span class="punctuation">(</span>o3<span class="punctuation">,</span> na.rm <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">/</span> <span class="number">2</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ann</span><br></pre></td></tr></table></figure><br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## # A tibble: 4 Ã— 2</span></span><br><span class="line"><span class="comment">##   season    o3</span></span><br><span class="line"><span class="comment">##   &lt;fct&gt;  &lt;dbl&gt;</span></span><br><span class="line"><span class="comment">## 1 Winter  21.5</span></span><br><span class="line"><span class="comment">## 2 Spring  31.0</span></span><br><span class="line"><span class="comment">## 3 Summer  29.2</span></span><br><span class="line"><span class="comment">## 4 Autumn  23.3</span></span><br></pre></td></tr></table></figure></p><p>â€¦â€¦å¹¶ä½¿ç”¨åˆè®¡æ•°æ®æŒ‡å®šæ³¨é‡Šçš„ä½ç½®ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span></span><br><span class="line">  geom_text<span class="punctuation">(</span>data <span class="operator">=</span> ann<span class="punctuation">,</span></span><br><span class="line">            aes<span class="punctuation">(</span>x <span class="operator">=</span> o3<span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">97</span><span class="punctuation">,</span></span><br><span class="line">                label <span class="operator">=</span> <span class="string">&quot;This is a useful annotation&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">            size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> fontface <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_y_continuous<span class="punctuation">(</span>limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="literal">NA</span><span class="punctuation">,</span> <span class="number">100</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  facet_wrap<span class="punctuation">(</span><span class="operator">~</span>season<span class="punctuation">,</span> scales <span class="operator">=</span> <span class="string">&quot;free_x&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa10f4abace.png" style="width:600px;"/></div></div></p><p>ä¸è¿‡ï¼Œè¿˜æœ‰ä¸€ç§æ›´ç®€å•çš„æ–¹æ³•ï¼ˆåœ¨å›ºå®šåæ ‡æ–¹é¢ï¼‰â€”ä½†ä¹Ÿéœ€è¦èŠ±äº›æ—¶é—´ç†Ÿè®°ä»£ç ã€‚{grid}è½¯ä»¶åŒ…ä¸{ggplot2}çš„<mark class="hl-label blue">annotation_custom()</mark> ç»“åˆä½¿ç”¨ï¼Œå¯ä»¥æ ¹æ®æ¯”ä¾‹åæ ‡æŒ‡å®šä½ç½®ï¼Œå…¶ä¸­ 0 ä»£è¡¨ä½ï¼Œ1 ä»£è¡¨é«˜ã€‚<mark class="hl-label blue">grobTree()</mark> åˆ›å»ºç½‘æ ¼å›¾å½¢å¯¹è±¡ï¼Œ<mark class="hl-label blue">textGrob</mark> åˆ›å»ºæ–‡æœ¬å›¾å½¢å¯¹è±¡ã€‚å½“æ‚¨æœ‰å¤šä¸ªä¸åŒæ¯”ä¾‹çš„ç»˜å›¾æ—¶ï¼Œè¿™ç§æ–¹æ³•çš„ä»·å€¼å°¤ä¸ºæ˜æ˜¾ã€‚<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>grid<span class="punctuation">)</span></span><br><span class="line">my_grob <span class="operator">&lt;-</span> grobTree<span class="punctuation">(</span>textGrob<span class="punctuation">(</span><span class="string">&quot;This text stays in place!&quot;</span><span class="punctuation">,</span></span><br><span class="line">                             x <span class="operator">=</span> <span class="number">.1</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">.9</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">                             gp <span class="operator">=</span> gpar<span class="punctuation">(</span>col <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                       fontsize <span class="operator">=</span> <span class="number">15</span><span class="punctuation">,</span></span><br><span class="line">                                       fontface <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">g <span class="operator">+</span></span><br><span class="line">  annotation_custom<span class="punctuation">(</span>my_grob<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  facet_wrap<span class="punctuation">(</span><span class="operator">~</span>season<span class="punctuation">,</span> scales <span class="operator">=</span> <span class="string">&quot;free_x&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_y_continuous<span class="punctuation">(</span>limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="literal">NA</span><span class="punctuation">,</span> <span class="number">100</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa11fe23f65.png" style="width:600px;"/></div></div></p><h2 id="ä½¿ç”¨-Markdown-å’Œ-HTML-æ¸²æŸ“æ³¨é‡Š"><a href="#ä½¿ç”¨-Markdown-å’Œ-HTML-æ¸²æŸ“æ³¨é‡Š" class="headerlink" title="ä½¿ç”¨ Markdown å’Œ HTML æ¸²æŸ“æ³¨é‡Š"></a>ä½¿ç”¨ Markdown å’Œ HTML æ¸²æŸ“æ³¨é‡Š</h2><p>æˆ‘ä»¬å†æ¬¡ä½¿ç”¨ Claus Wilke çš„ {ggtext} è½¯ä»¶åŒ…ï¼Œè¯¥è½¯ä»¶åŒ…æ—¨åœ¨æ”¹è¿› {ggplot2} çš„æ–‡æœ¬æ¸²æŸ“æ”¯æŒã€‚<a href="https://wilkelab.org/ggtext/">{ggtext}</a>è½¯ä»¶åŒ…å®šä¹‰äº†ä¸¤ä¸ªæ–°çš„ä¸»é¢˜å…ƒç´ ï¼š<mark class="hl-label blue">element_markdown()</mark> å’Œ <mark class="hl-label blue">element_textbox()</mark> ã€‚<mark class="hl-label blue">geom_richtext()</mark> å¯æ›¿ä»£<mark class="hl-label blue">geom_text()</mark> å’Œ<mark class="hl-label blue">geom_label()</mark> ï¼Œå¹¶å°†æ–‡æœ¬æ¸²æŸ“ä¸ºæ ‡è®°ç¬¦â€¦</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>ggtext<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">lab_md <span class="operator">&lt;-</span> <span class="string">&quot;This plot shows **temperature** in *Â°F* versus **ozone level** in *ppm*&quot;</span></span><br><span class="line"></span><br><span class="line">g <span class="operator">+</span></span><br><span class="line">  geom_richtext<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">35</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span> label <span class="operator">=</span> lab_md<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                stat <span class="operator">=</span> <span class="string">&quot;unique&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa13b18204d.png" style="width:600px;"/></div></div><p>â€¦ æˆ– htmlï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">lab_html <span class="operator">&lt;-</span> <span class="string">&quot;&amp;#9733; This plot shows &lt;b style=&#x27;color:red;&#x27;&gt;temperature&lt;/b&gt; in &lt;i&gt;Â°F&lt;/i&gt; versus &lt;b style=&#x27;color:blue;&#x27;&gt;ozone level&lt;/b&gt;in &lt;i&gt;ppm&lt;/i&gt; &amp;#9733;&quot;</span></span><br><span class="line"></span><br><span class="line">g <span class="operator">+</span></span><br><span class="line">  geom_richtext<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">33</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span> label <span class="operator">=</span> lab_html<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                stat <span class="operator">=</span> <span class="string">&quot;unique&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa142f0f217.png" style="width:600px;"/></div></div></p><p>geom é™„å¸¦äº†è®¸å¤šå¯ä»¥ä¿®æ”¹çš„ç»†èŠ‚ï¼Œä¾‹å¦‚è§’åº¦ï¼ˆé»˜è®¤çš„<mark class="hl-label blue">geom_text()</mark> å’Œ<mark class="hl-label blue">geom_label()</mark> æ— æ³•ä¿®æ”¹ï¼‰ã€æ–¹æ¡†å±æ€§å’Œæ–‡æœ¬å±æ€§ã€‚<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span></span><br><span class="line">  geom_richtext<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">25</span><span class="punctuation">,</span> label <span class="operator">=</span> lab_md<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                stat <span class="operator">=</span> <span class="string">&quot;unique&quot;</span><span class="punctuation">,</span> angle <span class="operator">=</span> <span class="number">30</span><span class="punctuation">,</span></span><br><span class="line">                color <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&quot;steelblue&quot;</span><span class="punctuation">,</span></span><br><span class="line">                label.color <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> vjust <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">                family <span class="operator">=</span> <span class="string">&quot;Playfair Display&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa151ed7482.png" style="width:600px;"/></div></div></p><p>æ¥è‡ª {ggtext} è½¯ä»¶åŒ…çš„å¦ä¸€ä¸ª geom æ˜¯<mark class="hl-label blue">geom_textbox()</mark> ã€‚è¯¥ geom å…è®¸å¯¹å­—ç¬¦ä¸²è¿›è¡ŒåŠ¨æ€åŒ…è£…ï¼Œè¿™å¯¹ä¿¡æ¯æ¡†å’Œå­—å¹•ç­‰è¾ƒé•¿çš„æ³¨é‡Šéå¸¸æœ‰ç”¨ã€‚<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">lab_long <span class="operator">&lt;-</span> <span class="string">&quot;**Lorem ipsum dolor**&lt;br&gt;&lt;i style=&#x27;font-size:8pt;color:red;&#x27;&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.&lt;br&gt;Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.&lt;/i&gt;&quot;</span></span><br><span class="line"></span><br><span class="line">g <span class="operator">+</span></span><br><span class="line">  geom_textbox<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">40</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> label <span class="operator">=</span> lab_long<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">               width <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">15</span><span class="punctuation">,</span> <span class="string">&quot;lines&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> stat <span class="operator">=</span> <span class="string">&quot;unique&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa1697f2fcb.png" style="width:600px;"/></div></div><br>è¯·æ³¨æ„ï¼Œæ—¢ä¸èƒ½æ—‹è½¬æ–‡æœ¬æ¡†ï¼ˆå§‹ç»ˆæ°´å¹³ï¼‰ï¼Œä¹Ÿä¸èƒ½æ›´æ”¹æ–‡æœ¬çš„å¯¹é½æ–¹å¼ï¼ˆå§‹ç»ˆå·¦å¯¹é½ï¼‰ã€‚</p><h1 id="åæ ‡ç³»"><a href="#åæ ‡ç³»" class="headerlink" title="åæ ‡ç³»"></a>åæ ‡ç³»</h1><h2 id="ç¿»è½¬å›¾ç‰‡"><a href="#ç¿»è½¬å›¾ç‰‡" class="headerlink" title="ç¿»è½¬å›¾ç‰‡"></a>ç¿»è½¬å›¾ç‰‡</h2><p>ç¿»è½¬å›¾ç‰‡éå¸¸å®¹æ˜“ã€‚æˆ‘åœ¨è¿™é‡Œæ·»åŠ äº† coord_flip()ï¼Œè¿™å°±æ˜¯ç¿»è½¬ç»˜å›¾æ‰€éœ€çš„å…¨éƒ¨åŠŸèƒ½ã€‚è¿™åœ¨ä½¿ç”¨å‡ ä½•å›¾å½¢è¡¨ç¤ºåˆ†ç±»æ•°æ®ï¼ˆä¾‹å¦‚æ¡å½¢å›¾æˆ–ä¸‹é¢ç¤ºä¾‹ä¸­çš„æ–¹æ¡†å›¾å’Œèƒ¡é¡»å›¾ï¼‰æ—¶æœ€æœ‰æ„ä¹‰ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> season<span class="punctuation">,</span> y <span class="operator">=</span> o3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_boxplot<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;indianred&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Season&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Ozone&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  coord_flip<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa17b339542.png" style="width:600px;"/></div></div></p><details class="folding-tag" green><summary> ğŸ’è‡ª{ggplot2}3.0.0ç‰ˆèµ·ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å‚æ•°orientation = yæ°´å¹³ç»˜åˆ¶å‡ ä½•å›¾å½¢ã€‚å±•å¼€æŸ¥çœ‹ç¤ºä¾‹ã€‚ </summary>              <div class='content'>              <figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> o3<span class="punctuation">,</span> y <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_boxplot<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;indianred&quot;</span><span class="punctuation">,</span> orientation <span class="operator">=</span> <span class="string">&quot;y&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Ozone&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Season&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa17b339542.png" style="width:600px;"/></div></div>              </div>            </details><h2 id="å›ºå®šè½´"><a href="#å›ºå®šè½´" class="headerlink" title="å›ºå®šè½´"></a>å›ºå®šè½´</h2><p>æˆ‘ä»¬å¯ä»¥å›ºå®šç¬›å¡å°”åæ ‡ç³»çš„çºµæ¨ªæ¯”ï¼Œå¹¶å¼ºåˆ¶æ²¿ x è½´å’Œ y è½´å¯¹å•ä½è¿›è¡Œç‰©ç†è¡¨ç¤ºï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> temp<span class="punctuation">,</span> y <span class="operator">=</span> o3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Ozone Level&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_x_continuous<span class="punctuation">(</span>breaks <span class="operator">=</span> seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">80</span><span class="punctuation">,</span> by <span class="operator">=</span> <span class="number">20</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  coord_fixed<span class="punctuation">(</span>ratio <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa192807040.png" style="width:600px;"/></div></div></p><p>è¿™æ ·ä¸ä»…å¯ä»¥ç¡®ä¿åæ ‡è½´ä¸Šçš„å›ºå®šæ­¥é•¿ï¼Œè¿˜å¯ä»¥ç¡®ä¿å¯¼å‡ºçš„ç»˜å›¾çœ‹èµ·æ¥ç¬¦åˆé¢„æœŸã€‚ä¸è¿‡ï¼Œå¦‚æœæ‚¨æ²¡æœ‰ä½¿ç”¨åˆé€‚çš„çºµæ¨ªæ¯”ï¼Œæ‚¨ä¿å­˜çš„ç»˜å›¾å¯èƒ½ä¼šåŒ…å«å¤§é‡ç©ºç™½ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> temp<span class="punctuation">,</span> y <span class="operator">=</span> o3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Ozone Level&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_x_continuous<span class="punctuation">(</span>breaks <span class="operator">=</span> seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">80</span><span class="punctuation">,</span> by <span class="operator">=</span> <span class="number">20</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  coord_fixed<span class="punctuation">(</span>ratio <span class="operator">=</span> <span class="number">1</span><span class="operator">/</span><span class="number">3</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>plot.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;grey80&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa199027c42.png" style="width:600px;"/></div></div></p><h2 id="é€†è½¬è½´"><a href="#é€†è½¬è½´" class="headerlink" title="é€†è½¬è½´"></a>é€†è½¬è½´</h2><p>æ‚¨è¿˜å¯ä»¥åˆ†åˆ«ä½¿ç”¨<mark class="hl-label blue">scale_x_reverse()</mark> æˆ–<mark class="hl-label blue">scale_y_reverse()</mark> è½»æ¾åœ°åè½¬åæ ‡è½´ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> o3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_y_reverse<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa1a54454c6.png" style="width:600px;"/></div></div></p><details class="folding-tag" green><summary> ğŸ’è¯·æ³¨æ„ï¼Œè¿™åªé€‚ç”¨äºè¿ç»­æ•°æ®ã€‚å¦‚æœè¦åè½¬åˆ†ç±»æ•°æ®ï¼Œè¯·ä½¿ç”¨forcatsè½¯ä»¶åŒ…ä¸­çš„fct_rev()å‡½æ•°ã€‚å±•å¼€æŸ¥çœ‹ç¤ºä¾‹ã€‚} <figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## the default</span></span><br><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> temp<span class="punctuation">,</span> y <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_jitter<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">,</span> show.legend <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure> {% image https://bu.dusays.com/2023/09/08/64fa1b511e951.png </summary>              <div class='content'>              <figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>forcats<span class="punctuation">)</span></span><br><span class="line">set.seed<span class="punctuation">(</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> temp<span class="punctuation">,</span> y <span class="operator">=</span> fct_rev<span class="punctuation">(</span>season<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_jitter<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">,</span> show.legend <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa1ba2a9f9e.png" style="width:600px;"/></div></div>              </div>            </details><h2 id="è½¬æ¢è½´çº¿"><a href="#è½¬æ¢è½´çº¿" class="headerlink" title="è½¬æ¢è½´çº¿"></a>è½¬æ¢è½´çº¿</h2><p>â€¦ æˆ–è€…ä½¿ç”¨<mark class="hl-label blue">scale_y_log10()</mark> æˆ–<mark class="hl-label blue">scale_y_sqrt()</mark> è½¬æ¢é»˜è®¤çº¿æ€§æ˜ å°„ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ª log10 è½¬æ¢è½´çš„ç¤ºä¾‹ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ä¼šå¼•å…¥ NAï¼Œå› æ­¤è¦å°å¿ƒï¼‰ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> o3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_y_log10<span class="punctuation">(</span>lim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.1</span><span class="punctuation">,</span> <span class="number">100</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa1cca1a066.png" style="width:600px;"/></div></div></p><h2 id="å°†å›¾ç‰‡ç¯åŒ–"><a href="#å°†å›¾ç‰‡ç¯åŒ–" class="headerlink" title="å°†å›¾ç‰‡ç¯åŒ–"></a>å°†å›¾ç‰‡ç¯åŒ–</h2><p>æ­¤å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡è°ƒç”¨<mark class="hl-label blue">coord_polar()</mark> å¯¹åæ ‡ç³»è¿›è¡Œåœ†åŒ–ï¼ˆæåŒ–ï¼Ÿï¼‰<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">chic <span class="operator">|&gt;</span></span><br><span class="line">  dplyr<span class="operator">::</span>group_by<span class="punctuation">(</span>season<span class="punctuation">)</span> <span class="operator">|&gt;</span></span><br><span class="line">  dplyr<span class="operator">::</span>summarize<span class="punctuation">(</span>o3 <span class="operator">=</span> median<span class="punctuation">(</span>o3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">|&gt;</span></span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> season<span class="punctuation">,</span> y <span class="operator">=</span> o3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    geom_col<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Median Ozone Level&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    coord_polar<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    guides<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa1dbd6724d.png" style="width:600px;"/></div></div></p><p>è¿™ç§åæ ‡ç³»è¿˜å¯ä»¥ç»˜åˆ¶é¥¼å›¾ï¼š</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">chic_sum <span class="operator">&lt;-</span></span><br><span class="line">  chic <span class="operator">|&gt;</span></span><br><span class="line">  dplyr<span class="operator">::</span>mutate<span class="punctuation">(</span>o3_avg <span class="operator">=</span> median<span class="punctuation">(</span>o3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">|&gt;</span></span><br><span class="line">  dplyr<span class="operator">::</span>filter<span class="punctuation">(</span>o3 <span class="operator">&gt;</span> o3_avg<span class="punctuation">)</span> <span class="operator">|&gt;</span></span><br><span class="line">  dplyr<span class="operator">::</span>mutate<span class="punctuation">(</span>n_all <span class="operator">=</span> n<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">|&gt;</span></span><br><span class="line">  dplyr<span class="operator">::</span>group_by<span class="punctuation">(</span>season<span class="punctuation">)</span> <span class="operator">|&gt;</span></span><br><span class="line">  dplyr<span class="operator">::</span>summarize<span class="punctuation">(</span>rel <span class="operator">=</span> n<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">/</span> unique<span class="punctuation">(</span>n_all<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>chic_sum<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> rel<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_col<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Proportion of Days Exceeding\nthe Median Ozone Level&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  coord_polar<span class="punctuation">(</span>theta <span class="operator">=</span> <span class="string">&quot;y&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_brewer<span class="punctuation">(</span>palette <span class="operator">=</span> <span class="string">&quot;Set1&quot;</span><span class="punctuation">,</span> name <span class="operator">=</span> <span class="string">&quot;Season:&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.ticks <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa1e2783ace.png" style="width:600px;"/></div></div><p>æˆ‘å»ºè®®åœ¨ç¬›å¡å°”åæ ‡ç³»ï¼ˆé»˜è®¤åæ ‡ç³»ï¼‰ä¸‹ä¹ŸæŸ¥çœ‹ç›¸åŒä»£ç çš„ç»“æœï¼Œä»¥äº†è§£<mark class="hl-label blue">coord_polar()</mark> å’Œ<mark class="hl-label blue">theta</mark> èƒŒåçš„é€»è¾‘ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic_sum<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> rel<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_col<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Proportion of Days Exceeding\nthe Median Ozone Level&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  <span class="comment">#coord_polar(theta = &quot;y&quot;) +</span></span><br><span class="line">  scale_fill_brewer<span class="punctuation">(</span>palette <span class="operator">=</span> <span class="string">&quot;Set1&quot;</span><span class="punctuation">,</span> name <span class="operator">=</span> <span class="string">&quot;Season:&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.ticks <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa1eb57bc78.png" style="width:600px;"/></div></div></p><h1 id="å›¾è¡¨ç±»å‹"><a href="#å›¾è¡¨ç±»å‹" class="headerlink" title="å›¾è¡¨ç±»å‹"></a>å›¾è¡¨ç±»å‹</h1><h2 id="ç®±æ€§å›¾çš„æ›¿ä»£æ–¹æ¡ˆ"><a href="#ç®±æ€§å›¾çš„æ›¿ä»£æ–¹æ¡ˆ" class="headerlink" title="ç®±æ€§å›¾çš„æ›¿ä»£æ–¹æ¡ˆ"></a>ç®±æ€§å›¾çš„æ›¿ä»£æ–¹æ¡ˆ</h2><p>æ–¹æ¡†å›¾å¾ˆæ£’ï¼Œä½†ä¹Ÿå¯èƒ½éå¸¸æ— èŠã€‚å¦å¤–ï¼Œå³ä½¿æ‚¨ä¹ æƒ¯äºç®±å½¢å›¾ï¼Œä¹Ÿè¦è®°ä½ï¼Œå¯èƒ½æœ‰å¾ˆå¤šäººåœ¨çœ‹æ‚¨çš„å›¾æ—¶ä»æœªè§è¿‡ç®±å½¢å›¾å’Œé¡»çŠ¶å›¾ã€‚</p><details class="folding-tag" green><summary> ğŸ’å±•å¼€ï¼Œç®€è¦å›é¡¾ç®±å½¢å›¾å’Œé¡»çº¿å›¾ã€‚ </summary>              <div class='content'>              <p>ç®±-é¡»å›¾ï¼ˆæœ‰æ—¶ç®€ç§°ç®±å›¾ï¼‰æ˜¯ä¸€ç§ç±»ä¼¼ç›´æ–¹å›¾çš„æ•°æ®æ˜¾ç¤ºæ–¹æ³•ï¼Œç”± J. Tukey å‘æ˜ã€‚ä¸­é—´ç²—çº¿è¡¨ç¤ºä¸­ä½æ•°ï¼Œä¹Ÿç§°ä¸ºå››åˆ†ä½æ•° Q2ã€‚æ–¹æ¡†çš„ç•Œé™ç”±ä¸‹å››åˆ†ä½æ•° Q1 å’Œä¸Šå››åˆ†ä½æ•° Q3 å†³å®šã€‚å› æ­¤ï¼Œæ–¹æ¡†åŒ…å« 50%çš„æ•°æ®ï¼Œç§°ä¸º â€œå››åˆ†ä½æ•°é—´è·â€ï¼ˆIQRï¼‰ã€‚æ™¶é¡»çš„é•¿åº¦ç”±ä¸è¢«è§†ä¸ºå¼‚å¸¸å€¼çš„æœ€æç«¯å€¼ï¼ˆå³å››åˆ†ä½æ•°é—´è·çš„ 3/2 å€ä»¥å†…çš„å€¼ï¼‰å†³å®šã€‚</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa20ed91d6a.png" style="width:600px;"/></div></div>              </div>            </details><p>è¿˜æœ‰å…¶ä»–æ–¹æ³•ï¼Œä½†é¦–å…ˆæˆ‘ä»¬è¦ç»˜åˆ¶ä¸€ä¸ªæ™®é€šçš„ç®±å½¢å›¾ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">&lt;-</span></span><br><span class="line">  ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> season<span class="punctuation">,</span> y <span class="operator">=</span> o3<span class="punctuation">,</span></span><br><span class="line">                   color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Season&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Ozone&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    scale_color_brewer<span class="punctuation">(</span>palette <span class="operator">=</span> <span class="string">&quot;Dark2&quot;</span><span class="punctuation">,</span> guide <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">g <span class="operator">+</span> geom_boxplot<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa2191d76a5.png" style="width:600px;"/></div></div></p><ol><li>æ›¿ä»£æ–¹æ¡ˆï¼šç‚¹é˜µå›¾<br>è®©æˆ‘ä»¬åªç»˜åˆ¶åŸå§‹æ•°æ®ä¸­çš„æ¯ä¸ªæ•°æ®ç‚¹ï¼š<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span> geom_point<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa223d9dc6a.png" style="width:600px;"/></div></div></li></ol><p>ä¸ä»…ä¹å‘³ï¼Œè€Œä¸”æ²¡æœ‰ä¿¡æ¯é‡ã€‚ä¸ºäº†æ”¹å–„æƒ…èŠ‚ï¼Œå¯ä»¥å¢åŠ é€æ˜åº¦ï¼Œä»¥è§£å†³æƒ…èŠ‚è¿‡å¤šçš„é—®é¢˜ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span> geom_point<span class="punctuation">(</span>alpha <span class="operator">=</span> <span class="number">.1</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/08/64fa22e14a284.png" style="width:600px;"/></div></div></p><p>ç„¶è€Œï¼Œåœ¨è¿™é‡Œè®¾ç½®é€æ˜åº¦æ˜¯å¾ˆå›°éš¾çš„ï¼Œå› ä¸ºè¦ä¹ˆé‡å åº¦å¤ªé«˜ï¼Œè¦ä¹ˆæå€¼ä¸æ˜æ˜¾ã€‚å¾ˆç³Ÿç³•ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬è¯•è¯•å…¶ä»–æ–¹æ³•ã€‚</p><ol><li>æ›¿ä»£æ–¹æ¡ˆï¼šæŠ–åŠ¨ç‚¹å›¾<br>å°è¯•ç»™æ•°æ®æ·»åŠ ä¸€ç‚¹æŠ–åŠ¨ã€‚æˆ‘å–œæ¬¢åœ¨å†…éƒ¨å¯è§†åŒ–ä¸­ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œä½†è¦å°å¿ƒä½¿ç”¨æŠ–åŠ¨ï¼Œå› ä¸ºä½ æ˜¯åœ¨æ•…æ„ç»™æ•°æ®æ·»åŠ å™ªéŸ³ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´å¯¹æ•°æ®çš„è¯¯è¯»ã€‚<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span> geom_jitter<span class="punctuation">(</span>width <span class="operator">=</span> <span class="number">.3</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb48813f99e.png" style="width:600px;"/></div></div></li></ol><ol><li><p>æ›¿ä»£æ–¹æ¡ˆï¼šå°æç´å›¾<br>å°æç´å›¾ï¼ˆViolin plotsï¼‰ä¸ç®±å½¢å›¾ç±»ä¼¼ï¼Œåªæ˜¯ä½¿ç”¨æ ¸å¯†åº¦æ¥æ˜¾ç¤ºæ•°æ®æœ€å¤šçš„åœ°æ–¹ï¼Œæ˜¯ä¸€ç§æœ‰ç”¨çš„å¯è§†åŒ–æ–¹æ³•ã€‚</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span> geom_violin<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;gray80&quot;</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb49509f7ec.png" style="width:600px;"/></div></div></li><li><p>æ›¿ä»£æ–¹æ¡ˆ å°†å°æç´å›¾ä¸æŠ–åŠ¨ç›¸ç»“åˆ<br>å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¼°è®¡å¯†åº¦å’ŒåŸå§‹æ•°æ®ç‚¹ä¸¤è€…ç»“åˆèµ·æ¥ï¼š</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span> geom_violin<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;gray80&quot;</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    geom_jitter<span class="punctuation">(</span>alpha <span class="operator">=</span> <span class="number">.25</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">.3</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    coord_flip<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb49d8531b2.png" style="width:600px;"/></div></div></li></ol><p><a href="https://ggforce.data-imaginist.com/">{ggforce}</a>è½¯ä»¶åŒ…æä¾›äº†æ‰€è°“çš„ sina å‡½æ•°ï¼ŒæŠ–åŠ¨çš„å®½åº¦ç”±æ•°æ®çš„å¯†åº¦åˆ†å¸ƒæ§åˆ¶ï¼Œè¿™ä½¿å¾—æŠ–åŠ¨åœ¨è§†è§‰ä¸Šæ›´æœ‰å¸å¼•åŠ›ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>ggforce<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">g <span class="operator">+</span> geom_violin<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;gray80&quot;</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    geom_sina<span class="punctuation">(</span>alpha <span class="operator">=</span> <span class="number">.25</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    coord_flip<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb4a8653683.png" style="width:600px;"/></div></div></p><ol><li>æ›¿ä»£æ–¹æ¡ˆ å°†å°æç´å›¾ä¸æ–¹æ¡†å›¾ç›¸ç»“åˆ<br>ä¸ºäº†ä¾¿äºä¼°ç®—é‡åŒ–å€¼ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åœ¨æ–¹æ¡†å›¾çš„å°æç´å†…éƒ¨æ·»åŠ æ–¹æ¡†ï¼Œä»¥è¡¨ç¤º 25% å››åˆ†ä½æ•°ã€ä¸­ä½æ•°å’Œ 75% å››åˆ†ä½æ•°ï¼š<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span> geom_violin<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    geom_boxplot<span class="punctuation">(</span>outlier.alpha <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> coef <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">                 color <span class="operator">=</span> <span class="string">&quot;gray40&quot;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">.2</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    scale_fill_brewer<span class="punctuation">(</span>palette <span class="operator">=</span> <span class="string">&quot;Dark2&quot;</span><span class="punctuation">,</span> guide <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    coord_flip<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb4b3d9d493.png" style="width:600px;"/></div></div></li></ol><h2 id="ä¸ºç»˜å›¾åˆ›å»º-Rug-è¡¨ç¤ºæ³•"><a href="#ä¸ºç»˜å›¾åˆ›å»º-Rug-è¡¨ç¤ºæ³•" class="headerlink" title="ä¸ºç»˜å›¾åˆ›å»º Rug è¡¨ç¤ºæ³•"></a>ä¸ºç»˜å›¾åˆ›å»º Rug è¡¨ç¤ºæ³•</h2><p>è½´é¡»å›¾è¡¨ç¤ºå•ä¸ªå®šé‡å˜é‡çš„æ•°æ®ï¼Œä»¥æ²¿åæ ‡è½´çš„æ ‡è®°å½¢å¼æ˜¾ç¤ºã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œé™¤æ•£ç‚¹å›¾æˆ–çƒ­å›¾ä¹‹å¤–ï¼Œå®ƒè¿˜ç”¨äºç›´è§‚æ˜¾ç¤ºä¸€ä¸ªæˆ–ä¸¤ä¸ªå˜é‡çš„æ€»ä½“åˆ†å¸ƒæƒ…å†µï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span></span><br><span class="line">                 color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>show.legend <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_rug<span class="punctuation">(</span>show.legend <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb4c4f3a00e.png" style="width:600px;"/></div></div></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>show.legend <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_rug<span class="punctuation">(</span>sides <span class="operator">=</span> <span class="string">&quot;r&quot;</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">.3</span><span class="punctuation">,</span> show.legend <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb4cc463987.png" style="width:600px;"/></div></div><h2 id="åˆ›å»ºç›¸å…³æ€§çŸ©é˜µ"><a href="#åˆ›å»ºç›¸å…³æ€§çŸ©é˜µ" class="headerlink" title="åˆ›å»ºç›¸å…³æ€§çŸ©é˜µ"></a>åˆ›å»ºç›¸å…³æ€§çŸ©é˜µ</h2><p>æœ‰å‡ ä¸ªè½¯ä»¶åŒ…å¯ä»¥åˆ›å»ºç›¸å…³çŸ©é˜µå›¾ï¼Œå…¶ä¸­ä¸€äº›è¿˜ä½¿ç”¨äº†{ggplot2}åŸºç¡€æ¶æ„ï¼Œä»è€Œè¿”å› ggplotsã€‚ä¸‹é¢æˆ‘å°†å‘å¤§å®¶å±•ç¤ºå¦‚ä½•åœ¨ä¸ä½¿ç”¨æ‰©å±•è½¯ä»¶åŒ…çš„æƒ…å†µä¸‹åˆ›å»ºç›¸å…³çŸ©é˜µå›¾ã€‚</p><p>ç¬¬ä¸€æ­¥æ˜¯åˆ›å»ºç›¸å…³çŸ©é˜µã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ {corrr} è½¯ä»¶åŒ…ï¼Œå®ƒå¯ä»¥å¾ˆå¥½åœ°ä¸ç®¡é“é…åˆä½¿ç”¨ï¼Œä½†ä¹Ÿæœ‰å¾ˆå¤šå…¶ä»–è½¯ä»¶ã€‚æˆ‘ä»¬ä½¿ç”¨çš®å°”é€Šç›¸å…³çŸ©é˜µï¼Œå› ä¸ºæ‰€æœ‰å˜é‡çš„åˆ†å¸ƒéƒ½æ¯”è¾ƒæ­£æ€ï¼ˆå¦‚æœå˜é‡çš„åˆ†å¸ƒæ¨¡å¼ä¸åŒï¼Œä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨æ–¯çš®å°”æ›¼ç›¸å…³çŸ©é˜µï¼‰ã€‚è¯·æ³¨æ„ï¼Œç”±äºç›¸å…³çŸ©é˜µæœ‰å†—ä½™ä¿¡æ¯ï¼Œå› æ­¤æˆ‘ä»¬å°†å…¶ä¸­ä¸€åŠè®¾ç½®ä¸º<mark class="hl-label blue">NA</mark> ã€‚<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">corm <span class="operator">&lt;-</span></span><br><span class="line">  chic <span class="operator">|&gt;</span></span><br><span class="line">  dplyr<span class="operator">::</span>select<span class="punctuation">(</span>temp<span class="punctuation">,</span> dewpoint<span class="punctuation">,</span> pm10<span class="punctuation">,</span> o3<span class="punctuation">)</span> <span class="operator">|&gt;</span></span><br><span class="line">  corrr<span class="operator">::</span>correlate<span class="punctuation">(</span>diagonal <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">|&gt;</span></span><br><span class="line">  corrr<span class="operator">::</span>shave<span class="punctuation">(</span>upper <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">corm</span><br></pre></td></tr></table></figure><br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## # A tibble: 4 Ã— 5</span></span><br><span class="line"><span class="comment">##   term      temp dewpoint   pm10    o3</span></span><br><span class="line"><span class="comment">##   &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span></span><br><span class="line"><span class="comment">## 1 temp         1    0.958  0.368 0.535</span></span><br><span class="line"><span class="comment">## 2 dewpoint    NA    1      0.327 0.454</span></span><br><span class="line"><span class="comment">## 3 pm10        NA   NA      1     0.206</span></span><br><span class="line"><span class="comment">## 4 o3          NA   NA     NA     1</span></span><br></pre></td></tr></table></figure></p><p>ç°åœ¨ï¼Œæˆ‘ä»¬ä½¿ç”¨ {tidyr} è½¯ä»¶åŒ…ä¸­çš„<mark class="hl-label blue">pivot_longer()</mark> å‡½æ•°å°†å¾—åˆ°çš„çŸ©é˜µè½¬æ¢ä¸ºé•¿æ ¼å¼ã€‚æˆ‘ä»¬è¿˜å°†ç›´æ¥æ ¼å¼åŒ–æ ‡ç­¾ï¼Œå¹¶ä¸ºä¸Šä¸‰è§’åŠ ä¸Šç©ºå¼•å·ã€‚è¯·æ³¨æ„ï¼Œæˆ‘ä½¿ç”¨äº†<mark class="hl-label blue">sprintf()</mark> æ¥ç¡®ä¿æ ‡ç­¾å§‹ç»ˆæ˜¾ç¤ºä¸¤ä½æ•°ã€‚<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">corm <span class="operator">&lt;-</span> corm <span class="operator">|&gt;</span></span><br><span class="line">  tidyr<span class="operator">::</span>pivot_longer<span class="punctuation">(</span></span><br><span class="line">    cols <span class="operator">=</span> <span class="operator">-</span>term<span class="punctuation">,</span></span><br><span class="line">    names_to <span class="operator">=</span> <span class="string">&quot;colname&quot;</span><span class="punctuation">,</span></span><br><span class="line">    values_to <span class="operator">=</span> <span class="string">&quot;corr&quot;</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">|&gt;</span></span><br><span class="line">  dplyr<span class="operator">::</span>mutate<span class="punctuation">(</span></span><br><span class="line">    rowname <span class="operator">=</span> forcats<span class="operator">::</span>fct_inorder<span class="punctuation">(</span>term<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    colname <span class="operator">=</span> forcats<span class="operator">::</span>fct_inorder<span class="punctuation">(</span>colname<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    label <span class="operator">=</span> dplyr<span class="operator">::</span>if_else<span class="punctuation">(</span><span class="built_in">is.na</span><span class="punctuation">(</span>corr<span class="punctuation">)</span><span class="punctuation">,</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> sprintf<span class="punctuation">(</span><span class="string">&quot;%1.2f&quot;</span><span class="punctuation">,</span> corr<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## # A tibble: 16 Ã— 5</span></span><br><span class="line"><span class="comment">##    term     colname    corr rowname  label </span></span><br><span class="line"><span class="comment">##    &lt;chr&gt;    &lt;fct&gt;     &lt;dbl&gt; &lt;fct&gt;    &lt;chr&gt; </span></span><br><span class="line"><span class="comment">##  1 temp     temp      1     temp     &quot;1.00&quot;</span></span><br><span class="line"><span class="comment">##  2 temp     dewpoint  0.958 temp     &quot;0.96&quot;</span></span><br><span class="line"><span class="comment">##  3 temp     pm10      0.368 temp     &quot;0.37&quot;</span></span><br><span class="line"><span class="comment">##  4 temp     o3        0.535 temp     &quot;0.53&quot;</span></span><br><span class="line"><span class="comment">##  5 dewpoint temp     NA     dewpoint &quot;&quot;    </span></span><br><span class="line"><span class="comment">##  6 dewpoint dewpoint  1     dewpoint &quot;1.00&quot;</span></span><br><span class="line"><span class="comment">##  7 dewpoint pm10      0.327 dewpoint &quot;0.33&quot;</span></span><br><span class="line"><span class="comment">##  8 dewpoint o3        0.454 dewpoint &quot;0.45&quot;</span></span><br><span class="line"><span class="comment">##  9 pm10     temp     NA     pm10     &quot;&quot;    </span></span><br><span class="line"><span class="comment">## 10 pm10     dewpoint NA     pm10     &quot;&quot;    </span></span><br><span class="line"><span class="comment">## 11 pm10     pm10      1     pm10     &quot;1.00&quot;</span></span><br><span class="line"><span class="comment">## 12 pm10     o3        0.206 pm10     &quot;0.21&quot;</span></span><br><span class="line"><span class="comment">## 13 o3       temp     NA     o3       &quot;&quot;    </span></span><br><span class="line"><span class="comment">## 14 o3       dewpoint NA     o3       &quot;&quot;    </span></span><br><span class="line"><span class="comment">## 15 o3       pm10     NA     o3       &quot;&quot;    </span></span><br><span class="line"><span class="comment">## 16 o3       o3        1     o3       &quot;1.00&quot;</span></span><br></pre></td></tr></table></figure></p><p>æˆ‘ä»¬å°†ä½¿ç”¨<mark class="hl-label blue">geom_tile()</mark> ç»˜åˆ¶çƒ­å›¾ï¼Œä½¿ç”¨<mark class="hl-label blue">geom_text()</mark> ç»˜åˆ¶æ ‡ç­¾ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>corm<span class="punctuation">,</span> aes<span class="punctuation">(</span>rowname<span class="punctuation">,</span> fct_rev<span class="punctuation">(</span>colname<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                 fill <span class="operator">=</span> corr<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_tile<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_text<span class="punctuation">(</span>aes<span class="punctuation">(</span>label <span class="operator">=</span> label<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  coord_fixed<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb703b6c2f2.png" style="width:600px;"/></div></div></p><p>æˆ‘å–œæ¬¢ä½¿ç”¨å‘æ•£çš„è°ƒè‰²æ¿â€”é‡è¦çš„æ˜¯ï¼Œåˆ»åº¦è¦ä»¥é›¶ç›¸å…³æ€§ä¸ºä¸­å¿ƒï¼ç™½è‰²è¡¨ç¤ºæ•°æ®ç¼ºå¤±ã€‚æ­¤å¤–ï¼Œæˆ‘è¿˜å–œæ¬¢çƒ­å›¾å‘¨å›´æ²¡æœ‰ç½‘æ ¼çº¿å’Œè¡¬å«ï¼Œæ ‡ç­¾çš„é¢œè‰²å–å†³äºåº•å±‚å¡«å……ç‰©<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>corm<span class="punctuation">,</span> aes<span class="punctuation">(</span>rowname<span class="punctuation">,</span> fct_rev<span class="punctuation">(</span>colname<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                 fill <span class="operator">=</span> corr<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_tile<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_text<span class="punctuation">(</span>aes<span class="punctuation">(</span></span><br><span class="line">    label <span class="operator">=</span> label<span class="punctuation">,</span></span><br><span class="line">    color <span class="operator">=</span> <span class="built_in">abs</span><span class="punctuation">(</span>corr<span class="punctuation">)</span> <span class="operator">&lt;</span> <span class="number">.75</span></span><br><span class="line">  <span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  coord_fixed<span class="punctuation">(</span>expand <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_color_manual<span class="punctuation">(</span></span><br><span class="line">    values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;white&quot;</span><span class="punctuation">,</span> <span class="string">&quot;black&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    guide <span class="operator">=</span> <span class="string">&quot;none&quot;</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_distiller<span class="punctuation">(</span></span><br><span class="line">    palette <span class="operator">=</span> <span class="string">&quot;PuOr&quot;</span><span class="punctuation">,</span> na.value <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span></span><br><span class="line">    direction <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    name <span class="operator">=</span> <span class="string">&quot;Pearson\nCorrelation:&quot;</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.border <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.position <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">.85</span><span class="punctuation">,</span> <span class="number">.8</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb706b6fd2c.png" style="width:600px;"/></div></div></p><h2 id="åˆ›å»ºç­‰é«˜çº¿å›¾"><a href="#åˆ›å»ºç­‰é«˜çº¿å›¾" class="headerlink" title="åˆ›å»ºç­‰é«˜çº¿å›¾"></a>åˆ›å»ºç­‰é«˜çº¿å›¾</h2><p>ç­‰å€¼çº¿å›¾æ˜¯æ˜¾ç¤ºæ•°å€¼ç­‰è·çš„å¥½æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥å¯¹æ•°æ®è¿›è¡Œåˆ†é€‰ï¼Œæ˜¾ç¤ºè§‚æµ‹å€¼çš„å¯†åº¦ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>temp<span class="punctuation">,</span> o3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_density_2d<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> x <span class="operator">=</span> <span class="string">&quot;Ozone Level&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb708d4616f.png" style="width:600px;"/></div></div></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>temp<span class="punctuation">,</span> o3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_density_2d_filled<span class="punctuation">(</span>show.legend <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  coord_cartesian<span class="punctuation">(</span>expand <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> x <span class="operator">=</span> <span class="string">&quot;Ozone Level&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb70ddbe0d0.png" style="width:600px;"/></div></div><p>ä½†ç°åœ¨ï¼Œæˆ‘ä»¬æ­£åœ¨ç»˜åˆ¶ä¸‰ç»´æ•°æ®ã€‚æˆ‘ä»¬å°†ç»˜åˆ¶éœ²ç‚¹ï¼ˆå³ç©ºæ°”ä¸­æ°´è’¸æ°”å‡ç»“æˆæ¶²æ€éœ²æ°´çš„æ¸©åº¦ï¼‰ä¸æ¸©åº¦å’Œè‡­æ°§æ°´å¹³ç›¸å…³çš„ä¸´ç•Œå€¼ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## interpolate data</span></span><br><span class="line">fld <span class="operator">&lt;-</span> with<span class="punctuation">(</span>chic<span class="punctuation">,</span> akima<span class="operator">::</span>interp<span class="punctuation">(</span>x <span class="operator">=</span> temp<span class="punctuation">,</span> y <span class="operator">=</span> o3<span class="punctuation">,</span> z <span class="operator">=</span> dewpoint<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## prepare data in long format</span></span><br><span class="line">df <span class="operator">&lt;-</span> fld<span class="operator">$</span>z <span class="operator">|&gt;</span></span><br><span class="line">  tibble<span class="operator">::</span>as_tibble<span class="punctuation">(</span>.name_repair <span class="operator">=</span> <span class="string">&quot;universal_quiet&quot;</span><span class="punctuation">)</span> <span class="operator">|&gt;</span> </span><br><span class="line">  dplyr<span class="operator">::</span>mutate<span class="punctuation">(</span>x <span class="operator">=</span> dplyr<span class="operator">::</span>row_number<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">|&gt;</span></span><br><span class="line">  tidyr<span class="operator">::</span>pivot_longer<span class="punctuation">(</span></span><br><span class="line">    cols <span class="operator">=</span> <span class="operator">-</span>x<span class="punctuation">,</span></span><br><span class="line">    names_to <span class="operator">=</span> <span class="string">&quot;y&quot;</span><span class="punctuation">,</span></span><br><span class="line">    names_transform <span class="operator">=</span> <span class="built_in">as.integer</span><span class="punctuation">,</span></span><br><span class="line">    values_to <span class="operator">=</span> <span class="string">&quot;Dewpoint&quot;</span><span class="punctuation">,</span> </span><br><span class="line">    names_prefix <span class="operator">=</span> <span class="string">&quot;...&quot;</span><span class="punctuation">,</span></span><br><span class="line">    values_drop_na <span class="operator">=</span> <span class="literal">TRUE</span></span><br><span class="line">  <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">g <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>data <span class="operator">=</span> df<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> x<span class="punctuation">,</span> y <span class="operator">=</span> y<span class="punctuation">,</span> z <span class="operator">=</span> Dewpoint<span class="punctuation">)</span><span class="punctuation">)</span>  <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Ozone Level&quot;</span><span class="punctuation">,</span></span><br><span class="line">       color <span class="operator">=</span> <span class="string">&quot;Dewpoint&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">g <span class="operator">+</span> stat_contour<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> after_stat<span class="punctuation">(</span>level<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb7109b4f8e.png" style="width:600px;"/></div></div></p><p>æƒŠå–œ æ ¹æ®å®šä¹‰ï¼Œæ‹”æ¨¡ç‚¹åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ç­‰äºæµ‹é‡æ¸©åº¦ã€‚</p><p>è¿™äº›çº¿æ¡è¡¨ç¤ºä¸åŒç­‰çº§çš„éœ²ç‚¹ï¼Œä½†è¿™å¹…å›¾å¹¶ä¸ç¾è§‚ï¼Œè€Œä¸”ç”±äºè¾¹æ¡†ç¼ºå¤±ï¼Œå¾ˆéš¾é˜…è¯»ã€‚è®©æˆ‘ä»¬å°è¯•ä½¿ç”¨ viridis è°ƒè‰²æ¿ç»˜åˆ¶ä¸€å¹…ç“¦ç‰‡å›¾ï¼Œå¯¹è‡­æ°§æ°´å¹³å’Œæ¸©åº¦çš„æ¯ç§ç»„åˆçš„éœ²ç‚¹è¿›è¡Œç¼–ç ï¼š</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span> geom_tile<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> Dewpoint<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    scale_fill_viridis_c<span class="punctuation">(</span>option <span class="operator">=</span> <span class="string">&quot;inferno&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb7123b325d.png" style="width:600px;"/></div></div><p>å¦‚æœæˆ‘ä»¬å°†ç­‰é«˜çº¿å›¾å’Œç“¦ç‰‡å›¾ç»“åˆèµ·æ¥ï¼Œå¡«å……ç­‰é«˜çº¿ä¸‹çš„åŒºåŸŸï¼Œæ•ˆæœä¼šå¦‚ä½•ï¼Ÿ<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">+</span> geom_tile<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> Dewpoint<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    stat_contour<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">.7</span><span class="punctuation">,</span> bins <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    scale_fill_viridis_c<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb713825e31.png" style="width:600px;"/></div></div></p><h2 id="åˆ›å»ºè®¡æ•°çƒ­å›¾"><a href="#åˆ›å»ºè®¡æ•°çƒ­å›¾" class="headerlink" title="åˆ›å»ºè®¡æ•°çƒ­å›¾"></a>åˆ›å»ºè®¡æ•°çƒ­å›¾</h2><p>ä¸ç¬¬ä¸€å¹…ç­‰é«˜çº¿å›¾ç±»ä¼¼ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡<mark class="hl-label blue">geom_hex()</mark> ï¼Œè½»æ¾æ˜¾ç¤ºæŒ‰å…­è¾¹å½¢ç½‘æ ¼åˆ’åˆ†çš„ç‚¹çš„è®¡æ•°æˆ–å¯†åº¦ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>temp<span class="punctuation">,</span> o3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_hex<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_distiller<span class="punctuation">(</span>palette <span class="operator">=</span> <span class="string">&quot;YlOrRd&quot;</span><span class="punctuation">,</span> direction <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Ozone Level&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb7151b69bf.png" style="width:600px;"/></div></div></p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œç»“æœå›¾ä¸­ä¼šå‡ºç°ç™½çº¿ã€‚å¯ä»¥é€šè¿‡å°†é¢œè‰²æ˜ å°„åˆ°<mark class="hl-label blue">after_stat(count)</mark> ï¼ˆé»˜è®¤å€¼ï¼‰æˆ– <mark class="hl-label blue">after_stat(density)</mark> æ¥è§£å†³è¿™ä¸ªé—®é¢˜â€¦<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>temp<span class="punctuation">,</span> o3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_hex<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> after_stat<span class="punctuation">(</span>count<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_distiller<span class="punctuation">(</span>palette <span class="operator">=</span> <span class="string">&quot;YlOrRd&quot;</span><span class="punctuation">,</span> direction <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_color_distiller<span class="punctuation">(</span>palette <span class="operator">=</span> <span class="string">&quot;YlOrRd&quot;</span><span class="punctuation">,</span> direction <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Ozone Level&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb7169a86dc.png" style="width:600px;"/></div></div></p><p>â€¦ æˆ–ä¸ºæ‰€æœ‰å…­è¾¹å½¢å•å…ƒæ ¼è®¾ç½®ç›¸åŒçš„è½®å»“é¢œè‰²ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>temp<span class="punctuation">,</span> o3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_hex<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;grey&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_distiller<span class="punctuation">(</span>palette <span class="operator">=</span> <span class="string">&quot;YlOrRd&quot;</span><span class="punctuation">,</span> direction <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Ozone Level&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb7186c981b.png" style="width:600px;"/></div></div></p><p>è¿˜å¯ä»¥æ›´æ”¹é»˜è®¤çš„åˆ†æ¡£ï¼Œä»¥å¢åŠ æˆ–å‡å°‘å…­è¾¹å½¢å•å…ƒçš„æ•°é‡ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>temp<span class="punctuation">,</span> o3<span class="punctuation">,</span> fill <span class="operator">=</span> after_stat<span class="punctuation">(</span>density<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_hex<span class="punctuation">(</span>bins <span class="operator">=</span> <span class="number">50</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;grey&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_distiller<span class="punctuation">(</span>palette <span class="operator">=</span> <span class="string">&quot;YlOrRd&quot;</span><span class="punctuation">,</span> direction <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Ozone Level&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb71a170b1d.png" style="width:600px;"/></div></div></p><p>å¦‚æœæƒ³ä½¿ç”¨è§„åˆ™ç½‘æ ¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<mark class="hl-label blue">geom_bin2d()</mark> ï¼Œå®ƒå¯ä»¥å°†æ•°æ®æ±‡æ€»åˆ°åŸºäº<mark class="hl-label blue">bins</mark> çš„çŸ©å½¢ç½‘æ ¼å•å…ƒä¸­ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>temp<span class="punctuation">,</span> o3<span class="punctuation">,</span> fill <span class="operator">=</span> after_stat<span class="punctuation">(</span>density<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_bin2d<span class="punctuation">(</span>bins <span class="operator">=</span> <span class="number">15</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;grey&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_distiller<span class="punctuation">(</span>palette <span class="operator">=</span> <span class="string">&quot;YlOrRd&quot;</span><span class="punctuation">,</span> direction <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Ozone Level&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb71b5773a2.png" style="width:600px;"/></div></div></p><h2 id="åˆ›å»ºå±±è„Šå›¾"><a href="#åˆ›å»ºå±±è„Šå›¾" class="headerlink" title="åˆ›å»ºå±±è„Šå›¾"></a>åˆ›å»ºå±±è„Šå›¾</h2><p>å±±è„Šå›¾æ˜¯ä¸€ç§æ–°å‹å›¾å½¢ï¼Œç›®å‰éå¸¸æµè¡Œã€‚</p><p>è™½ç„¶æ‚¨å¯ä»¥ä½¿ç”¨åŸºæœ¬çš„ {ggplot2} å‘½ä»¤æ¥åˆ›å»ºè¿™äº›å›¾ï¼Œä½†ç”±äºæµè¡Œï¼Œæˆ‘ä»¬å¼€å‘äº†ä¸€ä¸ªè½¯ä»¶åŒ…ï¼Œå¯ä»¥æ›´è½»æ¾åœ°åˆ›å»ºè¿™äº›å›¾ï¼š {ggridges}ã€‚æˆ‘ä»¬å°†åœ¨è¿™é‡Œä½¿ç”¨è¿™ä¸ªè½¯ä»¶åŒ…ã€‚</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>ggridges<span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> temp<span class="punctuation">,</span> y <span class="operator">=</span> factor<span class="punctuation">(</span>year<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">   geom_density_ridges<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;gray90&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">   labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb71c9707d6.png" style="width:600px;"/></div></div><p>ä½ å¯ä»¥åˆ†åˆ«ä½¿ç”¨å‚æ•°<mark class="hl-label blue">rel_min_height</mark> å’Œ<mark class="hl-label blue">scale</mark> æ¥è½»æ¾æŒ‡å®šé‡å éƒ¨åˆ†å’Œå°¾éƒ¨ã€‚è¯¥è½¯ä»¶åŒ…è¿˜è‡ªå¸¦ä¸»é¢˜ï¼ˆä½†æˆ‘æ›´å–œæ¬¢åˆ›å»ºè‡ªå·±çš„ä¸»é¢˜ï¼Œå‚è§ â€œåˆ›å»ºå’Œä½¿ç”¨è‡ªå®šä¹‰ä¸»é¢˜ â€œä¸€ç« ï¼‰ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜ä¼šæ ¹æ®å¹´ä»½æ”¹å˜é¢œè‰²ï¼Œä½¿å…¶æ›´å¸å¼•äººã€‚<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> temp<span class="punctuation">,</span> y <span class="operator">=</span> factor<span class="punctuation">(</span>year<span class="punctuation">)</span><span class="punctuation">,</span> fill <span class="operator">=</span> year<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_density_ridges<span class="punctuation">(</span>alpha <span class="operator">=</span> <span class="number">.8</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span></span><br><span class="line">                      scale <span class="operator">=</span> <span class="number">2.5</span><span class="punctuation">,</span> rel_min_height <span class="operator">=</span> <span class="number">.01</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  guides<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_ridges<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb72239b7af.png" style="width:600px;"/></div></div></p><p>æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨ä½äº 1 çš„ç¼©æ”¾å‚æ•°å€¼æ¥æ¶ˆé™¤é‡å ï¼ˆä½†è¿™ä¸è„Šå›¾çš„ç†å¿µç›¸æ‚–â€¦â€¦ï¼‰ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªé¢å¤–ä½¿ç”¨ viridis é¢œè‰²æ¢¯åº¦å’Œå†…ç½®ä¸»é¢˜çš„ç¤ºä¾‹ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> temp<span class="punctuation">,</span> y <span class="operator">=</span> season<span class="punctuation">,</span> fill <span class="operator">=</span> after_stat<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_density_ridges_gradient<span class="punctuation">(</span>scale <span class="operator">=</span> <span class="number">.9</span><span class="punctuation">,</span> gradient_lwd <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">,</span></span><br><span class="line">                               color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_viridis_c<span class="punctuation">(</span>option <span class="operator">=</span> <span class="string">&quot;plasma&quot;</span><span class="punctuation">,</span> name <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Season&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_ridges<span class="punctuation">(</span>font_family <span class="operator">=</span> <span class="string">&quot;Roboto Condensed&quot;</span><span class="punctuation">,</span> grid <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb7236857e3.png" style="width:600px;"/></div></div></p><p>æˆ‘ä»¬è¿˜å¯ä»¥æ¯”è¾ƒæ¯æ¡å±±è„Šçº¿çš„å‡ ä¸ªç»„åˆ«ï¼Œå¹¶æ ¹æ®ç»„åˆ«è¿›è¡Œç€è‰²ã€‚è¿™ä¸é©¬å…‹-è´å°”å°Šæ–¯ï¼ˆMarc Belzuncesï¼‰çš„æƒ³æ³•ä¸è°‹è€Œåˆã€‚<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>dplyr<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## only plot extreme season using dplyr from the tidyverse</span></span><br><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> dplyr<span class="operator">::</span>filter<span class="punctuation">(</span>chic<span class="punctuation">,</span> season <span class="operator">%in%</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Summer&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Winter&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">         aes<span class="punctuation">(</span>x <span class="operator">=</span> temp<span class="punctuation">,</span> y <span class="operator">=</span> year<span class="punctuation">,</span> fill <span class="operator">=</span> paste<span class="punctuation">(</span>year<span class="punctuation">,</span> season<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_density_ridges<span class="punctuation">(</span>alpha <span class="operator">=</span> <span class="number">.7</span><span class="punctuation">,</span> rel_min_height <span class="operator">=</span> <span class="number">.01</span><span class="punctuation">,</span></span><br><span class="line">                      color <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> from <span class="operator">=</span> <span class="operator">-</span><span class="number">5</span><span class="punctuation">,</span> to <span class="operator">=</span> <span class="number">95</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_cyclical<span class="punctuation">(</span>breaks <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;1997 Summer&quot;</span><span class="punctuation">,</span> <span class="string">&quot;1997 Winter&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                      labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span>`<span class="number">1997</span> Summer` = &quot;Summer&quot;,</span><br><span class="line">                                 `1997 Winter` = &quot;Winter&quot;),</span><br><span class="line">                      values = c(&quot;tomato&quot;, &quot;dodgerblue&quot;),</span><br><span class="line">                      name = &quot;Season:&quot;, guide = &quot;legend&quot;) +</span><br><span class="line">  theme_ridges(grid = FALSE) +</span><br><span class="line">  labs(x = &quot;Temperature (Â°F)&quot;, y = &quot;Year&quot;)</span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb724f84fa6.png" style="width:600px;"/></div></div></p><p>åœ¨<mark class="hl-label blue">geom_density_ridges()</mark> å‘½ä»¤ä¸­ä½¿ç”¨<mark class="hl-label =binline">stat</mark> ï¼Œ{ggridges}è½¯ä»¶åŒ…è¿˜å¯ä»¥å¸®åŠ©åˆ›å»ºä¸åŒç»„åˆ«çš„ç›´æ–¹å›¾ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> temp<span class="punctuation">,</span> y <span class="operator">=</span> factor<span class="punctuation">(</span>year<span class="punctuation">)</span><span class="punctuation">,</span> fill <span class="operator">=</span> year<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_density_ridges<span class="punctuation">(</span>stat <span class="operator">=</span> <span class="string">&quot;binline&quot;</span><span class="punctuation">,</span> bins <span class="operator">=</span> <span class="number">25</span><span class="punctuation">,</span> scale <span class="operator">=</span> <span class="number">.9</span><span class="punctuation">,</span></span><br><span class="line">                      draw_baseline <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> show.legend <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_minimal<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Season&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb725fefc1e.png" style="width:600px;"/></div></div></p><h1 id="ä½¿ç”¨è‰²å¸¦ï¼ˆAUCã€CI-ç­‰ï¼‰"><a href="#ä½¿ç”¨è‰²å¸¦ï¼ˆAUCã€CI-ç­‰ï¼‰" class="headerlink" title="ä½¿ç”¨è‰²å¸¦ï¼ˆAUCã€CI ç­‰ï¼‰"></a>ä½¿ç”¨è‰²å¸¦ï¼ˆAUCã€CI ç­‰ï¼‰</h1><p>è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå®Œç¾çš„æ•°æ®é›†ï¼Œä½†ä½¿ç”¨ribbon å¯ä»¥å¾ˆæœ‰ç”¨ã€‚åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ filter() å‡½æ•°åˆ›å»ºä¸€ä¸ª 30 å¤©çš„è¿è¡Œå¹³å‡å€¼ï¼Œè¿™æ ·æˆ‘ä»¬çš„æ•°æ®å¸¦å°±ä¸ä¼šå¤ªå˜ˆæ‚ã€‚</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">chic<span class="operator">$</span>o3run <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>stats<span class="operator">::</span>filter<span class="punctuation">(</span>chic<span class="operator">$</span>o3<span class="punctuation">,</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">/</span><span class="number">30</span><span class="punctuation">,</span> <span class="number">30</span><span class="punctuation">)</span><span class="punctuation">,</span> sides <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> o3run<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">   geom_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;chocolate&quot;</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">.8</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">   labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Ozone&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb727d74ed0.png" style="width:600px;"/></div></div><p>å¦‚æœæˆ‘ä»¬ä½¿ç”¨<mark class="hl-label blue">geom_ribbon()</mark> å‡½æ•°å¡«å……æ›²çº¿ä¸‹æ–¹çš„åŒºåŸŸï¼Œæ•ˆæœä¼šå¦‚ä½•ï¼Ÿ<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> o3run<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">   geom_ribbon<span class="punctuation">(</span>aes<span class="punctuation">(</span>ymin <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> ymax <span class="operator">=</span> o3run<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">               fill <span class="operator">=</span> <span class="string">&quot;orange&quot;</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">.4</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">   geom_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;chocolate&quot;</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">.8</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">   labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Ozone&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb7296ba5e4.png" style="width:600px;"/></div></div></p><p>è¡¨ç¤ºæ›²çº¿ä¸‹é¢ç§¯<a href="https://en.wikipedia.org/wiki/Area_under_the_curve_(pharmacokinetics">ï¼ˆAUCï¼‰</a>)å¾ˆå¥½ï¼Œä½†è¿™å¹¶ä¸æ˜¯ä½¿ç”¨ geom_ribbon() çš„å¸¸è§„æ–¹æ³•ã€‚</p><details class="folding-tag" green><summary> ğŸ’ å®é™…ä¸Šï¼Œgeom_area() æ˜¯å®ç°åŒæ ·æ•ˆæœçš„æ›´å¥½æ–¹æ³•ã€‚ </summary>              <div class='content'>              <figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> o3run<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">   geom_area<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;chocolate&quot;</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">.8</span><span class="punctuation">,</span></span><br><span class="line">             fill <span class="operator">=</span> <span class="string">&quot;orange&quot;</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">.4</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">   labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Ozone&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb7296ba5e4.png" style="width:600px;"/></div></div>              </div>            </details><p>å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œæˆ‘ä»¬ç”»ä¸€æ¡å¸¦çŠ¶çº¿ï¼Œä½¿æˆ‘ä»¬çš„æ•°æ®ä¸Šä¸‹å„æœ‰ä¸€ä¸ªæ ‡å‡†å·®ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">chic<span class="operator">$</span>mino3 <span class="operator">&lt;-</span> chic<span class="operator">$</span>o3run <span class="operator">-</span> sd<span class="punctuation">(</span>chic<span class="operator">$</span>o3run<span class="punctuation">,</span> na.rm <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">chic<span class="operator">$</span>maxo3 <span class="operator">&lt;-</span> chic<span class="operator">$</span>o3run <span class="operator">+</span> sd<span class="punctuation">(</span>chic<span class="operator">$</span>o3run<span class="punctuation">,</span> na.rm <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> o3run<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">   geom_ribbon<span class="punctuation">(</span>aes<span class="punctuation">(</span>ymin <span class="operator">=</span> mino3<span class="punctuation">,</span> ymax <span class="operator">=</span> maxo3<span class="punctuation">)</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">,</span></span><br><span class="line">               fill <span class="operator">=</span> <span class="string">&quot;darkseagreen3&quot;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;transparent&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">   geom_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;aquamarine4&quot;</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">.7</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">   labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Ozone&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb72eb7f4a9.png" style="width:600px;"/></div></div></p><h1 id="å¹³æ»‘å›¾"><a href="#å¹³æ»‘å›¾" class="headerlink" title="å¹³æ»‘å›¾"></a>å¹³æ»‘å›¾</h1><p>ä½¿ç”¨ {ggplot2} ä¸ºæ•°æ®æ·»åŠ å¹³æ»‘å¤„ç†éå¸¸ç®€å•ã€‚</p><h2 id="é»˜è®¤å€¼-æ·»åŠ -LOESS-æˆ–-GAM-å¹³æ»‘å¤„ç†"><a href="#é»˜è®¤å€¼-æ·»åŠ -LOESS-æˆ–-GAM-å¹³æ»‘å¤„ç†" class="headerlink" title="é»˜è®¤å€¼ æ·»åŠ  LOESS æˆ– GAM å¹³æ»‘å¤„ç†"></a>é»˜è®¤å€¼ æ·»åŠ  LOESS æˆ– GAM å¹³æ»‘å¤„ç†</h2><p>æ‚¨åªéœ€ä½¿ç”¨<mark class="hl-label blue">stat_smooth()</mark> ï¼Œç”šè‡³ä¸éœ€è¦å…¬å¼ã€‚å¦‚æœç‚¹æ•°å°‘äº 1000 ä¸ªï¼Œåˆ™æ·»åŠ  LOESSï¼ˆå±€éƒ¨åŠ æƒæ•£ç‚¹å›¾å¹³æ»‘ï¼Œ<mark class="hl-label blue">method=loess</mark> ï¼‰ï¼Œå¦åˆ™æ·»åŠ  GAMï¼ˆå¹¿ä¹‰ç›¸åŠ æ¨¡å‹ï¼Œ<mark class="hl-label gam">method=</mark> ï¼‰ã€‚ç”±äºæˆ‘ä»¬æœ‰è¶…è¿‡ 1000 ä¸ªç‚¹ï¼Œæ‰€ä»¥å¹³æ»‘æ˜¯åŸºäº GAM ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;gray40&quot;</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  stat_smooth<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> </span><br></pre></td></tr></table></figure><br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## `geom_smooth()` using method = &#x27;gam&#x27; and formula = &#x27;y ~ s(x, bs = &quot;cs&quot;)&#x27;</span></span><br></pre></td></tr></table></figure></p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb74636abcb.png" style="width:600px;"/></div></div><p><strong>ğŸ’¡ åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›ç‚¹ä½äºè‰²å¸¦çš„é¡¶éƒ¨ï¼Œå› æ­¤è¯·ç¡®ä¿åœ¨æ·»åŠ ç‚¹ä¹‹å‰è°ƒç”¨å¹³æ»‘ã€‚</strong></p><h2 id="æ·»åŠ çº¿æ€§æ‹Ÿåˆ"><a href="#æ·»åŠ çº¿æ€§æ‹Ÿåˆ" class="headerlink" title="æ·»åŠ çº¿æ€§æ‹Ÿåˆ"></a>æ·»åŠ çº¿æ€§æ‹Ÿåˆ</h2><p>è™½ç„¶é»˜è®¤æ˜¯ LOESS æˆ– GAM å¹³æ»‘ï¼Œä½†ä¹Ÿå¯ä»¥è½»æ¾æ·»åŠ æ ‡å‡†çº¿æ€§æ‹Ÿåˆï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> temp<span class="punctuation">,</span> y <span class="operator">=</span> dewpoint<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">   geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;gray40&quot;</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">   stat_smooth<span class="punctuation">(</span>method <span class="operator">=</span> <span class="string">&quot;lm&quot;</span><span class="punctuation">,</span> se <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span></span><br><span class="line">               color <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">1.3</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">   labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Dewpoint&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb7526e13fe.png" style="width:600px;"/></div></div></p><h2 id="æŒ‡å®šå¹³æ»‘å…¬å¼"><a href="#æŒ‡å®šå¹³æ»‘å…¬å¼" class="headerlink" title="æŒ‡å®šå¹³æ»‘å…¬å¼"></a>æŒ‡å®šå¹³æ»‘å…¬å¼</h2><p>{ggplot2} å…è®¸æ‚¨æŒ‡å®šè¦ä½¿ç”¨çš„æ¨¡å‹ã€‚ä¹Ÿè®¸ä½ æƒ³ä½¿ç”¨å¤šé¡¹å¼å›å½’ï¼Ÿ<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> o3<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;gray40&quot;</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">.3</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_smooth<span class="punctuation">(</span></span><br><span class="line">    method <span class="operator">=</span> <span class="string">&quot;lm&quot;</span><span class="punctuation">,</span></span><br><span class="line">    formula <span class="operator">=</span> y <span class="operator">~</span> x <span class="operator">+</span> I<span class="punctuation">(</span>x<span class="operator">^</span><span class="number">2</span><span class="punctuation">)</span> <span class="operator">+</span> I<span class="punctuation">(</span>x<span class="operator">^</span><span class="number">3</span><span class="punctuation">)</span> <span class="operator">+</span> I<span class="punctuation">(</span>x<span class="operator">^</span><span class="number">4</span><span class="punctuation">)</span> <span class="operator">+</span> I<span class="punctuation">(</span>x<span class="operator">^</span><span class="number">5</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span></span><br><span class="line">    fill <span class="operator">=</span> <span class="string">&quot;firebrick&quot;</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Ozone Level&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb75f7ea31f.png" style="width:600px;"/></div></div></p><details class="folding-tag" green><summary> ğŸ’ å’¦ï¼Œgeom_smooth()ï¼Ÿgeomå’Œstatä¹‹é—´æœ‰é‡è¦åŒºåˆ«ï¼Œä½†åœ¨è¿™é‡Œç”¨å“ªä¸ªå¹¶ä¸é‡è¦ã€‚å±•å¼€ä»¥æ¯”è¾ƒä¸¤è€…ã€‚ </summary>              <div class='content'>              <figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> o3<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;gray40&quot;</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">.3</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_smooth<span class="punctuation">(</span>stat <span class="operator">=</span> <span class="string">&quot;smooth&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> <span class="comment">## the default</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Ozone Level&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb76e5ba58d.png" style="width:600px;"/></div></div><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> o3<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;gray40&quot;</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">.3</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  stat_smooth<span class="punctuation">(</span>geom <span class="operator">=</span> <span class="string">&quot;smooth&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> <span class="comment">## the default</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Ozone Level&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb76e5ba58d.png" style="width:600px;"/></div></div>              </div>            </details><p>æˆ–è€…ï¼Œå‡è®¾æ‚¨æƒ³å¢åŠ  GAM ç»´åº¦ï¼ˆåœ¨å¹³æ»‘çš„åŸºç¡€ä¸Šå¢åŠ ä¸€äº›é¢å¤–çš„æ‘†åŠ¨ï¼‰ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">cols <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;darkorange2&quot;</span><span class="punctuation">,</span> <span class="string">&quot;firebrick&quot;</span><span class="punctuation">,</span> <span class="string">&quot;dodgerblue3&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;gray40&quot;</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">.3</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  stat_smooth<span class="punctuation">(</span>aes<span class="punctuation">(</span>col <span class="operator">=</span> <span class="string">&quot;1000&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">              method <span class="operator">=</span> <span class="string">&quot;gam&quot;</span><span class="punctuation">,</span></span><br><span class="line">              formula <span class="operator">=</span> y <span class="operator">~</span> s<span class="punctuation">(</span>x<span class="punctuation">,</span> k <span class="operator">=</span> <span class="number">1000</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">              se <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">1.3</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  stat_smooth<span class="punctuation">(</span>aes<span class="punctuation">(</span>col <span class="operator">=</span> <span class="string">&quot;100&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">              method <span class="operator">=</span> <span class="string">&quot;gam&quot;</span><span class="punctuation">,</span></span><br><span class="line">              formula <span class="operator">=</span> y <span class="operator">~</span> s<span class="punctuation">(</span>x<span class="punctuation">,</span> k <span class="operator">=</span> <span class="number">100</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">              se <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  stat_smooth<span class="punctuation">(</span>aes<span class="punctuation">(</span>col <span class="operator">=</span> <span class="string">&quot;10&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">              method <span class="operator">=</span> <span class="string">&quot;gam&quot;</span><span class="punctuation">,</span></span><br><span class="line">              formula <span class="operator">=</span> y <span class="operator">~</span> s<span class="punctuation">(</span>x<span class="punctuation">,</span> k <span class="operator">=</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">              se <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> linewidth <span class="operator">=</span> <span class="number">.8</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_color_manual<span class="punctuation">(</span>name <span class="operator">=</span> <span class="string">&quot;k&quot;</span><span class="punctuation">,</span> values <span class="operator">=</span> cols<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Year&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb7920cf067.png" style="width:600px;"/></div></div></p><h1 id="äº¤äº’å¼ç»˜å›¾"><a href="#äº¤äº’å¼ç»˜å›¾" class="headerlink" title="äº¤äº’å¼ç»˜å›¾"></a>äº¤äº’å¼ç»˜å›¾</h1><p>ä»¥ä¸‹åº“é›†åˆ—å‡ºäº†å¯ä¸ {ggplot2} ç»“åˆä½¿ç”¨æˆ–å•ç‹¬ä½¿ç”¨çš„åº“ï¼Œç”¨äºåœ¨ R ä¸­åˆ›å»ºäº¤äº’å¼å¯è§†åŒ–ï¼ˆé€šå¸¸åˆ©ç”¨ç°æœ‰ JavaScript åº“ï¼‰ã€‚</p><h2 id="ggplot2-å’Œ-shiny-çš„ç»„åˆ"><a href="#ggplot2-å’Œ-shiny-çš„ç»„åˆ" class="headerlink" title="{ggplot2}å’Œ{shiny}çš„ç»„åˆ"></a>{ggplot2}å’Œ{shiny}çš„ç»„åˆ</h2><p>{shiny}æ˜¯<a href="https://posit.co/">RStudio</a>çš„ä¸€ä¸ªè½¯ä»¶åŒ…ï¼Œå®ƒè®©ä½¿ç”¨Ræ„å»ºäº¤äº’å¼ç½‘ç»œåº”ç”¨å˜å¾—å¼‚å¸¸ç®€å•ã€‚å¦‚éœ€äº†è§£ç›¸å…³ä»‹ç»å’Œå®ä¾‹ï¼Œè¯·è®¿é—®<a href="https://shiny.posit.co/">Shiny</a>ä¸»é¡µã€‚</p><p>è¦äº†è§£å…¶æ½œåœ¨ç”¨é€”ï¼Œå¯ä»¥æŸ¥çœ‹ Hello Shiny ç¤ºä¾‹ã€‚è¿™æ˜¯ç¬¬ä¸€ä¸ªï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>shiny<span class="punctuation">)</span></span><br><span class="line">runExample<span class="punctuation">(</span><span class="string">&quot;01_hello&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure></p><p>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨è¿™äº›åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ ggplotsã€‚æœ¬ä¾‹å±•ç¤ºäº†æ·»åŠ ä¸€äº›äº¤äº’å¼ç”¨æˆ·ä½“éªŒçš„å¯èƒ½æ€§ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">runExample<span class="punctuation">(</span><span class="string">&quot;04_mpg&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure></p><h2 id="é€šè¿‡-plotly-å’Œ-ggplot2-Plot-ly"><a href="#é€šè¿‡-plotly-å’Œ-ggplot2-Plot-ly" class="headerlink" title="é€šè¿‡ {plotly} å’Œ {ggplot2} Plot.ly"></a>é€šè¿‡ {plotly} å’Œ {ggplot2} Plot.ly</h2><p><a href="https://chart-studio.plotly.com/feed/#/">Plot.ly</a>æ˜¯ä¸€æ¬¾ç”¨äºåˆ›å»ºåœ¨çº¿äº¤äº’å¼å›¾å½¢å’Œç½‘ç»œåº”ç”¨çš„å·¥å…·ã€‚{plotly}è½¯ä»¶åŒ…å¯ä»¥è®©ä½ ç›´æ¥ä»{ggplot2}ç»˜å›¾ä¸­åˆ›å»ºè¿™äº›å›¾å½¢ï¼Œè€Œä¸”å·¥ä½œæµç¨‹å‡ºå¥‡åœ°ç®€å•ï¼Œ<a href="https://plotly-r.com/">å¯ä»¥åœ¨Rä¸­å®Œæˆ</a>ã€‚ä¸è¿‡ï¼Œä½ çš„ä¸€äº›ä¸»é¢˜è®¾ç½®å¯èƒ½ä¼šè¢«æ›´æ”¹ï¼Œä¹‹åéœ€è¦æ‰‹åŠ¨ä¿®æ”¹ã€‚æ­¤å¤–ï¼Œé—æ†¾çš„æ˜¯ï¼Œåˆ›å»ºèƒ½å¾ˆå¥½ç¼©æ”¾çš„é¢å›¾æˆ–çœŸæ­£çš„å¤šé¢æ¿å›¾å¹¶ä¸ç®€å•ã€‚<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">g <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>date<span class="punctuation">,</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;grey&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_color_brewer<span class="punctuation">(</span>palette <span class="operator">=</span> <span class="string">&quot;Dark2&quot;</span><span class="punctuation">,</span> guide <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_bw<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb7c714f6f0.png" style="width:600px;"/></div></div></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>plotly<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplotly<span class="punctuation">(</span>g<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb7ceab0d2e.png" style="width:600px;"/></div></div><p>ä¾‹å¦‚ï¼Œè¿™é‡Œä¿ç•™äº†æ•´ä½“ä¸»é¢˜è®¾ç½®ï¼Œä½†å†æ¬¡æ·»åŠ äº†å›¾ä¾‹ã€‚</p><h2 id="ggiraph-å’Œ-ggplot2"><a href="#ggiraph-å’Œ-ggplot2" class="headerlink" title="ggiraph å’Œ ggplot2"></a>ggiraph å’Œ ggplot2</h2><p><a href="https://davidgohel.github.io/ggiraph/index.html">{ggiraph}</a>æ˜¯ä¸€ä¸ª R è½¯ä»¶åŒ…ï¼Œå¯ç”¨äºåˆ›å»ºåŠ¨æ€ {ggplot2} å›¾å½¢ã€‚æ‚¨å¯ä»¥åœ¨å›¾å½¢ä¸­æ·»åŠ å·¥å…·æç¤ºã€åŠ¨ç”»å’Œ JavaScript æ“ä½œã€‚åœ¨ Shiny åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨è¯¥è½¯ä»¶åŒ…æ—¶ï¼Œè¿˜å¯ä»¥é€‰æ‹©å›¾å½¢å…ƒç´ ã€‚</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>ggiraph<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">g <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>chic<span class="punctuation">,</span> aes<span class="punctuation">(</span>date<span class="punctuation">,</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;grey&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point_interactive<span class="punctuation">(</span></span><br><span class="line">    aes<span class="punctuation">(</span>color <span class="operator">=</span> season<span class="punctuation">,</span> tooltip <span class="operator">=</span> season<span class="punctuation">,</span> data_id <span class="operator">=</span> season<span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_color_brewer<span class="punctuation">(</span>palette <span class="operator">=</span> <span class="string">&quot;Dark2&quot;</span><span class="punctuation">,</span> guide <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_bw<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">girafe<span class="punctuation">(</span>ggobj <span class="operator">=</span> g<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb7ebedbf49.png" style="width:600px;"/></div></div><h2 id="Highcharts-é€šè¿‡-highcharter"><a href="#Highcharts-é€šè¿‡-highcharter" class="headerlink" title="Highcharts é€šè¿‡ {highcharter}"></a>Highcharts é€šè¿‡ {highcharter}</h2><p><a href="https://www.highcharts.com/">Highcharts</a>æ˜¯ä¸€ä¸ªç”¨äºäº¤äº’å¼å›¾è¡¨åˆ¶ä½œçš„è½¯ä»¶åº“ï¼Œå®ƒæ˜¯å¦ä¸€ä¸ªç”¨çº¯JavaScriptç¼–å†™çš„å¯è§†åŒ–åº“ï¼Œå·²è¢«ç§»æ¤åˆ°Rè¯­è¨€ä¸­ã€‚</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>highcharter<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">hchart<span class="punctuation">(</span>chic<span class="punctuation">,</span> <span class="string">&quot;scatter&quot;</span><span class="punctuation">,</span> hcaes<span class="punctuation">(</span>x <span class="operator">=</span> date<span class="punctuation">,</span> y <span class="operator">=</span> temp<span class="punctuation">,</span> group <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb7fa570a6b.png" style="width:600px;"/></div></div><h2 id="Echarts-é€šè¿‡-echarts4r"><a href="#Echarts-é€šè¿‡-echarts4r" class="headerlink" title="Echarts é€šè¿‡ {echarts4r}"></a>Echarts é€šè¿‡ {echarts4r}</h2><p><a href="https://echarts.apache.org/en/index.html">Apache ECharts</a>æ˜¯ä¸€ä¸ªå…è´¹ã€åŠŸèƒ½å¼ºå¤§çš„å›¾è¡¨å’Œå¯è§†åŒ–åº“ï¼Œæä¾›äº†ä¸€ç§æ„å»ºç›´è§‚ã€äº¤äº’å¼å’Œé«˜åº¦å¯å®šåˆ¶å›¾è¡¨çš„ç®€å•æ–¹æ³•ã€‚å°½ç®¡å®ƒæ˜¯ç”¨çº¯ JavaScript ç¼–å†™çš„ï¼Œä½†ç”±äº John Coene çš„åŠŸåŠ³ï¼Œäººä»¬å¯ä»¥é€šè¿‡ <a href="https://echarts4r.john-coene.com/">{echarts4r}</a>åº“åœ¨ R ä¸­ä½¿ç”¨å®ƒã€‚è¯·æŸ¥çœ‹ä»¤äººå°è±¡æ·±åˆ»çš„ç¤ºä¾‹å›¾åº“æˆ–è½¯ä»¶åŒ…å¼€å‘è€…<a href="https://john-coene.com/">John Coene</a>åˆ¶ä½œçš„<a href="https://johncoene.shinyapps.io/fopi-contest/">åº”ç”¨ç¨‹åº</a>ã€‚</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>echarts4r<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">chic <span class="operator">|&gt;</span></span><br><span class="line">  e_charts<span class="punctuation">(</span>date<span class="punctuation">)</span> <span class="operator">|&gt;</span></span><br><span class="line">  e_scatter<span class="punctuation">(</span>temp<span class="punctuation">,</span> symbol_size <span class="operator">=</span> <span class="number">7</span><span class="punctuation">)</span> <span class="operator">|&gt;</span></span><br><span class="line">  e_visual_map<span class="punctuation">(</span>temp<span class="punctuation">)</span> <span class="operator">|&gt;</span></span><br><span class="line">  e_y_axis<span class="punctuation">(</span>name <span class="operator">=</span> <span class="string">&quot;Temperature (Â°F)&quot;</span><span class="punctuation">)</span> <span class="operator">|&gt;</span></span><br><span class="line">  e_legend<span class="punctuation">(</span><span class="literal">FALSE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/09/64fb8102872b2.png" style="width:600px;"/></div></div><h2 id="Chart-js-é€šè¿‡-charter"><a href="#Chart-js-é€šè¿‡-charter" class="headerlink" title="Chart.js é€šè¿‡ {charter}"></a>Chart.js é€šè¿‡ {charter}</h2><p><a href="https://github.com/JohnCoene/charter">charter</a>æ˜¯ John Coene å¼€å‘çš„å¦ä¸€ä¸ªè½¯ä»¶åŒ…ï¼Œå¯ä»¥åœ¨ R ä¸­ä½¿ç”¨ JavaScript å¯è§†åŒ–åº“ã€‚é€šè¿‡è¯¥è½¯ä»¶åŒ…ï¼Œæ‚¨å¯ä»¥å€ŸåŠ©<a href="https://www.chartjs.org/">Charts.jsæ¡†æ¶</a>æ„å»ºäº¤äº’å¼å›¾è¡¨ã€‚</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>charter<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">chic<span class="operator">$</span>date_num <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>chic<span class="operator">$</span>date<span class="punctuation">)</span></span><br><span class="line"><span class="comment">## doesn&#x27;t work with class date</span></span><br><span class="line"></span><br><span class="line">chart<span class="punctuation">(</span>data <span class="operator">=</span> chic<span class="punctuation">,</span> caes<span class="punctuation">(</span>date_num<span class="punctuation">,</span> temp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">|&gt;</span></span><br><span class="line">  c_scatter<span class="punctuation">(</span>caes<span class="punctuation">(</span>color <span class="operator">=</span> season<span class="punctuation">,</span> group <span class="operator">=</span> season<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">|&gt;</span></span><br><span class="line">  c_colors<span class="punctuation">(</span>RColorBrewer<span class="operator">::</span>brewer.pal<span class="punctuation">(</span><span class="number">4</span><span class="punctuation">,</span> name <span class="operator">=</span> <span class="string">&quot;Dark2&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>(è¯¥ç¤ºä¾‹åœ¨ Rmarkdown ä¸­ä¸èµ·ä½œç”¨)ã€‚</p><h1 id="å¤‡æ³¨ã€æç¤ºå’Œèµ„æº"><a href="#å¤‡æ³¨ã€æç¤ºå’Œèµ„æº" class="headerlink" title="å¤‡æ³¨ã€æç¤ºå’Œèµ„æº"></a>å¤‡æ³¨ã€æç¤ºå’Œèµ„æº</h1><h2 id="åœ¨å¾ªç¯å’Œå‡½æ•°ä¸­ä½¿ç”¨-ggplot2"><a href="#åœ¨å¾ªç¯å’Œå‡½æ•°ä¸­ä½¿ç”¨-ggplot2" class="headerlink" title="åœ¨å¾ªç¯å’Œå‡½æ•°ä¸­ä½¿ç”¨ ggplot2"></a>åœ¨å¾ªç¯å’Œå‡½æ•°ä¸­ä½¿ç”¨ ggplot2</h2><p>lattice å’Œ ggplot2 ä¸­åŸºäºç½‘æ ¼çš„å›¾å½¢å‡½æ•°ä¼šåˆ›å»ºä¸€ä¸ªå›¾å½¢å¯¹è±¡ã€‚åœ¨å‘½ä»¤è¡Œä¸‹äº¤äº’ä½¿ç”¨è¿™äº›å‡½æ•°æ—¶ï¼Œç»“æœä¼šè‡ªåŠ¨æ‰“å°å‡ºæ¥ï¼Œä½†åœ¨ <mark class="hl-label blue">source()</mark> ä¸­æˆ–è‡ªå·±çš„å‡½æ•°ä¸­ï¼Œåˆ™éœ€è¦æ˜¾å¼<mark class="hl-label blue">print()</mark> è¯­å¥ï¼Œå³æˆ‘ä»¬å¤§å¤šæ•°ç¤ºä¾‹ä¸­çš„<mark class="hl-label blue">print(g)</mark> ã€‚å¦è¯·å‚è§<a href="https://cran.r-project.org/doc/FAQ/R-FAQ.html#Why-do-lattice_002ftrellis-graphics-not-work_003f">Rçš„é—®ç­”é¡µé¢</a>ã€‚</p><h2 id="å…¶ä»–èµ„æº"><a href="#å…¶ä»–èµ„æº" class="headerlink" title="å…¶ä»–èµ„æº"></a>å…¶ä»–èµ„æº</h2><ul><li><a href="https://ggplot2-book.org/">â€œggplot2: Elegant Graphics for Data Analysisâ€</a> by Hadley Wickham, available via open-access!</li><li><a href="http://serialmentor.com/dataviz/">â€œFundamentals of Data Visualizationâ€</a> by Claus O. Wilke about data visualization in general but using - - {ggplot2}. (You can find the codes on <a href="https://github.com/clauswilke/dataviz">his GitHub profile</a>.)</li><li><a href="http://www.cookbook-r.com/Graphs/">â€œCookbook for Râ€</a> by Winston Chang with recipes to produce R plots</li><li>Gallery of the Top <a href="http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html">50 ggplot2 visualizations</a></li><li>Gallery of <a href="https://exts.ggplot2.tidyverse.org/gallery/">{ggplot2} extension packages</a></li><li><a href="https://cran.r-project.org/web/packages/ggplot2/vignettes/extending-ggplot2.html">How to extend {ggplot2}</a> by Hadley Wickham</li><li>The fantastic <a href="https://www.rfordatasci.com/">R4DS Online Learning Community</a> that offers help and mentoring for all things related to - the content of the <a href="https://www.cedricscherer.com/2019/08/05/a-ggplot2-tutorial-for-beautiful-plotting-in-r/r4ds.had.co.nz/">â€œR for Data Scienceâ€ book</a> by Hadley Wickham</li><li><a href="https://github.com/rfordatascience/tidytuesday">#TidyTuesday</a>, a weekly social data project focusing on ggplotsâ€”check also <a href="https://twitter.com/hashtag/TidyTuesday?lang=en">#TidyTuesday</a> on Twitter and <a href="https://www.nsgrantham.com/tidytuesdayrocks">this collection of contributions by Neil Grantham</a></li><li>A two-part, 4.5-hours tutorial series by Thomas Linn Pedersen (<a href="https://www.youtube.com/watch?v=h29g21z0a68">Part 1</a> | <a href="https://www.youtube.com/watch?v=0m4yywqNPVY">Part 2</a>)</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‡†å¤‡&quot;&gt;&lt;a href=&quot;#å‡†å¤‡&quot; class=&quot;headerlink&quot; title=&quot;å‡†å¤‡&quot;&gt;&lt;/a&gt;å‡†å¤‡&lt;/h1&gt;&lt;details class=&quot;folding-tag&quot; green&gt;&lt;summary&gt; æ‰€éœ€RåŒ… &lt;/summary&gt;
            </summary>
      
    
    
    
    <category term="ç”Ÿç‰©ä¿¡æ¯å­¦" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="Rè¯­è¨€" scheme="https://smileszh.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
    <category term="RåŒ…" scheme="https://smileszh.github.io/tags/R%E5%8C%85/"/>
    
  </entry>
  
  <entry>
    <title>GOplotåŒ…</title>
    <link href="https://smileszh.github.io/posts/65ebd0df.html"/>
    <id>https://smileszh.github.io/posts/65ebd0df.html</id>
    <published>2023-07-03T18:00:00.000Z</published>
    <updated>2023-09-04T18:06:37.639Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŠ è½½æ•°æ®"><a href="#åŠ è½½æ•°æ®" class="headerlink" title="åŠ è½½æ•°æ®"></a>åŠ è½½æ•°æ®</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Load the library. -------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">library<span class="punctuation">(</span>GOplot<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Load the dataset. --------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">data<span class="punctuation">(</span>EC<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Get the result from a functions analysis. -------------------------------</span></span><br><span class="line"></span><br><span class="line">head<span class="punctuation">(</span>EC<span class="operator">$</span>david<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Get a list of selected genes and their logFC. ---------------------------</span></span><br><span class="line"></span><br><span class="line">head<span class="punctuation">(</span>EC<span class="operator">$</span>genelist<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate the plotting object --------------------------------------------</span></span><br><span class="line"></span><br><span class="line">circ <span class="operator">&lt;-</span> circle_dat<span class="punctuation">(</span>EC<span class="operator">$</span>david<span class="punctuation">,</span> EC<span class="operator">$</span>genelist<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h1 id="æŸ±çŠ¶å›¾GObar"><a href="#æŸ±çŠ¶å›¾GObar" class="headerlink" title="æŸ±çŠ¶å›¾GObar"></a>æŸ±çŠ¶å›¾GObar</h1><div class="tabs" id="æŸ±çŠ¶å›¾gobar"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="æŸ±çŠ¶å›¾gobar-1">ä¾‹å›¾</button><button type="button" class="tab " data-href="æŸ±çŠ¶å›¾gobar-2">ä»£ç </button></ul><div class="tab-contents"><div class="tab-item-content active" id="æŸ±çŠ¶å›¾gobar-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/07/04/64a309ba7ff08.png" style="width:600px;"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/07/04/64a30f7aba78b.png" style="width:600px;"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/07/04/64a30f71c861c.png" style="width:600px;"/></div></div></div><div class="tab-item-content" id="æŸ±çŠ¶å›¾gobar-2"><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Barplot -----------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate a simple barplot</span></span><br><span class="line">GOBar<span class="punctuation">(</span>subset<span class="punctuation">(</span>circ<span class="punctuation">,</span> category <span class="operator">==</span> <span class="string">&#x27;BP&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Facet the barplot according to the categories of the terms </span></span><br><span class="line">GOBar<span class="punctuation">(</span>circ<span class="punctuation">,</span> display <span class="operator">=</span> <span class="string">&#x27;multiple&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Facet the barplot, add a title and change the colour scale for the z-score</span></span><br><span class="line">GOBar<span class="punctuation">(</span>circ<span class="punctuation">,</span> display <span class="operator">=</span> <span class="string">&#x27;multiple&#x27;</span><span class="punctuation">,</span> </span><br><span class="line">      title <span class="operator">=</span> <span class="string">&#x27;Z-score coloured barplot&#x27;</span><span class="punctuation">,</span> </span><br><span class="line">      zsc.col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;yellow&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;cyan&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="æ°”æ³¡å›¾GObubble"><a href="#æ°”æ³¡å›¾GObubble" class="headerlink" title="æ°”æ³¡å›¾GObubble"></a>æ°”æ³¡å›¾GObubble</h1><div class="tabs" id="æ°”æ³¡å›¾gobubble"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="æ°”æ³¡å›¾gobubble-1">ä¾‹å›¾</button><button type="button" class="tab " data-href="æ°”æ³¡å›¾gobubble-2">ä»£ç </button></ul><div class="tab-contents"><div class="tab-item-content active" id="æ°”æ³¡å›¾gobubble-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/07/04/64a31ff468c29.png" style="width:600px;"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/07/04/64a310cc2c3b9.png" style="width:600px;"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/07/04/64a310cc2c533.png" style="width:600px;"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/07/04/64a310cc2c3e5.png" style="width:600px;"/></div></div></div><div class="tab-item-content" id="æ°”æ³¡å›¾gobubble-2"><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Bubble plot -------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate the bubble plot with a label threshold of 3</span></span><br><span class="line">GOBubble<span class="punctuation">(</span>circ<span class="punctuation">,</span> labels <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Add a title, change the colour of the circles, facet the plot according to the categories and change the label threshold</span></span><br><span class="line">GOBubble<span class="punctuation">(</span>circ<span class="punctuation">,</span> title <span class="operator">=</span> <span class="string">&#x27;Bubble plot&#x27;</span><span class="punctuation">,</span> </span><br><span class="line">         colour <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;darkred&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;gold&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">         display <span class="operator">=</span> <span class="string">&#x27;multiple&#x27;</span><span class="punctuation">,</span> </span><br><span class="line">         labels <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># Colour the background according to the category</span></span><br><span class="line">GOBubble<span class="punctuation">(</span>circ<span class="punctuation">,</span> title <span class="operator">=</span> <span class="string">&#x27;Bubble plot with background colour&#x27;</span><span class="punctuation">,</span> </span><br><span class="line">         display <span class="operator">=</span> <span class="string">&#x27;multiple&#x27;</span><span class="punctuation">,</span></span><br><span class="line">         bg.col <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span> </span><br><span class="line">         labels <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span>  </span><br><span class="line"></span><br><span class="line"><span class="comment"># Reduce redundant terms with a gene overlap &gt;= 0.75...</span></span><br><span class="line">reduced_circ <span class="operator">&lt;-</span> reduce_overlap<span class="punctuation">(</span>circ<span class="punctuation">,</span> overlap <span class="operator">=</span> <span class="number">0.75</span><span class="punctuation">)</span></span><br><span class="line">GOBubble<span class="punctuation">(</span>reduced_circ<span class="punctuation">,</span> labels <span class="operator">=</span> <span class="number">2.8</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="åœˆå›¾GOCircle"><a href="#åœˆå›¾GOCircle" class="headerlink" title="åœˆå›¾GOCircle"></a>åœˆå›¾GOCircle</h1><div class="tabs" id="åœˆå›¾gocircle"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="åœˆå›¾gocircle-1">ä¾‹å›¾</button><button type="button" class="tab " data-href="åœˆå›¾gocircle-2">ä»£ç </button></ul><div class="tab-contents"><div class="tab-item-content active" id="åœˆå›¾gocircle-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/07/04/64a313b7d6ceb.png" style="width:600px;"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/07/04/64a313b7d6ee3.png" style="width:600px;"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/07/04/64a313b7d6ceb.png" style="width:600px;"/></div></div></div><div class="tab-item-content" id="åœˆå›¾gocircle-2"><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># GOcircle ----------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Generate a circular visualization of the results of gene- annotation enrichment analysis</span></span><br><span class="line">GOCircle<span class="punctuation">(</span>circ<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate a circular visualization of selected terms</span></span><br><span class="line">IDs <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;GO:0007507&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;GO:0001568&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;GO:0001944&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;GO:0048729&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;GO:0048514&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;GO:0005886&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;GO:0008092&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;GO:0008047&#x27;</span><span class="punctuation">)</span></span><br><span class="line">GOCircle<span class="punctuation">(</span>circ<span class="punctuation">,</span> nsub <span class="operator">=</span> IDs<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate a circular visualization for 10 terms</span></span><br><span class="line">GOCircle<span class="punctuation">(</span>circ<span class="punctuation">,</span> nsub <span class="operator">=</span> <span class="number">10</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="åœˆå›¾GOChrod"><a href="#åœˆå›¾GOChrod" class="headerlink" title="åœˆå›¾GOChrod"></a>åœˆå›¾GOChrod</h1><div class="tabs" id="åœˆå›¾gochrod"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="åœˆå›¾gochrod-1">ä¾‹å›¾</button><button type="button" class="tab " data-href="åœˆå›¾gochrod-2">ä»£ç </button></ul><div class="tab-contents"><div class="tab-item-content active" id="åœˆå›¾gochrod-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/07/04/64a316d993705.png" style="width:600px;"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/07/04/64a31982d8e0b.png" style="width:600px;"/></div></div></div><div class="tab-item-content" id="åœˆå›¾gochrod-2"><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># GOChrod -----------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Dataset -----------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Define a list of genes which you think are interesting to look at. The item EC$genes of the toy </span></span><br><span class="line"><span class="comment"># sample contains the data frame of selected genes and their logFC. Have a look...</span></span><br><span class="line">head<span class="punctuation">(</span>EC<span class="operator">$</span>genes<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Since we have a lot of significantly enriched processes we selected some specific ones (EC$process)</span></span><br><span class="line">EC<span class="operator">$</span>process</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create the plot chord. ------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The genes and process parameters are optional</span></span><br><span class="line">chord <span class="operator">&lt;-</span> chord_dat<span class="punctuation">(</span>data <span class="operator">=</span> circ<span class="punctuation">,</span> genes <span class="operator">=</span> EC<span class="operator">$</span>genes<span class="punctuation">,</span> process <span class="operator">=</span> EC<span class="operator">$</span>process<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">GOChord<span class="punctuation">(</span>chord<span class="punctuation">,</span> space <span class="operator">=</span> <span class="number">0.02</span><span class="punctuation">,</span> gene.order <span class="operator">=</span> <span class="string">&#x27;logFC&#x27;</span><span class="punctuation">,</span> gene.space <span class="operator">=</span> <span class="number">0.25</span><span class="punctuation">,</span> gene.size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Display only genes which are assigned to at least three processes</span></span><br><span class="line">GOChord<span class="punctuation">(</span>chord<span class="punctuation">,</span> limit <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span> gene.order <span class="operator">=</span> <span class="string">&#x27;logFC&#x27;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="çƒ­å›¾GOHeat"><a href="#çƒ­å›¾GOHeat" class="headerlink" title="çƒ­å›¾GOHeat"></a>çƒ­å›¾GOHeat</h1><div class="tabs" id="goheat"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="goheat-1">ä¾‹å›¾</button><button type="button" class="tab " data-href="goheat-2">ä»£ç </button></ul><div class="tab-contents"><div class="tab-item-content active" id="goheat-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/07/04/64a38be654929.png" style="width:600px;"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/07/04/64a38b6abbb5d.png" style="width:600px;"/></div></div></div><div class="tab-item-content" id="goheat-2"><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># GOHeat ------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">chord <span class="operator">&lt;-</span> chord_dat<span class="punctuation">(</span>data <span class="operator">=</span> circ<span class="punctuation">,</span> genes <span class="operator">=</span> EC<span class="operator">$</span>genes<span class="punctuation">,</span> process <span class="operator">=</span> EC<span class="operator">$</span>process<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># First, we use the chord object without logFC column to create the heatmap</span></span><br><span class="line">GOHeat<span class="punctuation">(</span>chord<span class="punctuation">[</span><span class="punctuation">,</span><span class="operator">-</span><span class="number">8</span><span class="punctuation">]</span><span class="punctuation">,</span> nlfc <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Now we create the heatmap with logFC values and user-defined colour scale</span></span><br><span class="line">GOHeat<span class="punctuation">(</span>chord<span class="punctuation">,</span> nlfc <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> fill.col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;yellow&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="èšç±»å›¾GOCluster"><a href="#èšç±»å›¾GOCluster" class="headerlink" title="èšç±»å›¾GOCluster"></a>èšç±»å›¾GOCluster</h1><div class="tabs" id="èšç±»å›¾"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="èšç±»å›¾-1">ä¾‹å›¾</button><button type="button" class="tab " data-href="èšç±»å›¾-2">ä»£ç </button></ul><div class="tab-contents"><div class="tab-item-content active" id="èšç±»å›¾-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/07/04/64a38d4e26e8b.png" style="width:600px;"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/07/04/64a38d5ac5d79.png" style="width:600px;"/></div></div></div><div class="tab-item-content" id="èšç±»å›¾-2"><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># GOCluster ---------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">GOCluster<span class="punctuation">(</span>circ<span class="punctuation">,</span> EC<span class="operator">$</span>process<span class="punctuation">,</span> clust.by <span class="operator">=</span> <span class="string">&#x27;logFC&#x27;</span><span class="punctuation">,</span> term.width <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">GOCluster<span class="punctuation">(</span>circ<span class="punctuation">,</span> EC<span class="operator">$</span>process<span class="punctuation">,</span> clust.by <span class="operator">=</span> <span class="string">&#x27;term&#x27;</span><span class="punctuation">,</span> lfc.col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;darkgoldenrod1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;cyan1&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="Vennå›¾GOVenn"><a href="#Vennå›¾GOVenn" class="headerlink" title="Vennå›¾GOVenn"></a>Vennå›¾GOVenn</h1><div class="tabs" id="vennå›¾"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="vennå›¾-1">ä¾‹å›¾</button><button type="button" class="tab " data-href="vennå›¾-2">ä»£ç </button></ul><div class="tab-contents"><div class="tab-item-content active" id="vennå›¾-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/07/04/64a390ef605c5.png" style="width:600px;"/></div></div></div><div class="tab-item-content" id="vennå›¾-2"><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># GOVenn ------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">l1 <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>circ<span class="punctuation">,</span> term <span class="operator">==</span> <span class="string">&#x27;heart development&#x27;</span><span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>genes<span class="punctuation">,</span>logFC<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">l2 <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>circ<span class="punctuation">,</span> term <span class="operator">==</span> <span class="string">&#x27;plasma membrane&#x27;</span><span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>genes<span class="punctuation">,</span>logFC<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">l3 <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>circ<span class="punctuation">,</span> term <span class="operator">==</span> <span class="string">&#x27;tissue morphogenesis&#x27;</span><span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>genes<span class="punctuation">,</span>logFC<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">GOVenn<span class="punctuation">(</span>l1<span class="punctuation">,</span>l2<span class="punctuation">,</span>l3<span class="punctuation">,</span> label <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;heart development&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;plasma membrane&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;tissue morphogenesis&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>åœ¨çº¿ä½œå›¾ï¼š<a href="https://wwalter.shinyapps.io/Venn/">VennDiagram</a></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;åŠ è½½æ•°æ®&quot;&gt;&lt;a href=&quot;#åŠ è½½æ•°æ®&quot; class=&quot;headerlink&quot; title=&quot;åŠ è½½æ•°æ®&quot;&gt;&lt;/a&gt;åŠ è½½æ•°æ®&lt;/h1&gt;&lt;figure class=&quot;highlight r&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;s</summary>
      
    
    
    
    <category term="ç”Ÿç‰©ä¿¡æ¯å­¦" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="Rè¯­è¨€" scheme="https://smileszh.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
    <category term="RåŒ…" scheme="https://smileszh.github.io/tags/R%E5%8C%85/"/>
    
    <category term="åŸºå› æ³¨é‡Š" scheme="https://smileszh.github.io/tags/%E5%9F%BA%E5%9B%A0%E6%B3%A8%E9%87%8A/"/>
    
    <category term="GO/KEGG" scheme="https://smileszh.github.io/tags/GO-KEGG/"/>
    
  </entry>
  
  <entry>
    <title>åŸºå› åŠŸèƒ½å¯Œé›†åˆ†æ</title>
    <link href="https://smileszh.github.io/posts/b3231219.html"/>
    <id>https://smileszh.github.io/posts/b3231219.html</id>
    <published>2023-07-02T03:30:00.000Z</published>
    <updated>2023-07-18T12:26:56.496Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸºå› åŠŸèƒ½å¯Œé›†åˆ†æç®—æ³•"><a href="#åŸºå› åŠŸèƒ½å¯Œé›†åˆ†æç®—æ³•" class="headerlink" title="åŸºå› åŠŸèƒ½å¯Œé›†åˆ†æç®—æ³•"></a>åŸºå› åŠŸèƒ½å¯Œé›†åˆ†æç®—æ³•</h1><p><img src="https://bu.dusays.com/2023/06/13/64885e43e32b2.png" alt="åŸºå› å¯Œé›†æ–¹æ³•.png" style="zoom: 50%;" /></p><div class="tabs" id="åŠŸèƒ½å¯Œé›†åˆ†æç®—æ³•"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="åŠŸèƒ½å¯Œé›†åˆ†æç®—æ³•-1">ORA:è¿‡ä»£è¡¨åˆ†æ</button><button type="button" class="tab " data-href="åŠŸèƒ½å¯Œé›†åˆ†æç®—æ³•-2">FCS:åŠŸèƒ½åˆ†ç±»æ‰“åˆ†</button><button type="button" class="tab " data-href="åŠŸèƒ½å¯Œé›†åˆ†æç®—æ³•-3">PT:é€šè·¯æ‹“æ‰‘ç»“æ„åˆ†æ</button><button type="button" class="tab " data-href="åŠŸèƒ½å¯Œé›†åˆ†æç®—æ³•-4">NT:ç½‘ç»œæ‹“æ‰‘ç»“æ„åˆ†æ</button></ul><div class="tab-contents"><div class="tab-item-content active" id="åŠŸèƒ½å¯Œé›†åˆ†æç®—æ³•-1"><div class="note info modern"><p>over-representation analysis: å…ˆè®¡æ•°åŸºå› åˆ—è¡¨ä¸åŸºå› åŠŸèƒ½é›†å…±åŒçš„åŸºå› ,å¹¶åˆ©ç”¨2Ã—2åˆ—è”è¡¨,è¿›è¡ŒFisherç²¾ç¡®æ£€éªŒã€‚æ ¹æ®è¶…å‡ ä½•åˆ†å¸ƒæ¥æ£€éªŒåŸºå› åˆ—è¡¨ä¸­çš„åŸºå› åœ¨å¾…æµ‹åŠŸèƒ½é›†ä¸­æ˜¯å¦æ˜¾è‘—å¯Œé›†ã€‚</p></div><p>ä¼˜ç‚¹ï¼š</p><ul><li>æ¯”è¾ƒå®Œå¤‡çš„ç»Ÿè®¡å­¦ç†è®º,è¾“å‡ºç»“æœæ¯”è¾ƒç¨³å¥ã€å¯é </li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>å®ƒä»…ä»…ä½¿ç”¨äº†åŸºå› çš„æ•°ç›®ä¿¡æ¯ï¼Œè€Œæ²¡æœ‰åˆ©ç”¨åŸºå› è¡¨è¾¾æ°´å¹³æˆ–è¡¨è¾¾å·®å¼‚å€¼</li><li>é€šå¸¸ä»…ä½¿ç”¨æœ€æ˜¾è‘—çš„åŸºå› åºåˆ—ï¼Œè€Œå¿½ç•¥å·®å¼‚ä¸æ˜¾è‘—çš„åŸºå› , å¯¼è‡´æ£€æµ‹çµæ•æ€§çš„é™ä½</li><li>å°†æ¯ä¸€ä¸ªåŸºå› è¿›è¡ŒåŒç­‰å¯¹å¾…ï¼Œå®ƒå¿½è§†äº†åŸºå› åœ¨é€šè·¯å†…éƒ¨ç”Ÿç‰©å­¦æ„ä¹‰çš„ä¸åŒï¼Œä»¥åŠåŸºå› é—´å¤æ‚çš„ç›¸äº’ä½œç”¨</li><li>å‡è®¾é€šè·¯ä¸é€šè·¯é—´æ˜¯ç‹¬ç«‹çš„ï¼Œä½†è¿™ä¸ªå‰æå‡è®¾æ˜¯ä¸å¤ªå‡†ç¡®çš„</li></ul><details class="folding-tag" green><summary> GO/KEGGç»Ÿè®¡å­¦æ–¹æ³•è¯¦è§£ </summary>              <div class='content'>              <p><strong>ç›®å‰æœ‰å¾ˆå¤šå·¥å…·å’Œæ•°æ®åº“æä¾›ORAçš„ä½¿ç”¨ï¼Œå¸¸è§çš„å°±æ˜¯GOå¯Œé›†åˆ†æå’ŒKEGGå¯Œé›†åˆ†æã€‚æˆ‘ä»¬é€šå¸¸é€šè¿‡å¤„ç†äºŒä»£æµ‹åºå’ŒèŠ¯ç‰‡æµ‹åºå¾—åˆ°çš„æ•°æ®ï¼Œè¿›è€Œè®¾ç½®ä¸€å®šå¯¹é˜ˆå€¼ï¼Œå¦‚å·®å¼‚å€æ•°æˆ–På€¼ï¼Œå¾—åˆ°çš„ä¸€ç»„æˆ‘ä»¬æ„Ÿå…´è¶£çš„åŸºå› ï¼Œè¿›è€Œå¯¼å…¥è¿™ä¸ªåŸºå› çš„IDï¼Œå¯¹è¿™äº›åŸºå› è¿›è¡Œæ³¨é‡Šã€‚</strong></p><ul><li><p>GOå¯Œé›†åˆ†æå°†å¯¼å…¥çš„æ¯ä¸€ä¸ªåŸºå› åˆ†åˆ«å¯¹åº”çš„CCã€BPã€MMè¿›è¡Œç½—åˆ—ï¼Œä½¿ç”¨è¶…å‡ ä½•åˆ†å¸ƒæ¥ç¡®å®šè¿™äº›å¯¹åº”çš„é€šè·¯æ˜¯å¦æ˜¯æ˜¾è‘—æ€§å¯Œé›†ï¼š</p><script type="math/tex; mode=display">P = 1-\sum_{i=0}^{k-1}\frac{C^i_MC^{n-i}_{N-M}}{C^n_N}</script><p>N: GOæ³¨é‡Šæ•°æ®åº“ä¸­çš„æ€»åŸºå› æ•°<br>Mï¼šæ•°æ®åº“ä¸­å±äºæŸä¸ªGOå­ç±»çš„åŸºå› æ•°<br>n: è¿›è¡ŒGOå¯Œé›†åˆ†æçš„åŸºå› æ€»æ•°ç›®<br>k: nä¸­å±äºMçš„æ•°ç›®</p></li><li><p>KEGGå¯Œé›†åˆ†æç»“æœç»“æœä½“ç°åœ¨ç”±äºå¤„ç†å¯¼è‡´ä¸ªä½“æˆ–ç»„åŸºå› è¡¨è¾¾å‘ç”Ÿè¾ƒå¤§æ”¹å˜ï¼Œå¯¼è‡´<strong>é€šè·¯</strong>æœ‰è¾ƒå¤§æ”¹å˜ã€‚åŸç†å’Œä¸Šé¢ç±»ä¼¼ã€‚</p></li></ul>              </div>            </details></div><div class="tab-item-content" id="åŠŸèƒ½å¯Œé›†åˆ†æç®—æ³•-2"><div class="note info modern"><p>functional class scoring: ä»¥GSEAä¸ºä¾‹, å¯¹åŸºå› è¡¨è¾¾è°±ä¸­çš„æ‰€æœ‰åŸºå› æŒ‰ç…§ä¸è¡¨å‹çš„å·®å¼‚è¡¨è¾¾ç¨‹åº¦æ’åº,å†åˆ©ç”¨KSæ£€éªŒå¯¹å¾…æµ‹åŠŸèƒ½åŸºå› é›†æ‰“åˆ†,åˆ©ç”¨éšæœºé‡æ’å¾—åˆ°èƒŒæ™¯åˆ†å¸ƒ,æ‰¾å‡ºæ˜¾è‘—å¯Œé›†çš„åŠŸèƒ½åŸºå› é›†ã€‚</p></div><p>ä¼˜ç‚¹ï¼š</p><ul><li>è€ƒè™‘åˆ°äº†åŸºå› è¡¨è¾¾å€¼çš„å±æ€§ä¿¡æ¯é—®é¢˜</li><li>ä»¥å¾…æµ‹åŸºå› åŠŸèƒ½é›†ä¸ºå¯¹è±¡æ¥è¿›è¡Œæ£€éªŒï¼Œä½¿å¾—æ£€æµ‹ç»“æœæ›´åŠ çµæ•åŠæ›´æœ‰é’ˆå¯¹æ€§</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>ç‹¬ç«‹åˆ†ææ¯ä¸€æ¡é€šè·¯ï¼Œä½†åŒä¸€ä¸ªåŸºå› å¯èƒ½æ¶‰åŠå¤šæ¡é€šè·¯ï¼Œä¸åŒé€šè·¯é—´çš„åŸºå› å‡ºç°é‡å ï¼Œæ‰€ä»¥å¯èƒ½ä¼šå¯¼è‡´åˆ«çš„é€šè·¯ç”±äºé‡å åŸºå› é—®é¢˜ï¼Œä¹Ÿå‡ºç°æ˜¾è‘—å¯Œé›†ç°è±¡ã€‚</li><li>ä»æŠŠå¾…æµ‹åŸºå› åŠŸèƒ½é›†ä¸­çš„æ¯ä¸ªåŸºå› ä½œä¸ºç‹¬ç«‹çš„ä¸ªä½“, å¿½ç•¥äº†åŸºå› çš„ç”Ÿç‰©å­¦å±æ€§å’ŒåŸºå› é—´çš„å¤æ‚ç›¸äº’ä½œç”¨å…³ç³»ã€‚ </li></ul><details class="folding-tag" green><summary> GSEAç»Ÿè®¡å­¦æ–¹æ³•è¯¦è§£ </summary>              <div class='content'>              <p><strong>GSEAæ˜¯å¸¸ç”¨çš„ä¸€ç§FCSæ–¹æ³•. å…¶åŸºæœ¬æ€è·¯æ˜¯é¦–å…ˆåŸºäºè¡¨è¾¾å·®å¼‚å€¼å¯¹å…¨åŸºå› ç»„åŸºå› è¿›è¡Œæ’åºå¾—åˆ°åŸºå› åˆ—è¡¨, ç„¶åæ£€éªŒå¾…æµ‹åŸºå› åŠŸèƒ½é›†ä¸­çš„åŸºå› ç›¸å¯¹äºéšæœºæƒ…å†µè€Œè¨€, æ˜¯å¦æ˜¾è‘—åœ°ä½äºåŸºå› åˆ—è¡¨çš„é¡¶ç«¯æˆ–åº•ç«¯, å³å¾…æµ‹åŸºå› é›†çš„è¡¨è¾¾æ°´å¹³åœ¨æ¡ˆä¾‹å’Œå¯¹ç…§å®éªŒçŠ¶æ€ä¸‹æ˜¯å¦å‘ç”Ÿäº†æ˜æ˜¾çš„å˜åŒ–.å…·ä½“è€Œè¨€, GSEA é¦–å…ˆè®¡ç®—äº†æ¯ä¸ªåŸºå› çš„è¡¨è¾¾æ°´å¹³ä¸æ¡ˆä¾‹å’Œå¯¹ç…§ä¸¤ç§çŠ¶æ€ä¸‹çš„å…³è”ç³»æ•°,å¹¶å¯¹å…³è”ç³»æ•°ä»é«˜åˆ°ä½è¿›è¡Œäº†æ’åº; ç„¶å, é’ˆå¯¹ä¸€ç‰¹å®šçš„å¾…æµ‹åŸºå› åŠŸèƒ½é›†, æ ¹æ®å…¶ä¸­æ¯ä¸ªåŸºå› çš„æ’åºæƒ…å†µ,åˆ©ç”¨åŠ æƒçš„è¿‘ä¼¼KSæ£€éªŒ, è·å¾—å¾…æµ‹åŸºå› åŠŸèƒ½é›†åœ¨æ’åºåˆ—è¡¨ä¸­çš„KSæ£€éªŒå€¼â€”â€”â€”â€”ä¹Ÿå³å¾…æµ‹åŸºå› åŠŸèƒ½é›†çš„ç»Ÿè®¡å€¼; ä¸ºæ£€éªŒè§‚å¯Ÿç»Ÿè®¡å€¼çš„æ˜¾è‘—æ€§, GSEA é€šè¿‡å¯¹æ ·æœ¬çš„éšæœºæ’åˆ—æ¥è·å¾—ç»Ÿè®¡å€¼çš„èƒŒæ™¯åˆ†å¸ƒ, å¹¶åˆ©ç”¨è¯¥åˆ†å¸ƒæ¥è¯„ä¼°è§‚å¯Ÿç»Ÿè®¡å€¼çš„På€¼.é™¤å¯¹æ ·æœ¬çš„éšæœºæ’åˆ—å¤–, åœ¨æ ·æœ¬é‡è¾ƒå°‘çš„æƒ…å†µä¸‹, GSEAä¹Ÿå¯ç”¨å¯¹åŸºå› çš„éšæœºæ’åˆ—æ¥ä¼°ç®—å¾…æµ‹åŸºå› åŠŸèƒ½é›†çš„æ˜¾è‘—æ°´å¹³ã€‚</strong></p><p><img src="https://bu.dusays.com/2023/07/03/64a1a7846284f.png" alt="GSEA.png"></p>              </div>            </details></div><div class="tab-item-content" id="åŠŸèƒ½å¯Œé›†åˆ†æç®—æ³•-3"><div class="note info modern"><p>pathway topology: ä»¥Pathway-Expressä¸ºä¾‹,æ ¹æ®ä¸Šä¸‹æ¸¸å…³ç³»å¯¹é€šè·¯è¿›è¡Œæ‰“åˆ†,ä¸Šæ¸¸é€šè·¯å½±å“å› å­è¾ƒå¤§,å¯¹å¾…æµ‹åŸºå› åŠŸèƒ½é›†æ ¹æ®å½±å“å› å­è¿›è¡Œæ‰“åˆ†,ç„¶åæ ¹æ®ç»Ÿè®¡æ£€éªŒæ¨¡å‹è®¡ç®—æ˜¾è‘—ç¨‹åº¦ã€‚</p></div><p>ä¼˜ç‚¹ï¼š</p><ul><li>åŸºäºPTçš„åŸºå› åŠŸèƒ½å¯Œé›†ç®—æ³•å¯¹ç ”ç©¶ä¸€äº›æ¯”è¾ƒå®Œå–„ã€æ‹“æ‰‘ç»“æ„å®Œæ•´çš„é€šè·¯ä¼šæœ‰æ›´å¼ºçš„æ˜¾è‘—æ€§ã€‚</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>ç ”ç©¶è¾ƒå°‘ï¼Œä¿¡æ¯ä¸å®Œå–„çš„é€šè·¯ç¨³å¥å‹è¾ƒå·®</li></ul></div><div class="tab-item-content" id="åŠŸèƒ½å¯Œé›†åˆ†æç®—æ³•-4"><div class="note info modern"><p>network topology: ä»¥NEAä¸ºä¾‹,å°†åŸºå› åˆ—è¡¨æˆ–åŸºå› è¡¨è¾¾è°±å’Œå¾…æµ‹åŸºå› åŠŸèƒ½é›†æ”¾å…¥ç”Ÿç‰©ç½‘ç»œä¸­,è®¡ç®—æ„Ÿå…´è¶£çš„åŸºå› ä¸å¾…æµ‹åŸºå› åŠŸèƒ½é›†åœ¨ç½‘ç»œä¹‹é—´çš„æœ€çŸ­è·ç¦»,é€šè¿‡å¯¹ç½‘ç»œé‡è°ƒå¾—åˆ°èƒŒæ™¯åˆ†å¸ƒ,æ‰¾å‡ºæ˜¾è‘—å¯Œé›†çš„åŸºå› åŠŸèƒ½é›†ã€‚</p></div><p>ä¼˜ç‚¹ï¼š</p><ul><li>åŠ å…¥äº†ç³»ç»Ÿå±‚é¢çš„åŸºå› é‡è¦æ€§ç¨‹åº¦åŠå…³è”ä¿¡æ¯ç­‰å±æ€§æ•°æ®ï¼Œä½¿å¾—é¢„æµ‹ç»“æœæ›´åŠ å‡†ç¡®å¯é </li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>æ›´å¤šä¿¡æ¯çš„åŠ å…¥ä¹Ÿå®¹æ˜“å¯¼è‡´ç®—æ³•è¿‡äºå¤æ‚ï¼Œè®¡ç®—é€Ÿåº¦è¾ƒæ…¢ï¼Œå®ç°éš¾åº¦ä¹Ÿå°±æ›´å¤§ã€‚</li></ul></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="å¯Œé›†åˆ†æåœ¨çº¿å·¥å…·"><a href="#å¯Œé›†åˆ†æåœ¨çº¿å·¥å…·" class="headerlink" title="å¯Œé›†åˆ†æåœ¨çº¿å·¥å…·"></a>å¯Œé›†åˆ†æåœ¨çº¿å·¥å…·</h1><div class="tabs" id="å¯Œé›†åˆ†æåœ¨çº¿å·¥å…·"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="å¯Œé›†åˆ†æåœ¨çº¿å·¥å…·-1">KOBAS</button><button type="button" class="tab " data-href="å¯Œé›†åˆ†æåœ¨çº¿å·¥å…·-2">WebGestalt</button><button type="button" class="tab " data-href="å¯Œé›†åˆ†æåœ¨çº¿å·¥å…·-3">Enrichr</button><button type="button" class="tab " data-href="å¯Œé›†åˆ†æåœ¨çº¿å·¥å…·-4">TAM2.0</button><button type="button" class="tab " data-href="å¯Œé›†åˆ†æåœ¨çº¿å·¥å…·-5">SCPortalen</button></ul><div class="tab-contents"><div class="tab-item-content active" id="å¯Œé›†åˆ†æåœ¨çº¿å·¥å…·-1"><p><a href="http://kobas.cbi.pku.edu.cn/">KOBAS</a></p><ul><li>åŸºå› /è›‹ç™½åŠŸèƒ½æ³¨é‡Šï¼ˆæ³¨é‡Šæ¨¡å—ï¼‰å’ŒåŠŸèƒ½åŸºå› é›†å¯Œé›†ï¼ˆå¯Œé›†æ¨¡å—ï¼‰çš„åœ¨çº¿å·¥å…·</li><li>æ³¨é‡Šæ¨¡å—ï¼šè¾“å…¥åŸºå› åˆ—è¡¨ï¼Œä»é€šè·¯ã€ç–¾ç—…ã€åŸºå› æœ¬ä½“è®ºç­‰å¤šä¸ªæ•°æ®åº“ä¸­æå–åŸºå› åŠŸèƒ½æ³¨é‡Šä¿¡æ¯</li><li>å¯Œé›†æ¨¡å—ï¼šè¾“å…¥åŸºå› åˆ—è¡¨æˆ–åŸºå› è¡¨è¾¾æ•°æ®ï¼Œæ ¹æ®å¤šç§æ–¹æ³•ç”Ÿæˆå¯Œé›†çš„åŸºå› é›†ã€å¯¹åº”çš„åç§°ã€På€¼æˆ–å¯Œé›†æ¦‚ç‡å’Œå¯Œé›†åˆ†æ•° </li><li>æ”¯æŒmicroarrayå’ŒRNA-Seqæ•°æ®çš„åˆ†æ</li></ul></div><div class="tab-item-content" id="å¯Œé›†åˆ†æåœ¨çº¿å·¥å…·-2"><p><a href="https://www.webgestalt.org/">WebGestalt</a> </p><ul><li>åŠŸèƒ½å¯Œé›†åˆ†æåœ¨çº¿å·¥å…·</li><li>æ”¯æŒä¸‰ç§å¯Œé›†åˆ†ææ–¹æ³•ï¼šORAã€GSEAã€NTA</li></ul></div><div class="tab-item-content" id="å¯Œé›†åˆ†æåœ¨çº¿å·¥å…·-3"><p><a href="https://maayanlab.cloud/Enrichr/">Enrichr</a></p><ul><li>ç»¼åˆæ€§åŸºå› å¯Œé›†åˆ†æåœ¨çº¿å·¥å…·</li><li>æ”¯æŒBEDæ ¼å¼å’ŒåŸºå› åˆ—è¡¨çš„è¾“å…¥</li><li>å¯Œé›†åˆ†æçš„æ•°æ®åº“åŒ…æ‹¬Transcriptionï¼ˆè½¬å½•ï¼‰, Pathwaysï¼ˆé€šè·¯ï¼‰, Ontologiesï¼ˆGOï¼‰, Diseases/Drugsï¼ˆç–¾ç—…/è¯ç‰©ï¼‰, Cell typesï¼ˆç»†èƒç±»å‹ï¼‰, Miscï¼ˆæœªåˆ†ç±»æ•°æ®é›†ï¼‰, Legacy, Crowd</li></ul></div><div class="tab-item-content" id="å¯Œé›†åˆ†æåœ¨çº¿å·¥å…·-4"><p><a href="http://www.lirmed.com/tam2/">TAM2.0</a></p><ul><li>miRNAå¯Œé›†ç½‘ç«™</li><li>å°†miRNAåˆ†ä¸ºå…­å¤§ç±»ï¼šmiRNA-family setsï¼ˆmiRNAå®¶æ—ï¼‰ï¼ŒmiRNA cluster setsï¼ˆmiRNAèšç±»ï¼‰ï¼ŒmiRNA-diseaseï¼ˆmiRNAç–¾ç—…ï¼‰ï¼ŒmiRNA-function setsï¼ˆmiRNAåŠŸèƒ½ï¼‰ï¼ŒmiRNA-TF setsï¼ˆmiRNAä¸è½¬å½•å› å­ï¼‰ï¼Œtissue specificity setsï¼ˆç»„ç»‡ç‰¹å¼‚æ€§ï¼‰ã€‚</li><li>â€œAnalysisâ€ï¼šå¯¹ä¸€ä¸ªmiRNAåˆ—è¡¨ï¼Œä»¥æ•°æ®åº“miRNAé›†ä¸ºèƒŒæ™¯è¿›è¡Œå¯Œé›†åˆ†æ</li><li>â€œComparisonâ€ï¼šå¯¹ä¸€ç»„ä¸Šè°ƒå’Œä¸‹è°ƒçš„miRNAåˆ—è¡¨ï¼Œè¯„ä¼°ä¸Šä¸‹è°ƒçš„miRNAä¸ç–¾ç—…å‘ç”Ÿæˆ–æŠ‘åˆ¶çš„å…³ç³»</li><li>â€œQueryâ€ï¼šé€šè¿‡å…³é”®è¯æŸ¥è¯¢ç›¸å…³çš„miRNAé›†</li></ul></div><div class="tab-item-content" id="å¯Œé›†åˆ†æåœ¨çº¿å·¥å…·-5"><p><a href="http://single-cell.riken.jp/SCPortalen_Database/Home/">SCPortalen</a></p><ul><li>å•ç»†èƒåˆ†æåœ¨çº¿å·¥å…·</li></ul></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="GO-KEGGå¯Œé›†åˆ†æ"><a href="#GO-KEGGå¯Œé›†åˆ†æ" class="headerlink" title="GO/KEGGå¯Œé›†åˆ†æ"></a>GO/KEGGå¯Œé›†åˆ†æ</h1><div class="tabs" id="go/keggå¯Œé›†åˆ†æ"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="go/keggå¯Œé›†åˆ†æ-1">GOç®€ä»‹</button><button type="button" class="tab " data-href="go/keggå¯Œé›†åˆ†æ-2">å•åŸºå› GO/KEGGå¯Œé›†åˆ†æåœ¨çº¿å·¥å…·</button><button type="button" class="tab " data-href="go/keggå¯Œé›†åˆ†æ-3">å¤šåŸºå› GO/KEGGå¯Œé›†åˆ†æåœ¨çº¿å·¥å…·</button></ul><div class="tab-contents"><div class="tab-item-content active" id="go/keggå¯Œé›†åˆ†æ-1"><p><a href="http://geneontology.org/">GO</a></p><blockquote><p>Gene Ontology: GOçš„åˆè¡·å°±æ˜¯å¸Œæœ›æä¾›ä¸€ä¸ªèƒ½å¯¹åŸºå› å’ŒåŸºå› äº§ç‰©ç‰¹æ€§ç›¸å…³çš„æœ¯è¯­æˆ–è¯ä¹‰ è¿›è¡Œæç»˜åŠè§£é‡Šçš„å·¥ä½œå¹³å°ï¼Œä»è€Œä½¿ç”Ÿç‰©ä¿¡æ¯å­¦ç ”ç©¶è€…å¯¹åŸºå› å’ŒåŸºå› äº§ç‰©çš„æ•°æ®èƒ½å¤Ÿè¿›è¡Œç»Ÿä¸€çš„å½’çº³ã€å¤„ç†ã€è§£é‡Šå’Œå…±äº«ï¼Œä¾¿äºæˆ‘ä»¬ç†è§£å’Œæ²Ÿé€šã€‚ åŸºå› æœ¬ä½“æ¶‰åŠçš„åŸºå› å’ŒåŸºå› äº§ç‰©è¯æ±‡åˆ†ä¸ºä¸‰å¤§ç±»ï¼Œæ¶µç›–ç”Ÿç‰©å­¦çš„ä¸‰ä¸ªæ–¹é¢ã€‚</p></blockquote><p><strong>GO term åˆ†ç±»</strong></p><ul><li><p><strong>ç»†èƒç»„åˆ†</strong>ï¼ˆcellular componentï¼‰ï¼šç»†èƒçš„æ¯ä¸ªéƒ¨åˆ†å’Œç»†èƒå¤–ç¯å¢ƒã€‚<mark class="hl-label green">åœ¨å“ªé‡Œå‘æŒ¥ä½œç”¨ï¼šå¾€å¾€ç”¨äºæè¿°åŸºå› åœ¨ç»†èƒä¸Šçš„å®šä½ä¿¡æ¯ï¼Œå½“ç ”ç©¶è€…å…³æ³¨ä¸€äº›ç‰¹æ®Šçš„äºšç»†èƒå®šä½ç ”ç©¶çš„æ—¶å€™å…·æœ‰é‡è¦çš„æ„ä¹‰ã€‚</mark> </p></li><li><p><strong>åˆ†å­åŠŸèƒ½</strong>ï¼ˆmolecular functionï¼‰ï¼šå¯ä»¥æè¿°ä¸ºåˆ†å­æ°´å¹³çš„æ´»æ€§ï¼ˆactivityï¼‰ï¼Œå¦‚å‚¬åŒ–ï¼ˆcatalyticï¼‰æˆ–ç»“åˆï¼ˆbindingï¼‰æ´»æ€§ç­‰ã€‚<mark class="hl-label green">åšä»€ä¹ˆå·¥ä½œï¼šç”¨äºæè¿°è›‹ç™½çš„å®é™…ä½œç”¨æ–¹å¼ï¼Œå½“ç ”ç©¶è€…æ›´å…³æ³¨æ•´ä¸ªç”Ÿç‰©å­¦äº‹ä»¶ä¸­è›‹ç™½ä½œç”¨æ–¹å¼ä¸Šçš„å˜åŒ–æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä»è¿™ä¸ªè§’åº¦åˆ‡å…¥ã€‚</mark> </p></li><li><p><strong>ç”Ÿç‰©è¿‡ç¨‹</strong>ï¼ˆbiological processï¼‰ï¼šæ˜¯æŒ‡ç”±ä¸€ä¸ªæˆ–å¤šä¸ªåˆ†å­åŠŸèƒ½æœ‰åºç»„åˆè€Œäº§ç”Ÿçš„ç³»åˆ—äº‹ä»¶ï¼Œä¸€èˆ¬ä¸€ä¸ªè¿‡ç¨‹æ˜¯ç”±å¤šä¸ªä¸åŒçš„æ­¥éª¤ç»„æˆã€‚<mark class="hl-label green">ç›®çš„æ˜¯ä»€ä¹ˆï¼šæ›´è´´è¿‘è¡¨å‹ï¼Œå¾€å¾€å¯ä»¥å¾ˆå¥½åœ°æè¿°æ ·æœ¬çš„å®é™…æƒ…å†µã€‚</mark> </p></li></ul></div><div class="tab-item-content" id="go/keggå¯Œé›†åˆ†æ-2"><details class="folding-tag" cyan><summary> é€šè·¯æ•°æ®åº“ KEGG </summary>              <div class='content'>              <p>1 è¿›å…¥<a href="https://www.genome.jp/kegg/">å®˜ç½‘</a>ï¼Œé€‰æ‹©GENESæ•°æ®åº“</p><p><img src="https://bu.dusays.com/2023/06/13/64887f9303e67.png" alt="å•åŸºå› 1.png"  /></p><p>2 è¾“å…¥æŸ¥è¯¢å•ä¸ªåŸºå› ä¿¡æ¯</p><p><img src="https://bu.dusays.com/2023/06/13/648880cd8c041.png" alt="å•åŸºå› 2â€”â€”tets.png"  /></p><p>3 æŸ¥çœ‹è¾“å‡ºç»“æœ</p><p><img src="https://bu.dusays.com/2023/06/20/6491b9e2a8e95.png" alt="Screenshot 2023-06-20 at 22.38.04.png"></p><p>4 å¯é€‰æ‹©æ¶‰åŠé€šè·¯å…·ä½“æŸ¥çœ‹</p><p><img src="https://bu.dusays.com/2023/06/13/64887f9307fcd.png" alt="å•åŸºå› 4.png" style="zoom:50%;" /></p><p>5 å¯è¿”å›ä¸»é¡µæœç´¢åŸºå› åæŸ¥çœ‹å¤šç‰©ç§åŸºå› å¯Œé›†ä¿¡æ¯</p><p><img src="https://bu.dusays.com/2023/06/13/64887f930f999.png" alt="å•åŸºå› 5.png"  /></p><p><img src="https://bu.dusays.com/2023/06/13/64887f9303eeb.png" alt="å•åŸºå› 6.png"  /></p>              </div>            </details><details class="folding-tag" cyan><summary> é€šè·¯æ•°æ®åº“ Reactome </summary>              <div class='content'>              <ul><li>é€šè·¯çŸ¥è¯†çš„å¯è§†åŒ–ã€è§£é‡Šå’Œåˆ†ææä¾›ç›´è§‚çš„ç”Ÿç‰©ä¿¡æ¯å­¦å·¥å…·ã€‚</li><li>Reactomeæ˜¯reactionï¼ˆååº”ï¼‰+ omeï¼ˆç»„ï¼‰çš„åˆæˆè¯ï¼Œååº”å¯ä»¥è¢«è§†ä¸ºé€”å¾„çš„â€œæ­¥éª¤â€ã€‚Reactomeå°†â€œååº”â€å®šä¹‰ä¸ºç”Ÿç‰©å­¦ä¸­ä»»ä½•æ”¹å˜ç”Ÿç‰©åˆ†å­çŠ¶æ€çš„äº‹ä»¶ï¼Œ æ¶‰åŠå‚¬åŒ–å‰‚çš„ç»“åˆã€æ´»åŒ–ã€æ˜“ä½ã€é™è§£å’Œç»å…¸ç”Ÿç‰©åŒ–å­¦äº‹ä»¶ã€‚å› æ­¤ï¼ŒReactomeæ•°æ®æ¨¡å‹çš„æ ¸å¿ƒå•å…ƒæ˜¯ååº”ï¼ˆreactionï¼‰ï¼Œå‚ä¸ååº”çš„å®ä½“ï¼ˆæ ¸é…¸ã€è›‹ç™½è´¨ã€å¤åˆç‰©å‰‚å’Œå°åˆ†å­ï¼‰å½¢æˆç”Ÿç‰©ç›¸äº’ä½œç”¨çš„ç½‘ç»œå¹¶è¢«åˆ†ç»„æˆé€šè·¯ã€‚</li></ul><p>1 è¿›å…¥<a href="https://reactome.org/">å®˜ç½‘</a>ï¼Œé€‰æ‹©Pathway Browser</p><p><img src="https://bu.dusays.com/2023/06/18/648de316e5c13.png" alt="react_4.png"></p><p>2 è¾“å…¥ç›¸å…³ä¿¡æ¯æŸ¥çœ‹ç»“æœ</p><p><img src="https://bu.dusays.com/2023/06/18/648de316e5bca.png" alt="react_5.png"></p><p>3 ä¹Ÿå¯è¿›å…¥Analysis Toolsè¿›è¡Œå¤šä¸ªåŸºå› é€šè·¯æŸ¥çœ‹</p><p><img src="https://bu.dusays.com/2023/06/18/648de316e5cad.png" alt="reacctome_1.png"></p><p><img src="https://bu.dusays.com/2023/06/18/648de316e654f.png" alt="reactome_2.png"></p><p><img src="https://bu.dusays.com/2023/06/18/648de316e9490.png" alt="reactome_3.png"></p>              </div>            </details><details class="folding-tag" cyan><summary> GeneCards </summary>              <div class='content'>              <p><a href="https://www.genecards.org/">GeneCards</a></p><ul><li>äººç±»åŸºå› æ•°æ®åº“</li></ul><p><img src="https://bu.dusays.com/2023/06/18/648de5698bf4d.png" alt="Screenshot 2023-06-18 at 00.52.36.png"><br><img src="https://bu.dusays.com/2023/06/18/648de5698bf4d.png" alt="Screenshot 2023-06-18 at 00.53.16.png"></p>              </div>            </details><details class="folding-tag" cyan><summary> Uniprot </summary>              <div class='content'>              <p><a href="https://www.uniprot.org/">Uniprot</a></p><p>1 è¾“å…¥åŸºå› </p><p><img src="https://bu.dusays.com/2023/06/18/648de75d8f607.png" alt="Screenshot 2023-06-18 at 00.57.30.png"></p><p>2 é€‰æ‹©éœ€è¦çš„ç»“æœ</p><p><img src="https://bu.dusays.com/2023/06/18/648de75d330d0.png" alt="Screenshot 2023-06-18 at 00.57.45.png"></p><p>3 è¯¦ç»†æŸ¥çœ‹éœ€è¦çš„ä¿¡æ¯</p><p><img src="https://bu.dusays.com/2023/06/18/648de75d330d0.png" alt="Screenshot 2023-06-18 at 01.01.44.png"></p>              </div>            </details></div><div class="tab-item-content" id="go/keggå¯Œé›†åˆ†æ-3"><details class="folding-tag" cyan><summary> DAVID </summary>              <div class='content'>              <p><a href="https://david.ncifcrf.gov/">DAVID</a>æ•°æ®åº“</p><ul><li>ä¸»è¦ç”¨äºå·®å¼‚åŸºå› çš„åŠŸèƒ½å’Œé€šè·¯å¯Œé›†åˆ†æ</li></ul><p>1 æ‰“å¼€å®˜ç½‘ï¼Œé€‰æ‹©Functional Annotation</p><p><img src="https://bu.dusays.com/2023/06/18/648df0cbddbc9.png" alt="Screenshot 2023-06-18 at 01.23.01.png"  /></p><p>2 è¾“å…¥éœ€è¦åˆ†æçš„åŸºå› é›†</p><p><img src="https://bu.dusays.com/2023/06/18/648df0cbbc11c.png" alt="Screenshot 2023-06-18 at 01.19.19.png"  /></p><p>3 é€‰æ‹©ç‰©ç§</p><p><img src="https://bu.dusays.com/2023/06/18/648df0cbb80e7.png" alt="Screenshot 2023-06-18 at 01.19.57.png"  /></p><p>4 é€‰æ‹©èƒŒæ™¯åŸºå› é›†</p><p><img src="https://bu.dusays.com/2023/06/18/648df0cbb82c3.png" alt="Screenshot 2023-06-18 at 01.20.37.png"  /></p><p>5 æŸ¥çœ‹ç»“æœä¿¡æ¯</p><p><img src="https://bu.dusays.com/2023/06/18/648df0cbb80e7.png" alt="Screenshot 2023-06-18 at 01.21.32.png"  /></p>              </div>            </details><details class="folding-tag" cyan><summary> Metascape </summary>              <div class='content'>              <p><a href="https://metascape.org/gp/#/main/step1">Metascape</a>æ•°æ®åº“</p><p>1 è¾“å…¥åŸºå› é›†</p><p><img src="https://bu.dusays.com/2023/06/20/6491bc5b88978.png" alt="Screenshot 2023-06-20 at 22.43.07.png"></p><p>2 é€‰æ‹©ç‰©ç§ä¿¡æ¯</p><p><img src="https://bu.dusays.com/2023/06/20/6491bc5b85776.png" alt="Screenshot 2023-06-20 at 22.43.51.png"></p><p>3 æŸ¥çœ‹åˆ†æç»“æœ</p><p><img src="https://bu.dusays.com/2023/06/20/6491bc5b7e12d.png" alt="Screenshot 2023-06-20 at 22.45.32.png"></p>              </div>            </details></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><details class="folding-tag" ><summary> å‚è€ƒèµ„æ–™ </summary>              <div class='content'>              <p><strong>æ–‡çŒ®</strong><br><a href="https://kns.cnki.net/kcms2/article/abstract?v=3uoqIhG8C44YLTlOAiTRKibYlV5Vjs7ijP0rjQD-AVm8oHBO0FTadqb8FqjcBpcDcidf-ZdGEi_ZrsFmD6Gl7-0hyOUbZkl8&amp;uniplatform=NZKPT">ç‹æ½‡,å°¹å¤©èˆ’,ææŸé€¸ç­‰.åŸºå› åŠŸèƒ½å¯Œé›†åˆ†æçš„ç ”ç©¶è¿›å±•[J].ä¸­å›½ç§‘å­¦:ç”Ÿå‘½ç§‘å­¦,2016,46(04):363-373.</a></p><p><strong>èµ„æ–™</strong><br><a href="https://space.bilibili.com/254040065?spm_id_from=333.337.0.0">è§£èºæ—‹</a><br><a href="https://www.bilibili.com/video/BV1MN4y1V7Gv/?spm_id_from=333.880.my_history.page.click&amp;vd_source=2fc0eac1995e2bcd209e8b17b7174cd8">æ–¹è¶…å­¦é•¿</a></p><p><strong>æ•°æ®</strong><br><a href="https://yun.console.xlj0.com/s/yDbsk">æ¨¡æ‹Ÿæ•°æ®</a></p>              </div>            </details>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;åŸºå› åŠŸèƒ½å¯Œé›†åˆ†æç®—æ³•&quot;&gt;&lt;a href=&quot;#åŸºå› åŠŸèƒ½å¯Œé›†åˆ†æç®—æ³•&quot; class=&quot;headerlink&quot; title=&quot;åŸºå› åŠŸèƒ½å¯Œé›†åˆ†æç®—æ³•&quot;&gt;&lt;/a&gt;åŸºå› åŠŸèƒ½å¯Œé›†åˆ†æç®—æ³•&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;https://bu.dusays.com/2023/0</summary>
      
    
    
    
    <category term="ç”Ÿç‰©ä¿¡æ¯å­¦" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="Rè¯­è¨€" scheme="https://smileszh.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
    <category term="æ•°æ®åº“" scheme="https://smileszh.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    <category term="å¯Œé›†åˆ†æ" scheme="https://smileszh.github.io/tags/%E5%AF%8C%E9%9B%86%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>Rè¯­è¨€ç»˜å›¾</title>
    <link href="https://smileszh.github.io/posts/839f439e.html"/>
    <id>https://smileszh.github.io/posts/839f439e.html</id>
    <published>2023-06-30T18:00:00.000Z</published>
    <updated>2023-12-08T12:46:53.311Z</updated>
    
    <content type="html"><![CDATA[<h1 id="çƒ­å›¾"><a href="#çƒ­å›¾" class="headerlink" title="çƒ­å›¾"></a>çƒ­å›¾</h1><h2 id="å·®å¼‚åŸºå› çƒ­å›¾ç»˜åˆ¶"><a href="#å·®å¼‚åŸºå› çƒ­å›¾ç»˜åˆ¶" class="headerlink" title="å·®å¼‚åŸºå› çƒ­å›¾ç»˜åˆ¶"></a>å·®å¼‚åŸºå› çƒ­å›¾ç»˜åˆ¶</h2><div class="tabs" id="å·®å¼‚åŸºå› çƒ­å›¾"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="å·®å¼‚åŸºå› çƒ­å›¾-1">ç»“æœå±•ç¤º</button><button type="button" class="tab " data-href="å·®å¼‚åŸºå› çƒ­å›¾-2">æ‰€éœ€æ•°æ®</button><button type="button" class="tab " data-href="å·®å¼‚åŸºå› çƒ­å›¾-3">ä»£ç </button><button type="button" class="tab " data-href="å·®å¼‚åŸºå› çƒ­å›¾-4">å¤‡æ³¨</button></ul><div class="tab-contents"><div class="tab-item-content active" id="å·®å¼‚åŸºå› çƒ­å›¾-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/07/01/649f167cd0737.png" style="width:300px;"/></div></div></div><div class="tab-item-content" id="å·®å¼‚åŸºå› çƒ­å›¾-2"><p><a href="https://tooc.web.xlj0.com/uploads/R%E8%AF%AD%E8%A8%80%E7%BB%98%E5%9B%BE/results.csv">DESeq2æˆ–edgeRå·®å¼‚è¡¨è¾¾åˆ†æåæ•°æ®</a></p></div><div class="tab-item-content" id="å·®å¼‚åŸºå› çƒ­å›¾-3"><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Create heat map from a differential expression count table.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Load the library.</span></span><br><span class="line">suppressPackageStartupMessages<span class="punctuation">(</span>library<span class="punctuation">(</span>gplots<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The name of the file that contains the counts.</span></span><br><span class="line">count_file <span class="operator">=</span> <span class="string">&quot;results.csv&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The name of the output file.</span></span><br><span class="line">output_file <span class="operator">=</span> <span class="string">&quot;heatmap.pdf&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Inform the user.</span></span><br><span class="line">print<span class="punctuation">(</span><span class="string">&quot;# Tool: Create Heatmap &quot;</span><span class="punctuation">)</span></span><br><span class="line">print<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&quot;# Input: &quot;</span><span class="punctuation">,</span> count_file<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">print<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&quot;# Output: &quot;</span><span class="punctuation">,</span> output_file<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># FDR cutoff.</span></span><br><span class="line">MIN_FDR <span class="operator">=</span> <span class="number">0.05</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot width</span></span><br><span class="line">WIDTH <span class="operator">=</span> <span class="number">12</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot height.</span></span><br><span class="line">HEIGHT <span class="operator">=</span> <span class="number">13</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the margins</span></span><br><span class="line">MARGINS <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">9</span><span class="punctuation">,</span> <span class="number">12</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Relative heights of the rows in the plot.</span></span><br><span class="line">LHEI <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Read normalized counts from the standard input.</span></span><br><span class="line">data <span class="operator">=</span> read.csv<span class="punctuation">(</span>count_file<span class="punctuation">,</span> header<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">,</span> as.is<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Subset data for values under a treshold.</span></span><br><span class="line">data <span class="operator">=</span> subset<span class="punctuation">(</span>data<span class="punctuation">,</span> data<span class="operator">$</span>FDR <span class="operator">&lt;=</span> MIN_FDR<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The heatmap row names will be taken from the first column.</span></span><br><span class="line">row_names <span class="operator">=</span> data<span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The code assumes that the normalized data matrix is listed to the right of the falsePos column.</span></span><br><span class="line">idx <span class="operator">=</span> which<span class="punctuation">(</span>colnames<span class="punctuation">(</span>data<span class="punctuation">)</span> <span class="operator">==</span> <span class="string">&quot;falsePos&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The normalized counts are on the right size.</span></span><br><span class="line">counts <span class="operator">=</span> data<span class="punctuation">[</span><span class="punctuation">,</span> idx <span class="operator">:</span> ncol<span class="punctuation">(</span>data<span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Load the data from the second column on.</span></span><br><span class="line">values <span class="operator">=</span> as.matrix<span class="punctuation">(</span>counts<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Adds a little noise to each element to avoid the</span></span><br><span class="line"><span class="comment"># clustering function failure on zero variance rows.</span></span><br><span class="line">values <span class="operator">=</span> jitter<span class="punctuation">(</span>values<span class="punctuation">,</span> factor <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> amount <span class="operator">=</span> <span class="number">0.00001</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Normalize each row to a z-score</span></span><br><span class="line">zscores <span class="operator">=</span> <span class="literal">NULL</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span> <span class="operator">:</span> nrow<span class="punctuation">(</span>values<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  row <span class="operator">=</span> values<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">  zrow <span class="operator">=</span> <span class="punctuation">(</span>row <span class="operator">-</span> mean<span class="punctuation">(</span>row<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">/</span> sd<span class="punctuation">(</span>row<span class="punctuation">)</span></span><br><span class="line">  zscores <span class="operator">=</span> rbind<span class="punctuation">(</span>zscores<span class="punctuation">,</span> zrow<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the row names on the zscores.</span></span><br><span class="line">row.names<span class="punctuation">(</span>zscores<span class="punctuation">)</span> <span class="operator">=</span> row_names</span><br><span class="line"></span><br><span class="line"><span class="comment"># Turn the data into a matrix for heatmap2.</span></span><br><span class="line">zscores <span class="operator">=</span> as.matrix<span class="punctuation">(</span>zscores<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the color palette.</span></span><br><span class="line">col <span class="operator">=</span> greenred</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a PDF device</span></span><br><span class="line">pdf<span class="punctuation">(</span>output_file<span class="punctuation">,</span> width <span class="operator">=</span> WIDTH<span class="punctuation">,</span> height <span class="operator">=</span> HEIGHT<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">heatmap.2<span class="punctuation">(</span>zscores<span class="punctuation">,</span> col<span class="operator">=</span>col<span class="punctuation">,</span> density.info<span class="operator">=</span><span class="string">&quot;none&quot;</span><span class="punctuation">,</span> Colv<span class="operator">=</span><span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">    dendrogram<span class="operator">=</span><span class="string">&quot;row&quot;</span><span class="punctuation">,</span> trace<span class="operator">=</span><span class="string">&quot;none&quot;</span><span class="punctuation">,</span> margins<span class="operator">=</span>MARGINS<span class="punctuation">,</span> lhei<span class="operator">=</span>LHEI<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="å·®å¼‚åŸºå› çƒ­å›¾-4"><ul><li>è®¾ç½®å·®å¼‚åŸºå› ç­›é€‰æ¡ä»¶ä¸ºFDR &lt; 0.05, è¿˜å¯ä»¥æ ¹æ®éœ€è¦è®¾ç½®å·®å¼‚å€æ•°ï¼Œç­›é€‰å‡ºéœ€è¦ç”»å›¾çš„åŸºå› </li><li>ä»£ç é»˜è®¤å½’ä¸€åŒ–çš„çŸ©é˜µåœ¨â€falsePosâ€åˆ—çš„å³ä¾§ï¼Œå¦‚æœä¸ä¸€è‡´ï¼Œéœ€å¦è¡Œè°ƒæ•´ä»£ç </li></ul></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="ç«å±±å›¾"><a href="#ç«å±±å›¾" class="headerlink" title="ç«å±±å›¾"></a>ç«å±±å›¾</h1><div class="tabs" id="ç«å±±å›¾"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="ç«å±±å›¾-1">ç»“æœå±•ç¤º</button><button type="button" class="tab " data-href="ç«å±±å›¾-2">æ‰€éœ€æ•°æ®</button><button type="button" class="tab " data-href="ç«å±±å›¾-3">ä»£ç </button></ul><div class="tab-contents"><div class="tab-item-content active" id="ç«å±±å›¾-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/24/650fac2561f55.png" style="width:300px;"/></div></div></div><div class="tab-item-content" id="ç«å±±å›¾-2"><p><a href="https://tooc.web.xlj0.com/uploads/R%E8%AF%AD%E8%A8%80%E7%BB%98%E5%9B%BE/%E7%81%AB%E5%B1%B1%E5%9B%BE.csv">ç«å±±å›¾æ•°æ®</a></p></div><div class="tab-item-content" id="ç«å±±å›¾-3"><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># Loading library</span></span><br><span class="line">library<span class="punctuation">(</span>tidyverse<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>readxl<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Import data</span></span><br><span class="line">data <span class="operator">&lt;-</span> read_xlsx<span class="punctuation">(</span><span class="string">&quot;å…¨éƒ¨æ•°æ®.xlsx&quot;</span><span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line">str<span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Pretreat data</span></span><br><span class="line">data<span class="operator">$</span>Status<span class="punctuation">[</span>data<span class="operator">$</span>LOG2FC <span class="operator">&gt;</span> <span class="number">1.2</span> <span class="operator">&amp;</span> data<span class="operator">$</span>P.value<span class="operator">&lt;</span><span class="number">0.05</span> <span class="operator">&amp;</span> data<span class="operator">$</span>OPLSDA.VIP <span class="operator">&gt;</span> <span class="number">1</span> <span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;Up-regulated&quot;</span></span><br><span class="line">data<span class="operator">$</span>Status<span class="punctuation">[</span>data<span class="operator">$</span>LOG2FC <span class="operator">&lt;</span> <span class="operator">-</span><span class="number">1.2</span> <span class="operator">&amp;</span> data<span class="operator">$</span>P.value<span class="operator">&lt;</span><span class="number">0.05</span> <span class="operator">&amp;</span> data<span class="operator">$</span>OPLSDA.VIP <span class="operator">&gt;</span> <span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;Down-regulated&quot;</span></span><br><span class="line">data<span class="operator">$</span>Status<span class="punctuation">[</span><span class="built_in">is.na</span><span class="punctuation">(</span>data<span class="operator">$</span>Status<span class="punctuation">)</span><span class="punctuation">]</span>  <span class="operator">&lt;-</span> <span class="string">&quot;Insignificant Change&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot volcano chart</span></span><br><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> data<span class="punctuation">,</span> aes<span class="punctuation">(</span>LOG2FC<span class="punctuation">,</span><span class="operator">-</span>log10<span class="punctuation">(</span>P.value<span class="punctuation">)</span><span class="punctuation">,</span> color <span class="operator">=</span> Status<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_hline<span class="punctuation">(</span>yintercept <span class="operator">=</span> <span class="operator">-</span>log10<span class="punctuation">(</span><span class="number">0.05</span><span class="punctuation">)</span><span class="punctuation">,</span>linetype <span class="operator">=</span> <span class="string">&quot;dashed&quot;</span><span class="punctuation">,</span>color <span class="operator">=</span><span class="string">&quot;#999999&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_vline<span class="punctuation">(</span>xintercept <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span>linetype <span class="operator">=</span> <span class="string">&quot;dashed&quot;</span><span class="punctuation">,</span>color <span class="operator">=</span><span class="string">&quot;#999999&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>size<span class="operator">=</span> OPLSDA.VIP<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_size<span class="punctuation">(</span><span class="built_in">range</span> <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_color_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;dodgerblue&quot;</span><span class="punctuation">,</span><span class="string">&quot;gray&quot;</span><span class="punctuation">,</span><span class="string">&quot;firebrick&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme_bw<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="éŸ¦æ©å›¾"><a href="#éŸ¦æ©å›¾" class="headerlink" title="éŸ¦æ©å›¾"></a>éŸ¦æ©å›¾</h1><div class="tabs" id="éŸ¦æ©å›¾"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="éŸ¦æ©å›¾-1">ç»“æœå±•ç¤º</button><button type="button" class="tab " data-href="éŸ¦æ©å›¾-2">æ‰€éœ€æ•°æ®</button><button type="button" class="tab " data-href="éŸ¦æ©å›¾-3">ä»£ç </button></ul><div class="tab-contents"><div class="tab-item-content active" id="éŸ¦æ©å›¾-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/10/28/653d1ebd2e8a0.jpg" style="width:300px;"/></div></div></div><div class="tab-item-content" id="éŸ¦æ©å›¾-2"><p><a href="https://tooc.web.xlj0.com/uploads/R%E8%AF%AD%E8%A8%80%E7%BB%98%E5%9B%BE/NaB_T1VSNaB_C1_down.targetList.xls">éŸ¦æ©å›¾æ•°æ®1</a></p><p><a href="https://tooc.web.xlj0.com/uploads/R%E8%AF%AD%E8%A8%80%E7%BB%98%E5%9B%BE/NaB_T1VSNaB_C1_up.targetList.xls">éŸ¦æ©å›¾æ•°æ®2</a></p></div><div class="tab-item-content" id="éŸ¦æ©å›¾-3"><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">library<span class="punctuation">(</span>tidyverse<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>VennDiagram<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">k9_up <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;NaB_T1VSNaB_C1_up.targetList.xls&quot;</span><span class="punctuation">)</span></span><br><span class="line">k9_down <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;NaB_T1VSNaB_C1_down.targetList.xls&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">H3K9ac_up <span class="operator">&lt;-</span> unique<span class="punctuation">(</span>k9_up<span class="punctuation">)</span></span><br><span class="line">H3K9ac_down <span class="operator">&lt;-</span> unique<span class="punctuation">(</span>k9_down<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data <span class="operator">&lt;-</span> <span class="built_in">list</span><span class="punctuation">(</span>H3K9ac_up<span class="operator">$</span>V1<span class="punctuation">,</span> H3K9ac_down<span class="operator">$</span>V1<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">venn.diagram<span class="punctuation">(</span>data<span class="punctuation">,</span> fill <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#FFB5BF&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#97C8E0&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">             alpha <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span> label.col <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span></span><br><span class="line">             cex <span class="operator">=</span> <span class="number">1.5</span><span class="punctuation">,</span> cat.col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#FFB5BF&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#97C8E0&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">             cat.cex <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> cat.fontface <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">,</span></span><br><span class="line">             label.cex <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">,</span></span><br><span class="line">             filename <span class="operator">=</span> <span class="string">&quot;~/Desktop/H3K9ac_ven.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">             category <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;UP&quot;</span><span class="punctuation">,</span> <span class="string">&quot;DOWN&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="ä¹è±¡é™å›¾"><a href="#ä¹è±¡é™å›¾" class="headerlink" title="ä¹è±¡é™å›¾"></a>ä¹è±¡é™å›¾</h1><div class="tabs" id="ä¹è±¡é™å›¾"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="ä¹è±¡é™å›¾-1">ç»“æœå±•ç¤º</button><button type="button" class="tab " data-href="ä¹è±¡é™å›¾-2">æ‰€éœ€æ•°æ®</button><button type="button" class="tab " data-href="ä¹è±¡é™å›¾-3">ä»£ç </button></ul><div class="tab-contents"><div class="tab-item-content active" id="ä¹è±¡é™å›¾-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/11/10/654de63140f21.png" style="width:300px;"/></div></div></div><div class="tab-item-content" id="ä¹è±¡é™å›¾-2"><p><a href="https://tooc.web.xlj0.com/uploads/R%E8%AF%AD%E8%A8%80%E7%BB%98%E5%9B%BE/common.csv">ä¹è±¡é™å›¾</a></p></div><div class="tab-item-content" id="ä¹è±¡é™å›¾-3"><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># load package ------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">library<span class="punctuation">(</span>tidyverse<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># loda data ---------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">com <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&quot;common.csv&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># clean data --------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">com<span class="operator">$</span>DEG <span class="operator">&lt;-</span> ifelse<span class="punctuation">(</span>com<span class="operator">$</span>RNA_log2FC <span class="operator">&gt;</span> <span class="number">1</span> <span class="operator">&amp;</span> com<span class="operator">$</span>H3K9ac_log2FC <span class="operator">&gt;</span> <span class="number">1</span><span class="punctuation">,</span> <span class="string">&quot;UP-UP&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  ifelse<span class="punctuation">(</span>com<span class="operator">$</span>RNA_log2FC <span class="operator">&lt;</span> <span class="operator">-</span><span class="number">1</span> <span class="operator">&amp;</span> com<span class="operator">$</span>H3K9ac_log2FC <span class="operator">&lt;</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="string">&quot;DOWN-DOWN&quot;</span><span class="punctuation">,</span></span><br><span class="line">                         ifelse<span class="punctuation">(</span>com<span class="operator">$</span>RNA_log2FC <span class="operator">&gt;</span> <span class="number">1</span> <span class="operator">&amp;</span> com<span class="operator">$</span>H3K9ac_log2FC <span class="operator">&lt;</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="string">&quot;UP-DOWN&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                ifelse<span class="punctuation">(</span>com<span class="operator">$</span>RNA_log2FC <span class="operator">&lt;</span> <span class="operator">-</span><span class="number">1</span> <span class="operator">&amp;</span> com<span class="operator">$</span>H3K9ac_log2FC <span class="operator">&gt;</span> <span class="number">1</span><span class="punctuation">,</span> <span class="string">&quot;DOWN-UP&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                       <span class="string">&quot;NONE&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># plot image --------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>com<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> RNA_log2FC<span class="punctuation">,</span> y<span class="operator">=</span>H3K9ac_log2FC<span class="punctuation">,</span> colour<span class="operator">=</span>DEG<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>alpha<span class="operator">=</span><span class="number">0.85</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">1</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_vline<span class="punctuation">(</span>xintercept<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span>lty<span class="operator">=</span><span class="number">4</span><span class="punctuation">,</span>col<span class="operator">=</span><span class="string">&quot;black&quot;</span><span class="punctuation">,</span>lwd<span class="operator">=</span><span class="number">0.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_hline<span class="punctuation">(</span>yintercept<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span>lty<span class="operator">=</span><span class="number">4</span><span class="punctuation">,</span>col<span class="operator">=</span><span class="string">&quot;black&quot;</span><span class="punctuation">,</span>lwd<span class="operator">=</span><span class="number">0.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_color_manual<span class="punctuation">(</span>values<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;steelblue&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#03BF7D&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span>  <span class="string">&#x27;#AEAF31&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;brown&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_bw<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  guides<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>plot.margin <span class="operator">=</span> unit<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x<span class="operator">=</span><span class="string">&quot;RNA-Seq_log2FC&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&quot;H3K9ac_com.pdf&quot;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">15</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">15</span><span class="punctuation">,</span> units <span class="operator">=</span> <span class="string">&quot;cm&quot;</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="æ•£ç‚¹å›¾-ç®±çº¿å›¾-å°æç´å›¾-tæ£€éªŒ-å¾ªç¯"><a href="#æ•£ç‚¹å›¾-ç®±çº¿å›¾-å°æç´å›¾-tæ£€éªŒ-å¾ªç¯" class="headerlink" title="æ•£ç‚¹å›¾+ç®±çº¿å›¾+å°æç´å›¾+tæ£€éªŒ+å¾ªç¯"></a>æ•£ç‚¹å›¾+ç®±çº¿å›¾+å°æç´å›¾+tæ£€éªŒ+å¾ªç¯</h1><div class="tabs" id="æ··åˆå›¾"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="æ··åˆå›¾-1">ç»“æœå±•ç¤º</button><button type="button" class="tab " data-href="æ··åˆå›¾-2">æ‰€éœ€æ•°æ®</button><button type="button" class="tab " data-href="æ··åˆå›¾-3">ä»£ç </button></ul><div class="tab-contents"><div class="tab-item-content active" id="æ··åˆå›¾-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/12/08/65730d0031ff1.png" style="width:300px;"/></div></div></div><div class="tab-item-content" id="æ··åˆå›¾-2"><p><a href="https://tooc.web.xlj0.com/uploads/R%E8%AF%AD%E8%A8%80%E7%BB%98%E5%9B%BE/qrt-pcr.xlsx">æ··åˆå›¾</a></p></div><div class="tab-item-content" id="æ··åˆå›¾-3"><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>readxl<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>tidyverse<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggpubr<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>gridExtra<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">pcr <span class="operator">&lt;-</span> read_xlsx<span class="punctuation">(</span><span class="string">&quot;qrt-pcr.xlsx&quot;</span><span class="punctuation">)</span></span><br><span class="line">pcr<span class="operator">$</span>Group <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>pcr<span class="operator">$</span>Group<span class="punctuation">,</span> levels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;control&quot;</span><span class="punctuation">,</span> <span class="string">&quot;butyrate&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">pcr<span class="operator">$</span>Gene <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>pcr<span class="operator">$</span>Gene<span class="punctuation">,</span> levels <span class="operator">=</span> paste0<span class="punctuation">(</span><span class="string">&quot;HDAC&quot;</span><span class="punctuation">,</span> <span class="number">1</span><span class="operator">:</span><span class="number">11</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">HDAC <span class="operator">&lt;-</span> paste0<span class="punctuation">(</span><span class="string">&quot;HDAC&quot;</span><span class="punctuation">,</span> <span class="number">1</span><span class="operator">:</span><span class="number">11</span><span class="punctuation">)</span></span><br><span class="line">plots <span class="operator">&lt;-</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> HDAC<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  plots<span class="punctuation">[[</span>i<span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>pcr<span class="punctuation">[</span>pcr<span class="operator">$</span>Gene <span class="operator">==</span> i<span class="punctuation">,</span> <span class="punctuation">]</span><span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> Group<span class="punctuation">,</span> y <span class="operator">=</span> Expression<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    geom_point<span class="punctuation">(</span>color<span class="operator">=</span><span class="string">&quot;black&quot;</span><span class="punctuation">,</span></span><br><span class="line">               size<span class="operator">=</span><span class="number">5</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">    geom_violin<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> Group<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                color <span class="operator">=</span> <span class="string">&quot;gray&quot;</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">0.4</span><span class="punctuation">,</span></span><br><span class="line">                scale <span class="operator">=</span> <span class="string">&quot;width&quot;</span><span class="punctuation">,</span></span><br><span class="line">                linewidth <span class="operator">=</span> <span class="number">0.6</span><span class="punctuation">,</span></span><br><span class="line">                trim <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">    geom_boxplot<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> </span><br><span class="line">                 outlier.color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span></span><br><span class="line">                 width <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">,</span></span><br><span class="line">                 size <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">,</span></span><br><span class="line">                 fill <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    geom_signif<span class="punctuation">(</span>comparisons <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;control&quot;</span><span class="punctuation">,</span> <span class="string">&quot;butyrate&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                y_position <span class="operator">=</span> <span class="built_in">max</span><span class="punctuation">(</span>pcr<span class="punctuation">[</span>pcr<span class="operator">$</span>Gene <span class="operator">==</span> i<span class="punctuation">,</span> <span class="punctuation">]</span><span class="operator">$</span>Expression<span class="operator">+</span><span class="number">0.1</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                map_signif_level <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span></span><br><span class="line">                test <span class="operator">=</span> <span class="string">&quot;t.test&quot;</span><span class="punctuation">,</span></span><br><span class="line">                textsize <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    guides<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">    theme_bw<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">    labs<span class="punctuation">(</span>x <span class="operator">=</span> i<span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Relative expression of mRNA&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">    ylim<span class="punctuation">(</span><span class="literal">NA</span><span class="punctuation">,</span> <span class="built_in">max</span><span class="punctuation">(</span>pcr<span class="punctuation">[</span>pcr<span class="operator">$</span>Gene <span class="operator">==</span> i<span class="punctuation">,</span> <span class="punctuation">]</span><span class="operator">$</span>Expression<span class="operator">+</span><span class="number">0.2</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    theme<span class="punctuation">(</span>axis.title.x <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">12</span><span class="punctuation">,</span> face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">          panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">do.call<span class="punctuation">(</span><span class="string">&quot;grid.arrange&quot;</span><span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>plots<span class="punctuation">,</span> ncol<span class="operator">=</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="å¤šæ¬¡æ‹Ÿåˆæ›²çº¿"><a href="#å¤šæ¬¡æ‹Ÿåˆæ›²çº¿" class="headerlink" title="å¤šæ¬¡æ‹Ÿåˆæ›²çº¿"></a>å¤šæ¬¡æ‹Ÿåˆæ›²çº¿</h1><div class="tabs" id="æ··åˆå›¾"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="æ··åˆå›¾-1">ç»“æœå±•ç¤º</button><button type="button" class="tab " data-href="æ··åˆå›¾-2">æ‰€éœ€æ•°æ®</button><button type="button" class="tab " data-href="æ··åˆå›¾-3">ä»£ç </button></ul><div class="tab-contents"><div class="tab-item-content active" id="æ··åˆå›¾-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/12/08/65730ef57b1ff.png" style="width:300px;"/></div></div></div><div class="tab-item-content" id="æ··åˆå›¾-2"><p><a href="https://tooc.web.xlj0.com/uploads/R%E8%AF%AD%E8%A8%80%E7%BB%98%E5%9B%BE/HPY%E6%95%B0%E6%8D%AE.xlsx">å¤šæ¬¡æ‹Ÿåˆæ›²çº¿</a></p></div><div class="tab-item-content" id="æ··åˆå›¾-3"><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>tidyverse<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>readxl<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HPY  <span class="operator">&lt;-</span> read_xlsx<span class="punctuation">(</span><span class="string">&quot;HPYæ•°æ®.xlsxâ€œ)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ggplot(HPY, aes(x = Time, y = HPY, linetype=Type)) +</span></span><br><span class="line"><span class="string">  geom_smooth(se = FALSE, color = &quot;</span>black<span class="string">&quot;, method = &quot;</span>lm<span class="string">&quot;, formula = y ~ poly(x, degree = 4)) +</span></span><br><span class="line"><span class="string">  xlab(&quot;</span>Time <span class="punctuation">(</span>day<span class="punctuation">)</span><span class="string">&quot;) +</span></span><br><span class="line"><span class="string">  ylab(&quot;</span>HPY <span class="punctuation">(</span>Âµg<span class="operator">/</span>ml<span class="punctuation">)</span><span class="string">&quot;)+</span></span><br><span class="line"><span class="string">  scale_y_continuous() +</span></span><br><span class="line"><span class="string">  theme_bw()+</span></span><br><span class="line"><span class="string">  theme(legend.title = element_blank(),</span></span><br><span class="line"><span class="string">        legend.position = c(0.9, 0.9),</span></span><br><span class="line"><span class="string">        panel.grid = element_blank(),</span></span><br><span class="line"><span class="string">        plot.margin = margin(1, 1, 1, 1, unit = &quot;</span>cm<span class="string">&quot;))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">fit1 &lt;- lm(HPY ~ poly(Time, degree = 4),</span></span><br><span class="line"><span class="string">           data = HPY[HPY$Type == &quot;</span>primiparous<span class="string">&quot;,])</span></span><br><span class="line"><span class="string">summary(fit1)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">fit2 &lt;- lm(HPY ~ poly(Time, degree = 4),</span></span><br><span class="line"><span class="string">           data = HPY[HPY$Type == &quot;</span>mutiparous<span class="string">&quot;,])</span></span><br><span class="line"><span class="string">summary(fit2)</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;çƒ­å›¾&quot;&gt;&lt;a href=&quot;#çƒ­å›¾&quot; class=&quot;headerlink&quot; title=&quot;çƒ­å›¾&quot;&gt;&lt;/a&gt;çƒ­å›¾&lt;/h1&gt;&lt;h2 id=&quot;å·®å¼‚åŸºå› çƒ­å›¾ç»˜åˆ¶&quot;&gt;&lt;a href=&quot;#å·®å¼‚åŸºå› çƒ­å›¾ç»˜åˆ¶&quot; class=&quot;headerlink&quot; title=&quot;å·®å¼‚åŸºå› çƒ­å›¾ç»˜åˆ¶&quot;</summary>
      
    
    
    
    <category term="ç”Ÿç‰©ä¿¡æ¯å­¦" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="Rè¯­è¨€" scheme="https://smileszh.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
    <category term="Rç»˜å›¾" scheme="https://smileszh.github.io/tags/R%E7%BB%98%E5%9B%BE/"/>
    
  </entry>
  
  <entry>
    <title>å·®å¼‚åŸºå› è¡¨æ³•åˆ†æ</title>
    <link href="https://smileszh.github.io/posts/1085fed1.html"/>
    <id>https://smileszh.github.io/posts/1085fed1.html</id>
    <published>2023-06-30T15:00:00.000Z</published>
    <updated>2023-06-30T16:32:15.590Z</updated>
    
    <content type="html"><![CDATA[<h1 id="DESeq2"><a href="#DESeq2" class="headerlink" title="DESeq2"></a>DESeq2</h1><div class="tabs" id="deseq2"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="deseq2-1">æ‰€éœ€æ•°æ®</button><button type="button" class="tab " data-href="deseq2-2">Rä»£ç </button><button type="button" class="tab " data-href="deseq2-3">è¾“å‡ºæ•°æ®</button><button type="button" class="tab " data-href="deseq2-4">å¤‡æ³¨</button></ul><div class="tab-contents"><div class="tab-item-content active" id="deseq2-1"><p><a href="https://tooc.web.xlj0.com/uploads/%E5%B7%AE%E5%BC%82%E8%A1%A8%E8%BE%BE%E5%88%86%E6%9E%90/counts.csv">åŸå§‹Countsæ•°æ®</a><br><a href="https://tooc.web.xlj0.com/uploads/%E5%B7%AE%E5%BC%82%E8%A1%A8%E8%BE%BE%E5%88%86%E6%9E%90/design.csv">æ ·æœ¬åˆ†ç»„ä¿¡æ¯</a></p></div><div class="tab-item-content" id="deseq2-2"><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># Differential expression analysis with the DESeq2 package.</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># https://bioconductor.org/packages/release/bioc/html/DESeq2.html</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Load the library.</span></span><br><span class="line">suppressPackageStartupMessages<span class="punctuation">(</span>library<span class="punctuation">(</span>DESeq2<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The name of the file that contains the counts.</span></span><br><span class="line">counts_file <span class="operator">=</span> <span class="string">&quot;counts.csv&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The sample file is in CSV format and must have the headers &quot;sample&quot; and &quot;condition&quot;.</span></span><br><span class="line">design_file <span class="operator">=</span> <span class="string">&quot;design.csv&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The final result file.</span></span><br><span class="line">output_file <span class="operator">=</span> <span class="string">&quot;results.csv&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Read the sample file.</span></span><br><span class="line">colData <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span>design_file<span class="punctuation">,</span> stringsAsFactors<span class="operator">=</span><span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Turn conditions into factors.</span></span><br><span class="line">colData<span class="operator">$</span>condition <span class="operator">=</span> factor<span class="punctuation">(</span>colData<span class="operator">$</span>condition<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The first level should correspond to the first entry in the file!</span></span><br><span class="line"><span class="comment"># Required later when building a model.</span></span><br><span class="line">colData<span class="operator">$</span>condition <span class="operator">=</span> relevel<span class="punctuation">(</span>colData<span class="operator">$</span>condition<span class="punctuation">,</span> toString<span class="punctuation">(</span>colData<span class="operator">$</span>condition<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Isolate the sample names.</span></span><br><span class="line">sample_names <span class="operator">&lt;-</span> colData<span class="operator">$</span>sample</span><br><span class="line"></span><br><span class="line"><span class="comment"># Read the data from the standard input.</span></span><br><span class="line">df <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span>counts_file<span class="punctuation">,</span> header<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> row.names<span class="operator">=</span><span class="number">1</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Created rounded integers for the count data</span></span><br><span class="line">countData <span class="operator">&lt;-</span> <span class="built_in">round</span><span class="punctuation">(</span>df<span class="punctuation">[</span><span class="punctuation">,</span> sample_names<span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Other columns in the dataframe that are not sample information. </span></span><br><span class="line">otherCols <span class="operator">&lt;-</span> df<span class="punctuation">[</span><span class="operator">!</span><span class="punctuation">(</span><span class="built_in">names</span><span class="punctuation">(</span>df<span class="punctuation">)</span> <span class="operator">%in%</span> sample_names<span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Running DESeq2</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create DESEq2 dataset.</span></span><br><span class="line">dds <span class="operator">&lt;-</span> DESeqDataSetFromMatrix<span class="punctuation">(</span>countData<span class="operator">=</span>countData<span class="punctuation">,</span> colData<span class="operator">=</span>colData<span class="punctuation">,</span> design <span class="operator">=</span> <span class="operator">~</span>condition<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Run deseq</span></span><br><span class="line">dse <span class="operator">&lt;-</span> DESeq<span class="punctuation">(</span>dds<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Format the results.</span></span><br><span class="line">res <span class="operator">&lt;-</span> results<span class="punctuation">(</span>dse<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The rest of the code is about formatting the output dataframe.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Turn the DESeq2 results into a data frame.</span></span><br><span class="line">data <span class="operator">&lt;-</span> cbind<span class="punctuation">(</span>otherCols<span class="punctuation">,</span> data.frame<span class="punctuation">(</span>res<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create the foldChange column.</span></span><br><span class="line">data<span class="operator">$</span>foldChange <span class="operator">&lt;-</span>  2 <span class="operator">^</span> data<span class="operator">$</span>log2FoldChange</span><br><span class="line"></span><br><span class="line"><span class="comment"># Rename columns to better reflect reality.</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>data<span class="punctuation">)</span><span class="punctuation">[</span><span class="built_in">names</span><span class="punctuation">(</span>data<span class="punctuation">)</span><span class="operator">==</span><span class="string">&quot;pvalue&quot;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span><span class="string">&quot;PValue&quot;</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>data<span class="punctuation">)</span><span class="punctuation">[</span><span class="built_in">names</span><span class="punctuation">(</span>data<span class="punctuation">)</span><span class="operator">==</span><span class="string">&quot;padj&quot;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;FDR&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a real adjusted pvalue</span></span><br><span class="line">data<span class="operator">$</span>PAdj <span class="operator">&lt;-</span> p.adjust<span class="punctuation">(</span>data<span class="operator">$</span>PValue<span class="punctuation">,</span> method<span class="operator">=</span><span class="string">&quot;hochberg&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Sort the data by PValue to compute false discovery counts.</span></span><br><span class="line">data <span class="operator">&lt;-</span> data<span class="punctuation">[</span>with<span class="punctuation">(</span>data<span class="punctuation">,</span> order<span class="punctuation">(</span>PValue<span class="punctuation">,</span> <span class="operator">-</span>foldChange<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Compute the false discovery counts on the sorted table.</span></span><br><span class="line">data<span class="operator">$</span>falsePos <span class="operator">=</span> <span class="number">1</span><span class="operator">:</span>nrow<span class="punctuation">(</span>data<span class="punctuation">)</span> <span class="operator">*</span> data<span class="operator">$</span>FDR</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create the additional columns that we wish to present.</span></span><br><span class="line">data<span class="operator">$</span>baseMeanA <span class="operator">&lt;-</span> 1</span><br><span class="line">data<span class="operator">$</span>baseMeanB <span class="operator">&lt;-</span> 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># Get the normalized counts.</span></span><br><span class="line">normed <span class="operator">&lt;-</span> counts<span class="punctuation">(</span>dse<span class="punctuation">,</span> normalized<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Round normalized counts to a single digit.</span></span><br><span class="line">normed <span class="operator">&lt;-</span> <span class="built_in">round</span><span class="punctuation">(</span>normed<span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Merge the two datasets by row names.</span></span><br><span class="line">total <span class="operator">&lt;-</span> merge<span class="punctuation">(</span>data<span class="punctuation">,</span> normed<span class="punctuation">,</span> by<span class="operator">=</span><span class="number">0</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Sort again for output.</span></span><br><span class="line">total <span class="operator">&lt;-</span> total<span class="punctuation">[</span>with<span class="punctuation">(</span>total<span class="punctuation">,</span> order<span class="punctuation">(</span>PValue<span class="punctuation">,</span> <span class="operator">-</span>foldChange<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Sample names for condition A</span></span><br><span class="line">col_names_A <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>split<span class="punctuation">(</span>colData<span class="punctuation">,</span> colData<span class="operator">$</span>condition<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Sample names for condition B</span></span><br><span class="line">col_names_B <span class="operator">=</span> data.frame<span class="punctuation">(</span>split<span class="punctuation">(</span>colData<span class="punctuation">,</span> colData<span class="operator">$</span>condition<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create the individual baseMean columns.</span></span><br><span class="line">total<span class="operator">$</span>baseMeanA <span class="operator">=</span> rowMeans<span class="punctuation">(</span>total<span class="punctuation">[</span><span class="punctuation">,</span> col_names_A<span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">total<span class="operator">$</span>baseMeanB <span class="operator">=</span> rowMeans<span class="punctuation">(</span>total<span class="punctuation">[</span><span class="punctuation">,</span> col_names_B<span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Bringing some sanity to numbers. Round columns to fewer digits.</span></span><br><span class="line">total<span class="operator">$</span>foldChange <span class="operator">=</span> <span class="built_in">round</span><span class="punctuation">(</span>total<span class="operator">$</span>foldChange<span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">)</span></span><br><span class="line">total<span class="operator">$</span>log2FoldChange <span class="operator">=</span> <span class="built_in">round</span><span class="punctuation">(</span>total<span class="operator">$</span>log2FoldChange<span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">total<span class="operator">$</span>baseMean  <span class="operator">=</span> <span class="built_in">round</span><span class="punctuation">(</span>total<span class="operator">$</span>baseMean<span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">total<span class="operator">$</span>baseMeanA <span class="operator">=</span> <span class="built_in">round</span><span class="punctuation">(</span>total<span class="operator">$</span>baseMeanA<span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">total<span class="operator">$</span>baseMeanB <span class="operator">=</span>  <span class="built_in">round</span><span class="punctuation">(</span>total<span class="operator">$</span>baseMeanB<span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">total<span class="operator">$</span>lfcSE <span class="operator">=</span> <span class="built_in">round</span><span class="punctuation">(</span>total<span class="operator">$</span>lfcSE<span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">total<span class="operator">$</span>stat <span class="operator">=</span> <span class="built_in">round</span><span class="punctuation">(</span>total<span class="operator">$</span>stat<span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">total<span class="operator">$</span>FDR <span class="operator">=</span> <span class="built_in">round</span><span class="punctuation">(</span>total<span class="operator">$</span>FDR<span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">)</span></span><br><span class="line">total<span class="operator">$</span>falsePos <span class="operator">=</span> <span class="built_in">round</span><span class="punctuation">(</span>total<span class="operator">$</span>falsePos<span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Reformat these columns as string.</span></span><br><span class="line">total<span class="operator">$</span>PAdj <span class="operator">&lt;-</span> formatC<span class="punctuation">(</span>total<span class="operator">$</span>PAdj<span class="punctuation">,</span> format <span class="operator">=</span> <span class="string">&quot;e&quot;</span><span class="punctuation">,</span> digits <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">total<span class="operator">$</span>PValue <span class="operator">&lt;-</span> formatC<span class="punctuation">(</span>total<span class="operator">$</span>PValue<span class="punctuation">,</span> format <span class="operator">=</span> <span class="string">&quot;e&quot;</span><span class="punctuation">,</span> digits <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Rename the first column.</span></span><br><span class="line">colnames<span class="punctuation">(</span>total<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;name&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Reorganize columns names to make more sense.</span></span><br><span class="line">new_cols <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;name&quot;</span><span class="punctuation">,</span> <span class="built_in">names</span><span class="punctuation">(</span>otherCols<span class="punctuation">)</span><span class="punctuation">,</span> <span class="string">&quot;baseMean&quot;</span><span class="punctuation">,</span><span class="string">&quot;baseMeanA&quot;</span><span class="punctuation">,</span><span class="string">&quot;baseMeanB&quot;</span><span class="punctuation">,</span><span class="string">&quot;foldChange&quot;</span><span class="punctuation">,</span></span><br><span class="line">             <span class="string">&quot;log2FoldChange&quot;</span><span class="punctuation">,</span><span class="string">&quot;lfcSE&quot;</span><span class="punctuation">,</span><span class="string">&quot;stat&quot;</span><span class="punctuation">,</span><span class="string">&quot;PValue&quot;</span><span class="punctuation">,</span><span class="string">&quot;PAdj&quot;</span><span class="punctuation">,</span> <span class="string">&quot;FDR&quot;</span><span class="punctuation">,</span><span class="string">&quot;falsePos&quot;</span><span class="punctuation">,</span>col_names_A<span class="punctuation">,</span> col_names_B<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Slice the dataframe with new columns.</span></span><br><span class="line">total <span class="operator">&lt;-</span> total<span class="punctuation">[</span><span class="punctuation">,</span> new_cols<span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Write the results to the standard output.</span></span><br><span class="line">write.csv<span class="punctuation">(</span>total<span class="punctuation">,</span> file<span class="operator">=</span>output_file<span class="punctuation">,</span> row.names<span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">,</span> <span class="built_in">quote</span><span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Inform the user.</span></span><br><span class="line">print<span class="punctuation">(</span><span class="string">&quot;# Tool: DESeq2&quot;</span><span class="punctuation">)</span></span><br><span class="line">print<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&quot;# Design: &quot;</span><span class="punctuation">,</span> design_file<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">print<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&quot;# Input: &quot;</span><span class="punctuation">,</span> counts_file<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">print<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&quot;# Output: &quot;</span><span class="punctuation">,</span> output_file<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="deseq2-3"><p><a href="https://tooc.web.xlj0.com/uploads/%E5%B7%AE%E5%BC%82%E8%A1%A8%E8%BE%BE%E5%88%86%E6%9E%90/results.csv">result</a></p></div><div class="tab-item-content" id="deseq2-4"><p>Deseq2çš„è¾“å‡ºä¸­ï¼Œ<strong>Padj</strong>å®é™…ä¸Šæ˜¯<strong>FDR</strong>! ä¸€èˆ¬æˆ‘ä»¬è®¤ä¸ºï¼šPAdjè¿›è¡Œå¤šé‡æ£€éªŒæ‰€ä½¿ç”¨çš„æ–¹æ³•æ˜¯<strong>hochberg</strong>, FDRè¿›è¡Œå¤šé‡æ£€éªŒçš„æ–¹æ³•æ˜¯<strong>Benjamini &amp; Hochberg</strong>ã€‚æ‰€ä»¥åœ¨ä»£ç ä¸­æˆ‘ä»¬è¿›è¡Œäº†è½¬æ¢æ“ä½œã€‚</p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><details class="folding-tag" ><summary> æ•°æ®ç»“æœè¯´æ˜ </summary>              <div class='content'>              <p><strong>name</strong> - the feature identity. It must be unique within the column. It may be a gene name, transcript name, or exon - whatever the feature we chose to quantify.<br><strong>baseMean</strong> - the average normalized expression level across samples. It measures how much total signal is present across both conditions.<br><strong>baseMeanA</strong> - the average normalized expression level across the first condition. It measures how much total signal is there for condition A.<br><strong>baseMeanB</strong> - the average normalized expression level across the first condition. It measures how much total signal is there for condition B.<br><strong>foldChange</strong> - the ratio of baseMeanB/baseMeanA. Very important to always be aware that in the fold change means B/A (second condition/first condition)<br><strong>log2FoldChange</strong> - the second logarithm of foldChange. Log 2 transformations are convenient as they transform the changes onto a uniform scale. A four-fold increase after transformation is 2. A four-fold decrease (1/4) after log 2 transform is -2. This property makes it much easier to compare the magnitude of up/down changes.<br><strong>PValue</strong> - the uncorrected p-value of the likelihood of observing the effect of the size foldChange (or larger) by chance alone. This p-value is not corrected for multiple comparisons.<br><strong>PAdj</strong> - the multiple comparisons corrected PValue (via the Hochberg method). This probability of having at least one false positive when accounting for all comparisons made. This value is usually overly conservative in genomics.<br><strong>FDR</strong> - the False Discovery Rate - this column represents the fraction of false discoveries for all the rows above the row where the value is listed. For example, if in row number 300 the FDR is 0.05, it means that if you were cut the table at this row and accept all genes at and above it as differentially expressed then, 300 * 0.05 = 15 genes out of the 300 are likely to be false positives. The values in this column are also called q-values.<br><strong>falsePos</strong> - this column is derived directly from FDR and represents the number of false positives in the rows above. It is computed as RowIndex * FDR and is there to provide a direct interpretation of FDR.<br>The following columns represent the normalized matrix of the original count data in this case, 3 and 3 conditions.</p>              </div>            </details><h1 id="edgeR"><a href="#edgeR" class="headerlink" title="edgeR"></a>edgeR</h1><div class="tabs" id="edger"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="edger-1">æ‰€éœ€æ•°æ®</button><button type="button" class="tab " data-href="edger-2">Rä»£ç </button><button type="button" class="tab " data-href="edger-3">è¾“å‡ºæ•°æ®</button></ul><div class="tab-contents"><div class="tab-item-content active" id="edger-1"><p><a href="https://tooc.web.xlj0.com/uploads/%E5%B7%AE%E5%BC%82%E8%A1%A8%E8%BE%BE%E5%88%86%E6%9E%90/counts.csv">åŸå§‹Countsæ•°æ®</a><br><a href="https://tooc.web.xlj0.com/uploads/%E5%B7%AE%E5%BC%82%E8%A1%A8%E8%BE%BE%E5%88%86%E6%9E%90/design.csv">æ ·æœ¬åˆ†ç»„ä¿¡æ¯</a></p></div><div class="tab-item-content" id="edger-2"><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Differential expression analysis with the edgeR package.</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># https://bioconductor.org/packages/release/bioc/html/edgeR.html</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Load the library</span></span><br><span class="line">library<span class="punctuation">(</span>edgeR<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The name of the file that contains the counts.</span></span><br><span class="line">counts_file <span class="operator">=</span> <span class="string">&quot;counts.csv&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The sample file is in CSV format and must have the headers &quot;sample&quot; and &quot;condition&quot;.</span></span><br><span class="line">design_file <span class="operator">=</span> <span class="string">&quot;design.csv&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The final result file.</span></span><br><span class="line">output_file <span class="operator">=</span> <span class="string">&quot;results.csv&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Read the sample file.</span></span><br><span class="line">colData <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span>design_file<span class="punctuation">,</span> stringsAsFactors<span class="operator">=</span><span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Turn conditions into factors.</span></span><br><span class="line">colData<span class="operator">$</span>condition <span class="operator">=</span> factor<span class="punctuation">(</span>colData<span class="operator">$</span>condition<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The first level should correspond to the first entry in the file!</span></span><br><span class="line"><span class="comment"># Required when building a model.</span></span><br><span class="line">colData<span class="operator">$</span>condition <span class="operator">=</span> relevel<span class="punctuation">(</span>colData<span class="operator">$</span>condition<span class="punctuation">,</span> toString<span class="punctuation">(</span>colData<span class="operator">$</span>condition<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Isolate the sample names.</span></span><br><span class="line">sample_names <span class="operator">&lt;-</span> colData<span class="operator">$</span>sample</span><br><span class="line"></span><br><span class="line"><span class="comment"># Read the data from the standard input.</span></span><br><span class="line">df <span class="operator">=</span> read.csv<span class="punctuation">(</span>counts_file<span class="punctuation">,</span> header<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> row.names<span class="operator">=</span><span class="number">1</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Created rounded integers for the count data</span></span><br><span class="line">counts <span class="operator">=</span> <span class="built_in">round</span><span class="punctuation">(</span>df<span class="punctuation">[</span><span class="punctuation">,</span> sample_names<span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Other columns in the dataframe that are not sample information. </span></span><br><span class="line">otherCols <span class="operator">=</span> df<span class="punctuation">[</span><span class="operator">!</span><span class="punctuation">(</span><span class="built_in">names</span><span class="punctuation">(</span>df<span class="punctuation">)</span> <span class="operator">%in%</span> sample_names<span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Using the same naming as in the library.</span></span><br><span class="line">group <span class="operator">&lt;-</span> colData<span class="operator">$</span>condition</span><br><span class="line"></span><br><span class="line"><span class="comment"># Creates a DGEList object from a table of counts and group.</span></span><br><span class="line">dge <span class="operator">&lt;-</span> DGEList<span class="punctuation">(</span>counts<span class="operator">=</span>counts<span class="punctuation">,</span> group<span class="operator">=</span>group<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Maximizes the negative binomial conditional common likelihood to estimate a common dispersion value across all genes.</span></span><br><span class="line">dis <span class="operator">&lt;-</span> estimateCommonDisp<span class="punctuation">(</span>dge<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Estimates tagwise dispersion values by an empirical Bayes method based on weighted conditional maximum likelihood.</span></span><br><span class="line">tag <span class="operator">&lt;-</span> estimateTagwiseDisp<span class="punctuation">(</span>dis<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Compute genewise exact tests for differences in the means between the groups.</span></span><br><span class="line">etx <span class="operator">&lt;-</span> exactTest<span class="punctuation">(</span>tag<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Extracts the most differentially expressed genes.</span></span><br><span class="line">etp <span class="operator">&lt;-</span> topTags<span class="punctuation">(</span>etx<span class="punctuation">,</span> n<span class="operator">=</span>nrow<span class="punctuation">(</span>counts<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Get the scale of the data</span></span><br><span class="line">scale <span class="operator">=</span> dge<span class="operator">$</span>samples<span class="operator">$</span>lib.size <span class="operator">*</span> dge<span class="operator">$</span>samples<span class="operator">$</span>norm.factors</span><br><span class="line"></span><br><span class="line"><span class="comment"># Get the normalized counts</span></span><br><span class="line">normed <span class="operator">=</span> <span class="built_in">round</span><span class="punctuation">(</span>t<span class="punctuation">(</span>t<span class="punctuation">(</span>counts<span class="punctuation">)</span><span class="operator">/</span>scale<span class="punctuation">)</span> <span class="operator">*</span> mean<span class="punctuation">(</span>scale<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Turn the DESeq2 results into a data frame.</span></span><br><span class="line">data <span class="operator">=</span> merge<span class="punctuation">(</span>otherCols<span class="punctuation">,</span> etp<span class="operator">$</span>table<span class="punctuation">,</span> by<span class="operator">=</span><span class="string">&quot;row.names&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create column placeholders.</span></span><br><span class="line">data<span class="operator">$</span>baseMean <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">data<span class="operator">$</span>baseMeanA <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">data<span class="operator">$</span>baseMeanB <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">data<span class="operator">$</span>foldChange <span class="operator">=</span> <span class="number">2</span> <span class="operator">^</span> data<span class="operator">$</span>logFC</span><br><span class="line">data<span class="operator">$</span>falsePos <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Rename the column.</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>data<span class="punctuation">)</span><span class="punctuation">[</span><span class="built_in">names</span><span class="punctuation">(</span>data<span class="punctuation">)</span><span class="operator">==</span><span class="string">&quot;logFC&quot;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span><span class="string">&quot;log2FoldChange&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Compute the adjusted p-value</span></span><br><span class="line">data<span class="operator">$</span>PAdj <span class="operator">=</span> p.adjust<span class="punctuation">(</span>data<span class="operator">$</span>PValue<span class="punctuation">,</span> method<span class="operator">=</span><span class="string">&quot;hochberg&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Rename the first columns for consistency with other methods.</span></span><br><span class="line">colnames<span class="punctuation">(</span>data<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&quot;name&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a merged output that contains the normalized counts.</span></span><br><span class="line">total <span class="operator">&lt;-</span> merge<span class="punctuation">(</span>data<span class="punctuation">,</span> normed<span class="punctuation">,</span> by.x<span class="operator">=</span><span class="string">&#x27;name&#x27;</span><span class="punctuation">,</span> by.y<span class="operator">=</span><span class="string">&quot;row.names&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Sort the data for the output. </span></span><br><span class="line">total <span class="operator">=</span> total<span class="punctuation">[</span>with<span class="punctuation">(</span>total<span class="punctuation">,</span> order<span class="punctuation">(</span>PValue<span class="punctuation">,</span> <span class="operator">-</span>foldChange<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Compute the false discovery counts on the sorted table.</span></span><br><span class="line">data<span class="operator">$</span>falsePos <span class="operator">=</span> <span class="number">1</span><span class="operator">:</span>nrow<span class="punctuation">(</span>data<span class="punctuation">)</span> <span class="operator">*</span> data<span class="operator">$</span>FDR</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sample names for condition A</span></span><br><span class="line">col_names_A <span class="operator">=</span> data.frame<span class="punctuation">(</span>split<span class="punctuation">(</span>colData<span class="punctuation">,</span> colData<span class="operator">$</span>condition<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Sample names for condition B</span></span><br><span class="line">col_names_B <span class="operator">=</span> data.frame<span class="punctuation">(</span>split<span class="punctuation">(</span>colData<span class="punctuation">,</span> colData<span class="operator">$</span>condition<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create the individual baseMean columns.</span></span><br><span class="line">total<span class="operator">$</span>baseMeanA <span class="operator">=</span> rowMeans<span class="punctuation">(</span>total<span class="punctuation">[</span><span class="punctuation">,</span> col_names_A<span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">total<span class="operator">$</span>baseMeanB <span class="operator">=</span> rowMeans<span class="punctuation">(</span>total<span class="punctuation">[</span><span class="punctuation">,</span> col_names_B<span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">total<span class="operator">$</span>baseMean <span class="operator">=</span> total<span class="operator">$</span>baseMeanA <span class="operator">+</span> total<span class="operator">$</span>baseMeanB</span><br><span class="line"></span><br><span class="line"><span class="comment"># Round the numbers</span></span><br><span class="line">total<span class="operator">$</span>foldChange <span class="operator">=</span> <span class="built_in">round</span><span class="punctuation">(</span>total<span class="operator">$</span>foldChange<span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">)</span></span><br><span class="line">total<span class="operator">$</span>FDR <span class="operator">=</span> <span class="built_in">round</span><span class="punctuation">(</span>total<span class="operator">$</span>FDR<span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">)</span></span><br><span class="line">total<span class="operator">$</span>PAdj <span class="operator">=</span> <span class="built_in">round</span><span class="punctuation">(</span>total<span class="operator">$</span>PAdj<span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">)</span></span><br><span class="line">total<span class="operator">$</span>logCPM <span class="operator">=</span> <span class="built_in">round</span><span class="punctuation">(</span>total<span class="operator">$</span>logCPM<span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">total<span class="operator">$</span>log2FoldChange <span class="operator">=</span> <span class="built_in">round</span><span class="punctuation">(</span>total<span class="operator">$</span>log2FoldChange<span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">total<span class="operator">$</span>baseMean <span class="operator">=</span> <span class="built_in">round</span><span class="punctuation">(</span>total<span class="operator">$</span>baseMean<span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">total<span class="operator">$</span>baseMeanA <span class="operator">=</span> <span class="built_in">round</span><span class="punctuation">(</span>total<span class="operator">$</span>baseMeanA<span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">total<span class="operator">$</span>baseMeanB <span class="operator">=</span> <span class="built_in">round</span><span class="punctuation">(</span>total<span class="operator">$</span>baseMeanB<span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">total<span class="operator">$</span>falsePos <span class="operator">=</span> <span class="built_in">round</span><span class="punctuation">(</span>total<span class="operator">$</span>falsePos<span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Reformat these columns as string.</span></span><br><span class="line">total<span class="operator">$</span>PAdj <span class="operator">=</span> formatC<span class="punctuation">(</span>total<span class="operator">$</span>PAdj<span class="punctuation">,</span> format <span class="operator">=</span> <span class="string">&quot;e&quot;</span><span class="punctuation">,</span> digits <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">total<span class="operator">$</span>PValue <span class="operator">=</span> formatC<span class="punctuation">(</span>total<span class="operator">$</span>PValue<span class="punctuation">,</span> format <span class="operator">=</span> <span class="string">&quot;e&quot;</span><span class="punctuation">,</span> digits <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Reorganize columns names to make more sense.</span></span><br><span class="line">new_cols <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;name&quot;</span><span class="punctuation">,</span> <span class="built_in">names</span><span class="punctuation">(</span>otherCols<span class="punctuation">)</span><span class="punctuation">,</span> <span class="string">&quot;baseMean&quot;</span><span class="punctuation">,</span><span class="string">&quot;baseMeanA&quot;</span><span class="punctuation">,</span><span class="string">&quot;baseMeanB&quot;</span><span class="punctuation">,</span><span class="string">&quot;foldChange&quot;</span><span class="punctuation">,</span></span><br><span class="line">         <span class="string">&quot;log2FoldChange&quot;</span><span class="punctuation">,</span><span class="string">&quot;logCPM&quot;</span><span class="punctuation">,</span><span class="string">&quot;PValue&quot;</span><span class="punctuation">,</span><span class="string">&quot;PAdj&quot;</span><span class="punctuation">,</span> <span class="string">&quot;FDR&quot;</span><span class="punctuation">,</span><span class="string">&quot;falsePos&quot;</span><span class="punctuation">,</span>col_names_A<span class="punctuation">,</span> col_names_B<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Slice the dataframe with new columns.</span></span><br><span class="line">total <span class="operator">=</span> total<span class="punctuation">[</span><span class="punctuation">,</span> new_cols<span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Write the result to the standard output.</span></span><br><span class="line">write.csv<span class="punctuation">(</span>total<span class="punctuation">,</span> file<span class="operator">=</span>output_file<span class="punctuation">,</span> row.names<span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">,</span> <span class="built_in">quote</span><span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Inform the user.</span></span><br><span class="line">print<span class="punctuation">(</span><span class="string">&quot;# Tool: edgeR&quot;</span><span class="punctuation">)</span></span><br><span class="line">print<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&quot;# Design: &quot;</span><span class="punctuation">,</span> design_file<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">print<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&quot;# Input: &quot;</span><span class="punctuation">,</span> counts_file<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">print<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&quot;# Output: &quot;</span><span class="punctuation">,</span> output_file<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="edger-3"><p><a href="https://tooc.web.xlj0.com/uploads/%E5%B7%AE%E5%BC%82%E8%A1%A8%E8%BE%BE%E5%88%86%E6%9E%90/results_edger.csv">result</a></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><details class="folding-tag" ><summary> æ•°æ®ç»“æœè¯´æ˜ </summary>              <div class='content'>              <p><strong>name</strong> - the feature identity. It must be unique within the column. It may be a gene name, transcript name, or exon - whatever the feature we chose to quantify.<br><strong>baseMean</strong> - the average normalized expression level across samples. It measures how much total signal is present across both conditions.<br><strong>baseMeanA</strong> - the average normalized expression level across the first condition. It measures how much total signal is there for condition A.<br><strong>baseMeanB</strong> - the average normalized expression level across the first condition. It measures how much total signal is there for condition B.<br><strong>foldChange</strong> - the ratio of baseMeanB/baseMeanA. Very important to always be aware that in the fold change means B/A (second condition/first condition)<br><strong>log2FoldChange</strong> - the second logarithm of foldChange. Log 2 transformations are convenient as they transform the changes onto a uniform scale. A four-fold increase after transformation is 2. A four-fold decrease (1/4) after log 2 transform is -2. This property makes it much easier to compare the magnitude of up/down changes.<br><strong>PValue</strong> - the uncorrected p-value of the likelihood of observing the effect of the size foldChange (or larger) by chance alone. This p-value is not corrected for multiple comparisons.<br><strong>PAdj</strong> - the multiple comparisons corrected PValue (via the Hochberg method). This probability of having at least one false positive when accounting for all comparisons made. This value is usually overly conservative in genomics.<br><strong>FDR</strong> - the False Discovery Rate - this column represents the fraction of false discoveries for all the rows above the row where the value is listed. For example, if in row number 300 the FDR is 0.05, it means that if you were cut the table at this row and accept all genes at and above it as differentially expressed then, 300 * 0.05 = 15 genes out of the 300 are likely to be false positives. The values in this column are also called q-values.<br><strong>falsePos</strong> - this column is derived directly from FDR and represents the number of false positives in the rows above. It is computed as RowIndex * FDR and is there to provide a direct interpretation of FDR.<br>The following columns represent the normalized matrix of the original count data in this case, 3 and 3 conditions.</p>              </div>            </details>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;DESeq2&quot;&gt;&lt;a href=&quot;#DESeq2&quot; class=&quot;headerlink&quot; title=&quot;DESeq2&quot;&gt;&lt;/a&gt;DESeq2&lt;/h1&gt;&lt;div class=&quot;tabs&quot; id=&quot;deseq2&quot;&gt;&lt;ul class=&quot;nav-tabs&quot;&gt;&lt;butto</summary>
      
    
    
    
    <category term="ç”Ÿç‰©ä¿¡æ¯å­¦" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="Rè¯­è¨€" scheme="https://smileszh.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
    <category term="å·®å¼‚è¡¨æ³•åˆ†æ" scheme="https://smileszh.github.io/tags/%E5%B7%AE%E5%BC%82%E8%A1%A8%E6%B3%95%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>Macç»ˆç«¯ï¼šæœåŠ¡å™¨ä¸æœ¬åœ°æ–‡ä»¶äº¤äº’</title>
    <link href="https://smileszh.github.io/posts/b21fca77.html"/>
    <id>https://smileszh.github.io/posts/b21fca77.html</id>
    <published>2023-06-30T08:00:00.000Z</published>
    <updated>2023-06-30T09:10:16.363Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä»æœåŠ¡å™¨ä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°"><a href="#ä»æœåŠ¡å™¨ä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°" class="headerlink" title="ä»æœåŠ¡å™¨ä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°"></a>ä»æœåŠ¡å™¨ä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°</h1><ol><li>æ‰“å¼€Macç»ˆç«¯</li><li>ä½¿ç”¨scpå‘½ä»¤ä¸‹è½½æ–‡ä»¶</li></ol><div class="tabs" id="scp"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="scp-1">å‘½ä»¤ğŸ’»</button><button type="button" class="tab " data-href="scp-2">å‚æ•°è§£é‡ŠğŸ—£ï¸</button></ul><div class="tab-contents"><div class="tab-item-content active" id="scp-1"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -r xiaosu@10.10.140.xxx:~xiaosu/gorden /Users/xiaosu/Desktop</span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="scp-2"><div class="table-container"><table><thead><tr><th style="text-align:center">å‚æ•°</th><th style="text-align:center">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:center">-r</td><td style="text-align:center">å¦‚ä¸‹è½½çš„æ˜¯æ–‡ä»¶å¤¹éœ€ä½¿ç”¨æ­¤å‚æ•°ï¼Œå¦‚æœæ˜¯æ–‡ä»¶å¯ä¸ä½¿ç”¨æ­¤å‚æ•°</td></tr><tr><td style="text-align:center">xiaosu@10.10.140.xxx</td><td style="text-align:center">æœåŠ¡å™¨åœ°å€</td></tr><tr><td style="text-align:center">~xiaosu/gorden</td><td style="text-align:center">è¾“å…¥æœåŠ¡å™¨ä¸­è¦ä¸‹è½½çš„æ–‡ä»¶è·¯å¾„</td></tr><tr><td style="text-align:center">/Users/xiaosu/Desktop</td><td style="text-align:center">è¾“å…¥æœ¬åœ°åœ°å€ï¼Œå¿…é¡»æ˜¯å…¨å±€è·¯å¾„</td></tr></tbody></table></div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><script async id="asciicast-ypnQv3nx22hIDB1V58Kop4o7j" src="https://asciinema.org/a/ypnQv3nx22hIDB1V58Kop4o7j.js"></script>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ä»æœåŠ¡å™¨ä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°&quot;&gt;&lt;a href=&quot;#ä»æœåŠ¡å™¨ä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°&quot; class=&quot;headerlink&quot; title=&quot;ä»æœåŠ¡å™¨ä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°&quot;&gt;&lt;/a&gt;ä»æœåŠ¡å™¨ä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;æ‰“å¼€Macç»ˆç«¯&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨scpå‘½ä»¤ä¸‹è½½æ–‡ä»¶</summary>
      
    
    
    
    <category term="ç”Ÿæ´»å…´è¶£" scheme="https://smileszh.github.io/categories/%E7%94%9F%E6%B4%BB%E5%85%B4%E8%B6%A3/"/>
    
    
    <category term="Mac" scheme="https://smileszh.github.io/tags/Mac/"/>
    
    <category term="Terminal" scheme="https://smileszh.github.io/tags/Terminal/"/>
    
  </entry>
  
  <entry>
    <title>ç”Ÿä¿¡æ•°æ®æ ¼å¼</title>
    <link href="https://smileszh.github.io/posts/795e1915.html"/>
    <id>https://smileszh.github.io/posts/795e1915.html</id>
    <published>2023-06-29T09:00:00.000Z</published>
    <updated>2023-09-27T02:57:42.982Z</updated>
    
    <content type="html"><![CDATA[<h1 id="FASTQ"><a href="#FASTQ" class="headerlink" title="FASTQ"></a>FASTQ</h1><div class="tabs" id="fastq"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="fastq-1">ç®€ä»‹</button></ul><div class="tab-contents"><div class="tab-item-content active" id="fastq-1"><p>é€šè¿‡æµ‹åºï¼Œä¸€èˆ¬æ‹¿åˆ°çš„æ•°æ®æ˜¯<strong>.fastq</strong>æˆ–è€…<strong>.fq</strong>çš„åŸå§‹æ•°æ®æ ¼å¼ï¼Œè¯¥æ•°æ®åŒ…å«æ‰€æœ‰çš„readsä¿¡æ¯ï¼Œå…¶ä¸­ä¸€æ¡readsä¸»è¦åŒ…å«ä»¥ä¸‹4è¡Œä¿¡æ¯ï¼š</p><ul><li><p>ç¬¬ä¸€è¡Œä¸»è¦å‚¨å­˜åºåˆ—æµ‹åºæ—¶çš„åæ ‡ç­‰ä¿¡æ¯ï¼Œå¯ç”¨äºåŒºåˆ†æ¥æºï¼›</p></li><li><p>ç¬¬äºŒè¡Œæ˜¯æµ‹åºå¾—åˆ°çš„åºåˆ—ä¿¡æ¯ï¼Œä¸€èˆ¬ç”¨ATCGNæ¥è¡¨ç¤ºï¼Œå…¶ä¸­Nè¡¨ç¤ºè§å…‰ä¿¡å·å¹²æ‰°æ— æ³•åˆ¤æ–­åˆ°åº•æ˜¯å“ªä¸ªç¢±åŸº;</p></li><li><p>ç¬¬ä¸‰è¡Œä»¥â€œ+â€å¼€å§‹ï¼Œå¯ä»¥å‚¨å­˜ä¸€äº›é™„åŠ ä¿¡æ¯ï¼Œä¸€èˆ¬æ˜¯ç©ºçš„ï¼›</p></li><li><p>ç¬¬å››è¡Œå‚¨å­˜çš„æ˜¯è´¨é‡ä¿¡æ¯ï¼Œä¸ç¬¬2è¡Œçš„ç¢±åŸºåºåˆ—æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œå…¶ä¸­çš„æ¯ä¸€ä¸ªç¬¦å·å¯¹åº”çš„ASCIIå€¼æˆä¸ºphredå€¼ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºå¯¹åº”ä½ç½®ç¢±åŸºçš„è´¨é‡å€¼ï¼Œè¶Šå¤§è¯´æ˜æµ‹åºçš„è´¨é‡è¶Šå¥½ã€‚ä¸åŒçš„ç‰ˆæœ¬å¯¹åº”çš„ä¸åŒã€‚</p></li></ul><p><img src="https://bu.dusays.com/2023/06/29/649ce796a5a28.png" alt="fastq.png"></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="SAM"><a href="#SAM" class="headerlink" title="SAM"></a>SAM</h1><div class="tabs" id="sam"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="sam-1">ç®€ä»‹</button></ul><div class="tab-contents"><div class="tab-item-content active" id="sam-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/09/27/65139179eac55.png" style="width:800px;"/></div></div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;FASTQ&quot;&gt;&lt;a href=&quot;#FASTQ&quot; class=&quot;headerlink&quot; title=&quot;FASTQ&quot;&gt;&lt;/a&gt;FASTQ&lt;/h1&gt;&lt;div class=&quot;tabs&quot; id=&quot;fastq&quot;&gt;&lt;ul class=&quot;nav-tabs&quot;&gt;&lt;button typ</summary>
      
    
    
    
    <category term="ç”Ÿç‰©ä¿¡æ¯å­¦" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="æ•°æ®æ ¼å¼" scheme="https://smileszh.github.io/tags/%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>RNA-Seq</title>
    <link href="https://smileszh.github.io/posts/7acd0447.html"/>
    <id>https://smileszh.github.io/posts/7acd0447.html</id>
    <published>2023-06-29T08:00:00.000Z</published>
    <updated>2023-07-04T08:49:51.954Z</updated>
    
    <content type="html"><![CDATA[<h1 id="RNA-Seqåˆ†ææµç¨‹"><a href="#RNA-Seqåˆ†ææµç¨‹" class="headerlink" title="RNA-Seqåˆ†ææµç¨‹"></a>RNA-Seqåˆ†ææµç¨‹</h1><p><img src="https://bu.dusays.com/2023/06/29/649ce4ac2c1fe.png" alt="åˆ†ææµç¨‹.png"></p><div class="tabs" id="åˆ†ææµç¨‹"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="åˆ†ææµç¨‹-1">æ¯”å¯¹å’Œç»„è£…</button><button type="button" class="tab " data-href="åˆ†ææµç¨‹-2">å®šé‡å’Œæ ‡å‡†åŒ–</button><button type="button" class="tab " data-href="åˆ†ææµç¨‹-3">å·®å¼‚åˆ†æ</button></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆ†ææµç¨‹-1"><p><img src="https://bu.dusays.com/2023/06/29/649ce8628dc1e.png" alt="æ¯”å¯¹å’Œç»„è£….png"></p></div><div class="tab-item-content" id="åˆ†ææµç¨‹-2"><p><img src="https://bu.dusays.com/2023/06/29/649ce991c1407.png" alt="å®šé‡å’Œæ ‡å‡†åŒ–.png"></p></div><div class="tab-item-content" id="åˆ†ææµç¨‹-3"><p><strong><a href="https://www.smileszh.cn/posts/1085fed1.html">å·®å¼‚åˆ†æ</a></strong></p><p><img src="https://bu.dusays.com/2023/06/29/649cea75e840e.png" alt="å·®å¼‚åˆ†æ.png"></p><p><img src="https://bu.dusays.com/2023/06/29/649d900223506.png" alt="åŸºå› è¿‡æ»¤.png"></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="åŸºå› è¡¨è¾¾é‡æ•°æ®ç±»å‹"><a href="#åŸºå› è¡¨è¾¾é‡æ•°æ®ç±»å‹" class="headerlink" title="åŸºå› è¡¨è¾¾é‡æ•°æ®ç±»å‹"></a>åŸºå› è¡¨è¾¾é‡æ•°æ®ç±»å‹</h1><div class="tabs" id="æ•°æ®ç±»å‹"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="æ•°æ®ç±»å‹-1">Counts</button><button type="button" class="tab " data-href="æ•°æ®ç±»å‹-2">RPM/CPM</button><button type="button" class="tab " data-href="æ•°æ®ç±»å‹-3">RPKM</button><button type="button" class="tab " data-href="æ•°æ®ç±»å‹-4">FPKM/FPKM-UQ</button><button type="button" class="tab " data-href="æ•°æ®ç±»å‹-5">TPM</button></ul><div class="tab-contents"><div class="tab-item-content active" id="æ•°æ®ç±»å‹-1"><p><img src="https://bu.dusays.com/2023/06/30/649e3cab4acae.png" alt="Counts.png"></p></div><div class="tab-item-content" id="æ•°æ®ç±»å‹-2"><p><img src="https://bu.dusays.com/2023/06/30/649e3d78cb226.png" alt="RPM.png"></p></div><div class="tab-item-content" id="æ•°æ®ç±»å‹-3"><p><img src="https://bu.dusays.com/2023/06/30/649e3db0533fb.png" alt="RPKM.png"></p></div><div class="tab-item-content" id="æ•°æ®ç±»å‹-4"><p><img src="https://bu.dusays.com/2023/06/30/649e3ea1474b5.png" alt="FPKM:FPKM-UQ.png"></p></div><div class="tab-item-content" id="æ•°æ®ç±»å‹-5"><p><img src="https://bu.dusays.com/2023/06/30/649e3efc298af.png" alt="TPM.png"></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="åŸºå› è¡¨è¾¾é‡æ•°æ®è½¬æ¢"><a href="#åŸºå› è¡¨è¾¾é‡æ•°æ®è½¬æ¢" class="headerlink" title="åŸºå› è¡¨è¾¾é‡æ•°æ®è½¬æ¢"></a>åŸºå› è¡¨è¾¾é‡æ•°æ®è½¬æ¢</h1><ul><li>åŸå§‹Countsæ•°æ®</li><li>åŸºå› é•¿åº¦ä¿¡æ¯ï¼ˆå¤–æ˜¾å­é•¿åº¦ä¹‹å’Œï¼‰</li><li>å¦‚æŒ‰ç…§protein-codingåŸºå› è®¡ç®—mapped readsè®¡ç®—ï¼Œè¿˜éœ€æä¾›åŸºå› çš„åˆ†ç±»ä¿¡æ¯</li></ul><p><img src="https://bu.dusays.com/2023/06/30/649e40f51a9cd.png" alt="åŸºå› è¡¨è¾¾é‡æ•°æ®è½¬æ¢.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;RNA-Seqåˆ†ææµç¨‹&quot;&gt;&lt;a href=&quot;#RNA-Seqåˆ†ææµç¨‹&quot; class=&quot;headerlink&quot; title=&quot;RNA-Seqåˆ†ææµç¨‹&quot;&gt;&lt;/a&gt;RNA-Seqåˆ†ææµç¨‹&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;https://bu.dusays.com/20</summary>
      
    
    
    
    <category term="ç”Ÿç‰©ä¿¡æ¯å­¦" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="è½¬å½•ç»„" scheme="https://smileszh.github.io/tags/%E8%BD%AC%E5%BD%95%E7%BB%84/"/>
    
  </entry>
  
  <entry>
    <title>ç–‘æƒ‘å½“é“º</title>
    <link href="https://smileszh.github.io/posts/53f493a2.html"/>
    <id>https://smileszh.github.io/posts/53f493a2.html</id>
    <published>2023-06-28T14:00:00.000Z</published>
    <updated>2023-08-26T16:36:06.143Z</updated>
    
    <content type="html"><![CDATA[<ul><li>ä»€ä¹ˆæ˜¯æœ‰ä¹‰é“¾/åä¹‰é“¾(sense/antisense)ï¼Ÿ<blockquote><p>æœ‰ä¹‰é“¾æ˜¯ä¸mRNAå…·æœ‰ç›¸åŒåºåˆ—çš„DNAé“¾ï¼Œåˆç§°<strong>ç¼–ç é“¾</strong>ã€<strong>æœ‰æ„ä¹‰é“¾</strong>ã€‚åœ¨è½¬å½•è¿‡ç¨‹ä¸­ä»¥åä¹‰é“¾ä¸ºæ¨¡ç‰ˆï¼Œç¿»è¯‘æˆè›‹ç™½è´¨ã€‚</p></blockquote></li></ul><ul><li><p>ä»€ä¹ˆæ˜¯æ­£é“¾(forward stand; Plus strand)/è´Ÿé“¾(reverse strand; minus strand)?</p><blockquote><p>äººä¸ºè§„å®šçš„ä¸€æ¡é“¾ï¼ŒDNAçš„ä¸€æ¡é“¾è¢«è®¤ä¸ºæ˜¯æ­£é“¾ï¼Œå¦ä¸€æ¡é“¾å°±æ˜¯è´Ÿé“¾ã€‚</p></blockquote></li><li><p>åŸºå› ç»“æ„æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ</p><blockquote><p>è½¬è‡ª<a href="https://zhuanlan.zhihu.com/p/49601643">çŸ¥ä¹</a></p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/07/18/64b64c767db31.jpeg" style="width:600px;"/></div></div></blockquote></li><li><p>æ ¸è‹·é…¸çš„æ­§ä¹‰ä»£ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Y     Pyrimidine (C or T) </span><br><span class="line">R     Purine (A or G) </span><br><span class="line">W     Weak (A or T)</span><br><span class="line">S     Strong (G or C) </span><br><span class="line">K     Keto (T or G) </span><br><span class="line">M     Amino (C or A)     </span><br><span class="line">D     A, G, T (not C - remember as after C)</span><br><span class="line">V     A, C, G (not T - remember as after T/U - We&#x27;ll get to &quot;U&quot; soon) </span><br><span class="line">H     A, C, T (not G - remember as after G)</span><br><span class="line">B     C, G, T (not A - remember as after A)</span><br><span class="line">N     Any base</span><br><span class="line">-     Gap  </span><br></pre></td></tr></table></figure></li><li><p>RNA-Seqæ ‡å‡†åŒ–ï¼šCPMã€RPKM/FPKMã€TPM</p><blockquote><p>è½¬è‡ª<a href="https://mp.weixin.qq.com/s/5mCWL5IveQreNkpo-6XMQA">ç”Ÿç‰©ä¿¡æ¯æŠ€æœ¯</a></p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/08/27/64ea29a08ce11.png" style="width:600px;"/></div></div></blockquote></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;ä»€ä¹ˆæ˜¯æœ‰ä¹‰é“¾/åä¹‰é“¾(sense/antisense)ï¼Ÿ&lt;blockquote&gt;
&lt;p&gt;æœ‰ä¹‰é“¾æ˜¯ä¸mRNAå…·æœ‰ç›¸åŒåºåˆ—çš„DNAé“¾ï¼Œåˆç§°&lt;strong&gt;ç¼–ç é“¾&lt;/strong&gt;ã€&lt;strong&gt;æœ‰æ„ä¹‰é“¾&lt;/strong&gt;ã€‚åœ¨è½¬å½•è¿‡ç¨‹ä¸­ä»¥åä¹‰é“¾ä¸ºæ¨¡ç‰ˆï¼Œç¿»è¯‘æˆè›‹ç™½è´¨ã€‚</summary>
      
    
    
    
    <category term="ç§‘ç ”çŸ¥è¯†" scheme="https://smileszh.github.io/categories/%E7%A7%91%E7%A0%94%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="çŸ¥è¯†ç‚¹" scheme="https://smileszh.github.io/tags/%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
    
  </entry>
  
  <entry>
    <title>åˆ†å­äº’ä½œ</title>
    <link href="https://smileszh.github.io/posts/80184fae.html"/>
    <id>https://smileszh.github.io/posts/80184fae.html</id>
    <published>2023-06-27T02:00:00.000Z</published>
    <updated>2023-07-02T18:57:31.942Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è›‹ç™½-DNA"><a href="#è›‹ç™½-DNA" class="headerlink" title="è›‹ç™½-DNA"></a>è›‹ç™½-DNA</h1><ul><li>ä¹Ÿç§°è½¬å½•å› å­æ¨¡å¼ï¼Œæ‰€æœ‰è½¬å½•å› å­éƒ½åŒ…å«ä¸€æ®µ DNAç»“åˆåŸŸï¼Œç»“æ„åŸŸèƒ½å¤Ÿè¯†åˆ«å’Œç»“åˆåŸºå› å¯åŠ¨å­ç‰¹å¾DNAåºåˆ—ï¼ˆmotifï¼‰ ï¼Œè¿›è€Œå½±å“é¶åŸºå› ä» DNA è½¬å½•äº§ç”Ÿ RNA çš„è¿‡ç¨‹ï¼Œæ•ˆåº”ç»“æœæ˜¯ RNAé‡çš„å¤šå°‘å˜åŒ–ï¼Œå¦‚æœè¿™ä¸ªRNAæ˜¯å¯ä»¥ç¼–ç è›‹ç™½çš„mRNAï¼Œé‚£ä¹ˆæœ€ç»ˆå°±ä¼šé€ æˆé¶åŸºå› è›‹ç™½é‡çš„ä¸Šè°ƒæˆ–è€…ä¸‹è°ƒã€‚</li><li><p>è½¬å½•å› å­ä¸Šçš„æ°¨åŸºé…¸åºåˆ—å’Œç»“æ„ç»“åˆçš„ DNA åºåˆ—æ˜¯æœ‰ä¸€å®šè§„å¾‹çš„ï¼Œè¿™ç§è§„å¾‹æ˜¯é¢„æµ‹è½¬å½•å› å­è°ƒæ§é¶åŸºå› çš„ç†è®ºåŸºç¡€ã€‚</p></li><li><p>å¯åŠ¨å­æ˜¯ä¸€æ®µDNAåºåˆ—, å¯åŠ¨å­é‡Œå«æœ‰ RNA èšåˆé…¶çš„ç‰¹å¼‚æ€§ç»“åˆåºåˆ—ï¼ŒåŒæ—¶å¯ä»¥è·Ÿè½¬å½•å› å­ç»“åˆæ§åˆ¶åŸºå› çš„è½¬å½•æ´»æ€§ã€‚</p></li></ul><p><img src="https://bu.dusays.com/2023/06/27/6499bea4b4c9b.png" alt="dna-è›‹ç™½è´¨.png"></p><h2 id="ç›¸å…³æ•°æ®åº“"><a href="#ç›¸å…³æ•°æ®åº“" class="headerlink" title="ç›¸å…³æ•°æ®åº“"></a>ç›¸å…³æ•°æ®åº“</h2><p><img src="https://bu.dusays.com/2023/06/27/6499c1836e9a1.png" alt="è›‹ç™½-dnaæ•°æ®åº“.png"></p><h2 id="è½¬å½•å› å­"><a href="#è½¬å½•å› å­" class="headerlink" title="è½¬å½•å› å­"></a>è½¬å½•å› å­</h2><div class="tabs" id="è½¬å½•å› å­"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="è½¬å½•å› å­-1">è½¬å½•å› å­é¢„æµ‹åŸç†</button><button type="button" class="tab " data-href="è½¬å½•å› å­-2">ç ”ç©¶æ€è·¯</button><button type="button" class="tab " data-href="è½¬å½•å› å­-3">é¢„æµ‹æ•°æ®åº“</button><button type="button" class="tab " data-href="è½¬å½•å› å­-4">è½¬å½•å› å­éªŒè¯å®éªŒ</button></ul><div class="tab-contents"><div class="tab-item-content active" id="è½¬å½•å› å­-1"><p><img src="https://bu.dusays.com/2023/06/28/649b8d13b84ce.png" alt="è½¬å½•å› å­é¢„æµ‹åŸç†.png"></p></div><div class="tab-item-content" id="è½¬å½•å› å­-2"><p>çº¯ç”Ÿä¿¡:</p><ul><li>æ ¹æ®æµ‹åºç»“æœç­›é€‰å‡ºçš„å…³é”®åŸºå› ï¼Œæ¢ç´¢èƒ½å¦æ‰¾åˆ°æ½œåœ¨çš„è½¬å½•å› å­è°ƒæ§è¿™äº›åŸºå› </li><li>å¯ä»¥åŒæ—¶å¼•å…¥ä¸è½¬å½•å› å­å’Œé¶åŸºå› ç»“åˆçš„éç¼–ç RNAï¼Œæ„å»ºè°ƒèŠ‚ç½‘ç»œ</li><li>æˆ–è€…è¯†åˆ«å‡ºçš„å·®å¼‚è¡¨è¾¾åŸºå­˜åœ¨è½¬å½•å› å­ï¼Œå¯ä»¥ä»¥è¿™ä¸ªè½¬å½•å› å­ä¸ºä¸­å¿ƒï¼Œæ„å»ºè°ƒèŠ‚ç½‘ç»œ</li><li>åŸºäºè½¬å½•å› å­æœ¬èº«çš„çš„è¡¨è¾¾æ°´å¹³ã€çªå˜çŠ¶æ€ã€ç”²åŸºåŒ–æ°´å¹³ã€åšè½¬å½•å› å­ä¸è¡¨å‹çš„ç”Ÿä¿¡åˆ†æ</li></ul><p>ç”Ÿä¿¡+å®éªŒ:</p><ul><li>åŸºäºåºåˆ—ä¿å®ˆæ€§å¯¹äº’ä½œå…³ç³»è¿›è¡Œé¢„ç­›é€‰ï¼Œç„¶åå†é€šè¿‡EMSAã€ChIPç­‰å®éªŒéªŒè¯</li></ul></div><div class="tab-item-content" id="è½¬å½•å› å­-3"><p><img src="https://bu.dusays.com/2023/06/28/649b926153d60.png" alt="é¢„æµ‹æ•°æ®åº“.png"></p><details class="folding-tag" ><summary> JASPAR </summary>              <div class='content'>              <p><a href="https://jaspar.genereg.net/">JASPAR</a></p><p> JASPARæ˜¯ä¸€ä¸ªæ”¶å½•è½¬å½•å› å­ä¸DNAç»“åˆä½ç‚¹ä»¥åŠç»“åˆæ¨¡å¼çš„å¼€æºå…¬å…±æ•°æ®åº“ã€‚JASPARå…±åŒ…å«<strong>9ä¸ªå­æ•°æ®é›†</strong>ï¼Œæœ€å¸¸ç”¨çš„æ˜¯<strong>JASPAR COREå­æ•°æ®é›†</strong>ï¼Œä¸»è¦æ”¶å½•äº†å…­å¤§ç‰©ç§ã€‚JASPARæ•°æ®åº“çš„ä¸»è¦åŠŸèƒ½æ˜¯é¢„æµ‹ç›®çš„åŸºå› ä¸Šæ¸¸ç»“åˆçš„è½¬å½•å› å­ã€‚</p><p><img src="https://bu.dusays.com/2023/06/28/649be997c4510.png" alt="JASPAR home.png"></p><p><img src="https://bu.dusays.com/2023/06/28/649bf85a3a568.png" alt="JASPAR aside.png"></p><p><strong>åº”ç”¨</strong></p><ul><li>é¢„æµ‹è½¬å½•å› å­ä¸ç›®çš„åŸºå› çš„ç»“åˆä½ç‚¹ä¿¡æ¯</li></ul>              </div>            </details><details class="folding-tag" ><summary> AnimalTFDB 3.0 </summary>              <div class='content'>              <p><a href="http://bioinfo.life.hust.edu.cn/AnimalTFDB/#!/">AnimalTFDB 3.0</a></p><ul><li>æ—¨åœ¨ä¸ºåŠ¨ç‰©è½¬å½•å› å­åŠå…¶è¾…åŠ©å› å­æä¾›æœ€å…¨é¢ã€å‡†ç¡®ä¿¡æ¯èµ„æºçš„æ•°æ®åº“</li><li>æä¾›å¤šç§æœç´¢æµè§ˆæ–¹å¼ï¼Œæ¯”å¦‚å¯ä»¥æŒ‰ç…§ familyã€species æˆ–è‡ªå®šä¹‰æ–¹å¼è¿› è¡Œæ£€ç´¢</li><li>å¯ä»¥æ‰¹é‡é¢„æµ‹è½¬å½•å› å­</li><li>å¯ä»¥æ‰¹é‡é¢„æµ‹ DNA åºåˆ—ä¸Šçš„è½¬å½•å› å­ç»“åˆä½ç‚¹</li></ul><p><img src="https://bu.dusays.com/2023/06/28/649c54e741ab8.png" alt="animal home.png"></p><p><img src="https://bu.dusays.com/2023/06/28/649c551d3172b.png" alt="animal home1.png"></p><p><strong>åº”ç”¨</strong></p><ul><li>é¢„æµ‹ä¸ç›®çš„åŸºå› ç»“åˆçš„è½¬å½•å› å­</li><li>æŸ¥è¯¢ä¸æŸä¸ªè½¬å½•å› å­æœ‰äº¤äº’ä½œç”¨çš„è›‹ç™½</li></ul>              </div>            </details><details class="folding-tag" ><summary> AnimalTFDB 4.0 </summary>              <div class='content'>              <p><a href="http://bioinfo.life.hust.edu.cn/AnimalTFDB4/#/">AnimalTFDB 4.0</a></p><blockquote><p>æ–°ç‰ˆæœ¬ï¼Œå¾…åç»­è¡¥å……æ­¤æ–‡æ¡£</p></blockquote>              </div>            </details><details class="folding-tag" ><summary> TRRUST </summary>              <div class='content'>              <p><a href="https://www.grnpedia.org/trrust/">TRRUST</a></p><ul><li>TRRUSTæ•°æ®åº“æ˜¯ä¸€ä¸ªè®°å½•è½¬å½•å› å­è°ƒæ§å…³ç³»çš„æ•°æ®åº“ï¼Œä¸ä»…åŒ…å«è½¬å½•å› å­å¯¹åº”çš„é¶åŸºå› ï¼Œä¹ŸåŒ…å«äº†è½¬å½•å› å­é—´çš„è°ƒæ§å…³ç³»ã€‚</li><li>è¯¥æ•°æ®åº“ä½¿ç”¨MeSHè¯æ±‡æŸ¥è¯¢ã€ä¸æ–­æ”¹è¿›çš„sentence-basedæ–‡æœ¬æŒ–æ˜ç®—æ³•ï¼ŒåŠ ä¹‹æŒ–æ˜åä»”ç»†çš„äººå·¥æ ¡å¯¹ï¼Œä¿è¯äº†è¯¥æ•°æ®åº“ä¸­çš„TF-targetè°ƒæ§äº’ä½œéƒ½æ˜¯ç»è¿‡å®éªŒéªŒè¯çš„ã€‚</li><li>ç›®å‰è¯¥æ•°æ®åº“åªå­˜å‚¨äº†<strong>äººå’Œå°é¼ </strong>ç›¸å…³çš„è°ƒæ§ä¿¡æ¯ã€‚</li><li>TRRUSTæ•°æ®åº“ä¸»è¦æœ‰ä¸‰ä¸ªåŠŸèƒ½ï¼šç¬¬ä¸€æŸ¥è¯¢è½¬å½•å› å­çš„é¶åŸºå› ï¼Œç¬¬äºŒæŸ¥è¯¢è°ƒæ§è½¬å½•å› å­çš„å…¶ä»–è½¬å½•å› å­ï¼Œç¬¬ä¸‰æŸ¥æ‰¾å¤šä¸ªåŸºå› çš„å…³é”®è½¬å½•å› å­ã€‚</li></ul><p><img src="https://bu.dusays.com/2023/06/28/649c586ded44b.png" alt="trust home.png"></p><p><strong>åº”ç”¨</strong></p><ul><li>æŸ¥è¯¢ä¸æŸä¸ªè½¬å½•å› å­æœ‰ç›¸åŒé¶åŸºå› çš„å…¶ä»–è½¬å½•å› å­</li><li>æŸ¥è¯¢å¯¹ä¸€ç»„åŸºå› èµ·å…³é”®ä½œç”¨çš„è½¬å½•å› å­</li></ul>              </div>            </details><details class="folding-tag" ><summary> Cistrome Data Browser </summary>              <div class='content'>              <p><a href="http://cistrome.org/db/#/">Cistrome Data Browser</a> </p><ul><li><p>æ¥è‡ªäºäººå’Œå°é¼ çš„å¤§é‡ChIP-seqã€DNase-seqå’ŒATAC-seqæŸ“è‰²è´¨è°±åˆ†ææ‰€å¾—åˆ°çš„æ•°æ®ï¼Œç„¶ååˆ©ç”¨è¿™äº›è·å–çš„èµ„æºæ¥ç»˜åˆ¶è½¬å½•å› å­ç»“åˆä½ç‚¹åœ¨å…¨åŸºå› ç»„ä¸­çš„ä½ç½®ã€ç»„è›‹ç™½ç¿»è¯‘åä¿®é¥°ç­‰ä¿¡æ¯ï¼Œå¹¶æŠŠæ¯ä¸ªæ ·æœ¬çš„è´¨é‡è¯„ä¼°ã€æ¯”å¯¹ç»“æœã€å³°å›¾æ•°æ®ã€ç»“åˆPEAKå’Œé¶åŸºå› ç­‰æ•°æ®å…±äº«å‡ºæ¥ã€‚</p></li><li><p>CistromeDBçš„æœ€å¤§ç‰¹è‰²å°±æ˜¯å®ƒè‡ªå·±çš„è´¨æ§ï¼Œæ‰€ä»¥CistromeDBè¿˜å¯ä»¥ä½œä¸ºChIP-seqå’ŒDNase-seqå®éªŒçš„è´¨é‡æ§åˆ¶æŒ‡å—ã€‚</p></li><li>CistromeDBç½‘ç«™ç›®å‰åŒ…å«äº†ä»¥ä¸‹å››ä¸ªæ–¹é¢çš„ä¿¡æ¯ï¼šä¸€ã€é’ˆå¯¹æ¯ä¸ªChIP-seqå’ŒDNase-seqæ•°æ®é›†éƒ½æä¾›äº†è‡ªå·±ç¼–å½•çš„ä¿¡æ¯ï¼›äºŒã€æä¾›äº†è¿™äº›å…¬å…±æ•°æ®é›†çš„åˆ†æç»“æœï¼ŒåŒ…æ‹¬å³°å›¾ã€readså¯†åº¦åˆ†æå’Œä¸€äº›æ³¨é‡Šå›¾ä¾‹ï¼›ä¸‰ã€ä¸ºæ¯ä¸ªæ•°æ®é›†æä¾›äº†å…¨é¢çš„è´¨é‡æ§åˆ¶æŒ‡æ ‡ï¼ŒåŒ…æ‹¬readsæ–¹é¢ã€ChIPæ–¹é¢å’Œæ³¨é‡Šæ–¹é¢ï¼›å››ã€ç½‘ç«™æä¾›äº†æ•°æ®é›†çš„åˆ†æå’Œå¯è§†åŒ–çš„åŠŸèƒ½ï¼Œç”¨æˆ·å¯ä»¥ç›´æ¥å°†æ•°æ®å‘é€åˆ°CistromeDBï¼ŒæŒ‰ç…§ä»–ä»¬çš„æ ‡å‡†æ¥è¿›è¡Œå¤„ç†ï¼Œå¹¶ä¸”ç½‘ç«™è¿˜æ”¯æŒé€šè¿‡UCSCå’ŒWashUæ¥å®ç°å•æ‰¹æ•°æ®é›†çš„å¯è§†åŒ–æ“ä½œã€‚</li></ul><p><img src="https://bu.dusays.com/2023/06/29/649c60503b842.png" alt="CDB1.png"></p><p><img src="https://bu.dusays.com/2023/06/29/649c60c029094.png" alt="CDB2.png"></p><p><strong>åº”ç”¨</strong></p><ul><li>å¯¹å•ä¸ªæ•°æ®é›†çš„ç»“æœè¿›è¡Œæ•´ä½“çš„æŸ¥æ‰¾å’ŒæŸ¥çœ‹ï¼Œæ¯”å¦‚æ•°æ®æ ·æœ¬å…·ä½“æ¥è‡ªäºå“ªä¸ªç»„ç»‡ã€å“ªä¸ªç»†èƒç³»</li><li>å¯ä»¥åˆ©ç”¨è¿™ä¸ªç½‘ç«™æ¥æŸ¥æ‰¾æŸä¸ªæ•°æ®é›†çš„è´¨é‡æ§åˆ¶æƒ…å†µ</li><li>åˆ©ç”¨è¿™ä¸ªç½‘ç«™æ¥å®ç°è½¬å½•å› å­ä¸‹æ¸¸é¶åŸºå› çš„é¢„æµ‹</li><li>å¯ä»¥åå‘éªŒè¯è‡ªå·±æ‰¾çš„é¶åŸºå› ä¸æŸä¸ªè½¬å½•å› å­ç»“åˆçš„å¯èƒ½æ€§ã€‚</li></ul>              </div>            </details><details class="folding-tag" ><summary> ChIP-Atla </summary>              <div class='content'>              <p><a href="https://chip-atlas.org/">ChIP-Atla</a></p><p>ChIP-Atlasæ•°æ®åº“å…¨é¢æ•´åˆäº†å…­ä¸ªä»£è¡¨æ€§æ¨¡å‹ç”Ÿç‰©ï¼ˆäººç±»ã€å°é¼ ã€å¤§é¼ ã€æœè‡ã€çº¿è™«å’Œé…µæ¯ï¼‰çš„ChIP-seqå’ŒDNase-seqæ•°æ®ã€‚ChIP-Atlasæ•°æ®åº“èƒ½å¤Ÿæ˜¾ç¤ºNCBIç½‘ç«™SRAä¸­å­˜æ¡£çš„æ‰€æœ‰å…¬å…±ChIP-seqå’ŒDNase-seqæ•°æ®çš„å¯¹æ¯”å’Œå³°å›¾ç»“æœã€‚</p><p><img src="https://bu.dusays.com/2023/06/29/649c6555eed78.png" alt="chip-at.png"></p><p><strong>åº”ç”¨</strong></p><ul><li>æµè§ˆè½¬å½•å› å­çš„ç»“åˆä½ç‚¹ä¿¡æ¯</li><li>é¢„æµ‹å¯èƒ½ä¸è½¬å½•å› å­ç»“åˆçš„é¶åŸºå› </li><li>æŸ¥æ‰¾è¿˜æœ‰å“ªäº›å…¶ä»–è½¬å½•å› å­ç»“åˆåœ¨è¿™ä¸ªé¶åŸºå› ä¸Š</li></ul>              </div>            </details><details class="folding-tag" ><summary> ChIPBase </summary>              <div class='content'>              <p><a href="https://rnasysu.com/chipbase3/">ChIPBase</a></p>              </div>            </details><details class="folding-tag" ><summary> miRGen </summary>              <div class='content'>              <p><a href="https://diana.e-ce.uth.gr/mirgenv4/tool">miRGen</a></p>              </div>            </details><details class="folding-tag" ><summary> TransmiR </summary>              <div class='content'>              <p><a href="https://www.cuilab.cn/transmir">TransmiR</a></p>              </div>            </details></div><div class="tab-item-content" id="è½¬å½•å› å­-4"><details class="folding-tag" ><summary> Luciferase assay è§å…‰ç´ é…¶æŠ¥å‘ŠåŸºå› å®éªŒ </summary>              <div class='content'>              <p>ç ”ç©¶æŸä¸ªè½¬å½•å› å­æ˜¯å¦ä¸å¯åŠ¨å­åŒº åŸŸæŸæ®µ DNA åºåˆ—ç»“åˆå½±å“åŸºå› è¡¨è¾¾æ—¶ï¼Œé€šå¸¸æ˜¯å°†å¸¦æ£€æµ‹çš„ DNA åºåˆ—æ’å…¥åˆ°è§å…‰ç´ é…¶æŠ¥å‘ŠåŸºå› çš„ 5â€™ç«¯ï¼Œç„¶ååŠ å…¥å¾…æ£€æµ‹çš„è½¬å½•å› å­ï¼Œé€šè¿‡å¯¹è§å…‰ä¿¡å·çš„è§‚æµ‹ï¼Œæ¨æ–­è½¬å½•å› å­å¯¹æŠ¥å‘ŠåŸºå› è½¬å½•çš„å½±å“ã€‚</p><p><img src="https://bu.dusays.com/2023/06/28/649b9d5ca70a3.png" alt="è§å…‰ç´ é…¶.png" style="zoom:67%;" /></p>              </div>            </details><details class="folding-tag" ><summary> EMSA(Electrophoretic Mobility Shift Assay) å‡èƒ¶è¿ç§»å®éªŒ </summary>              <div class='content'>              <p>ç ”ç©¶ DNA ä¸è›‹ç™½è´¨ç›´æ¥ç»“åˆçš„å¸¸ç”¨æŠ€æœ¯ï¼Œå¯ç”¨äºå®šæ€§å’Œå®šé‡åˆ†æã€‚é¦–å…ˆè®©è›‹ç™½è´¨ä¸æœ«ç«¯æ ‡è®°çš„ DNA æ¢é’ˆå­µè‚²ï¼Œç„¶åè·‘ PAGE èƒ¶ã€‚ç»“åˆäº†è›‹ç™½è´¨çš„ DNA æ¢é’ˆæ¯”æœªç»“åˆè›‹ç™½è´¨çš„æ¢é’ˆçš„ç”µæ³³é€Ÿç‡è¦æ…¢ï¼Œ è¿›è€Œåˆ¤æ–­æŸä¸ªè›‹ç™½å’ŒæŸæ®µ DNA èƒ½å¦ç›´æ¥ç»“åˆã€‚</p><p><img src="https://bu.dusays.com/2023/06/28/649b9dec54b7f.png" alt="EMSA.png"></p>              </div>            </details><details class="folding-tag" ><summary> Chip(Chromatin ImmunoPrecipitation)æŸ“è‰²è´¨å…ç–«å…±æ²‰æ·€å®éªŒ </summary>              <div class='content'>              <p>åœ¨ç”Ÿç†çŠ¶æ€ä¹Ÿå°±æ˜¯æ´»ç»†èƒçŠ¶æ€ä¸‹ï¼ŒæŠŠç»†èƒå†…çš„ DNA ä¸è›‹ç™½è´¨äº¤è”åœ¨ä¸€èµ·ï¼Œé€šè¿‡è¶…å£°æˆ–é…¶å¤„ç†å°†å…¶éšæœºåˆ‡æ–­æˆä¸€å®šé•¿ åº¦èŒƒå›´å†…çš„æŸ“è‰²è´¨å°ç‰‡æ®µåï¼Œåˆ©ç”¨ç›®çš„è›‹ç™½æŠ—ä½“ï¼Œç‰¹å¼‚æ€§åœ°å¯Œé›†ç›®çš„è›‹ç™½ç»“åˆçš„ DNA ç‰‡æ®µã€‚æ¥ç€ï¼Œé€šè¿‡å¤šç§ä¸‹æ¸¸æ£€æµ‹æŠ€æœ¯ï¼Œå¦‚å®šé‡ PCRï¼ŒäºŒä»£æµ‹åºç­‰ æ¥æ£€æµ‹æ­¤å¯Œé›†ç‰‡æ®µçš„ DNA åº åˆ—ã€‚</p><p><img src="https://bu.dusays.com/2023/06/28/649b9fb4d093e.png" alt="CHIP.png" style="zoom:67%;" /></p>              </div>            </details></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="è›‹ç™½-è›‹ç™½"><a href="#è›‹ç™½-è›‹ç™½" class="headerlink" title="è›‹ç™½-è›‹ç™½"></a>è›‹ç™½-è›‹ç™½</h1><p>è›‹ç™½ä¸è›‹ç™½é€šè¿‡ç”Ÿæˆå¤åˆç‰©å‘æŒ¥ä½œç”¨ï¼Œæˆ–é€šè¿‡ç›´æ¥ç»“åˆæ•ˆåº”è›‹ç™½ï¼Œå½±å“æ•ˆåº”è›‹ç™½çš„åŠŸèƒ½</p><p><img src="https://bu.dusays.com/2023/06/27/6499c2c763c64.png" alt="è›‹ç™½-è›‹ç™½.png" style="zoom:67%;" /></p><h2 id="ç›¸å…³æ•°æ®åº“-1"><a href="#ç›¸å…³æ•°æ®åº“-1" class="headerlink" title="ç›¸å…³æ•°æ®åº“"></a>ç›¸å…³æ•°æ®åº“</h2><p><img src="https://bu.dusays.com/2023/06/27/6499c32ac65d4.png" alt="è›‹ç™½-è›‹ç™½æ•°æ®åº“.png"></p><h1 id="RNA-RNA-DNA"><a href="#RNA-RNA-DNA" class="headerlink" title="RNA-RNA/DNA"></a>RNA-RNA/DNA</h1><p>RNAæ—¢å¯ä»¥ç»“åˆåˆ°DNAä¸Šï¼Œå½±å“åŸºå› è½¬å½•ç­‰åŠŸèƒ½ã€‚ä¹Ÿå¯ä»¥ç»“åˆåˆ°RNAä¸Šï¼Œåœ¨è½¬å½•æ°´å¹³ä¸Šå½±å“RNAã€‚</p><p><img src="https://bu.dusays.com/2023/06/27/6499c4dfd14c6.png" alt="RNA- RNA.png" style="zoom:67%;" /></p><h2 id="ç›¸å…³æ•°æ®åº“-2"><a href="#ç›¸å…³æ•°æ®åº“-2" class="headerlink" title="ç›¸å…³æ•°æ®åº“"></a>ç›¸å…³æ•°æ®åº“</h2><p><img src="https://bu.dusays.com/2023/06/27/6499c542501f4.png" alt="RNA- RNAæ•°æ®åº“.png"></p><h1 id="RNA-è›‹ç™½"><a href="#RNA-è›‹ç™½" class="headerlink" title="RNA-è›‹ç™½"></a>RNA-è›‹ç™½</h1><p>RNAèƒ½å¤Ÿç»“åˆåˆ°è›‹ç™½ä¸Šï¼Œå½±å“è›‹ç™½åˆ°åŠŸèƒ½æˆ–è€…å®šä½ã€‚è›‹ç™½ä¹Ÿå¯ä»¥ä½œç”¨äºRNAï¼Œå½±å“RNAçš„åŠŸèƒ½</p><p><img src="https://bu.dusays.com/2023/06/27/6499c659cecc2.png" alt="protein-RNA.png" style="zoom:67%;" /></p><h2 id="ç›¸å…³æ•°æ®åº“-3"><a href="#ç›¸å…³æ•°æ®åº“-3" class="headerlink" title="ç›¸å…³æ•°æ®åº“"></a>ç›¸å…³æ•°æ®åº“</h2><p><img src="https://bu.dusays.com/2023/06/27/6499c659e7267.png" alt="è›‹ç™½- RNA database.png"></p><h1 id="åŒ–åˆç‰©-åˆ†å­"><a href="#åŒ–åˆç‰©-åˆ†å­" class="headerlink" title="åŒ–åˆç‰©-åˆ†å­"></a>åŒ–åˆç‰©-åˆ†å­</h1><p>åŒ–åˆç‰©å¯ä»¥é€šè¿‡ç›´æ¥ä½œç”¨æˆ–é—´æ¥ä½œç”¨å½±å“åˆ°ç»†èƒå†…é¶åˆ†å­çš„è¡¨è¾¾é‡åŠåŠŸèƒ½æ´»æ€§ã€‚</p><p><img src="https://bu.dusays.com/2023/06/27/6499c78653e9b.png" alt="mol-mol.png"></p><h2 id="ç›¸å…³æ•°æ®åº“-4"><a href="#ç›¸å…³æ•°æ®åº“-4" class="headerlink" title="ç›¸å…³æ•°æ®åº“"></a>ç›¸å…³æ•°æ®åº“</h2><p><img src="https://bu.dusays.com/2023/06/27/6499c78672683.png" alt="mol-mol database.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;è›‹ç™½-DNA&quot;&gt;&lt;a href=&quot;#è›‹ç™½-DNA&quot; class=&quot;headerlink&quot; title=&quot;è›‹ç™½-DNA&quot;&gt;&lt;/a&gt;è›‹ç™½-DNA&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;ä¹Ÿç§°è½¬å½•å› å­æ¨¡å¼ï¼Œæ‰€æœ‰è½¬å½•å› å­éƒ½åŒ…å«ä¸€æ®µ DNAç»“åˆåŸŸï¼Œç»“æ„åŸŸèƒ½å¤Ÿè¯†åˆ«å’Œç»“åˆåŸºå› å¯åŠ¨å­ç‰¹å¾DNA</summary>
      
    
    
    
    <category term="ç”Ÿç‰©ä¿¡æ¯å­¦" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="æ•°æ®åº“" scheme="https://smileszh.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    <category term="åˆ†å­äº’ä½œ" scheme="https://smileszh.github.io/tags/%E5%88%86%E5%AD%90%E4%BA%92%E4%BD%9C/"/>
    
  </entry>
  
  <entry>
    <title>WGCNA</title>
    <link href="https://smileszh.github.io/posts/572fa456.html"/>
    <id>https://smileszh.github.io/posts/572fa456.html</id>
    <published>2023-06-26T12:00:00.000Z</published>
    <updated>2023-07-04T11:39:42.505Z</updated>
    
    <content type="html"><![CDATA[<h1 id="WGCNA-å…¥é—¨"><a href="#WGCNA-å…¥é—¨" class="headerlink" title="WGCNA å…¥é—¨"></a>WGCNA å…¥é—¨</h1><div class="tabs" id="wgcnaå…¥é—¨"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="wgcnaå…¥é—¨-1">èƒŒæ™¯çŸ¥è¯†</button><button type="button" class="tab " data-href="wgcnaå…¥é—¨-2">ç®€ä»‹</button><button type="button" class="tab " data-href="wgcnaå…¥é—¨-3">åŸç†</button><button type="button" class="tab " data-href="wgcnaå…¥é—¨-4">åŸºæœ¬åˆ†ææµç¨‹</button><button type="button" class="tab " data-href="wgcnaå…¥é—¨-5">è®¡ç®—æ­¥éª¤</button></ul><div class="tab-contents"><div class="tab-item-content active" id="wgcnaå…¥é—¨-1"><ul><li>æƒé‡(weghted)ï¼šåŸºå› ä¹‹é—´ä¸ä»…ä»…æ˜¯ç›¸å…³ä¸å¦ï¼Œè¿˜è®°å½•ç€å®ƒä»¬çš„ç›¸å…³æ€§æ•°å€¼ï¼Œæ•°å€¼å°±æ˜¯åŸºå› ä¹‹é—´çš„è”ç³»çš„æƒé‡(ç›¸å…³æ€§)ã€‚</li><li>æ¨¡å—(module)ï¼šè¡¨è¾¾æ¨¡å¼ç›¸ä¼¼çš„åŸºå› åˆ†ä¸ºä¸€ç±»ï¼Œè¿™æ ·çš„ä¸€ç±»åŸºå› æˆä¸ºæ¨¡å—ã€‚</li><li>Eigengeneï¼šåŸºå› å’Œæ ·æœ¬æ„æˆçš„çŸ©é˜µã€‚</li><li>é‚»æ¥çŸ©é˜µ(Adjacency Matrix)ï¼šæ˜¯å›¾çš„ä¸€ç§å­˜å‚¨å½¢å¼ï¼Œç”¨ä¸€ä¸ªä¸€ç»´æ•°ç»„å­˜æ”¾å›¾ä¸­æ‰€æœ‰é¡¶ç‚¹æ•°æ®ï¼›ç”¨ä¸€ä¸ªäºŒç»´æ•°ç»„å­˜æ”¾é¡¶ç‚¹é—´å…³ç³»ï¼ˆè¾¹æˆ–å¼§ï¼‰çš„æ•°æ®ï¼Œè¿™ä¸ªäºŒç»´æ•°ç»„ç§°ä¸ºé‚»æ¥çŸ©é˜µï¼›åœ¨WGCNAåˆ†æé‡Œé¢æŒ‡çš„æ˜¯åŸºå› ä¸åŸºå› ä¹‹é—´çš„ç›¸å…³æ€§ç³»æ•°çŸ©é˜µã€‚ å¦‚æœç”¨äº†é˜ˆå€¼æ¥åˆ¤æ–­åŸºå› ç›¸å…³ä¸å¦ï¼Œé‚£ä¹ˆè¿™ä¸ªé‚»è¿‘çŸ©é˜µå°±æ˜¯0/1çŸ©é˜µï¼Œåªè®°å½•åŸºå› ç›¸å…³ä¸å¦ã€‚ä½†æ˜¯WGCNAæ²¡æœ‰ç”¨é˜ˆå€¼æ¥å¡åŸºå› çš„ç›¸å…³æ€§ï¼Œè€Œæ˜¯è®°å½•äº†æ‰€æœ‰åŸºå› ä¹‹é—´çš„ç›¸å…³æ€§ã€‚</li><li>æ‹“æ‰‘é‡å çŸ©é˜µ(TOMï¼ŒTopological Overlap Matrix)ï¼šWGNAè®¤ä¸ºåŸºå› ä¹‹é—´çš„ç®€å•çš„ç›¸å…³æ€§ä¸è¶³ä»¥è®¡ç®—å…±è¡¨è¾¾ï¼Œæ‰€ä»¥å®ƒåˆ©ç”¨é‚»è¿‘çŸ©é˜µï¼Œåˆè®¡ç®—äº†ä¸€ä¸ªæ–°çš„é‚»è¿‘çŸ©é˜µã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒTOMå°±æ˜¯WGCNAåˆ†æçš„æœ€ç»ˆç»“æœï¼Œåç»­çš„åªæ˜¯å¯¹TOMçš„ä¸‹æ¸¸æ³¨é‡Šã€‚</li></ul></div><div class="tab-item-content" id="wgcnaå…¥é—¨-2"><ul><li>WGCNAï¼ˆWeighted Gene Co-expression Network Analysisï¼‰ï¼Œå³åŠ æƒåŸºå› å…±è¡¨è¾¾ç½‘ç»œåˆ†æã€‚ æ˜¯ä¸€ç§æ„å»ºåŸºå› å…±è¡¨è¾¾ç½‘ç»œçš„å¸¸ç”¨ç³»ç»Ÿç”Ÿç‰©å­¦ç®—æ³•ï¼Œä¸ä¼ ç»Ÿçš„åŸºå› è¡¨è¾¾ç½‘ç»œç®—æ³•çš„ä¸»è¦å·®å¼‚åœ¨WGCNAé‡‡ç”¨äº†è½¯é˜ˆå€¼Î²å¯¹è¡¨è¾¾çŸ©é˜µè¿›è¡Œäº†åŠ æƒã€‚</li><li>WGCNAçš„åˆ†æç›®çš„åœ¨äºå¯»æ‰¾å…·æœ‰ååŒè¡¨è¾¾æˆ–å…±è¡¨è¾¾çš„åŸºå› ç»„æˆçš„ç½‘ç»œæ¨¡å—ï¼Œæ¢ç´¢è¿™äº›åŸºå› ç½‘ç»œæ¨¡å—ä¸ç ”ç©¶çš„è¡¨å‹æˆ–æ€§çŠ¶ä¹‹é—´çš„å…³ç³»ï¼Œå¯»æ‰¾ä¸å¤–éƒ¨ä¿¡æ¯ç›¸å…³çš„HubåŸºå› ã€‚</li></ul></div><div class="tab-item-content" id="wgcnaå…¥é—¨-3"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/06/26/6498fc8a1d155.png" style="width:1000px;"/></div></div></div><div class="tab-item-content" id="wgcnaå…¥é—¨-4"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/06/26/64990175eb5ee.png" style="width:600px;"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/06/26/649901e2a74b5.png" style="width:600px;"/></div></div></div><div class="tab-item-content" id="wgcnaå…¥é—¨-5"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/06/26/649902acb2818.png" style="width:600px;"/></div></div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="æ•°æ®è¦æ±‚"><a href="#æ•°æ®è¦æ±‚" class="headerlink" title="æ•°æ®è¦æ±‚"></a>æ•°æ®è¦æ±‚</h1><ul><li>è¡¨è¾¾çŸ©é˜µ</li><li>è¡¨å‹ä¿¡æ¯</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/06/26/6498fe959360d.png" style="width:1000px;"/></div></div><h1 id="åˆ†ææ‰‹æ®µ"><a href="#åˆ†ææ‰‹æ®µ" class="headerlink" title="åˆ†ææ‰‹æ®µ"></a>åˆ†ææ‰‹æ®µ</h1><details class="folding-tag" cyan><summary> åœ¨çº¿å·¥å…· </summary>              <div class='content'>              <ul><li><a href="http://bioinformatics.sdstate.edu/idep/">iDEP</a></li><li><a href="https://bmbls.bmi.osumc.edu/IRIS/">IRIS</a></li></ul>              </div>            </details><details class="folding-tag" cyan><summary> RåŒ… </summary>              <div class='content'>              <ul><li>WGCNAåŒ…</li></ul>              </div>            </details><h1 id="ç»“æœè§£è¯»"><a href="#ç»“æœè§£è¯»" class="headerlink" title="ç»“æœè§£è¯»"></a>ç»“æœè§£è¯»</h1><div class="tabs" id="ç»“æœè§£è¯»"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="ç»“æœè§£è¯»-1">æ ·æœ¬å’Œæ€§çŠ¶çƒ­å›¾</button><button type="button" class="tab " data-href="ç»“æœè§£è¯»-2">é€‰æ‹©è½¯é˜ˆå€¼ÃŸ</button><button type="button" class="tab " data-href="ç»“æœè§£è¯»-3">éªŒè¯æ˜¯å¦ç¬¦åˆæ— å°ºåº¦ç½‘ç»œ</button><button type="button" class="tab " data-href="ç»“æœè§£è¯»-4">TOMçŸ©é˜µåŸºå› èšç±»å›¾ä¸ç½‘ç»œæ¨¡å—å›¾</button><button type="button" class="tab " data-href="ç»“æœè§£è¯»-5">åˆæ­¥æ„å»ºçš„ç½‘ç»œæ¨¡å—è¿›è¡Œåˆå¹¶</button><button type="button" class="tab " data-href="ç»“æœè§£è¯»-6">åˆå¹¶å‰ååŸºå› èšç±»ä¸ç½‘ç»œæ¨¡å—å¯¹æ¯”å›¾</button><button type="button" class="tab " data-href="ç»“æœè§£è¯»-7">æ¨¡å—ä¸æ€§çŠ¶å…³ç³»çƒ­å›¾</button><button type="button" class="tab " data-href="ç»“æœè§£è¯»-8">æ¨¡å—GS vs MM</button><button type="button" class="tab " data-href="ç»“æœè§£è¯»-9">ç½‘ç»œæ‹“æ‰‘ç»“æ„çš„å¯è§†åŒ–</button></ul><div class="tab-contents"><div class="tab-item-content active" id="ç»“æœè§£è¯»-1"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/06/26/64990343be8a5.png" style="width:800px;"/></div></div></div><div class="tab-item-content" id="ç»“æœè§£è¯»-2"><p>ä¸ºäº†è¡¡é‡ä¸¤ä¸ªåŸºå› æ˜¯å¦å…·æœ‰ç›¸ä¼¼è¡¨è¾¾æ¨¡å¼ï¼Œä¸€èˆ¬éœ€è¦è®¾ç½®é˜ˆå€¼æ¥ç­›é€‰ï¼Œé«˜äºé˜ˆå€¼çš„åˆ™è®¤ä¸ºæ˜¯ç›¸ä¼¼çš„ã€‚ä½†æ˜¯å‡è®¾ç›´æ¥å°†é˜ˆå€¼è®¾ä¸º0.8ï¼Œé‚£ä¹ˆå¾ˆéš¾è¯´æ˜0.8å’Œ0.79ä¸¤ä¸ªæ˜¯æœ‰æ˜¾è‘—å·®åˆ«çš„ã€‚å› æ­¤ï¼Œ<strong>WGCNAåˆ†ææ—¶é‡‡ç”¨ç›¸å…³ç³»æ•°åŠ æƒå€¼ï¼Œå³å¯¹åŸºå› ç›¸å…³ç³»æ•°å–Næ¬¡å¹‚</strong>ï¼Œä½¿å¾—ç½‘ç»œä¸­çš„åŸºå› ä¹‹é—´çš„è¿æ¥æœä»<strong>æ— å°ºåº¦ç½‘ç»œåˆ†å¸ƒ(scale-freenetworks)</strong>ï¼Œè¿™ç§ç®—æ³•æ›´å…·ç”Ÿç‰©å­¦æ„ä¹‰ã€‚</p><ul><li>å¦‚ä¾‹å›¾æ‰€ç¤ºï¼Œéšç€ÃŸå¢å¤§ï¼ŒR^2^å¢å¤§ï¼Œç½‘ç»œçš„è¿é€šæ€§é™ä½ï¼›ÃŸ=9æ—¶å‘¢ï¼Œç½‘ç»œçš„è¿é€šæ€§å¾ˆä½ï¼Œè¿™æ—¶æˆ‘ä»¬è€ƒè™‘é™ä½R^2^çš„é€‰æ‹©ï¼Œé€‰æ‹©ÃŸ=5ã€‚ï¼ˆR^2^æœ€å¥½ä¸è¦ä½äº0.8ï¼‰</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/06/26/649905af0cdbb.png" style="width:800px;"/></div></div></div><div class="tab-item-content" id="ç»“æœè§£è¯»-3"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/06/26/64995c53a66de.png" style="width:700px;"/></div></div></div><div class="tab-item-content" id="ç»“æœè§£è¯»-4"><p>é€šè¿‡åŸºå› ä¹‹é—´çš„ç›¸å…³ç³»æ•°æ„å»ºåˆ†å±‚èšç±»æ ‘ï¼Œ<strong>èšç±»æ ‘çš„ä¸åŒåˆ†æ”¯ä»£è¡¨ä¸åŒçš„åŸºå› æ¨¡å—</strong>ï¼Œä¸åŒé¢œè‰²ä»£è¡¨ä¸åŒçš„æ¨¡å—ã€‚åŸºäºåŸºå› çš„åŠ æƒç›¸å…³ç³»æ•°ï¼Œå°†åŸºå› æŒ‰ç…§è¡¨è¾¾æ¨¡å¼è¿›è¡Œåˆ†ç±»ï¼Œå°†æ¨¡å¼ç›¸ä¼¼çš„åŸºå› å½’ä¸ºä¸€ä¸ªæ¨¡å—ã€‚è¿™æ ·å°±å¯ä»¥å°†å‡ ä¸‡ä¸ªåŸºå› é€šè¿‡åŸºå› è¡¨è¾¾æ¨¡å¼è¢«åˆ†æˆäº†å‡ åä¸ªæ¨¡å—ï¼Œæ˜¯ä¸€ä¸ªæå–å½’çº³ä¿¡æ¯çš„è¿‡ç¨‹ã€‚</p><ul><li>åŠ¨æ€å‰ªåˆ‡æ ‘ç®—æ³•å¯¹åŸºå› æ‹“æ‰‘çŸ©é˜µè¿›è¡Œèšç±»ï¼Œåˆæ­¥è¯†åˆ«ç½‘ç»œæ¨¡å—</li><li>Heightè¡¨ç¤ºåŸºå› ä¹‹é—´çš„ç›¸å¼‚æ€§ç¨‹åº¦ï¼Œè¶Šå¤§è¡¨ç¤ºåŸºå› ååŒè¡¨è¾¾å·®å¼‚è¶Šå¤§ï¼Œä¸å±äºä¸€ä¸ªç½‘ç»œæ¨¡å—</li><li>ä¸åŒé¢œè‰²ç”¨äºè¡¨ç¤ºä¸åŒçš„ç½‘ç»œæ¨¡å— </li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/06/26/64995f24b987f.png" style="width:800px;"/></div></div></div><div class="tab-item-content" id="ç»“æœè§£è¯»-5"><p>å¯¹åˆæ­¥æ„å»ºçš„ç½‘ç»œæ¨¡å—è¿›è¡Œåˆå¹¶, å·¦å›¾ä¸­çº¢çº¿è¡¨ç¤º0.25ï¼Œåœ¨çº¢çº¿ä¸‹é¢è¡¨ç¤ºï¼šè¿™äº›æ¨¡å—ä¹‹é—´çš„ç›¸å¼‚ç¨‹åº¦å°äº0.25ï¼Œå³ç›¸ä¼¼ç¨‹åº¦é«˜äº0.75ï¼Œå°†è¿™äº›æ¨¡å—åˆå¹¶ä¸ºä¸€ä¸ªæ¨¡å—ï¼Œå¦‚å³å›¾æ‰€ç¤ºã€‚ </p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/06/26/6499610078f57.png" style="width:700px;"/></div></div></div><div class="tab-item-content" id="ç»“æœè§£è¯»-6"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/06/26/649977698f12e.png" style="width:800px;"/></div></div></div><div class="tab-item-content" id="ç»“æœè§£è¯»-7"><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/06/26/649977b34c5b4.png" style="width:800px;"/></div></div></div><div class="tab-item-content" id="ç»“æœè§£è¯»-8"><ul><li>GS: (Gene Significance) ï¼Œè¡¨ç¤ºåŸºå› æ˜¾è‘—æ€§ï¼Œå®šä¹‰å•ä¸ªåŸºå› ä¸å¤–éƒ¨ä¿¡æ¯çš„å…³è”æ€§ï¼Œå³åŸºå› ä¸æŸä¸ªæ€§çŠ¶çš„ç›¸å…³æ€§ã€‚</li><li>MM: (Module Membership) ï¼Œç”¨äºæè¿°æ¨¡å—çš„æŒ‡æ ‡ï¼Œæ˜¯åŸºäºGSå€¼è®¡ç®—å‡ºæ¥ã€‚</li><li>GSå’ŒMMé«˜åº¦ç›¸å…³, ä¸æŸä¸ªæ€§çŠ¶é«˜åº¦ç›¸å…³çš„åŸºå› æ‰€åœ¨çš„æ¨¡å—å¾€å¾€ä¹Ÿä¸è¯¥æ€§çŠ¶ç›¸å…³ã€‚</li><li>å›¾ä¸­çš„æ¨ªåæ ‡è¡¨ç¤ºMMå€¼ï¼Œçºµåæ ‡è¡¨ç¤ºGSå€¼ï¼Œå¯ä»¥çœ‹å‡ºåœ¨brownæ¨¡å—ä¸­GSå€¼å’ŒMMå€¼é«˜åº¦å…³è”ï¼Œä»på€¼çœ‹ä¹Ÿæ˜¯æ˜¾è‘—ç›¸å…³çš„ã€‚ </li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/06/26/649979963972f.png" style="width:600px;"/></div></div></div><div class="tab-item-content" id="ç»“æœè§£è¯»-9"><p>å›¾ä¸­æ˜¯å¯¹ç½‘ç»œæ¨¡å—æ‹“æ‰‘ç»“æ„çš„å¯è§†åŒ–ï¼Œä½¿ç”¨çš„æ•°æ®æ˜¯ç½‘ç»œæ‹“æ‰‘ï¼ˆTOMï¼‰çŸ©é˜µï¼Œä¸Šä¾§å’Œå·¦ä¾§è¡¨ç¤ºå±‚æ¬¡èšç±»ç»“æœã€‚ä»çƒ­å›¾å¯ä»¥çœ‹å‡ºï¼Œçƒ­å›¾çš„ç»“æœä¸èšç±»çš„æ ‘æä¸€ä¸€å¯¹åº”ã€‚ </p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/06/26/64997a4b6359e.png" style="width:600px;"/></div></div></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;WGCNA-å…¥é—¨&quot;&gt;&lt;a href=&quot;#WGCNA-å…¥é—¨&quot; class=&quot;headerlink&quot; title=&quot;WGCNA å…¥é—¨&quot;&gt;&lt;/a&gt;WGCNA å…¥é—¨&lt;/h1&gt;&lt;div class=&quot;tabs&quot; id=&quot;wgcnaå…¥é—¨&quot;&gt;&lt;ul class=&quot;nav-tab</summary>
      
    
    
    
    <category term="ç”Ÿç‰©ä¿¡æ¯å­¦" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="èšç±»åˆ†æ" scheme="https://smileszh.github.io/tags/%E8%81%9A%E7%B1%BB%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>ç”Ÿç‰©æ•°æ®åº“åŸºå› ID</title>
    <link href="https://smileszh.github.io/posts/df5af0f1.html"/>
    <id>https://smileszh.github.io/posts/df5af0f1.html</id>
    <published>2023-06-11T14:00:00.000Z</published>
    <updated>2023-07-04T12:04:57.722Z</updated>
    
    <content type="html"><![CDATA[<p><em>å°è‹ç¢ç¢å¿µï¼š</em></p><p><em>ç§‘ç ”åˆ†æä¸­ç»å¸¸ä¼šé‡åˆ°å„ç§å„æ ·çš„åŸºå› IDç±»å‹ï¼Œäº†è§£å„ç§å‘½åçš„æ¥æºå’Œè§„åˆ™æœ‰åŠ©äºæˆ‘ä»¬åœ¨ä¸åŒçš„æ•°æ®åº“ä¹‹é—´è¿›è¡Œè½¬æ¢å’Œä½¿ç”¨ã€‚åŒæ—¶å› å„ç§å„æ ·çš„æ•°æ®åº“è¶Šæ¥è¶Šå¤šï¼Œæœ¬æ–‡æ¡£ä¹Ÿä¼šæŒç»­å®Œå–„å’Œæ›´æ–°ï½ï½ï½ğŸŠã€‚</em></p><h1 id="èƒŒæ™¯çŸ¥è¯†"><a href="#èƒŒæ™¯çŸ¥è¯†" class="headerlink" title="èƒŒæ™¯çŸ¥è¯†"></a>èƒŒæ™¯çŸ¥è¯†</h1><ul><li><p>NCBIï¼šNational Center for Biotechnology Information, å³ç¾å›½å›½å®¶ç”Ÿç‰©æŠ€æœ¯ä¿¡æ¯ä¸­å¿ƒï¼Œæ˜¯ä¸€ä¸ªæœºæ„åç§°ï¼Œä¸æ˜¯æ•°æ®åº“ã€‚</p></li><li><p><a href="https://www.ncbi.nlm.nih.gov/">Entrez</a> æ˜¯ä¸€ä¸ªå½’å±äº NCBI çš„ç»¼åˆæ€§çš„ç”Ÿç‰©ä¿¡æ¯æ•°æ®æ£€ç´¢å¼•æ“ç³»ç»Ÿï¼Œè¿™ä¸ªæœç´¢å¼•æ“æ•´åˆäº†åŒ…å«æ ¸é…¸ã€è›‹ç™½è´¨ã€åŸºå› ã€åŸºå› ç»„ã€GEO ç­‰åœ¨å†…çš„å¾ˆå¤šå¸¸ç”¨æ•°æ®åº“ã€‚</p></li><li>HGNC: HUGO Gene Nomenclature Committee, å³äººç±»åŸºå› å‘½åå§”å‘˜ä¼šã€‚äººç±»å¤§å¤šåŸºå› çš„å‘½åï¼Œæ˜¯æœ‰HGNCå®Œæˆçš„ã€‚</li><li>å°é¼ ï¼ˆmouseï¼‰çš„åŸºå› å‘½åæ¥æºäºMGNCï¼›å¤§é¼ ï¼ˆratï¼‰åŸºå› å‘½åæ¥æºäºRGNCï¼›æ–‘é©¬é±¼ï¼ˆzebrafishï¼‰åŸºå› å‘½åæ¥æºäºZFIN</li><li><a href="https://www.ensembl.org/index.html">Ensembl</a> åŸºå› ç»„æ•°æ®åº“é¡¹ç›®ï¼Œæ˜¯ 1999 å¹´å¯åŠ¨çš„ï¼Œæ¥åº”å¯¹å½“æ—¶å³å°†å®Œæˆçš„äººç±»åŸºå› ç»„è®¡åˆ’çš„ä¸€ä¸ªç§‘å­¦é¡¹ç›®ï¼Œæ˜¯ç§‘ç ”äººå‘˜ç”¨äºæ£€ç´¢åŸºå› ç»„ä¿¡æ¯çš„æœ€å¸¸ç”¨æ•°æ®åº“ä¹‹ä¸€ã€‚</li><li>refseqå‚è€ƒåºåˆ—æ•°æ®åº“ï¼Œæ˜¯NCBIæä¾›çš„å…·æœ‰ç”Ÿç‰©å­¦æ„ä¹‰ä¸Šçš„éå†—ä½™çš„åŸºå› å’Œè›‹ ç™½ç­‰ç‰‡æ®µåºåˆ—çš„æ•°æ®åº“ã€‚å®ƒæ˜¯ç›®å‰ä¸–ç•Œä¸Šæ¯”è¾ƒæƒå¨çš„åºåˆ—æ•°æ®åº“ï¼Œä¸€èˆ¬å¯ä¿¡åº¦æ˜¯æ¯”è¾ƒé«˜çš„ã€‚</li></ul><h1 id="Entrez-Gene-ID"><a href="#Entrez-Gene-ID" class="headerlink" title="Entrez Gene ID"></a>Entrez Gene ID</h1><blockquote><p>Entrez ID</p></blockquote><p>Entrez gene ID æ¥æºäº Entrez gene æ•°æ®åº“çš„ç¼–å·ç³»ç»Ÿã€‚Entrez åŸºå› æ•°æ®åº“å…¶å®å°±æ˜¯æˆ‘ä»¬ç°åœ¨æŒ‡çš„ NCBI ä¸­çš„ Gene æ•°æ®åº“ï¼Œè¿™ä¸¤ä¸ªåå­—æŒ‡çš„æ˜¯åŒä¸€ä¸ªæ•°æ®åº“</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/06/11/6485cd2ea5710.png" style="width:600px;"/></div></div><p>Entrez Gene IDç¼–å·çš„æ ¼å¼å°±æ˜¯ä¸€ä¸²æ•°å­—ã€‚æ¯”å¦‚è¯´åƒ <a href="https://www.ncbi.nlm.nih.gov/gene/7157">TP53</a>ï¼Œä»–ä¸‹é¢çš„ gene ID:7157</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/06/11/6485ce4cac856.png" style="width:600px;"/></div></div><h1 id="Gene-Symbol"><a href="#Gene-Symbol" class="headerlink" title="Gene Symbol"></a>Gene Symbol</h1><blockquote><p>official Symbol,  HGNC symbol</p></blockquote><ul><li>Office symbol: æ˜¯HGNCç»„ç»‡å¯¹åŸºå› è¿›è¡Œå‘½åçš„æè¿°çš„ä¸€ä¸ªç¼©å†™æ ‡è¯†ç¬¦</li><li>Office Full Name: æ˜¯ç»HGNCæ‰¹å‡†çš„åŸºå› åå…¨ç§°</li><li>HGNC IDï¼šæ˜¯HGNCæ•°æ®åº“åˆ†é…çš„åŸºå› ç¼–å·ï¼Œæ¯ä¸ªæ ‡å‡†çš„symboléƒ½æœ‰å¯¹åº”çš„HGNC ID</li></ul><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/06/11/6485d13d7e1d7.png" style="width:600px;"/></div></div><p><em>æ³¨ï¼šå¹¶ä¸æ˜¯æ‰€æœ‰çš„åŸºå› éƒ½æœ‰Official Symbolã€‚å¦‚æœåŸºå› ç¼ºå°‘åŸºå› å‘½åå§”å‘˜ä¼šå‘½åçš„Gene Symbolï¼ŒEntez Geneæ•°æ®åº“ä¸­çš„Official symbol å°±ä¼šå˜ä¸ºGene Symbol, å¹¶ä¸”Gene Symbolçš„ç¼–å·ä¼šå˜ä¸ºLOCå‰ç¼€åŠ Entrez IDã€‚</em>å¦‚ï¼š</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/06/11/6485d3fde40a0.png" style="width:600px;"/></div></div><h1 id="Ensemble-ID"><a href="#Ensemble-ID" class="headerlink" title="Ensemble ID"></a>Ensemble ID</h1><blockquote><p>Ensembl Stable ID </p></blockquote><p>å‘½åè§„åˆ™ï¼šENS[æ ¹æ®ä¸åŒç‰©ç§è®¾ç½®çš„å‰ç¼€][æ•°æ®æ‰€æŒ‡ç±»å‹ï¼ˆå¦‚åŸºå› ï¼Œè›‹ç™½ç­‰ï¼‰][ä¸€æ®µç‰¹å®šçš„æ•°å­—] . [ç‰ˆæœ¬]</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/06/11/6485d81a96f6c.png" style="width:600px;"/></div></div><h1 id="RefSeq-Accession-Number"><a href="#RefSeq-Accession-Number" class="headerlink" title="RefSeq Accession Number"></a>RefSeq Accession Number</h1><blockquote><p>RefSeq ID</p></blockquote><p>å‘½åçš„æ ¼å¼ä»¥ä¸¤ä¸ªå­—æ¯å¼€å¤´ï¼Œåé¢è·Ÿä¸€ä¸ªä¸‹åˆ’çº¿å’Œå…­ä¸ªæˆ–å¤šä¸ªå­—æ¯</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/06/11/6485db197eb94.png" style="width:600px;"/></div></div><p><em>æ³¨ï¼šåœ¨ NCBI çš„è¿™ä¸ªæ£€ç´¢ç»“æœé‡Œï¼Œrefseq status è¿™ä¸€è¡Œä¼šæ˜¾ç¤ºè¿™æ¡ refseq çš„çŠ¶æ€ã€‚ä¸»è¦çŠ¶æ€æœ‰:MODEL æŒ‡è‡ªåŠ¨è¢« NCBI æä¾›çš„ï¼Œæ²¡æœ‰è¢«å®¡æ ¸è¿‡ï¼ŒINFERRED æŒ‡ç”±åºåˆ—åˆ†æé¢„æµ‹å¾—åˆ°ï¼Œæ²¡æœ‰ç»è¿‡å®éªŒéªŒè¯ï¼ŒPREDICTED æŒ‡æ²¡æœ‰ç»è¿‡äººå·¥å®¡æ ¸ï¼ŒREVIEWED æŒ‡å·²è¢«äººå·¥å®¡ æ ¸ç­‰ç­‰ï¼Œå¯ä»¥æ ¹æ®è¿™æ¡ä¿¡æ¯è®¤å®šåºåˆ—çš„å¯ä¿¡åº¦ã€‚</em></p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://bu.dusays.com/2023/06/11/6485d9504d3a7.png" style="width:600px;"/></div></div>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;em&gt;å°è‹ç¢ç¢å¿µï¼š&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;ç§‘ç ”åˆ†æä¸­ç»å¸¸ä¼šé‡åˆ°å„ç§å„æ ·çš„åŸºå› IDç±»å‹ï¼Œäº†è§£å„ç§å‘½åçš„æ¥æºå’Œè§„åˆ™æœ‰åŠ©äºæˆ‘ä»¬åœ¨ä¸åŒçš„æ•°æ®åº“ä¹‹é—´è¿›è¡Œè½¬æ¢å’Œä½¿ç”¨ã€‚åŒæ—¶å› å„ç§å„æ ·çš„æ•°æ®åº“è¶Šæ¥è¶Šå¤šï¼Œæœ¬æ–‡æ¡£ä¹Ÿä¼šæŒç»­å®Œå–„å’Œæ›´æ–°ï½ï½ï½ğŸŠã€‚&lt;/em&gt;&lt;/p&gt;
&lt;h1 id=&quot;èƒŒæ™¯</summary>
      
    
    
    
    <category term="ç§‘ç ”çŸ¥è¯†" scheme="https://smileszh.github.io/categories/%E7%A7%91%E7%A0%94%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="åŸºå› ID" scheme="https://smileszh.github.io/tags/%E5%9F%BA%E5%9B%A0ID/"/>
    
    <category term="ç”Ÿç‰©æ•°æ®åº“" scheme="https://smileszh.github.io/tags/%E7%94%9F%E7%89%A9%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>å®šé‡å¼•ç‰©è®¾è®¡</title>
    <link href="https://smileszh.github.io/posts/e7e9fba0.html"/>
    <id>https://smileszh.github.io/posts/e7e9fba0.html</id>
    <published>2023-06-10T16:00:00.000Z</published>
    <updated>2023-06-11T14:07:35.982Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æŸ¥æ‰¾åŸºå› "><a href="#æŸ¥æ‰¾åŸºå› " class="headerlink" title="æŸ¥æ‰¾åŸºå› "></a>æŸ¥æ‰¾åŸºå› </h1><h2 id="è¿›å…¥NCBIå®˜ç½‘"><a href="#è¿›å…¥NCBIå®˜ç½‘" class="headerlink" title="è¿›å…¥NCBIå®˜ç½‘"></a>è¿›å…¥<a href="https://www.ncbi.nlm.nih.gov/">NCBIå®˜ç½‘</a></h2><p><img src="https://bu.dusays.com/2023/06/11/6484a6b1c4eae.png" alt="å®˜ç½‘.png" style="zoom: 35%;" /></p><h2 id="æŸ¥æ‰¾åºåˆ—"><a href="#æŸ¥æ‰¾åºåˆ—" class="headerlink" title="æŸ¥æ‰¾åºåˆ—"></a>æŸ¥æ‰¾åºåˆ—</h2><p><img src="https://bu.dusays.com/2023/06/11/6484a6b1d340a.png" alt="æŸ¥æ‰¾åŸºå› 1.png" style="zoom:35%;" /></p><h2 id="æŸ¥æ‰¾åŸºå› ID"><a href="#æŸ¥æ‰¾åŸºå› ID" class="headerlink" title="æŸ¥æ‰¾åŸºå› ID"></a>æŸ¥æ‰¾åŸºå› ID</h2><p><img src="https://bu.dusays.com/2023/06/11/6484a6b1d0f51.png" alt="æŸ¥æ‰¾åŸºå› 2.png" style="zoom:35%;" /></p><h1 id="å¼•ç‰©è®¾è®¡"><a href="#å¼•ç‰©è®¾è®¡" class="headerlink" title="å¼•ç‰©è®¾è®¡"></a>å¼•ç‰©è®¾è®¡</h1><h2 id="æ‰“å¼€Prime-BLAST"><a href="#æ‰“å¼€Prime-BLAST" class="headerlink" title="æ‰“å¼€Prime-BLAST"></a>æ‰“å¼€<a href="https://www.ncbi.nlm.nih.gov/tools/primer-blast/index.cgi?LINK_LOC=BlastHome">Prime-BLAST</a></h2><p><img src="https://bu.dusays.com/2023/06/11/6484a6b1c5396.png" alt="å¼•ç‰©1.png" style="zoom:35%;" /></p><h2 id="æ ¹æ®éœ€æ±‚å¡«å†™å‚æ•°"><a href="#æ ¹æ®éœ€æ±‚å¡«å†™å‚æ•°" class="headerlink" title="æ ¹æ®éœ€æ±‚å¡«å†™å‚æ•°"></a>æ ¹æ®éœ€æ±‚å¡«å†™å‚æ•°</h2><p><img src="https://bu.dusays.com/2023/06/11/6484a6b1dbb3c.png" alt="å¼•ç‰©2.png" style="zoom:35%;" /></p><h1 id="ç»“æœç­›é€‰"><a href="#ç»“æœç­›é€‰" class="headerlink" title="ç»“æœç­›é€‰"></a>ç»“æœç­›é€‰</h1><p><img src="https://bu.dusays.com/2023/06/11/6484a6b1c5b30.png" alt="ç»“æœ.png" style="zoom:40%;" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æŸ¥æ‰¾åŸºå› &quot;&gt;&lt;a href=&quot;#æŸ¥æ‰¾åŸºå› &quot; class=&quot;headerlink&quot; title=&quot;æŸ¥æ‰¾åŸºå› &quot;&gt;&lt;/a&gt;æŸ¥æ‰¾åŸºå› &lt;/h1&gt;&lt;h2 id=&quot;è¿›å…¥NCBIå®˜ç½‘&quot;&gt;&lt;a href=&quot;#è¿›å…¥NCBIå®˜ç½‘&quot; class=&quot;headerlink&quot; title=&quot;è¿›</summary>
      
    
    
    
    <category term="ç§‘ç ”çŸ¥è¯†" scheme="https://smileszh.github.io/categories/%E7%A7%91%E7%A0%94%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="å¼•ç‰©è®¾è®¡" scheme="https://smileszh.github.io/tags/%E5%BC%95%E7%89%A9%E8%AE%BE%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>tidyverseï¼šå¤„ç†å…³ç³»æ•°æ®</title>
    <link href="https://smileszh.github.io/posts/7218365e.html"/>
    <id>https://smileszh.github.io/posts/7218365e.html</id>
    <published>2023-06-10T15:00:00.000Z</published>
    <updated>2023-07-04T08:49:49.778Z</updated>
    
    <content type="html"><![CDATA[<details class="folding-tag" ><summary> æ–‡æ¡£ä½¿ç”¨æ•°æ®æºè¯´æ˜ </summary>              <div class='content'>              <p>æ–‡æ¡£ä¸­ä¸¾ä¾‹é™¤äº†ä½¿ç”¨è‡ªå»ºæ•°æ®å¤–ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ nycflights13ã€‚è¿™ä¸ªæ•°æ®åŒ…å«äº† 2013 å¹´ä»çº½çº¦å¸‚å‡ºå‘çš„æ‰€æœ‰ 336 776æ¬¡èˆªç­çš„ä¿¡æ¯ã€‚è¯¥æ•°æ®æ¥è‡ªäºç¾å›½äº¤é€šç»Ÿè®¡å±€ï¼Œ å¯ä»¥ä½¿ç”¨?nycflights13 æŸ¥çœ‹å…¶è¯´æ˜æ–‡æ¡£ã€‚åŒ…æ‹¬flights, airports, planes, weather, airlineäº”ä¸ªæ•°æ®æ¡†ã€‚ æ–‡æ¡£ä¸­å¦‚å‡ºç°æ­¤ç±»æ•°æ®å¯¹è±¡ï¼Œä¸å†å¦è¡Œè¯´æ˜ã€‚</p><ul><li>flights: åŒ…å«èˆªç­ä¿¡æ¯</li><li>airlines:å¯ä»¥æ ¹æ®èˆªç©ºå…¬å¸çš„ç¼©å†™ç æŸ¥åˆ°å…¬å¸å…¨åã€‚</li><li>airports:ç»™å‡ºäº†æ¯ä¸ªæœºåœºçš„ä¿¡æ¯ï¼Œé€šè¿‡ faa æœºåœºç¼–ç è¿›è¡Œæ ‡è¯†ã€‚</li><li>planes:ç»™å‡ºäº†æ¯æ¶é£æœºçš„ä¿¡æ¯ï¼Œé€šè¿‡ tailnum è¿›è¡Œæ ‡è¯†ã€‚</li><li>weather:ç»™å‡ºäº†çº½çº¦æœºåœºæ¯å°æ—¶çš„å¤©æ°”çŠ¶å†µã€‚</li></ul><p><img src="https://bu.dusays.com/2023/06/10/64847e2f85887.png" alt="æ•°æ®å…³ç³».png" style="zoom: 25%;" /></p><p>RåŒ…ä½¿ç”¨ï¼š<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>tidyverse<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>nycflights13<span class="punctuation">)</span></span><br></pre></td></tr></table></figure></p>              </div>            </details><h1 id="ç›¸å…³æ¦‚å¿µ"><a href="#ç›¸å…³æ¦‚å¿µ" class="headerlink" title="ç›¸å…³æ¦‚å¿µ"></a>ç›¸å…³æ¦‚å¿µ</h1><ul><li><strong>é”®</strong>ï¼šç”¨äºè¿æ¥æ¯å¯¹æ•°æ®è¡¨å¯¹å˜é‡ç§°ä¸ºé”®ï¼Œé”®æ˜¯èƒ½å”¯ä¸€æ ‡è¯†è§‚æµ‹çš„å˜é‡ï¼ˆæˆ–å˜é‡é›†åˆï¼‰</li><li><strong>ä¸»é”®</strong>ï¼šå”¯ä¸€æ ‡è¯†å…¶æ‰€åœ¨æ•°æ®æ¡†çš„è§‚æµ‹</li><li><strong>å¤–é”®</strong>ï¼šå”¯ä¸€æ ‡è¯†å¦ä¸€ä¸ªæ•°æ®è¡¨ä¸­çš„è§‚æµ‹</li><li><strong>ä»£ç†é”®</strong>ï¼šä¸€ä¸ªè¡¨æ ¼æ²¡æœ‰ä¸»é”®æ—¶ï¼Œä½¿ç”¨mutate()å’Œrow_number()å‡½æ•°äººä¸ºæ·»åŠ çš„ä¸€ä¸ªä¸»é”®ç§°ä¸ºä»£ç†é”®</li></ul><h1 id="åˆå¹¶è¿æ¥"><a href="#åˆå¹¶è¿æ¥" class="headerlink" title="åˆå¹¶è¿æ¥"></a>åˆå¹¶è¿æ¥</h1><blockquote><p>åˆå¹¶è¿æ¥å°†ä¸¤ä¸ªè¡¨æ ¼ä¸­çš„å˜é‡è¿›è¡Œç»„åˆï¼Œé€šè¿‡ä¸¤ä¸ªè¡¨æ ¼ä¸­é”®åŒ¹é…è§‚æµ‹ï¼Œç„¶åå°†ä¸€ä¸ªè¡¨æ ¼ä¸­çš„å˜é‡å¤åˆ¶åˆ°å¦ä¸€ä¸ªè¡¨æ ¼ä¸­ã€‚</p></blockquote><div class="tabs" id="åˆå¹¶è¿æ¥"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="åˆå¹¶è¿æ¥-1">å†…è¿æ¥</button><button type="button" class="tab " data-href="åˆå¹¶è¿æ¥-2">å¤–è¿æ¥</button></ul><div class="tab-contents"><div class="tab-item-content active" id="åˆå¹¶è¿æ¥-1"><p>å†…è¿æ¥ inner_join() </p><blockquote><p>ä¿ç•™Xå’ŒYä¸­å…±æœ‰çš„è§‚æµ‹</p></blockquote><p><img src="https://bu.dusays.com/2023/06/10/64843c3112eed.png" alt="å†…è¿æ¥.png" style="zoom:50%;" /></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ•°æ®æ„é€ </span></span><br><span class="line"></span><br><span class="line">x <span class="operator">&lt;-</span> tribble<span class="punctuation">(</span></span><br><span class="line">  <span class="operator">~</span>key<span class="punctuation">,</span> <span class="operator">~</span>val_x<span class="punctuation">,</span></span><br><span class="line">  <span class="number">1</span><span class="punctuation">,</span> <span class="string">&quot;x1&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="number">2</span><span class="punctuation">,</span> <span class="string">&quot;x2&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="number">3</span><span class="punctuation">,</span> <span class="string">&quot;x3&quot;</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">y <span class="operator">&lt;-</span> tribble<span class="punctuation">(</span></span><br><span class="line">  <span class="operator">~</span>key<span class="punctuation">,</span> <span class="operator">~</span>val_x<span class="punctuation">,</span></span><br><span class="line">  <span class="number">1</span><span class="punctuation">,</span> <span class="string">&quot;y1&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="number">2</span><span class="punctuation">,</span> <span class="string">&quot;y2&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="number">4</span><span class="punctuation">,</span> <span class="string">&quot;y3&quot;</span></span><br><span class="line"><span class="punctuation">)</span>  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å†…è¿æ¥</span></span><br><span class="line"></span><br><span class="line">x <span class="operator">%&gt;%</span></span><br><span class="line">  inner_join<span class="punctuation">(</span>y<span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&quot;key&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A tibble: 2 Ã— 3</span></span><br><span class="line">    key val_x.x val_x.y</span><br><span class="line">  <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span> <span class="operator">&lt;</span>chr<span class="operator">&gt;</span>   <span class="operator">&lt;</span>chr<span class="operator">&gt;</span>  </span><br><span class="line"><span class="number">1</span>     <span class="number">1</span> x1      y1     </span><br><span class="line"><span class="number">2</span>     <span class="number">2</span> x2      y2  </span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="åˆå¹¶è¿æ¥-2"><blockquote><ul><li>å·¦è¿æ¥ï¼šä¿ç•™xä¸­çš„æ‰€æœ‰è§‚æµ‹</li><li>å³è¿æ¥ï¼šä¿ç•™Yä¸­çš„æ‰€æœ‰è§‚æµ‹</li><li>å…¨è¿æ¥ï¼Œä¿ç•™Xå’ŒYä¸­æ‰€æœ‰è§‚æµ‹</li></ul></blockquote><p><img src="https://bu.dusays.com/2023/06/10/64843d25c12d6.png" alt="å¤–è¿æ¥.png" style="zoom:50%;" /></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å·¦è¿æ¥</span></span><br><span class="line">left_join<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å³è¿æ¥</span></span><br><span class="line">right_join<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¨è¿æ¥</span></span><br><span class="line">full_join<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="ç­›é€‰è¿æ¥"><a href="#ç­›é€‰è¿æ¥" class="headerlink" title="ç­›é€‰è¿æ¥"></a>ç­›é€‰è¿æ¥</h1><blockquote><p>æ ¹æ®åŒ¹é…çš„é”®ï¼Œç­›é€‰æ•°æ®è¡¨ä¸­çš„è§‚æµ‹</p></blockquote><div class="tabs" id="ç­›é€‰è¿æ¥"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="ç­›é€‰è¿æ¥-1">åŠè¿æ¥</button><button type="button" class="tab " data-href="ç­›é€‰è¿æ¥-2">åè¿æ¥</button></ul><div class="tab-contents"><div class="tab-item-content active" id="ç­›é€‰è¿æ¥-1"><p><strong>åŠè¿æ¥ semi_join(x, y)</strong></p><blockquote><p><strong>ä¿ç•™</strong>Xè¡¨ä¸­ä¸Yè¡¨ä¸­çš„è§‚æµ‹ç›¸åŒ¹é…çš„æ‰€æœ‰è§‚æµ‹</p></blockquote><p><img src="https://bu.dusays.com/2023/06/10/648475b9ac49d.png" alt="åŠè¿æ¥.png" style="zoom:50%;" /></p><p><img src="https://bu.dusays.com/2023/06/10/648475b9ac49d.png" alt="åŠè¿æ¥1.png" style="zoom:50%;" /></p><p>ä¾‹ï¼šæ ¹æ®è¡¨flightsæ‰¾å‡ºé£å¾€æœ€å—æ¬¢è¿çš„10ä¸ªç›®çš„åœ°çš„èˆªç­ä¿¡æ¯</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰¾å‡ºæœ€å—æ¬¢è¿çš„10ä¸ªç›®çš„åœ° -----------------------------------------------------------</span></span><br><span class="line">top_dest <span class="operator">&lt;-</span> flights <span class="operator">%&gt;%</span> </span><br><span class="line">  count<span class="punctuation">(</span>dest<span class="punctuation">,</span> sort <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  head<span class="punctuation">(</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">top_dest</span><br><span class="line"></span><br><span class="line"><span class="comment"># # A tibble: 10 Ã— 2</span></span><br><span class="line"><span class="comment"># dest      n</span></span><br><span class="line"><span class="comment"># &lt;chr&gt; &lt;int&gt;</span></span><br><span class="line"><span class="comment">#   1 ORD   17283</span></span><br><span class="line"><span class="comment"># 2 ATL   17215</span></span><br><span class="line"><span class="comment"># 3 LAX   16174</span></span><br><span class="line"><span class="comment"># 4 BOS   15508</span></span><br><span class="line"><span class="comment"># 5 MCO   14082</span></span><br><span class="line"><span class="comment"># 6 CLT   14064</span></span><br><span class="line"><span class="comment"># 7 SFO   13331</span></span><br><span class="line"><span class="comment"># 8 FLL   12055</span></span><br><span class="line"><span class="comment"># 9 MIA   11728</span></span><br><span class="line"><span class="comment"># 10 DCA    9705</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰¾å‡ºé£å¾€è¿™äº›ç›®çš„åœ°çš„èˆªç­ ------------------------------------------------------------</span></span><br><span class="line">flights <span class="operator">%&gt;%</span></span><br><span class="line">  semi_join<span class="punctuation">(</span>top_dest<span class="punctuation">)</span> <span class="comment"># é»˜è®¤å€¼by = NULL, ä¼šä½¿ç”¨å­˜åœ¨äºä¸¤ä¸ªè¡¨ä¸­çš„æ‰€æœ‰å˜é‡ï¼Œè¿™ç§æ–¹å¼ç§°ä¸ºè‡ªç„¶è¿æ¥</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="ç­›é€‰è¿æ¥-2"><p><strong>åè¿æ¥ anti_join(x, y)</strong></p><blockquote><p><strong>ä¸¢å¼ƒ</strong>Xè¡¨ä¸­ä¸Yè¡¨ä¸­çš„è§‚æµ‹ç›¸åŒ¹é…çš„æ‰€æœ‰è§‚æµ‹</p></blockquote><p><img src="https://bu.dusays.com/2023/06/10/648475b9ac49d.png" alt="åè¿æ¥.png" style="zoom:50%;" /></p><p>ä¾‹ï¼šæ‰¾å‡ºflights ä¸­åœ¨ planes ä¸­æ²¡æœ‰åŒ¹é…çš„è®°å½•</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flights <span class="operator">%&gt;%</span></span><br><span class="line">  anti_join<span class="punctuation">(</span>planes<span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&quot;tailnum&quot;</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span></span><br><span class="line">  count<span class="punctuation">(</span>tailnum<span class="punctuation">,</span> sort <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="é›†åˆæ“ä½œ"><a href="#é›†åˆæ“ä½œ" class="headerlink" title="é›†åˆæ“ä½œ"></a>é›†åˆæ“ä½œ</h1><blockquote><p>é›†åˆæ“ä½œè¦æ±‚Xå’ŒYå…·æœ‰ç›¸åŒçš„å˜é‡</p></blockquote><p>æ¨¡æ‹Ÿæ•°æ®æ„å»º:</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">df1 <span class="operator">&lt;-</span> tribble<span class="punctuation">(</span></span><br><span class="line">  <span class="operator">~</span>x<span class="punctuation">,</span> <span class="operator">~</span>y<span class="punctuation">,</span></span><br><span class="line">  <span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">  <span class="number">2</span><span class="punctuation">,</span> <span class="number">1</span> </span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">df2 <span class="operator">&lt;-</span> tribble<span class="punctuation">(</span></span><br><span class="line">  <span class="operator">~</span>x<span class="punctuation">,</span> <span class="operator">~</span>y<span class="punctuation">,</span></span><br><span class="line">  <span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">  <span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span> </span><br><span class="line"><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><div class="tabs" id="é›†åˆæ“ä½œ"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="é›†åˆæ“ä½œ-1">intersect(x, y)</button><button type="button" class="tab " data-href="é›†åˆæ“ä½œ-2">union(x, y)</button><button type="button" class="tab " data-href="é›†åˆæ“ä½œ-3">setdiff(x, y)</button></ul><div class="tab-contents"><div class="tab-item-content active" id="é›†åˆæ“ä½œ-1"><p><strong>intersect(x, y)</strong></p><blockquote><p>è¿”å›æ—¢åœ¨ x è¡¨ï¼Œåˆåœ¨ y è¡¨ä¸­çš„è§‚æµ‹ã€‚ </p></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">intersect<span class="punctuation">(</span>df1<span class="punctuation">,</span> df2<span class="punctuation">)</span> </span><br><span class="line"><span class="comment"># # A tibble: 1 Ã— 2</span></span><br><span class="line"><span class="comment">#      x     y</span></span><br><span class="line"><span class="comment">#    &lt;dbl&gt; &lt;dbl&gt;</span></span><br><span class="line"><span class="comment"># 1    1     1</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="é›†åˆæ“ä½œ-2"><p><strong>union(x, y)</strong></p><blockquote><p>è¿”å› x è¡¨æˆ– y è¡¨ä¸­çš„å”¯ä¸€è§‚æµ‹ã€‚</p></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ³¨æ„ï¼Œæˆ‘ä»¬å¾—åˆ°äº†3è¡Œï¼Œè€Œä¸æ˜¯4è¡Œ </span></span><br><span class="line">union<span class="punctuation">(</span>df1<span class="punctuation">,</span> df2<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># # A tibble: 3 Ã— 2</span></span><br><span class="line"><span class="comment">#       x     y</span></span><br><span class="line"><span class="comment">#     &lt;dbl&gt; &lt;dbl&gt;</span></span><br><span class="line"><span class="comment"># 1     1     1</span></span><br><span class="line"><span class="comment"># 2     2     1</span></span><br><span class="line"><span class="comment"># 3     1     2</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="é›†åˆæ“ä½œ-3"><p><strong>setdiff(x, y)</strong></p><blockquote><p>è¿”å›åœ¨ x è¡¨ï¼Œä½†ä¸åœ¨ y è¡¨ä¸­çš„è§‚æµ‹ï¼Œæˆ–åä¹‹ã€‚</p></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">setdiff<span class="punctuation">(</span>df1<span class="punctuation">,</span> df2<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># # A tibble: 1 Ã— 2</span></span><br><span class="line"><span class="comment">#       x     y</span></span><br><span class="line"><span class="comment">#     &lt;dbl&gt; &lt;dbl&gt;</span></span><br><span class="line"><span class="comment"># 1     2     1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">setdiff<span class="punctuation">(</span>df2<span class="punctuation">,</span> df1<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># A tibble: 1 Ã— 2</span></span><br><span class="line"><span class="comment">#       x     y</span></span><br><span class="line"><span class="comment">#     &lt;dbl&gt; &lt;dbl&gt;</span></span><br><span class="line"><span class="comment"># 1     1     2</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h1><ol><li>æ‰¾å‡ºèƒ½å”¯ä¸€æ ‡è¯†çš„ä¸»é”®</li><li>ç¡®ä¿ä¸»é”®ä¸­æ²¡æœ‰ç¼ºå¤±å€¼</li><li>æ£€æŸ¥å¤–é”®æ˜¯å¦ä¸å¦ä¸€å¼ è¡¨ä¸»é”®åŒ¹é…</li></ol><details class="folding-tag" yellow><summary> ç›¸å…³é—®é¢˜ </summary>              <div class='content'>              <ul><li>éªŒè¯ä¸»é”®æ˜¯å¦æ˜¯å”¯ä¸€æ ‡è¯†</li></ul><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># éªŒè¯tailnumæ˜¯å¦ä¸ºplanesè¡¨ä¸­çš„å”¯ä¸€æ ‡è¯†</span></span><br><span class="line">planes <span class="operator">%&gt;%</span></span><br><span class="line">  count<span class="punctuation">(</span>tailnum<span class="punctuation">)</span> <span class="operator">%&gt;%</span>  </span><br><span class="line">  filter<span class="punctuation">(</span>n<span class="operator">&gt;</span><span class="number">1</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># éªŒè¯ç»„åˆå˜é‡æ˜¯å¦ä¸ºå”¯ä¸€æ ‡è¯†</span></span><br><span class="line">flights <span class="operator">%&gt;%</span></span><br><span class="line">  count<span class="punctuation">(</span>year<span class="punctuation">,</span> month<span class="punctuation">,</span> day<span class="punctuation">,</span> flight<span class="punctuation">)</span> <span class="operator">%&gt;%</span></span><br><span class="line">  filter<span class="punctuation">(</span>n <span class="operator">&gt;</span> <span class="number">1</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><ul><li>ä¸¤ä¸ªè¡¨ä¸­å˜é‡åä¸åŒå¦‚ä½•è¿›è¡Œè¿æ¥</li></ul><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨ by = c(&quot;a&quot; = &quot;b&quot;) å½¢å¼è¿›è¡Œè¿æ¥</span></span><br><span class="line">flights2 <span class="operator">%&gt;%</span></span><br><span class="line">  left_join<span class="punctuation">(</span>airports<span class="punctuation">,</span> by <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;dest&quot;</span> <span class="operator">=</span> <span class="string">&quot;faa&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>              </div>            </details>]]></content>
    
    
      
      
    <summary type="html">&lt;details class=&quot;folding-tag&quot; &gt;&lt;summary&gt; æ–‡æ¡£ä½¿ç”¨æ•°æ®æºè¯´æ˜ &lt;/summary&gt;
              &lt;div class=&#39;content&#39;&gt;
              &lt;p&gt;æ–‡æ¡£ä¸­ä¸¾ä¾‹é™¤äº†ä½¿ç”¨è‡ªå»ºæ•°æ®å¤–ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ nycf</summary>
      
    
    
    
    <category term="ç”Ÿç‰©ä¿¡æ¯å­¦" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="æ•°æ®åˆ†æ" scheme="https://smileszh.github.io/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/"/>
    
    <category term="tidyverse" scheme="https://smileszh.github.io/tags/tidyverse/"/>
    
    <category term="R è¯­è¨€" scheme="https://smileszh.github.io/tags/R-%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>GEOæ•°æ®åº“</title>
    <link href="https://smileszh.github.io/posts/56308c9.html"/>
    <id>https://smileszh.github.io/posts/56308c9.html</id>
    <published>2023-06-08T05:00:00.000Z</published>
    <updated>2023-06-11T03:00:01.053Z</updated>
    
    <content type="html"><![CDATA[<h1 id="GEOæ•°æ®åº“"><a href="#GEOæ•°æ®åº“" class="headerlink" title="GEOæ•°æ®åº“"></a><a href="https://www.ncbi.nlm.nih.gov/geo/">GEOæ•°æ®åº“</a></h1><p> <em>å†™åœ¨å‰é¢çš„è¯</em></p><p><em>GEO æ•°æ®åº“æ˜¯ NCBI ç½‘ç«™ä¸‹çš„å­æ•°æ®åº“ï¼Œä¸»è¦æ”¶å½•åŸºäºèŠ¯ç‰‡å’Œæµ‹åºæŠ€æœ¯çš„æ•°æ®ï¼Œæ¥æºäºå…¨çƒä¼—å¤šç ”ç©¶è€…çš„ä¸Šä¼ æ•°æ®ã€‚GEOæ•°æ®åº“ä¸€ç›´æ˜¯è¿›è¡Œç”Ÿä¿¡æŒ–æ˜çš„é‡è¦æ•°æ®åº“ï¼Œäº†è§£GEOæ•°æ®åº“çš„æ•°æ®å½¢å¼ï¼Œç»„ç»‡ç±»å‹åŠä¸‹è½½æ–¹å¼è¿›è¡Œæ•°æ®æŒ–æ˜çš„å¿…å¤‡æŠ€èƒ½ã€‚</em></p><h2 id="æ•°æ®å­˜å‚¨æ ¼å¼"><a href="#æ•°æ®å­˜å‚¨æ ¼å¼" class="headerlink" title="æ•°æ®å­˜å‚¨æ ¼å¼"></a>æ•°æ®å­˜å‚¨æ ¼å¼</h2><h3 id="SOFT-æ ¼å¼"><a href="#SOFT-æ ¼å¼" class="headerlink" title="SOFT æ ¼å¼"></a>SOFT æ ¼å¼</h3><p>SOFT (Simple Omnibus in Text Format)æ ¼å¼ï¼Œæ˜¯ä¸€ç§ç´§å‡‘ã€ç®€å•ã€åŸºäºè¡Œçš„ ASCII(ç¾å›½ä¿¡æ¯äº¤æ¢æ ‡å‡†ä»£ç )æ–‡æœ¬æ ¼å¼ï¼Œ åŒ…å«å®éªŒæ•°æ®å’Œæ³¨é‡Šæ•°æ®ã€‚</p><h3 id="MINiML-æ ¼å¼"><a href="#MINiML-æ ¼å¼" class="headerlink" title="MINiML æ ¼å¼"></a>MINiML æ ¼å¼</h3><p>MINiML (MIAME Notation in Markup Language, pronounced minimal)æ ¼å¼ï¼Œä¸ SOFT æ ¼å¼æ–‡ä»¶çš„åŒ…å«ä¿¡æ¯å®Œå…¨ç›¸åŒï¼Œä»…æ ¼å¼ä¸åŒï¼Œä¸º XML æ ¼å¼ã€‚ XML(eXtensible Markup Language)åˆç§°ä¸ºå¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼Œæå…¶ç®€å•ï¼Œä½¿å…¶æ˜“äºåœ¨ä»»ä½•åº”ç”¨ç¨‹åºä¸­è¯»å†™æ•°æ®ã€‚MIAME å’Œ MINSEQE åˆ†åˆ«æ˜¯èŠ¯ç‰‡å’Œæµ‹åºæ•°æ®ä¸Šä¼ çš„æ ‡å‡†æŒ‡å—ï¼ŒæŒ‡å‡ºä¸Šä¼ çš„èŠ¯ç‰‡æˆ–æµ‹åºæ•°æ®æœ€èµ·ç åº”åŒ…å«çš„æ•°æ®å†…å®¹ã€‚</p><h3 id="Series-Matrix-files"><a href="#Series-Matrix-files" class="headerlink" title="Series Matrix files"></a>Series Matrix files</h3><p>Series Matrix filesï¼Œæ˜¯ä»¥åˆ¶è¡¨ç¬¦åˆ†éš”çš„åŒ…å«æ¯ä¸ªæ ·æœ¬å…·ä½“æ•°å€¼(æ¯”å¦‚åŸºå› è¡¨è¾¾é‡) çš„æ–‡æœ¬æ–‡ä»¶ï¼Œä»¥åŒ…å«GSMå’ŒGSEæè¿°ä¿¡æ¯çš„æ•°æ®å¼€å¤´ï¼Œç„¶åæ˜¯æ ·æœ¬ä¸ºåˆ—ã€æ¢é’ˆæˆ–è€…åŸºå› ä¸ºè¡Œçš„è¡¨è¾¾çŸ©é˜µã€‚è‹¥æ¥æºäºä¸åŒå¹³å°åˆ™åˆ†å‰²ä¸ºæ•°ä¸ªå•ç‹¬çš„æ–‡ä»¶ã€‚</p><h3 id="Supplementary-files"><a href="#Supplementary-files" class="headerlink" title="Supplementary files"></a>Supplementary files</h3><p>Supplementary filesï¼Œå³è¡¥å……æ–‡ä»¶ï¼Œåˆ—å‡º GSM åŸå§‹æ•°æ®æˆ–ä¸Šä¼ è€…åˆ†äº«çš„(å¦‚ä¸´åºŠä¿¡æ¯ ç­‰)ç›¸å…³æ–‡ä»¶;GEO æ•°æ®åº“é¼“åŠ±ä½†ä¸å¼ºåˆ¶è¦æ±‚ä¸Šä¼ è¡¥å……æ–‡ä»¶ã€‚GEO ä¸­ä¸åŒçš„æ•°æ®ç±»å‹ï¼Œå…·ä½“ å¯¹åº”çš„æ–‡ä»¶æ ¼å¼ä¹Ÿæœ‰æ‰€ä¸åŒã€‚GEO å­˜å‚¨çš„æ•°æ®ä¸€èˆ¬éƒ½æ˜¯ gzip å‹ç¼©æ–‡ä»¶ï¼Œæ–‡ä»¶åç¼€å.gz æˆ– è€….tgzï¼Œå¸¸ç”¨çš„è§£å‹ç¼©å·¥å…·ä¸€èˆ¬éƒ½å¯ä»¥æ‰“å¼€ã€‚</p><h2 id="æ•°æ®ç»„ç»‡å½¢å¼-Data-organiation"><a href="#æ•°æ®ç»„ç»‡å½¢å¼-Data-organiation" class="headerlink" title="æ•°æ®ç»„ç»‡å½¢å¼(Data organiation)"></a>æ•°æ®ç»„ç»‡å½¢å¼(Data organiation)</h2><h3 id="GPL-GEO-platform"><a href="#GPL-GEO-platform" class="headerlink" title="GPL(GEO platform)"></a>GPL(GEO platform)</h3><p>GPL,æ˜¯ GEO platform çš„ç®€ç§°ï¼Œä¹Ÿå°±æ˜¯å¹³å°ï¼Œæ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯é€šè¿‡èŠ¯ç‰‡æˆ–è€…æµ‹åºæ•°æ®å•†çš„å¹³ å°äº§ç”Ÿçš„ï¼Œå¹³å°æ•°æ®åŒ…æ‹¬äº†è¯¥å¹³å°çš„ä¸»è¦æè¿°ä¿¡æ¯ï¼ŒèŠ¯ç‰‡å¹³å°æ•°æ®è¿˜åŒ…æ‹¬äº†èŠ¯ç‰‡æ¶‰åŠçš„æ³¨ é‡Šä¿¡æ¯ã€‚GEO ä¸­åŒ…å«äº† 2 ä¸‡å¤šä¸ªå¹³å°æ•°æ®ï¼Œç¼–å·ä»¥ GPL å¼€å¤´ï¼ŒGPL æ•°æ®é¡µé¢åˆ—å‡ºäº† GEO æ•°æ® åº“ä¸­ä½¿ç”¨è¯¥å¹³å°çš„æ‰€æœ‰æ ·æœ¬ GSM ç¼–å·å’Œç³»åˆ— GSE ç¼–å·ã€‚</p><blockquote><p>GPL æ•°æ®ä¸»è¦æœ‰å››ç§å¯¹åº”çš„å­˜å‚¨æ ¼å¼ã€‚æœ€å¸¸ç”¨çš„æ˜¯ annotation æ³¨é‡Šè¡¨æ ¼æ–‡ä»¶ï¼Œå°†èŠ¯ç‰‡æ¢é’ˆåè½¬æ¢ä¸ºåŸºå› åæ—¶éœ€ è¦ç”¨åˆ°è¿™ä¸ªæ–‡ä»¶ã€‚ç„¶åå°±æ˜¯ SOFT æ ¼å¼å’Œ MINiML æ ¼å¼çš„å¹³å°æ•°æ®ï¼Œå­˜å‚¨äº†ä½¿ç”¨è¯¥å¹³å°æ‰€æœ‰ GSMã€GSE çš„ç¼–å·ä¿¡æ¯ï¼Œä¸€èˆ¬æ–‡ä»¶è¾ƒå¤§ï¼Œä¸€èˆ¬åˆ†æä¸å¸¸ç”¨åˆ°è¿™ä¸ªæ•°æ®ã€‚éƒ¨åˆ†å¹³å°ç”±è¡¥å……æ•°æ®æ–‡ä»¶ã€‚æ¯”å¦‚å¸¸è§çš„ <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GPL571">GPL571</a>ï¼Œæœ‰å‰ä¸‰ç§æ•°æ®æ ¼å¼ã€‚</p><ul><li>GPLxxx.annot.gz, åŸºå› åºåˆ—çš„æ³¨é‡Šä¿¡æ¯è¡¨æ ¼æ–‡ä»¶ï¼Œä¸å®šæœŸæ›´æ–°</li><li>GPLxxx.family.xml.tgz, å‹ç¼©çš„MINIMLæ ¼å¼æ–‡ä»¶ï¼ŒåŒ…å«ä½¿ç”¨è¯¥å¹³å°çš„æ‰€æœ‰GSMï¼ŒGSEçš„ä¿¡æ¯</li><li>GPLxxx_soft.gz, å‹ç¼©çš„Softæ ¼å¼æ–‡ä»¶ï¼ŒåŒ…å«ä½¿ç”¨è¯¥å¹³å°çš„æ‰€æœ‰GSMï¼ŒGSEçš„ä¿¡æ¯</li><li>GPLxxx.xxx.gz, è¡¥å……æ–‡ä»¶ï¼Œéƒ¨åˆ†æ•°æ®æ— è¡¥å……æ–‡ä»¶</li></ul></blockquote><p><img src="https://bu.dusays.com/2023/06/08/64815da7310fe.png" alt="GPL.png"></p><h3 id="GSM-GEO-sample"><a href="#GSM-GEO-sample" class="headerlink" title="GSM(GEO sample)"></a>GSM(GEO sample)</h3><p>GSMï¼Œå…¨ç§° GEO sampleï¼Œå³æ ·æœ¬æ•°æ®ï¼Œè®°å½•äº†å•ä¸ªæ ·æœ¬çš„ç”Ÿç‰©å­¦ä¿¡æ¯ã€å¤„ç†æµç¨‹ä»¥åŠè¯¥æ · æœ¬åœ¨å¹³å°ä¸Šäº§ç”Ÿçš„åŸå§‹æ•°æ®ï¼Œç¼–å·ä»¥ GSM å¼€å¤´ï¼Œä¸€ä¸ª GSM æ ·æœ¬ä»…å¯¹åº”ä¸€ä¸ªå¹³å°ã€‚å³ä½¿åŒä¸€ ä¸ªç”Ÿç‰©æ ·æœ¬åœ¨åŒä¸€ä¸ªå¹³å°æˆ–è€…å¤šä¸ªå¹³å°å†…å¤šæ¬¡æ£€æµ‹ï¼Œå°±äº§ç”Ÿå¤šä¸ª GSM æ ·æœ¬æ•°æ®ï¼Œæ¯ä¸ªå¹³å° çš„æ¯ä¸€æ¬¡æ£€æµ‹å°±ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ GSM æ ·æœ¬æ•°æ®ã€‚</p><blockquote><p>GSM æ•°æ®å¯¹åº”çš„æ˜¯ä¸€ä¸ªå•ç‹¬çš„å‹ç¼©æ–‡ä»¶ï¼Œåˆ—åœ¨è¡¥å……æ–‡ä»¶æ¡ç›®ä¸‹ã€‚è®°å½•äº†è¯¥æ ·æœ¬çš„æè¿°ä¿¡æ¯å’ŒåŸå§‹æ•°æ®(raw data)ï¼Œæ ¹æ®äº§ç”Ÿæ•°æ®å¹³å°çš„ä¸åŒï¼ŒåŸ å§‹æ•°æ®çš„æ–‡ä»¶æ ¼å¼æœ‰æ‰€ä¸åŒï¼ŒCEL æ ¼å¼å°±æ˜¯ Affymetrix èŠ¯ç‰‡çš„åŸå§‹æ•°æ®æ ¼å¼ã€‚GSM åŸå§‹æ•°æ®çš„æ–‡ä»¶åä¹Ÿååº”äº†ä¸€äº›ä¿¡æ¯ï¼Œæ¯”å¦‚ <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM18423">GSM18423_PA-D_132.cel.gz</a>ï¼Œè¡¨ç¤º:gzip å‹ç¼©çš„ CEL æ–‡ä»¶ï¼ŒGSM18423 ä¸ºæ ·æœ¬ç¼–å·ï¼Œâ€œPA-D_132â€ä¸ºè¯¥æ ·æœ¬çš„ç®€è¦åˆ†ç»„ä¿¡æ¯ã€‚</p><ul><li>GSMxxxxxx.xxx.gz, å•ä¸ªæ ·æœ¬çš„gzipå‹ç¼©æ–‡ä»¶ï¼Œä½äºè¡¥å……æ–‡ä»¶ç±»åˆ«ä¸‹</li></ul></blockquote><p><img src="https://bu.dusays.com/2023/06/08/64815da72f531.png" alt="GSM.png"></p><h3 id="GSE-GEO-series"><a href="#GSE-GEO-series" class="headerlink" title="GSE(GEO series)"></a>GSE(GEO series)</h3><p>GSEï¼Œæ˜¯ GEO series çš„ç®€ç§°ï¼Œç³»åˆ—æ•°æ®æ˜¯æŠŠç›¸å…³è”çš„ GSM æ ·æœ¬æ•°æ®é›†åˆåœ¨ä¸€èµ·ï¼Œé€šå¸¸æ˜¯ä¸€ é¡¹ç ”ç©¶ä¸­çš„æ‰€æœ‰æ ·æœ¬æ•°æ®çš„é›†åˆï¼Œç¼–å·ä»¥ GSE å¼€å¤´ã€‚ä¸€ä¸ª GSE ç³»åˆ—æ•°æ®ä¸­åŒ…å«çš„æ ·æœ¬å¯èƒ½ æ¥æºäºä¸åŒå¹³å°ï¼ŒåŒä¸€ä¸ªæ ·æœ¬çš„æ•°æ®ä¹Ÿå¯ä»¥å‡ºç°åœ¨å¤šä¸ª GSE ä¸­ã€‚</p><blockquote><p>GSE æ–‡ä»¶çš„ä¸‹è½½é“¾æ¥ï¼Œä¸€èˆ¬åœ¨ GSE ç½‘é¡µçš„ ä¸‹æ–¹ã€‚å¦‚<a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE1145">GSE1145</a></p><ul><li>GSExxx_series_matrix.txt.gz æˆ– GSExxx- GPLxxx_series_matrix.txt.gzï¼ŒåŒ…å«è¯¥ GSE çš„æ ·æœ¬è¡¨è¾¾çŸ©é˜µåŠç®€è¦æ ·æœ¬ã€å¹³å°ä¿¡æ¯; è‹¥ä¸€ ä¸ª GSE å†…åº”ç”¨äº†å¤šä¸ªå¹³å°åˆ™æŒ‰å¹³å°åˆ†å‰²ä¸ºå¤šä¸ª series matrix æ–‡æœ¬æ–‡ä»¶ï¼Œå¹¶æŒ‰ç¬¬äºŒç§æ–¹å¼ å‘½åã€‚</li><li>GSExxx_family.soft.gz, SOFTæ ¼å¼ï¼ŒåŒ…å«GSEæ‰€æ¶‰åŠçš„æ‰€æœ‰æ ·æœ¬åŠå¹³å°æ•°æ®</li><li>GSExxx_family.xml.tgz, MINiMLæ ¼å¼ï¼ŒåŒ…å«è¯¥GSEæ‰€æ¶‰åŠçš„æ‰€æœ‰æ ·æœ¬åŠå¹³å°æ•°æ®</li><li>GSExxx_RAW.tarï¼Œè¯¥ GSE æ‰€æ¶‰åŠçš„æ‰€æœ‰æ ·æœ¬çš„åŸå§‹æ•°æ®ï¼Œå¦‚æ‰€æœ‰æ ·æœ¬ çš„ CEL å‹ç¼©æ–‡ä»¶ï¼Œæˆ–å…¶ä»–è¡¥å……æ–‡ä»¶</li></ul></blockquote><p><img src="https://bu.dusays.com/2023/06/08/64815da72dee9.png" alt="GSE.png"></p><h3 id="GDS-GEO-DataSet"><a href="#GDS-GEO-DataSet" class="headerlink" title="GDS(GEO DataSet)"></a>GDS(GEO DataSet)</h3><p>GDSï¼Œæ˜¯ GEO DataSet çš„ç®€ç§°ï¼Œæ˜¯ç» GEO æ•°æ®åº“çš„å·¥ä½œäººå‘˜æŒ‘é€‰æ•´ç†åçš„æ•°æ®é›†è®°å½•ï¼Œæ˜¯å¯¹å¾ˆå°‘ä¸€éƒ¨åˆ† GSE åŸå§‹æ•°æ®è¿›è¡ŒèƒŒæ™¯æ ¡æ­£ã€å‡ä¸€åŒ–ç­‰å¤„ç†åå¾—åˆ°çš„ã€‚ç¼–å·ä»¥ GDS å¼€å¤´ï¼Œæ¯ä¸ª GDS çš„æ•°æ®å¯¹åº”ä¸€ä¸ªå¹³å°ï¼Œä½¿å¾—æ•°æ®åœ¨ GDS å†…éƒ¨å…·æœ‰ç›´æ¥çš„å¯æ¯”æ€§ã€‚</p><blockquote><p>GDS æ•°æ®çš„æ ¼å¼ä¸€èˆ¬ä¸º soft æ ¼å¼ï¼Œåˆ†ä¸º soft å’Œ full.soft æ–‡ä»¶ï¼Œå…¶ä¸­ full.soft æ–‡ä»¶ä¸­å¢åŠ äº†è¯¥ GDS å¯¹åº”å¹³å°çš„æœ€æ–°åŸºå› æ³¨é‡Šä¿¡æ¯ã€‚GDS é¡µé¢åŒæ—¶è¿˜æ•´åˆäº†è¯¥ GDS å¯¹åº”çš„ GSE å’Œ GPL annotation æ•°æ®ä¸‹è½½é“¾æ¥ã€‚å¦‚<a href="https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS2225">GDS2225</a></p><ul><li>GDSxxx.soft.gz, æ¥æºäºåŸå§‹çš„GSEæ•°æ®ï¼Œç»GEOå¤„ç†ï¼Œå…·æœ‰GDSå†…æ•°å€¼å¯æ¯”æ€§çš„æ•°æ®</li><li>GDSxxx_full.soft.gz, SOFTæ ¼å¼ï¼Œåœ¨GDSxxx.soft.gzåŸºç¡€ä¸Šï¼Œå¢åŠ äº†è¯¥GDSå¯¹åº”å¹³å°çš„æœ€æ–°åŸºå› æ³¨é‡Š</li></ul></blockquote><p><img src="https://bu.dusays.com/2023/06/08/64815da72ea63.png" alt="GDS.png"></p><h3 id="GEO-Profile"><a href="#GEO-Profile" class="headerlink" title="GEO Profile"></a>GEO Profile</h3><p>GEO Profile æ•°æ®ï¼Œç›´æ¥æ¥æºäº GDS æ•°æ®ï¼Œåªæ˜¯å‘ˆç°çš„å½¢å¼ä¸åŒï¼Œé‡ç‚¹å…³æ³¨å•ä¸ªåŸºå› çš„æ°´å¹³ã€‚ä»å•ä¸ªåŸºå› è§’åº¦ç›´è§‚åœ°ä»¥å›¾è¡¨å±•ç¤ºç‰¹å®šåŸºå› åœ¨ GDS ä¸åŒåˆ†ç»„ã€æ‰€æœ‰æ ·æœ¬ä¸­çš„è¡¨è¾¾æ°´ å¹³ï¼Œç½‘é¡µå†…å¯ä»¥ç›´æ¥ä¸‹è½½æ•´ç†å¥½ Profile æ•°æ®ã€‚</p><blockquote><p> GEO profile æ–‡ä»¶ä¸‹è½½çš„æ–‡ä»¶å‘½åä¸º profile_data.txtï¼Œæ²¡æœ‰ç‰¹å®šçš„ç¼–å·ï¼Œæ–‡ä»¶å†…åŒ…å«äº†æ‰€æŸ¥è¯¢åŸºå› çš„ä¿¡æ¯ä»¥åŠåœ¨å„ä¸ªæ ·æœ¬ä¸­çš„è¡¨è¾¾å€¼æ•°æ®ï¼Œæ¨èç”¨ Excel æ‰“å¼€è¿™ä¸ªæ–‡æœ¬æ–‡ä»¶ã€‚å¦‚<a href="https://www.ncbi.nlm.nih.gov/geoprofiles/28483590">GDS2225ä¸­Herpud1åŸºå› çš„profileæ•°æ®</a></p><p>Profile_data.txt, åŒ…å«æ‰€æŸ¥è¯¢åŸºå› çš„ä¿¡æ¯åŠåœ¨å„ä¸ªæ ·æœ¬ä¸­çš„è¡¨è¾¾å€¼æ•°æ®</p></blockquote><p><img src="https://bu.dusays.com/2023/06/08/64815da72db57.png" alt="GEO profile.png"></p><h2 id="æ•°æ®ä¸‹è½½"><a href="#æ•°æ®ä¸‹è½½" class="headerlink" title="æ•°æ®ä¸‹è½½"></a>æ•°æ®ä¸‹è½½</h2><h3 id="ç½‘é¡µé“¾æ¥ä¸‹è½½"><a href="#ç½‘é¡µé“¾æ¥ä¸‹è½½" class="headerlink" title="ç½‘é¡µé“¾æ¥ä¸‹è½½"></a>ç½‘é¡µé“¾æ¥ä¸‹è½½</h3><p><a href="https://www.ncbi.nlm.nih.gov/geo/">GEOæ•°æ®åº“ä¸»é¡µ</a></p><h3 id="æ„å»ºftpé“¾æ¥ä¸‹è½½"><a href="#æ„å»ºftpé“¾æ¥ä¸‹è½½" class="headerlink" title="æ„å»ºftpé“¾æ¥ä¸‹è½½"></a>æ„å»ºftpé“¾æ¥ä¸‹è½½</h3><p><a href="ftp://ftp.ncbi.nlm.nih.gov/geo/">GEOæ•°æ®åº“ftpç«™ç‚¹</a></p><blockquote><p>4ç§æ•°æ®ç±»å‹çš„å­ç›®</p><ul><li>datasets</li><li>platforms</li><li>sample</li><li>Series</li></ul></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;GEOæ•°æ®åº“&quot;&gt;&lt;a href=&quot;#GEOæ•°æ®åº“&quot; class=&quot;headerlink&quot; title=&quot;GEOæ•°æ®åº“&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://www.ncbi.nlm.nih.gov/geo/&quot;&gt;GEOæ•°æ®åº“&lt;/a&gt;&lt;/h1&gt;&lt;p&gt; &lt;em&gt;å†™</summary>
      
    
    
    
    <category term="ç”Ÿç‰©ä¿¡æ¯å­¦" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="æ•°æ®åº“" scheme="https://smileszh.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>Rç»˜å›¾-çƒ­å›¾</title>
    <link href="https://smileszh.github.io/posts/5c21bb3.html"/>
    <id>https://smileszh.github.io/posts/5c21bb3.html</id>
    <published>2023-06-07T08:00:00.000Z</published>
    <updated>2023-06-30T17:56:25.134Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å·®å¼‚åŸºå› çƒ­å›¾ç»˜åˆ¶"><a href="#å·®å¼‚åŸºå› çƒ­å›¾ç»˜åˆ¶" class="headerlink" title="å·®å¼‚åŸºå› çƒ­å›¾ç»˜åˆ¶"></a>å·®å¼‚åŸºå› çƒ­å›¾ç»˜åˆ¶</h1><div class="tabs" id="å·®å¼‚åŸºå› çƒ­å›¾"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="å·®å¼‚åŸºå› çƒ­å›¾-1">æ‰€éœ€æ•°æ®</button><button type="button" class="tab " data-href="å·®å¼‚åŸºå› çƒ­å›¾-2">ä»£ç </button><button type="button" class="tab " data-href="å·®å¼‚åŸºå› çƒ­å›¾-3">ç»“æœå±•ç¤º</button></ul><div class="tab-contents"><div class="tab-item-content active" id="å·®å¼‚åŸºå› çƒ­å›¾-1"><p><a href="https://tooc.web.xlj0.com/uploads/%E5%B7%AE%E5%BC%82%E8%A1%A8%E8%BE%BE%E5%88%86%E6%9E%90/results.csv">DESeq2æˆ–edgeRå·®å¼‚è¡¨è¾¾åˆ†æåæ•°æ®</a></p></div><div class="tab-item-content" id="å·®å¼‚åŸºå› çƒ­å›¾-2"><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Create heat map from a differential expression count table.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Load the library.</span></span><br><span class="line">suppressPackageStartupMessages<span class="punctuation">(</span>library<span class="punctuation">(</span>gplots<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The name of the file that contains the counts.</span></span><br><span class="line">count_file <span class="operator">=</span> <span class="string">&quot;results.csv&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The name of the output file.</span></span><br><span class="line">output_file <span class="operator">=</span> <span class="string">&quot;heatmap.pdf&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Inform the user.</span></span><br><span class="line">print<span class="punctuation">(</span><span class="string">&quot;# Tool: Create Heatmap &quot;</span><span class="punctuation">)</span></span><br><span class="line">print<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&quot;# Input: &quot;</span><span class="punctuation">,</span> count_file<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">print<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&quot;# Output: &quot;</span><span class="punctuation">,</span> output_file<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># FDR cutoff.</span></span><br><span class="line">MIN_FDR <span class="operator">=</span> <span class="number">0.05</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot width</span></span><br><span class="line">WIDTH <span class="operator">=</span> <span class="number">12</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot height.</span></span><br><span class="line">HEIGHT <span class="operator">=</span> <span class="number">13</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the margins</span></span><br><span class="line">MARGINS <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">9</span><span class="punctuation">,</span> <span class="number">12</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Relative heights of the rows in the plot.</span></span><br><span class="line">LHEI <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Read normalized counts from the standard input.</span></span><br><span class="line">data <span class="operator">=</span> read.csv<span class="punctuation">(</span>count_file<span class="punctuation">,</span> header<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">,</span> as.is<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Subset data for values under a treshold.</span></span><br><span class="line">data <span class="operator">=</span> subset<span class="punctuation">(</span>data<span class="punctuation">,</span> data<span class="operator">$</span>FDR <span class="operator">&lt;=</span> MIN_FDR<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The heatmap row names will be taken from the first column.</span></span><br><span class="line">row_names <span class="operator">=</span> data<span class="punctuation">[</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The code assumes that the normalized data matrix is listed to the right of the falsePos column.</span></span><br><span class="line">idx <span class="operator">=</span> which<span class="punctuation">(</span>colnames<span class="punctuation">(</span>data<span class="punctuation">)</span> <span class="operator">==</span> <span class="string">&quot;falsePos&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The normalized counts are on the right size.</span></span><br><span class="line">counts <span class="operator">=</span> data<span class="punctuation">[</span><span class="punctuation">,</span> idx <span class="operator">:</span> ncol<span class="punctuation">(</span>data<span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Load the data from the second column on.</span></span><br><span class="line">values <span class="operator">=</span> as.matrix<span class="punctuation">(</span>counts<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Adds a little noise to each element to avoid the</span></span><br><span class="line"><span class="comment"># clustering function failure on zero variance rows.</span></span><br><span class="line">values <span class="operator">=</span> jitter<span class="punctuation">(</span>values<span class="punctuation">,</span> factor <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> amount <span class="operator">=</span> <span class="number">0.00001</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Normalize each row to a z-score</span></span><br><span class="line">zscores <span class="operator">=</span> <span class="literal">NULL</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span> <span class="operator">:</span> nrow<span class="punctuation">(</span>values<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  row <span class="operator">=</span> values<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">  zrow <span class="operator">=</span> <span class="punctuation">(</span>row <span class="operator">-</span> mean<span class="punctuation">(</span>row<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">/</span> sd<span class="punctuation">(</span>row<span class="punctuation">)</span></span><br><span class="line">  zscores <span class="operator">=</span> rbind<span class="punctuation">(</span>zscores<span class="punctuation">,</span> zrow<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the row names on the zscores.</span></span><br><span class="line">row.names<span class="punctuation">(</span>zscores<span class="punctuation">)</span> <span class="operator">=</span> row_names</span><br><span class="line"></span><br><span class="line"><span class="comment"># Turn the data into a matrix for heatmap2.</span></span><br><span class="line">zscores <span class="operator">=</span> as.matrix<span class="punctuation">(</span>zscores<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the color palette.</span></span><br><span class="line">col <span class="operator">=</span> greenred</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a PDF device</span></span><br><span class="line">pdf<span class="punctuation">(</span>output_file<span class="punctuation">,</span> width <span class="operator">=</span> WIDTH<span class="punctuation">,</span> height <span class="operator">=</span> HEIGHT<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">heatmap.2<span class="punctuation">(</span>zscores<span class="punctuation">,</span> col<span class="operator">=</span>col<span class="punctuation">,</span> density.info<span class="operator">=</span><span class="string">&quot;none&quot;</span><span class="punctuation">,</span> Colv<span class="operator">=</span><span class="literal">NULL</span><span class="punctuation">,</span></span><br><span class="line">    dendrogram<span class="operator">=</span><span class="string">&quot;row&quot;</span><span class="punctuation">,</span> trace<span class="operator">=</span><span class="string">&quot;none&quot;</span><span class="punctuation">,</span> margins<span class="operator">=</span>MARGINS<span class="punctuation">,</span> lhei<span class="operator">=</span>LHEI<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="å·®å¼‚åŸºå› çƒ­å›¾-3"><p><img src="https://bu.dusays.com/2023/07/01/649f167cd0737.png" alt="heatmap.png"></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="æ™®é€šçƒ­å›¾"><a href="#æ™®é€šçƒ­å›¾" class="headerlink" title="æ™®é€šçƒ­å›¾"></a>æ™®é€šçƒ­å›¾</h1><h2 id="çƒ­å›¾æ•ˆæœ"><a href="#çƒ­å›¾æ•ˆæœ" class="headerlink" title="çƒ­å›¾æ•ˆæœ"></a>çƒ­å›¾æ•ˆæœ</h2><blockquote><p>æ¨ªè½´ä¸ºæ ·æœ¬ç±»å‹ï¼Œçºµå‘ä¸ºåŸºå› ID</p></blockquote><h2 id="æ•°æ®å‡†å¤‡"><a href="#æ•°æ®å‡†å¤‡" class="headerlink" title="æ•°æ®å‡†å¤‡"></a>æ•°æ®å‡†å¤‡</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">GeneSample1Sample2Sample3Sample4Sample5Sample6Sample7Sample8Sample9Sample10</span><br><span class="line">Gene10.601.060.000.250.782.050.420.570.410.57</span><br><span class="line">Gene24.034.050.940.004.494.101.940.690.230.98</span><br><span class="line">Gene30.060.190.360.610.640.390.150.200.520.20</span><br><span class="line">Gene42.551.860.160.421.164.390.420.000.350.00</span><br><span class="line">Gene50.890.910.000.000.101.250.350.280.480.28</span><br><span class="line">Gene62.755.020.040.001.415.762.080.000.980.00</span><br><span class="line">Gene70.660.900.000.530.340.590.750.390.400.18</span><br><span class="line">Gene80.902.870.360.170.060.060.970.080.000.26</span><br><span class="line">Gene97.155.970.000.001.708.463.499.880.120.27</span><br><span class="line">Gene103.123.410.520.150.363.440.902.090.152.08</span><br><span class="line">Gene110.240.640.000.000.150.880.310.000.570.08</span><br><span class="line">Gene124.315.320.000.171.883.941.300.970.511.32</span><br><span class="line">Gene132.272.090.080.000.001.781.451.171.201.37</span><br><span class="line">Gene140.870.270.000.000.000.640.000.000.000.00</span><br><span class="line">Gene153.373.631.260.292.414.081.780.060.910.06</span><br><span class="line">Gene160.181.090.150.371.280.720.230.301.560.30</span><br><span class="line">Gene173.563.820.180.001.105.361.484.761.235.31</span><br><span class="line">Gene181.771.541.620.000.204.820.910.250.360.25</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åŠ è½½åŒ…</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>pheatmap<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¼å…¥æ•°æ®</span></span><br><span class="line">data <span class="operator">&lt;-</span> as.matrix<span class="punctuation">(</span>read.table<span class="punctuation">(</span><span class="string">&quot;data.txt&quot;</span><span class="punctuation">,</span>row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„å»ºåˆ—æ³¨é‡Šä¿¡æ¯</span></span><br><span class="line">annotation_col <span class="operator">=</span> data.frame<span class="punctuation">(</span>CellType <span class="operator">=</span> factor<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;A&quot;</span><span class="punctuation">,</span><span class="string">&quot;B&quot;</span><span class="punctuation">,</span><span class="string">&quot;C&quot;</span><span class="punctuation">,</span><span class="string">&quot;D&quot;</span><span class="punctuation">,</span><span class="string">&quot;E&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                                <span class="string">&quot;F&quot;</span><span class="punctuation">,</span><span class="string">&quot;G&quot;</span><span class="punctuation">,</span><span class="string">&quot;H&quot;</span><span class="punctuation">,</span><span class="string">&quot;I&quot;</span><span class="punctuation">,</span><span class="string">&quot;J&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">rownames<span class="punctuation">(</span>annotation_col<span class="punctuation">)</span> <span class="operator">&lt;-</span> colnames<span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>annotation_col<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªå®šæ³¨é‡Šä¿¡æ¯çš„é¢œè‰²åˆ—è¡¨</span></span><br><span class="line">ann_colors <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span></span><br><span class="line">  CellType <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span>A <span class="operator">=</span> <span class="string">&quot;#65B99F&quot;</span><span class="punctuation">,</span> B <span class="operator">=</span> <span class="string">&quot;#F08961&quot;</span><span class="punctuation">,</span> C <span class="operator">=</span> <span class="string">&quot;#8A9BC3&quot;</span><span class="punctuation">,</span> D <span class="operator">=</span> <span class="string">&quot;#DA85B5&quot;</span><span class="punctuation">,</span> E <span class="operator">=</span> <span class="string">&quot;#A1CC56&quot;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="built_in">F</span> <span class="operator">=</span> <span class="string">&quot;#F5D239&quot;</span><span class="punctuation">,</span> G <span class="operator">=</span> <span class="string">&quot;#7CC07B&quot;</span><span class="punctuation">,</span> H <span class="operator">=</span> <span class="string">&quot;#BAABD0&quot;</span><span class="punctuation">,</span> I <span class="operator">=</span> <span class="string">&quot;#3766A4&quot;</span><span class="punctuation">,</span> J <span class="operator">=</span> <span class="string">&quot;#DF3078&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">head<span class="punctuation">(</span>ann_colors<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">pheatmap<span class="punctuation">(</span>data<span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># å»æ‰èšç±»æ ‘ï¼š</span></span><br><span class="line">         cluster_cols <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span></span><br><span class="line">         cluster_rows <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># åŠ color barï¼šåˆ—æ³¨é‡Šä¿¡æ¯ï¼›</span></span><br><span class="line">         annotation_col <span class="operator">=</span> annotation_col<span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># color bar é¢œè‰²è®¾å®šï¼š</span></span><br><span class="line">         annotation_colors <span class="operator">=</span> ann_colors<span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># è®¾ç½®å•å…ƒæ ¼é¢œè‰²æ¸å˜ï¼›(100)è¡¨ç¤ºåˆ†100æ®µæ¸å˜ï¼›</span></span><br><span class="line">         color <span class="operator">=</span> colorRampPalette<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#FDEBEA&quot;</span><span class="punctuation">,</span><span class="string">&quot;#D5281F&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">(</span><span class="number">100</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">         <span class="comment"># è¡Œã€åˆ—æ ‡ç­¾çš„å­—ä½“å¤§å°</span></span><br><span class="line">         fontsize_col <span class="operator">=</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line">         fontsize_row <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># æ˜¯å¦æ˜¾ç¤ºè¡Œã€åˆ—å</span></span><br><span class="line">         show_colnames <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># è®¾ç½®æ¯ä¸ªå•å…ƒæ ¼çš„å®½åº¦å’Œé«˜åº¦</span></span><br><span class="line">         cellwidth <span class="operator">=</span> <span class="number">30</span><span class="punctuation">,</span> </span><br><span class="line">         cellheight <span class="operator">=</span> <span class="number">24</span><span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># è¡Œã€åˆ—èšç±»æ ‘çš„é«˜åº¦ï¼š</span></span><br><span class="line">         <span class="comment"># treeheight_row = 50, </span></span><br><span class="line">         <span class="comment"># treeheight_col = 30,</span></span><br><span class="line">         <span class="comment"># display_numbers = TRUEå‚æ•°è®¾å®šåœ¨æ¯ä¸ªçƒ­å›¾æ ¼å­ä¸­æ˜¾ç¤ºç›¸åº”çš„æ•°å€¼ï¼Œ</span></span><br><span class="line">         <span class="comment"># number_colorå‚æ•°è®¾ç½®æ•°å€¼å­—ä½“çš„é¢œè‰²</span></span><br><span class="line">         display_numbers <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span>number_color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># è®¾ç½®æ ‡é¢˜ï¼š</span></span><br><span class="line">         main <span class="operator">=</span> <span class="string">&quot;Heatmap&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="circle-çƒ­å›¾"><a href="#circle-çƒ­å›¾" class="headerlink" title="circle çƒ­å›¾"></a>circle çƒ­å›¾</h1><h2 id="çƒ­å›¾æ•ˆæœ-1"><a href="#çƒ­å›¾æ•ˆæœ-1" class="headerlink" title="çƒ­å›¾æ•ˆæœ"></a>çƒ­å›¾æ•ˆæœ</h2><p><img src="https://s2.loli.net/2023/05/10/Okx86iFDLWtYlRw.png" alt="image-20230510124031974" style="zoom: 33%;" /></p><h2 id="æ•°æ®å‡†å¤‡-1"><a href="#æ•°æ®å‡†å¤‡-1" class="headerlink" title="æ•°æ®å‡†å¤‡"></a>æ•°æ®å‡†å¤‡</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">GeneSample1Sample2Sample3Sample4Sample5Sample6Sample7Sample8Sample9Sample10</span><br><span class="line">Gene10.601.060.000.250.782.050.420.570.410.57</span><br><span class="line">Gene24.034.050.940.004.494.101.940.690.230.98</span><br><span class="line">Gene30.060.190.360.610.640.390.150.200.520.20</span><br><span class="line">Gene42.551.860.160.421.164.390.420.000.350.00</span><br><span class="line">Gene50.890.910.000.000.101.250.350.280.480.28</span><br><span class="line">Gene62.755.020.040.001.415.762.080.000.980.00</span><br><span class="line">Gene70.660.900.000.530.340.590.750.390.400.18</span><br><span class="line">Gene80.902.870.360.170.060.060.970.080.000.26</span><br><span class="line">Gene97.155.970.000.001.708.463.499.880.120.27</span><br><span class="line">Gene103.123.410.520.150.363.440.902.090.152.08</span><br><span class="line">Gene110.240.640.000.000.150.880.310.000.570.08</span><br><span class="line">Gene124.315.320.000.171.883.941.300.970.511.32</span><br><span class="line">Gene132.272.090.080.000.001.781.451.171.201.37</span><br><span class="line">Gene140.870.270.000.000.000.640.000.000.000.00</span><br><span class="line">Gene153.373.631.260.292.414.081.780.060.910.06</span><br><span class="line">Gene160.181.090.150.371.280.720.230.301.560.30</span><br><span class="line">Gene173.563.820.180.001.105.361.484.761.235.31</span><br><span class="line">Gene181.771.541.620.000.204.820.910.250.360.25</span><br></pre></td></tr></table></figure><h2 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åŠ è½½åŒ…</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggtree<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¼å…¥æ•°æ®</span></span><br><span class="line">data <span class="operator">&lt;-</span> as.matrix<span class="punctuation">(</span>read.table<span class="punctuation">(</span><span class="string">&quot;data.txt&quot;</span><span class="punctuation">,</span>row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿›è¡Œå±‚æ¬¡èšç±»</span></span><br><span class="line">df <span class="operator">&lt;-</span> hclust<span class="punctuation">(</span>dist<span class="punctuation">(</span>data<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»˜åˆ¶è¿›åŒ–æ ‘</span></span><br><span class="line">p1 <span class="operator">&lt;-</span> ggtree<span class="punctuation">(</span>df<span class="punctuation">)</span></span><br><span class="line">p1</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ˜¯å¦åˆé€‚</span></span><br><span class="line">gheatmap<span class="punctuation">(</span>p1<span class="punctuation">,</span>data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†è¿›åŒ–æ ‘ç»˜åˆ¶æˆåœ†å½¢</span></span><br><span class="line">p2 <span class="operator">&lt;-</span> ggtree<span class="punctuation">(</span>df<span class="punctuation">,</span>layout <span class="operator">=</span> <span class="string">&quot;circular&quot;</span><span class="punctuation">)</span></span><br><span class="line">p2</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®å¼€å£æ–¹å‘ï¼šrotate_tree()</span></span><br><span class="line"><span class="comment"># é¡ºæ—¶é’ˆæ—‹è½¬100åº¦</span></span><br><span class="line">p3 <span class="operator">&lt;-</span> rotate_tree<span class="punctuation">(</span>p2<span class="punctuation">,</span><span class="number">100</span><span class="punctuation">)</span></span><br><span class="line">P3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">gheatmap<span class="punctuation">(</span>p3 <span class="operator">+</span> geom_tiplab<span class="punctuation">(</span>offset <span class="operator">=</span> <span class="number">13</span><span class="punctuation">)</span><span class="punctuation">,</span>data<span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># è®¾ç½®çƒ­å›¾çš„å®½åº¦ï¼š</span></span><br><span class="line">         width <span class="operator">=</span> <span class="number">1.5</span><span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># è®¾ç½®å•å…ƒæ ¼çš„é¢œè‰²ï¼š</span></span><br><span class="line">         low <span class="operator">=</span> <span class="string">&quot;#FDEBEA&quot;</span><span class="punctuation">,</span></span><br><span class="line">         high <span class="operator">=</span> <span class="string">&quot;#D5281F&quot;</span><span class="punctuation">,</span></span><br><span class="line">         font.size <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span></span><br><span class="line">         colnames_position <span class="operator">=</span> <span class="string">&quot;top&quot;</span><span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># è°ƒæ•´å¼€å£å¤§å°</span></span><br><span class="line">         colnames_offset_y <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># è°ƒèŠ‚åˆ—åå’Œé¡¶éƒ¨ä¹‹é—´çš„è·ç¦»ï¼š</span></span><br><span class="line">         hjust <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">         <span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&quot;right&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–‡å­—å’Œå›¾çš„ä½ç½®åç»­å¯ä»¥åœ¨Aiä¸­è°ƒæ•´ï¼›</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å·®å¼‚åŸºå› çƒ­å›¾ç»˜åˆ¶&quot;&gt;&lt;a href=&quot;#å·®å¼‚åŸºå› çƒ­å›¾ç»˜åˆ¶&quot; class=&quot;headerlink&quot; title=&quot;å·®å¼‚åŸºå› çƒ­å›¾ç»˜åˆ¶&quot;&gt;&lt;/a&gt;å·®å¼‚åŸºå› çƒ­å›¾ç»˜åˆ¶&lt;/h1&gt;&lt;div class=&quot;tabs&quot; id=&quot;å·®å¼‚åŸºå› çƒ­å›¾&quot;&gt;&lt;ul class=&quot;nav-tabs</summary>
      
    
    
    
    <category term="ç”Ÿç‰©ä¿¡æ¯å­¦" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="Rè¯­è¨€" scheme="https://smileszh.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
    <category term="Rç»˜å›¾" scheme="https://smileszh.github.io/tags/R%E7%BB%98%E5%9B%BE/"/>
    
  </entry>
  
  <entry>
    <title>clusterProfileråŒ…</title>
    <link href="https://smileszh.github.io/posts/cc9b0903.html"/>
    <id>https://smileszh.github.io/posts/cc9b0903.html</id>
    <published>2023-06-05T12:00:00.000Z</published>
    <updated>2023-07-18T16:21:40.094Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h1><div class="tabs" id="clusterprofiler"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="clusterprofiler-1">ç®€ä»‹</button><button type="button" class="tab " data-href="clusterprofiler-2">GOå¯Œé›†åˆ†æ</button><button type="button" class="tab " data-href="clusterprofiler-3">KEGGå¯Œé›†åˆ†æ</button></ul><div class="tab-contents"><div class="tab-item-content active" id="clusterprofiler-1"><p><img src="https://bu.dusays.com/2023/07/01/649f90fac2511.png" alt="clusterprofilerç®€ä»‹.png"><br><img src="https://bu.dusays.com/2023/07/01/64a0139b0ed96.png" alt="clusterProfiler-diagram.png"></p></div><div class="tab-item-content" id="clusterprofiler-2"><p><img src="https://bu.dusays.com/2023/07/01/64a01458856ad.png" alt="enrichGO.png"><br><img src="https://bu.dusays.com/2023/07/01/649f939bbf6be.png" alt="GO è¾“å…¥æ•°æ®.png"><br><img src="https://bu.dusays.com/2023/07/01/64a0092178ddd.png" alt="GOprofilerè¾“å‡ºç»“æœ.png"></p><p><a href="https://tooc.web.xlj0.com/uploads/%E5%B7%AE%E5%BC%82%E8%A1%A8%E8%BE%BE%E5%88%86%E6%9E%90/gene.xlsx">è¾“å…¥æ•°æ®ï¼šå¯Œé›†åˆ†æåŸºå› åˆ—è¡¨</a><br><a href="https://tooc.web.xlj0.com/uploads/%E5%B7%AE%E5%BC%82%E8%A1%A8%E8%BE%BE%E5%88%86%E6%9E%90/go_enrichresults.csv">è¾“å‡ºæ•°æ®ï¼šå¯Œé›†ç»“æœ</a><br><a href="https://tooc.web.xlj0.com/uploads/%E5%B7%AE%E5%BC%82%E8%A1%A8%E8%BE%BE%E5%88%86%E6%9E%90/go.RData">è¾“å‡ºç»“æœï¼šgo.RData</a><br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># load packages -----------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">library<span class="punctuation">(</span>clusterProfiler<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>org.Bt.eg.db<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>readxl<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># load data ---------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">rna <span class="operator">&lt;-</span> read_xlsx<span class="punctuation">(</span><span class="string">&quot;gene.xlsx&quot;</span><span class="punctuation">)</span></span><br><span class="line">SYMBOL <span class="operator">&lt;-</span> unique<span class="punctuation">(</span>rna<span class="operator">$</span>geneSymbol<span class="punctuation">)</span></span><br><span class="line">rna <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>SYMBOL<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Id transition -----------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">gene.list <span class="operator">&lt;-</span> bitr<span class="punctuation">(</span>rna<span class="operator">$</span>SYMBOL<span class="punctuation">,</span></span><br><span class="line">                fromType <span class="operator">=</span> <span class="string">&quot;SYMBOL&quot;</span><span class="punctuation">,</span></span><br><span class="line">                toType <span class="operator">=</span> <span class="string">&quot;ENTREZID&quot;</span><span class="punctuation">,</span></span><br><span class="line">                OrgDb <span class="operator">=</span> org.Bt.eg.db<span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>gene.list<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># prepare analysis --------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">gene <span class="operator">&lt;-</span> gene.list<span class="operator">$</span>ENTREZID</span><br><span class="line"></span><br><span class="line"><span class="comment"># GO analysis -------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">go <span class="operator">&lt;-</span> enrichGO<span class="punctuation">(</span>gene <span class="operator">=</span> gene<span class="punctuation">,</span></span><br><span class="line">               OrgDb <span class="operator">=</span> org.Bt.eg.db<span class="punctuation">,</span></span><br><span class="line">               keyType <span class="operator">=</span> <span class="string">&quot;ENTREZID&quot;</span><span class="punctuation">,</span></span><br><span class="line">               ont <span class="operator">=</span> <span class="string">&#x27;ALL&#x27;</span><span class="punctuation">,</span></span><br><span class="line">               pvalueCutoff <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">,</span></span><br><span class="line">               pAdjustMethod <span class="operator">=</span> <span class="string">&#x27;BH&#x27;</span><span class="punctuation">,</span></span><br><span class="line">               qvalueCutoff <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">,</span></span><br><span class="line">               minGSSize <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">               maxGSSize <span class="operator">=</span> <span class="number">500</span><span class="punctuation">,</span></span><br><span class="line">               readable <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span></span><br><span class="line">               pool <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Output the result -------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">write.csv<span class="punctuation">(</span>go<span class="operator">@</span>result<span class="punctuation">,</span> file <span class="operator">=</span> <span class="string">&quot;go_enrichresults.csv&quot;</span><span class="punctuation">)</span></span><br><span class="line">save<span class="punctuation">(</span>go<span class="punctuation">,</span> file <span class="operator">=</span> <span class="string">&quot;go.RData&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure></p></div><div class="tab-item-content" id="clusterprofiler-3"><p><img src="https://bu.dusays.com/2023/07/01/64a00984417d1.png" alt="enrichKEGG.png"><br><img src="https://bu.dusays.com/2023/07/01/64a00ea249699.png" alt="KEGGjç»“æœ.png"></p><p><a href="https://tooc.web.xlj0.com/uploads/%E5%B7%AE%E5%BC%82%E8%A1%A8%E8%BE%BE%E5%88%86%E6%9E%90/kegg_enrichresults.csv">è¾“å‡ºæ•°æ®ï¼šå¯Œé›†ç»“æœ</a><br><a href="https://tooc.web.xlj0.com/uploads/%E5%B7%AE%E5%BC%82%E8%A1%A8%E8%BE%BE%E5%88%86%E6%9E%90/kegg.RData">è¾“å‡ºç»“æœï¼škegg.RData</a></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># kegg analysis -----------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¥GOå¯Œé›†åˆ†æçš„æ•°æ®è¿›è¡Œåˆ†æ</span></span><br><span class="line"></span><br><span class="line">kegg <span class="operator">&lt;-</span> enrichKEGG<span class="punctuation">(</span>gene <span class="operator">=</span> gene<span class="punctuation">,</span></span><br><span class="line">                   organism <span class="operator">=</span> <span class="string">&quot;bta&quot;</span><span class="punctuation">,</span></span><br><span class="line">                   pvalueCutoff <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">,</span></span><br><span class="line">                   pAdjustMethod <span class="operator">=</span> <span class="string">&quot;BH&quot;</span><span class="punctuation">,</span></span><br><span class="line">                   minGSSize <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">                   maxGSSize <span class="operator">=</span> <span class="number">500</span><span class="punctuation">,</span></span><br><span class="line">                   qvalueCutoff <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">,</span></span><br><span class="line">                   use_internal_data <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Output the KEGG result --------------------------------------------------</span></span><br><span class="line">write.csv<span class="punctuation">(</span>kegg<span class="operator">@</span>result<span class="punctuation">,</span> file <span class="operator">=</span> <span class="string">&quot;kegg_enrichresults.csv&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="å¯è§†åŒ–"><a href="#å¯è§†åŒ–" class="headerlink" title="å¯è§†åŒ–"></a>å¯è§†åŒ–</h1><div class="tabs" id="å¯è§†åŒ–"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="å¯è§†åŒ–-1">æŸ±çŠ¶å›¾:barplot</button><button type="button" class="tab " data-href="å¯è§†åŒ–-2">æ°”æ³¡å›¾:dotplot</button><button type="button" class="tab " data-href="å¯è§†åŒ–-3">ç½‘ç»œå›¾:cnetplot</button><button type="button" class="tab " data-href="å¯è§†åŒ–-4">çƒ­å›¾:heatplot</button><button type="button" class="tab " data-href="å¯è§†åŒ–-5">GOå¯Œé›†å›¾:emapplot, goplot</button><button type="button" class="tab " data-href="å¯è§†åŒ–-6">é«˜çº§vennå›¾:upsetplot</button></ul><div class="tab-contents"><div class="tab-item-content active" id="å¯è§†åŒ–-1"><p><img src="https://bu.dusays.com/2023/07/01/64a043bcc595a.png" alt="barplot.png"></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">barplot<span class="punctuation">(</span>go<span class="punctuation">,</span> showCategory <span class="operator">=</span> <span class="number">20</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;pvalue&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="å¯è§†åŒ–-2"><p><img src="https://bu.dusays.com/2023/07/02/64a05286c5e57.png" alt="dotplot.png"></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotplot<span class="punctuation">(</span>go<span class="punctuation">,</span> showCategory <span class="operator">=</span><span class="number">20</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;pvalue&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="å¯è§†åŒ–-3"><p><img src="https://bu.dusays.com/2023/07/02/64a052ff7f02c.png" alt="cnetplot.png"></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnetplot<span class="punctuation">(</span>kegg<span class="punctuation">,</span> circular <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span> colorEdge <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="å¯è§†åŒ–-4"><p><img src="https://bu.dusays.com/2023/07/02/64a053553978e.png" alt="heatplot.png"></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">heatplot<span class="punctuation">(</span>go<span class="punctuation">)</span> <span class="comment">#   å¯æ·»åŠ å·®å¼‚å€æ•°ï¼Œå¢åŠ è‰²å½©</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="å¯è§†åŒ–-5"><p><img src="https://bu.dusays.com/2023/07/02/64a058e0c39a6.png" alt="emapplot.png"><br><img src="https://bu.dusays.com/2023/07/02/64a05837dd299.png" alt="goplot.png"></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emapplot<span class="punctuation">(</span>pairwise_termsim<span class="punctuation">(</span>go<span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="å¯è§†åŒ–-6"><p><img src="https://bu.dusays.com/2023/07/02/64a05469a780d.png" alt="upsetplot.png"></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">upsetplot<span class="punctuation">(</span>go<span class="punctuation">)</span></span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;åˆ†æ&quot;&gt;&lt;a href=&quot;#åˆ†æ&quot; class=&quot;headerlink&quot; title=&quot;åˆ†æ&quot;&gt;&lt;/a&gt;åˆ†æ&lt;/h1&gt;&lt;div class=&quot;tabs&quot; id=&quot;clusterprofiler&quot;&gt;&lt;ul class=&quot;nav-tabs&quot;&gt;&lt;button type=</summary>
      
    
    
    
    <category term="ç”Ÿç‰©ä¿¡æ¯å­¦" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="Rè¯­è¨€" scheme="https://smileszh.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
    <category term="RåŒ…" scheme="https://smileszh.github.io/tags/R%E5%8C%85/"/>
    
    <category term="åŸºå› æ³¨é‡Š" scheme="https://smileszh.github.io/tags/%E5%9F%BA%E5%9B%A0%E6%B3%A8%E9%87%8A/"/>
    
    <category term="GO/KEGG" scheme="https://smileszh.github.io/tags/GO-KEGG/"/>
    
  </entry>
  
  <entry>
    <title>åŸºå› IDè½¬æ¢</title>
    <link href="https://smileszh.github.io/posts/cee7e62d.html"/>
    <id>https://smileszh.github.io/posts/cee7e62d.html</id>
    <published>2023-06-05T12:00:00.000Z</published>
    <updated>2023-06-24T02:41:12.393Z</updated>
    
    <content type="html"><![CDATA[<p><em>å†™åœ¨å‰é¢çš„è¯ï¼š</em></p><p><em>åŸºå› IDåœ¨ä¸åŒçš„ç”Ÿä¿¡è½¯ä»¶å’Œæ•°æ®åº“ä¸­æœ‰ä¸åŒçš„å‘½åè§„åˆ™ã€‚å› æ­¤ï¼Œå°†åŸºå› IDè¿›è¡Œè½¬æ¢æ˜¯å¿…å¤‡çš„ç”Ÿä¿¡æŠ€èƒ½ã€‚æ­¤æ–‡ç« ä¸»è¦ä»‹ç»å‡ ä¸ªå¸¸ç”¨çš„åŸºå› IDè½¬æ¢ç½‘ç«™åŠRåŒ…è½¬æ¢å·¥å…·</em></p><h1 id="BioMartå·¥å…·"><a href="#BioMartå·¥å…·" class="headerlink" title="BioMartå·¥å…·"></a><a href="https://www.ensembl.org/biomart/martview/ccf8f9fdc5c9f83c988b1d4f24648cf5">BioMartå·¥å…·</a></h1><blockquote><p>BioMart æ˜¯ Ensembl ç½‘ç«™æä¾›çš„ä¸€ä¸ª web å·¥å…·ã€‚ä»–çš„ä¸»è¦åŠŸèƒ½æ˜¯è¿›è¡ŒåŸºå› åŠŸèƒ½çš„æ³¨é‡Šå’Œè·¨æ•°æ®åº“æ³¨é‡Šï¼Œè¿˜æœ‰å°±æ˜¯åŸºå› IDçš„è½¬æ¢ã€‚</p></blockquote><h2 id="é€‰æ‹©æ•°æ®åº“å’Œæ•°æ®é›†"><a href="#é€‰æ‹©æ•°æ®åº“å’Œæ•°æ®é›†" class="headerlink" title="é€‰æ‹©æ•°æ®åº“å’Œæ•°æ®é›†"></a>é€‰æ‹©æ•°æ®åº“å’Œæ•°æ®é›†</h2><p><img src="https://bu.dusays.com/2023/06/13/64874d703b0f8.png" alt="ç¬¬ä¸€æ­¥.png" style="zoom: 67%;" /></p><p><img src="https://bu.dusays.com/2023/06/13/64874d7042b11.png" alt="ç¬¬äºŒæ­¥.png" style="zoom:67%;" /></p><h2 id="è¾“å…¥IDç±»å‹åŠåŸºå› é›†"><a href="#è¾“å…¥IDç±»å‹åŠåŸºå› é›†" class="headerlink" title="è¾“å…¥IDç±»å‹åŠåŸºå› é›†"></a>è¾“å…¥IDç±»å‹åŠåŸºå› é›†</h2><blockquote><p>é™åˆ¶ä¸€æ¬¡500ä¸ªIDè½¬æ¢</p></blockquote><p><img src="https://bu.dusays.com/2023/06/13/64874d705049c.png" alt="ç¬¬ä¸‰æ­¥.png" style="zoom:67%;" /></p><p><img src="https://bu.dusays.com/2023/06/13/64874d703d705.png" alt="ç¬¬å››æ­¥.png" style="zoom:67%;" /></p><h2 id="é€‰æ‹©è¾“å‡ºåŸºå› IDç±»å‹"><a href="#é€‰æ‹©è¾“å‡ºåŸºå› IDç±»å‹" class="headerlink" title="é€‰æ‹©è¾“å‡ºåŸºå› IDç±»å‹"></a>é€‰æ‹©è¾“å‡ºåŸºå› IDç±»å‹</h2><p><img src="https://bu.dusays.com/2023/06/13/64874d703d1ab.png" alt="ç¬¬äº”æ­¥.png" style="zoom:67%;" /></p><p><em>æ³¨ï¼šæŸ¥çœ‹æ•°æ®åŸºå› IDä¿¡æ¯</em></p><p><img src="https://bu.dusays.com/2023/06/13/64874d70415b1.png" alt="ç¬¬å…­æ­¥.png" style="zoom:67%;" /></p><h2 id="è¾“å‡ºç»“æœ"><a href="#è¾“å‡ºç»“æœ" class="headerlink" title="è¾“å‡ºç»“æœ"></a>è¾“å‡ºç»“æœ</h2><p><img src="https://bu.dusays.com/2023/06/13/64874d7039cdb.png" alt="ç¬¬ä¸ƒæ­¥.png" style="zoom:67%;" /></p><h1 id="BioDBnet"><a href="#BioDBnet" class="headerlink" title="BioDBnet"></a><a href="https://biodbnet-abcc.ncifcrf.gov/">BioDBnet</a></h1><blockquote><p>biological DataBase networkï¼Œä¸€ä¸ªé›†æˆäº†å¤§é‡ç”Ÿç‰©æ•°æ®åº“çš„åº”ç”¨ç¨‹åºï¼Œæ¯”å¦‚Gene, UniProt, Ensembl, GOç­‰ï¼Œç”±ABCCè¿›è¡Œç»´æŠ¤ã€‚å®ƒå®é™…ä¸ŠåŒ…æ‹¬å¤šä¸ªåº”ç”¨ç¨‹åºï¼Œå¦‚dbWorkï¼ŒdbFindç­‰ã€‚ä¸»è¦åŠŸèƒ½åŒ…æ‹¬åŸºå› IDè½¬æ¢ï¼ŒåŸºå› åŠŸèƒ½æ³¨é‡Šï¼ŒåŸºå› ä¿¡æ¯æŸ¥æ‰¾ï¼Œè¿˜å¯ä»¥å°†åŸºå› IDè½¬æ¢æˆå…¶ä»–ç‰©ç§çš„åŒæºåŸºå› IDç­‰ã€‚</p></blockquote><h2 id="é€‰æ‹©è¾“å…¥å’Œè¾“å‡ºIDç±»å‹"><a href="#é€‰æ‹©è¾“å…¥å’Œè¾“å‡ºIDç±»å‹" class="headerlink" title="é€‰æ‹©è¾“å…¥å’Œè¾“å‡ºIDç±»å‹"></a>é€‰æ‹©è¾“å…¥å’Œè¾“å‡ºIDç±»å‹</h2><p><img src="https://bu.dusays.com/2023/06/13/6487538f3c72e.png" alt="1.png" style="zoom: 50%;" /></p><h2 id="è¾“å…¥ç‰©ç§Taxon-ID"><a href="#è¾“å…¥ç‰©ç§Taxon-ID" class="headerlink" title="è¾“å…¥ç‰©ç§Taxon ID"></a>è¾“å…¥ç‰©ç§Taxon ID</h2><p><img src="https://bu.dusays.com/2023/06/13/6487538f572a5.png" alt="2.png" style="zoom:50%;" /></p><p><img src="https://bu.dusays.com/2023/06/13/6487538f3b159.png" alt="3.png" style="zoom: 50%;" /></p><h2 id="è¾“å…¥æ•°æ®é›†å¹¶æäº¤ç»“æœ"><a href="#è¾“å…¥æ•°æ®é›†å¹¶æäº¤ç»“æœ" class="headerlink" title="è¾“å…¥æ•°æ®é›†å¹¶æäº¤ç»“æœ"></a>è¾“å…¥æ•°æ®é›†å¹¶æäº¤ç»“æœ</h2><p><img src="https://bu.dusays.com/2023/06/13/6487538f55c2f.png" alt="4.png" style="zoom:50%;" /></p><h2 id="ç»“æœæŸ¥çœ‹"><a href="#ç»“æœæŸ¥çœ‹" class="headerlink" title="ç»“æœæŸ¥çœ‹"></a>ç»“æœæŸ¥çœ‹</h2><p><img src="https://bu.dusays.com/2023/06/13/6487538f55c2f.png" alt="5.png" style="zoom:50%;" /></p><h1 id="BioDBnetå…¶ä»–å·¥å…·"><a href="#BioDBnetå…¶ä»–å·¥å…·" class="headerlink" title="BioDBnetå…¶ä»–å·¥å…·"></a>BioDBnetå…¶ä»–å·¥å…·</h1><h2 id="dbWalk"><a href="#dbWalk" class="headerlink" title="dbWalk"></a>dbWalk</h2><blockquote><p>é€‚ç”¨äºéœ€è¦è½¬æ¢ä¸ºå¤šç§IDç±»å‹</p></blockquote><p><img src="https://bu.dusays.com/2023/06/13/64875ca1e3640.png" alt="6.png" style="zoom:50%;" /></p><p><img src="https://bu.dusays.com/2023/06/13/64875cd40ed8d.png" alt="7.png" style="zoom: 50%;" /></p><h2 id="dbFind"><a href="#dbFind" class="headerlink" title="dbFind"></a>dbFind</h2><blockquote><p>è‡ªåŠ¨è¯†åˆ«è¾“å…¥çš„åŸºå› IDç±»å‹ï¼Œå¹¶è½¬æ¢ä¸ºç»Ÿä¸€IDç±»å‹</p></blockquote><p><img src="https://bu.dusays.com/2023/06/13/64875ce4ac000.png" alt="8.png" style="zoom:50%;" /></p><p><img src="https://bu.dusays.com/2023/06/13/64875ce70ae86.png" alt="9.png" style="zoom:50%;" /></p><h1 id="DAVID"><a href="#DAVID" class="headerlink" title="DAVID"></a><a href="https://david.ncifcrf.gov/home.jsp">DAVID</a></h1><h2 id="æ‰“å¼€å®˜ç½‘ï¼Œé€‰æ‹©åŸºå› IDè½¬æ¢å·¥å…·"><a href="#æ‰“å¼€å®˜ç½‘ï¼Œé€‰æ‹©åŸºå› IDè½¬æ¢å·¥å…·" class="headerlink" title="æ‰“å¼€å®˜ç½‘ï¼Œé€‰æ‹©åŸºå› IDè½¬æ¢å·¥å…·"></a>æ‰“å¼€å®˜ç½‘ï¼Œé€‰æ‹©åŸºå› IDè½¬æ¢å·¥å…·</h2><p><img src="https://bu.dusays.com/2023/06/18/648df8d0b8414.png" alt="Screenshot 2023-06-18 at 01.55.47.png"></p><h2 id="ä¸Šä¼ åŸºå› List"><a href="#ä¸Šä¼ åŸºå› List" class="headerlink" title="ä¸Šä¼ åŸºå› List"></a>ä¸Šä¼ åŸºå› List</h2><p><img src="https://bu.dusays.com/2023/06/18/648df8a619dcc.png" alt="Screenshot 2023-06-18 at 01.57.47.png"></p><h2 id="å¡«å†™é€‰é¡¹"><a href="#å¡«å†™é€‰é¡¹" class="headerlink" title="å¡«å†™é€‰é¡¹"></a>å¡«å†™é€‰é¡¹</h2><p><img src="https://bu.dusays.com/2023/06/18/648df87d5e7a5.png" alt="David ID.png"></p><h2 id="ç»“æœæŸ¥çœ‹-1"><a href="#ç»“æœæŸ¥çœ‹-1" class="headerlink" title="ç»“æœæŸ¥çœ‹"></a>ç»“æœæŸ¥çœ‹</h2><p><img src="https://bu.dusays.com/2023/06/24/649657a4d9bec.png" alt="Screenshot 2023-06-18 at 02.04.12.png" style="zoom:100%;" /></p><h1 id="Uniprot"><a href="#Uniprot" class="headerlink" title="Uniprot"></a><a href="https://www.uniprot.org/">Uniprot</a></h1><h2 id="é€‰æ‹©ID-mapping"><a href="#é€‰æ‹©ID-mapping" class="headerlink" title="é€‰æ‹©ID mapping"></a>é€‰æ‹©ID mapping</h2><p><img src="https://bu.dusays.com/2023/06/20/6491c87ec0aff.png" alt="uniprotåŸºå› è½¬åŒ–1.png"></p><h2 id="æ ¹æ®éœ€æ±‚è¾“å…¥ä¿¡æ¯"><a href="#æ ¹æ®éœ€æ±‚è¾“å…¥ä¿¡æ¯" class="headerlink" title="æ ¹æ®éœ€æ±‚è¾“å…¥ä¿¡æ¯"></a>æ ¹æ®éœ€æ±‚è¾“å…¥ä¿¡æ¯</h2><p><img src="https://bu.dusays.com/2023/06/20/6491c87e5b7fa.png" alt="uniprotåŸºå› è½¬åŒ–2.png"></p><h2 id="é€‰æ‹©Reviewed"><a href="#é€‰æ‹©Reviewed" class="headerlink" title="é€‰æ‹©Reviewed"></a>é€‰æ‹©Reviewed</h2><p><img src="https://bu.dusays.com/2023/06/20/6491c87e61175.png" alt="uniprotåŸºå› è½¬åŒ–3.png"></p><h2 id="ç»“æœæŸ¥çœ‹å’Œä¸‹è½½"><a href="#ç»“æœæŸ¥çœ‹å’Œä¸‹è½½" class="headerlink" title="ç»“æœæŸ¥çœ‹å’Œä¸‹è½½"></a>ç»“æœæŸ¥çœ‹å’Œä¸‹è½½</h2><p><img src="https://bu.dusays.com/2023/06/20/6491c87e61175.png" alt="uniprotåŸºå› è½¬åŒ–4.png"></p><h1 id="ä½¿ç”¨RåŒ…è¿›è¡Œè½¬æ¢"><a href="#ä½¿ç”¨RåŒ…è¿›è¡Œè½¬æ¢" class="headerlink" title="ä½¿ç”¨RåŒ…è¿›è¡Œè½¬æ¢"></a>ä½¿ç”¨RåŒ…è¿›è¡Œè½¬æ¢</h1><div class="tabs" id="åŸºå› idè½¬æ¢"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="åŸºå› idè½¬æ¢-1">ä»£ç ç¤ºä¾‹</button><button type="button" class="tab " data-href="åŸºå› idè½¬æ¢-2">åŸºå› IDç±»å‹</button><button type="button" class="tab " data-href="åŸºå› idè½¬æ¢-3">ç‰©ç§åŸºå› æ³¨é‡ŠåŒ…</button></ul><div class="tab-contents"><div class="tab-item-content active" id="åŸºå› idè½¬æ¢-1"><p><strong><br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span><span class="string">&quot;clusterProfiler&quot;</span><span class="punctuation">)</span> </span><br><span class="line">library<span class="punctuation">(</span><span class="string">&quot;org.Bt.eg.db&quot;</span><span class="punctuation">)</span> <span class="comment"># æ ¹æ®ç‰©ç§é€‰æ‹©ä¸åŒçš„ç‰©ç§åŸºå› æ³¨é‡ŠåŒ…</span></span><br><span class="line"></span><br><span class="line">gene_name <span class="operator">&lt;-</span> bitr<span class="punctuation">(</span>sig_rna<span class="operator">$</span>ENSEMBLTRANS<span class="punctuation">,</span> <span class="comment"># è¾“å…¥æ•°æ®é›†</span></span><br><span class="line">                fromType <span class="operator">=</span> <span class="string">&quot;ENSEMBLTRANS&quot;</span><span class="punctuation">,</span> <span class="comment"># è¾“å…¥IDç±»å‹</span></span><br><span class="line">                toType <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;SYMBOL&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="comment"># è¾“å‡ºIDç±»å‹</span></span><br><span class="line">                OrgDb <span class="operator">=</span> org.Bt.eg.db<span class="punctuation">)</span> <span class="comment"># ç‰©ç§IDæ•°æ®åŒ…</span></span><br></pre></td></tr></table></figure></strong></p></div><div class="tab-item-content" id="åŸºå› idè½¬æ¢-2"><p><strong><br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytypes<span class="punctuation">(</span>org.Bt.eg.db<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br>[1] â€œACCNUMâ€       â€œALIASâ€        â€œENSEMBLâ€<br>[4] â€œENSEMBLPROTâ€  â€œENSEMBLTRANSâ€ â€œENTREZIDâ€<br>[7] â€œENZYMEâ€       â€œEVIDENCEâ€     â€œEVIDENCEALLâ€<br>[10] â€œGENENAMEâ€     â€œGENETYPEâ€     â€œGOâ€<br>[13] â€œGOALLâ€        â€œIPIâ€          â€œONTOLOGYâ€<br>[16] â€œONTOLOGYALLâ€  â€œPATHâ€         â€œPFAMâ€<br>[19] â€œPMIDâ€         â€œPROSITEâ€      â€œREFSEQâ€<br>[22] â€œSYMBOLâ€       â€œUNIPROTâ€ </strong></p></div><div class="tab-item-content" id="åŸºå› idè½¬æ¢-3"><p><strong><br><a href="http://bioconductor.org/packages/release/BiocViews.html#___OrgDb">ç‰©ç§åŸºå› æ³¨é‡ŠåŒ…</a></strong></p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;em&gt;å†™åœ¨å‰é¢çš„è¯ï¼š&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;åŸºå› IDåœ¨ä¸åŒçš„ç”Ÿä¿¡è½¯ä»¶å’Œæ•°æ®åº“ä¸­æœ‰ä¸åŒçš„å‘½åè§„åˆ™ã€‚å› æ­¤ï¼Œå°†åŸºå› IDè¿›è¡Œè½¬æ¢æ˜¯å¿…å¤‡çš„ç”Ÿä¿¡æŠ€èƒ½ã€‚æ­¤æ–‡ç« ä¸»è¦ä»‹ç»å‡ ä¸ªå¸¸ç”¨çš„åŸºå› IDè½¬æ¢ç½‘ç«™åŠRåŒ…è½¬æ¢å·¥å…·&lt;/em&gt;&lt;/p&gt;
&lt;h1 id=&quot;BioMartå·¥å…·&quot;&gt;&lt;a hre</summary>
      
    
    
    
    <category term="ç”Ÿç‰©ä¿¡æ¯å­¦" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="Rè¯­è¨€" scheme="https://smileszh.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
    <category term="åŸºå› ID" scheme="https://smileszh.github.io/tags/%E5%9F%BA%E5%9B%A0ID/"/>
    
  </entry>
  
  <entry>
    <title>condaç®¡ç†ç”Ÿä¿¡è½¯ä»¶</title>
    <link href="https://smileszh.github.io/posts/7aba474f.html"/>
    <id>https://smileszh.github.io/posts/7aba474f.html</id>
    <published>2023-06-04T19:00:00.000Z</published>
    <updated>2023-06-23T23:53:45.778Z</updated>
    
    <content type="html"><![CDATA[<h1 id="condaç®¡ç†ç”Ÿä¿¡è½¯ä»¶"><a href="#condaç®¡ç†ç”Ÿä¿¡è½¯ä»¶" class="headerlink" title="condaç®¡ç†ç”Ÿä¿¡è½¯ä»¶"></a>condaç®¡ç†ç”Ÿä¿¡è½¯ä»¶</h1><p><em>å†™åœ¨å‰é¢çš„è¯ï¼š</em></p><p><em>linuxä½œä¸ºéå›¾å½¢åŒ–æ“ä½œç³»ç»Ÿï¼Œè½¯ä»¶ä¸‹è½½åŠç®¡ç†ç›¸å¯¹äºwindowsæ›´åŠ å¤æ‚ã€‚å¯¹äºç”Ÿä¿¡åˆ†æï¼Œcondaèƒ½å¤Ÿå¾ˆå¥½çš„è§£å†³å¤§éƒ¨åˆ†è½¯ä»¶çš„ä¸‹è½½ã€å®‰è£…åŠç®¡ç†ã€‚æœ€é‡è¦çš„æ˜¯condaèƒ½å¤Ÿè§£å†³ä¸åŒè½¯ä»¶é—´çš„ç¯å¢ƒå†²çªã€‚ï¼ˆminicondaæ˜¯anacondaçš„è½»é‡çº§æ›¿ä»£ï¼Œè¶³å¤Ÿæˆ‘ä»¬ä½¿ç”¨ï¼‰</em></p><h2 id="condaä¸‹è½½"><a href="#condaä¸‹è½½" class="headerlink" title="condaä¸‹è½½"></a>condaä¸‹è½½</h2><ol><li><p><a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/miniconda/">æ¸…åå¤§å­¦å¼€æºè½¯ä»¶é•œåƒç«™:minicondaå®‰è£…åŒ…æŸ¥æ‰¾</a></p></li><li><p>æ ¹æ®ä¸åŒçš„ç”µè„‘ç³»ç»Ÿé€‰æ‹©æ‰€éœ€è¦çš„ç‰ˆæœ¬(windows, linux, MacOSX)</p></li><li>ä¸‹è½½æœ€æ–°çš„linuxç‰ˆæœ¬ç¤ºä¾‹ï¼š</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -c https://mirrors.tuna.tsinghua.edu.cn/anaconda/miniconda/Miniconda2-latest-Linux-x86_64.sh</span><br></pre></td></tr></table></figure><h2 id="minicondaå®‰è£…"><a href="#minicondaå®‰è£…" class="headerlink" title="minicondaå®‰è£…"></a>minicondaå®‰è£…</h2><p>å®‰è£…æœ€æ–°ç‰ˆlinuxç¤ºä¾‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash Miniconda2-latest-Linux-x86_64.sh</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">å®‰è£…è¿‡ç¨‹ä¸­å¯èƒ½ä¼šé‡åˆ°ä¸‹é¢çš„æç¤ºï¼š</span><br><span class="line"></span><br><span class="line">Please, press ENTER to <span class="built_in">continue</span></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="comment"># æ­¤å¤„ç›´æ¥ç‚¹å‡»enterå³å¯</span></span><br><span class="line">===================================</span><br><span class="line">Miniconda End User License Agreement</span><br><span class="line">===================================</span><br><span class="line">.......</span><br><span class="line"><span class="comment"># è¿™â¾¥ç‚¹å‡»å¥½â¼æ¬¡ç©ºæ ¼é”®ï¼Œç›´åˆ°å‡ºç°ä¸‹â¾¯â¾</span></span><br><span class="line">Do you accept the license terms? [<span class="built_in">yes</span>|no]</span><br><span class="line">[no] &gt;&gt;&gt;</span><br><span class="line"><span class="comment"># è¿™â¾¥è¾“â¼Šyesï¼Œç‚¹å‡»enter</span></span><br><span class="line"><span class="comment"># å¦‚æœè¾“â¼Šé”™è¯¯ï¼Œâ½å¦‚è¾“â¼Šyessï¼Œâ¼œåˆ é™¤ä¸äº†ï¼Œæ­¤æ—¶ä½ åº”è¯¥æŒ‰enter,é‡æ–°è¾“â¼Šyeså³å¯</span></span><br><span class="line">[/home/you/miniconda2] &gt;&gt;&gt;</span><br><span class="line"><span class="comment"># é‡åˆ°æ­¤å¤„æ—¶ï¼Œç›´æ¥enterå³å¯</span></span><br><span class="line"><span class="comment"># è¿™â¾¥çš„ç»å¯¹è·¯å¾„æ˜¯æŒ‡miniconda2çš„å®‰è£…è·¯å¾„</span></span><br><span class="line">installation finished.</span><br><span class="line">Do you wish the installer to initialize Miniconda2</span><br><span class="line"><span class="keyword">in</span> your /home/you/.bashrc ? [<span class="built_in">yes</span>|no]</span><br><span class="line">[no] &gt;&gt;&gt;</span><br><span class="line"><span class="comment"># è¿™â¾¥è¾“â¼Šyes</span></span><br><span class="line"><span class="comment"># åˆšå¼€å§‹å­¦çš„â¼ˆæœ€å¥½è¾“â¼Šyesï¼Œâ½¬çš„æ˜¯è®©condaâ¾ƒåŠ¨ç»™ä½ é…ç½®ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="comment"># è¾“â¼Šyesçš„ç»“æœæ˜¯ï¼š~/.bashrcè¿™â¾¥â½‚ä»¶â¾¥æœ€åâ¼â¾å¤šäº†condaçš„é…ç½®ä¿¡æ¯</span></span><br><span class="line"><span class="comment"># less ~/.bashrc,å¤šå‡ºæ¥çš„é…ç½®ä¿¡æ¯ç¬¬â¼€â¾å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="comment"># added by Miniconda2 4.5.12 installer</span></span><br><span class="line">.......</span><br><span class="line">Thank you <span class="keyword">for</span> installing Miniconda2!</span><br><span class="line"><span class="comment"># å‡ºç°è¿™ä¸ªä»£è¡¨å®‰è£…æˆåŠŸ</span></span><br><span class="line"><span class="comment"># æ‰§â¾ä¸‹â¾¯è¯­å¥</span></span><br><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure><h2 id="minicondaé…ç½®é•œåƒ"><a href="#minicondaé…ç½®é•œåƒ" class="headerlink" title="minicondaé…ç½®é•œåƒ"></a>minicondaé…ç½®é•œåƒ</h2><p>condaå®‰è£…è½¯ä»¶éœ€è¦ä»å°±è¿‘çš„é•œåƒä¸­æŸ¥æ‰¾å®‰è£…åŒ…ï¼Œå› æ­¤è½¯ä»¶å®‰è£…æˆåŠŸåå¿…é¡»<strong>é…ç½®é•œåƒ</strong>ï¼ˆè¿™é‡Œç”¨çš„æ˜¯æ¸…åé•œåƒæºï¼Œä¹Ÿå¯ä»¥é€‰æ‹©å…¶ä»–çš„é•œåƒæºï¼Œå…·ä½“å¯ç™¾åº¦ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free</span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge</span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda</span><br><span class="line">conda config --<span class="built_in">set</span> show_channel_urls <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p>é…ç½®ä¿¡æ¯ä¿å­˜åœ¨ <code>~/.condarc</code>é‡Œ</p><h2 id="åˆ›å»ºå°ç¯å¢ƒ"><a href="#åˆ›å»ºå°ç¯å¢ƒ" class="headerlink" title="åˆ›å»ºå°ç¯å¢ƒ"></a>åˆ›å»ºå°ç¯å¢ƒ</h2><p>åˆ›å»ºå°ç¯å¢ƒç›¸å½“äºåœ¨å±‹å­é‡Œå®‰è£…ä¸€ä¸ªæŸœå­ï¼Œå¯ä»¥æŠŠç‰©å“æ”¾åœ¨æŸœå­é‡Œï¼ŒæŸœå­åäº†å¯ä»¥ç›´æ¥ä¸¢æ‰ã€‚å¦‚æœç›´æ¥åœ¨å¤§ç¯å¢ƒé‡Œå®‰è£…è½¯ä»¶å¦‚æœç ´åäº†ä¸»ç¯å¢ƒï¼Œæ¢å¤çš„ä»£ä»·å°±ä¼šæ›´é«˜ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.åˆ›å»ºåä¸ºrnaçš„å°ç¯å¢ƒ</span></span><br><span class="line">conda create -n rna</span><br><span class="line"><span class="comment"># 2.å®‰è£…python2ç‰ˆæœ¬ï¼ˆå¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©pythonç‰ˆæœ¬ï¼‰</span></span><br><span class="line">conda install python=2</span><br><span class="line"><span class="comment">## å¯ä»¥åˆå¹¶ä¸¤ä¸ªå‘½ä»¤</span></span><br><span class="line">conda create -n rna python=2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å·²ç»å­˜åœ¨çš„å°ç¯å¢ƒ(å¤šä¸ªå‘½ä»¤éƒ½å¯å®ç°)</span></span><br><span class="line">conda info -e</span><br><span class="line">conda inf0 --envs</span><br><span class="line">conda <span class="built_in">env</span> list</span><br></pre></td></tr></table></figure><h2 id="è¿›å…¥å°ç¯å¢ƒ"><a href="#è¿›å…¥å°ç¯å¢ƒ" class="headerlink" title="è¿›å…¥å°ç¯å¢ƒ"></a>è¿›å…¥å°ç¯å¢ƒ</h2><p>åˆ›å»ºå°ç¯å¢ƒåï¼Œå®‰è£…è½¯ä»¶æˆ–è€…ä½¿ç”¨å°ç¯å¢ƒå†…è½¯ä»¶è¿›è¡Œåˆ†æï¼Œä¸€å®šè¦<strong>è¿›å…¥/æ¿€æ´»</strong>å°ç¯å¢ƒï¼Œå¦åˆ™åªä¼šåœ¨å½“å‰è´¦æˆ·ç¯å¢ƒä¸‹è¿è¡Œã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¿€æ´»årnaçš„å°ç¯å¢ƒ</span></span><br><span class="line"><span class="built_in">source</span> activate rna</span><br></pre></td></tr></table></figure><h2 id="æŸ¥æ‰¾è½¯ä»¶"><a href="#æŸ¥æ‰¾è½¯ä»¶" class="headerlink" title="æŸ¥æ‰¾è½¯ä»¶"></a>æŸ¥æ‰¾è½¯ä»¶</h2><p>è½¯ä»¶ä¼šæœ‰ä¸åŒçš„ç‰ˆæœ¬ï¼Œä¸åŒç‰ˆæœ¬ä¹‹é—´ä¹Ÿä¼šæœ‰ä¸åŒçš„ç¯å¢ƒè¦æ±‚ï¼Œåœ¨å®‰è£…ä¹‹å‰å¯ä»¥è¿›è¡ŒæŸ¥æ‰¾ã€‚</p><ol><li><p><a href="https://bioconda.github.io/conda-package_index.html">åœ¨condaç½‘é¡µå†…æŸ¥æ‰¾</a></p></li><li><p>ç›´æ¥è¿è¡Œå‘½ä»¤æŸ¥è¯¢</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥æ‰¾stringtieè½¯ä»¶å®‰è£…åŒ…</span></span><br><span class="line">conda search stringtie</span><br></pre></td></tr></table></figure></li></ol><h2 id="å®‰è£…è½¯ä»¶"><a href="#å®‰è£…è½¯ä»¶" class="headerlink" title="å®‰è£…è½¯ä»¶"></a>å®‰è£…è½¯ä»¶</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…sra-toolsã€trim-galoreä¸¤ä¸ªè½¯ä»¶ï¼Œé»˜è®¤å®‰è£…æœ€æ–°ç‰ˆ</span></span><br><span class="line">conda install -y sra-tools trim-galore</span><br><span class="line"></span><br><span class="line"><span class="comment"># é€‰æ‹©å®‰è£…ç‰ˆæœ¬</span></span><br><span class="line">conda install numpy=1.11 ï¼šå³å®‰è£…èƒ½æ¨¡ç³ŠåŒ¹é…åˆ°numpyç‰ˆæœ¬ä¸º1.11</span><br><span class="line">conda install numpy==1.11 ï¼šå³ç²¾ç¡®å®‰è£…numpyä¸º1.11çš„ç‰ˆæœ¬</span><br></pre></td></tr></table></figure><h2 id="å¸è½½è½¯ä»¶"><a href="#å¸è½½è½¯ä»¶" class="headerlink" title="ã€€å¸è½½è½¯ä»¶"></a>ã€€å¸è½½è½¯ä»¶</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda uninstall bwa</span><br></pre></td></tr></table></figure><h2 id="æ›´æ–°è½¯ä»¶"><a href="#æ›´æ–°è½¯ä»¶" class="headerlink" title="æ›´æ–°è½¯ä»¶"></a>æ›´æ–°è½¯ä»¶</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ›´æ–°conda</span></span><br><span class="line">conda update conda</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ›´æ–°bwa</span></span><br><span class="line">conda update bwa</span><br></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹å½“å‰ç¯å¢ƒå·²å®‰è£…è½¯ä»¶"><a href="#æŸ¥çœ‹å½“å‰ç¯å¢ƒå·²å®‰è£…è½¯ä»¶" class="headerlink" title="æŸ¥çœ‹å½“å‰ç¯å¢ƒå·²å®‰è£…è½¯ä»¶"></a>æŸ¥çœ‹å½“å‰ç¯å¢ƒå·²å®‰è£…è½¯ä»¶</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda list</span><br></pre></td></tr></table></figure><h2 id="é€€å‡ºå°ç¯å¢ƒ"><a href="#é€€å‡ºå°ç¯å¢ƒ" class="headerlink" title="é€€å‡ºå°ç¯å¢ƒ"></a>é€€å‡ºå°ç¯å¢ƒ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda deactivate</span><br></pre></td></tr></table></figure><h2 id="ç§»é™¤å°ç¯å¢ƒ"><a href="#ç§»é™¤å°ç¯å¢ƒ" class="headerlink" title="ç§»é™¤å°ç¯å¢ƒ"></a>ç§»é™¤å°ç¯å¢ƒ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç§»é™¤åä¸ºrnaçš„å°ç¯å¢ƒ</span></span><br><span class="line">conda <span class="built_in">env</span> remove -n rna</span><br></pre></td></tr></table></figure><h2 id="é•œåƒæº"><a href="#é•œåƒæº" class="headerlink" title="é•œåƒæº"></a>é•œåƒæº</h2><p>å›½å†…è®¿é—®å›½å¤–condaå®˜ç½‘è¾ƒæ…¢ï¼Œæ‰€ä»¥éœ€è¦æ›¿æ¢å›½å†…é•œåƒæº</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ˜¾ç¤ºç›®å‰condaæºä¿¡æ¯</span></span><br><span class="line">conda info</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤å¹¶æ¢å¤é»˜è®¤çš„condaæº</span></span><br><span class="line">conda config --remove-key channels</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®å®‰è£…åŒ…æ—¶ï¼Œæ˜¾ç¤ºé•œåƒæ¥æºï¼ˆä¸ªäººéœ€æ±‚ï¼‰</span></span><br><span class="line">conda config --<span class="built_in">set</span> show_channel_urls <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p>è®¾ç½®<a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/">æ¸…åé•œåƒæº</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">conda config --add channels r </span><br><span class="line">conda config --add channels defaults</span><br><span class="line">conda config --add channels conda-forge</span><br><span class="line">conda config --add channels bioconda</span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/msys2/</span><br><span class="line"><span class="comment"># Anocanda æ¸…åé•œåƒ</span></span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/</span><br><span class="line">conda config --add channels  https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/cond-forge</span><br><span class="line"><span class="comment"># æ¸…åé€šé“, æœ€é«˜ä¼˜å…ˆçº§</span></span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda/</span><br><span class="line">conda config --<span class="built_in">set</span> show_channel_urls <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p>å¦‚æœé•œåƒæºå‡ºç°é—®é¢˜ï¼Œå¯è¿˜åŸä½¿ç”¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conda config --remove-key channels</span><br><span class="line">conda config --append channels conda-forge --append channels bioconda --append channels defaults</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;condaç®¡ç†ç”Ÿä¿¡è½¯ä»¶&quot;&gt;&lt;a href=&quot;#condaç®¡ç†ç”Ÿä¿¡è½¯ä»¶&quot; class=&quot;headerlink&quot; title=&quot;condaç®¡ç†ç”Ÿä¿¡è½¯ä»¶&quot;&gt;&lt;/a&gt;condaç®¡ç†ç”Ÿä¿¡è½¯ä»¶&lt;/h1&gt;&lt;p&gt;&lt;em&gt;å†™åœ¨å‰é¢çš„è¯ï¼š&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;linuxä½œ</summary>
      
    
    
    
    <category term="ç”Ÿç‰©ä¿¡æ¯å­¦" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="conda" scheme="https://smileszh.github.io/tags/conda/"/>
    
    <category term="è½¯ä»¶ç®¡ç†" scheme="https://smileszh.github.io/tags/%E8%BD%AF%E4%BB%B6%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
</feed>
