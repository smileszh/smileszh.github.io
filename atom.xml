<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>海底捞里没有鱼</title>
  
  <subtitle>平安喜乐, 万事胜意</subtitle>
  <link href="https://smileszh.github.io/atom.xml" rel="self"/>
  
  <link href="https://smileszh.github.io/"/>
  <updated>2023-06-28T14:27:35.384Z</updated>
  <id>https://smileszh.github.io/</id>
  
  <author>
    <name>小苏</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>疑惑当铺</title>
    <link href="https://smileszh.github.io/posts/53f493a2.html"/>
    <id>https://smileszh.github.io/posts/53f493a2.html</id>
    <published>2023-06-28T14:00:00.000Z</published>
    <updated>2023-06-28T14:27:35.384Z</updated>
    
    <content type="html"><![CDATA[<p><em>小苏碎碎念</em></p><p><em>此篇文档主要记录科研上的一些易混知识，持续更新～</em></p><ul><li>什么是有义链/反义链(sense/antisense)？<blockquote><p>有义链是与mRNA具有相同序列的DNA链，又称<strong>编码链</strong>、<strong>有意义链</strong>。在转录过程中以反义链为模版，翻译成蛋白质。</p></blockquote></li></ul><ul><li>什么是正链(forward stand; Plus strand)/负链(reverse strand; minus strand)?<blockquote><p>人为规定的一条链，DNA的一条链被认为是正链，另一条链就是负链。</p></blockquote></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;em&gt;小苏碎碎念&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;此篇文档主要记录科研上的一些易混知识，持续更新～&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;什么是有义链/反义链(sense/antisense)？&lt;blockquote&gt;
&lt;p&gt;有义链是与mRNA具有相同序列的DNA链，又称&lt;</summary>
      
    
    
    
    <category term="科研知识" scheme="https://smileszh.github.io/categories/%E7%A7%91%E7%A0%94%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="知识点" scheme="https://smileszh.github.io/tags/%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
    
  </entry>
  
  <entry>
    <title>分子互作简介</title>
    <link href="https://smileszh.github.io/posts/80184fae.html"/>
    <id>https://smileszh.github.io/posts/80184fae.html</id>
    <published>2023-06-27T02:00:00.000Z</published>
    <updated>2023-06-27T01:49:33.678Z</updated>
    
    <content type="html"><![CDATA[<h1 id="蛋白-DNA"><a href="#蛋白-DNA" class="headerlink" title="蛋白-DNA"></a>蛋白-DNA</h1><ul><li>也称转录因子模式，所有转录因子都包含一段 DNA结合域，结构域能够识别和结合基因启动子特征DNA序列（motif） ，进而影响靶基因从 DNA 转录产生 RNA 的过程，效应结果是 RNA量的多少变化，如果这个RNA是可以编码蛋白的mRNA，那么最终就会造成靶基因蛋白量的上调或者下调。</li><li><p>转录因子上的氨基酸序列和结构结合的 DNA 序列是有一定规律的，这种规律是预测转录因子调控靶基因的理论基础。</p></li><li><p>启动子是一段DNA序列, 启动子里含有 RNA 聚合酶的特异性结合序列，同时可以跟转录因子结合控制基因的转录活性。</p></li></ul><p><img src="https://bu.dusays.com/2023/06/27/6499bea4b4c9b.png" alt="dna-蛋白质.png"></p><h2 id="相关数据库"><a href="#相关数据库" class="headerlink" title="相关数据库"></a>相关数据库</h2><p><img src="https://bu.dusays.com/2023/06/27/6499c1836e9a1.png" alt="蛋白-dna数据库.png"></p><h1 id="蛋白-蛋白"><a href="#蛋白-蛋白" class="headerlink" title="蛋白-蛋白"></a>蛋白-蛋白</h1><p>蛋白与蛋白通过生成复合物发挥作用，或通过直接结合效应蛋白，影响效应蛋白的功能</p><p><img src="https://bu.dusays.com/2023/06/27/6499c2c763c64.png" alt="蛋白-蛋白.png" style="zoom:67%;" /></p><h2 id="相关数据库-1"><a href="#相关数据库-1" class="headerlink" title="相关数据库"></a>相关数据库</h2><p><img src="https://bu.dusays.com/2023/06/27/6499c32ac65d4.png" alt="蛋白-蛋白数据库.png"></p><h1 id="RNA-RNA-DNA"><a href="#RNA-RNA-DNA" class="headerlink" title="RNA-RNA/DNA"></a>RNA-RNA/DNA</h1><p>RNA既可以结合到DNA上，影响基因转录等功能。也可以结合到RNA上，在转录水平上影响RNA。</p><p><img src="https://bu.dusays.com/2023/06/27/6499c4dfd14c6.png" alt="RNA- RNA.png" style="zoom:67%;" /></p><h2 id="相关数据库-2"><a href="#相关数据库-2" class="headerlink" title="相关数据库"></a>相关数据库</h2><p><img src="https://bu.dusays.com/2023/06/27/6499c542501f4.png" alt="RNA- RNA数据库.png"></p><h1 id="RNA-蛋白"><a href="#RNA-蛋白" class="headerlink" title="RNA-蛋白"></a>RNA-蛋白</h1><p>RNA能够结合到蛋白上，影响蛋白到功能或者定位。蛋白也可以作用于RNA，影响RNA的功能</p><p><img src="https://bu.dusays.com/2023/06/27/6499c659cecc2.png" alt="protein-RNA.png" style="zoom:67%;" /></p><h2 id="相关数据库-3"><a href="#相关数据库-3" class="headerlink" title="相关数据库"></a>相关数据库</h2><p><img src="https://bu.dusays.com/2023/06/27/6499c659e7267.png" alt="蛋白- RNA database.png"></p><h1 id="化合物-分子"><a href="#化合物-分子" class="headerlink" title="化合物-分子"></a>化合物-分子</h1><p>化合物可以通过直接作用或间接作用影响到细胞内靶分子的表达量及功能活性。</p><p><img src="https://bu.dusays.com/2023/06/27/6499c78653e9b.png" alt="mol-mol.png"></p><h2 id="相关数据库-4"><a href="#相关数据库-4" class="headerlink" title="相关数据库"></a>相关数据库</h2><p><img src="https://bu.dusays.com/2023/06/27/6499c78672683.png" alt="mol-mol database.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;蛋白-DNA&quot;&gt;&lt;a href=&quot;#蛋白-DNA&quot; class=&quot;headerlink&quot; title=&quot;蛋白-DNA&quot;&gt;&lt;/a&gt;蛋白-DNA&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;也称转录因子模式，所有转录因子都包含一段 DNA结合域，结构域能够识别和结合基因启动子特征DNA</summary>
      
    
    
    
    <category term="生物信息学" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="数据库" scheme="https://smileszh.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    <category term="分子互作" scheme="https://smileszh.github.io/tags/%E5%88%86%E5%AD%90%E4%BA%92%E4%BD%9C/"/>
    
  </entry>
  
  <entry>
    <title>WGCNA</title>
    <link href="https://smileszh.github.io/posts/572fa456.html"/>
    <id>https://smileszh.github.io/posts/572fa456.html</id>
    <published>2023-06-26T12:00:00.000Z</published>
    <updated>2023-06-26T12:33:44.717Z</updated>
    
    <content type="html"><![CDATA[<h1 id="背景知识"><a href="#背景知识" class="headerlink" title="背景知识"></a>背景知识</h1><ul><li>权重(weghted)：基因之间不仅仅是相关与否，还记录着它们的相关性数值，数值就是基因之间的联系的权重(相关性)。</li><li>模块(module)：表达模式相似的基因分为一类，这样的一类基因成为模块。</li><li>Eigengene：基因和样本构成的矩阵。</li><li>邻接矩阵(Adjacency Matrix)：是图的一种存储形式，用一个一维数组存放图中所有顶点数据；用一个二维数组存放顶点间关系（边或弧）的数据，这个二维数组称为邻接矩阵；在WGCNA分析里面指的是基因与基因之间的相关性系数矩阵。 如果用了阈值来判断基因相关与否，那么这个邻近矩阵就是0/1矩阵，只记录基因相关与否。但是WGCNA没有用阈值来卡基因的相关性，而是记录了所有基因之间的相关性。</li><li>拓扑重叠矩阵(TOM，Topological Overlap Matrix)：WGNA认为基因之间的简单的相关性不足以计算共表达，所以它利用邻近矩阵，又计算了一个新的邻近矩阵。一般来说，TOM就是WGCNA分析的最终结果，后续的只是对TOM的下游注释。</li></ul><h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><ul><li>WGCNA（Weighted Gene Co-expression Network Analysis），即加权基因共表达网络分析。 是一种构建基因共表达网络的常用系统生物学算法，与传统的基因表达网络算法的主要差异在WGCNA采用了软阈值β对表达矩阵进行了加权。</li><li>WGCNA的分析目的在于寻找具有协同表达或共表达的基因组成的网络模块，探索这些基因网络模块与研究的表型或性状之间的关系，寻找与外部信息相关的Hub基因。</li></ul><h1 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h1><p><img src="https://bu.dusays.com/2023/06/26/6498fc8a1d155.png" alt="WGCNA 原理.png"></p><h1 id="基本分析流程"><a href="#基本分析流程" class="headerlink" title="基本分析流程"></a>基本分析流程</h1><p><img src="https://bu.dusays.com/2023/06/26/64990175eb5ee.png" alt="分析流程1.png"></p><p><img src="https://bu.dusays.com/2023/06/26/649901e2a74b5.png" alt="分析流程2.png"></p><h1 id="计算步骤"><a href="#计算步骤" class="headerlink" title="计算步骤"></a>计算步骤</h1><p><img src="https://bu.dusays.com/2023/06/26/649902acb2818.png" alt="计算步骤.png"></p><h1 id="结果解读"><a href="#结果解读" class="headerlink" title="结果解读"></a>结果解读</h1><h2 id="样本和性状热图"><a href="#样本和性状热图" class="headerlink" title="样本和性状热图"></a>样本和性状热图</h2><p><img src="https://bu.dusays.com/2023/06/26/64990343be8a5.png" alt="结果解读1.png"></p><h2 id="选择软阈值s"><a href="#选择软阈值s" class="headerlink" title="选择软阈值ß"></a>选择软阈值ß</h2><p>为了衡量两个基因是否具有相似表达模式，一般需要设置阈值来筛选，高于阈值的则认为是相似的。但是假设直接将阈值设为0.8，那么很难说明0.8和0.79两个是有显著差别的。因此，<strong>WGCNA分析时采用相关系数加权值，即对基因相关系数取N次幂</strong>，使得网络中的基因之间的连接服从<strong>无尺度网络分布(scale-freenetworks)</strong>，这种算法更具生物学意义。</p><ul><li>如例图所示，随着ß增大，R^2^增大，网络的连通性降低；ß=9时呢，网络的连通性很低，这时我们考虑降低R^2^的选择，选择ß=5。（R^2^最好不要低于0.8）</li></ul><p><img src="https://bu.dusays.com/2023/06/26/649905af0cdbb.png" alt="结果解读2.png"></p><h2 id="验证是否符合无尺度网络"><a href="#验证是否符合无尺度网络" class="headerlink" title="验证是否符合无尺度网络"></a>验证是否符合无尺度网络</h2><p><img src="https://bu.dusays.com/2023/06/26/64995c53a66de.png" alt="结果解读3.png"></p><h2 id="TOM矩阵基因聚类图与网络模块图"><a href="#TOM矩阵基因聚类图与网络模块图" class="headerlink" title="TOM矩阵基因聚类图与网络模块图"></a>TOM矩阵基因聚类图与网络模块图</h2><p>通过基因之间的相关系数构建分层聚类树，<strong>聚类树的不同分支代表不同的基因模块</strong>，不同颜色代表不同的模块。基于基因的加权相关系数，将基因按照表达模式进行分类，将模式相似的基因归为一个模块。这样就可以将几万个基因通过基因表达模式被分成了几十个模块，是一个提取归纳信息的过程。</p><ul><li>动态剪切树算法对基因拓扑矩阵进行聚类，初步识别网络模块</li><li>Height表示基因之间的相异性程度，越大表示基因协同表达差异越大，不属于一个网络模块</li><li>不同颜色用于表示不同的网络模块 </li></ul><p><img src="https://bu.dusays.com/2023/06/26/64995f24b987f.png" alt="结果解读4.png"></p><h2 id="初步构建的网络模块进行合并"><a href="#初步构建的网络模块进行合并" class="headerlink" title="初步构建的网络模块进行合并"></a>初步构建的网络模块进行合并</h2><p>对初步构建的网络模块进行合并, 左图中红线表示0.25，在红线下面表示：这些模块之间的相异程度小于0.25，即相似程度高于0.75，将这些模块合并为一个模块，如右图所示。 </p><p><img src="https://bu.dusays.com/2023/06/26/6499610078f57.png" alt="结果解读5.png"></p><h2 id="合并前后基因聚类与网络模块对比图"><a href="#合并前后基因聚类与网络模块对比图" class="headerlink" title="合并前后基因聚类与网络模块对比图"></a>合并前后基因聚类与网络模块对比图</h2><p><img src="https://bu.dusays.com/2023/06/26/649977698f12e.png" alt="结果解读6.png"></p><h2 id="模块与性状关系热图"><a href="#模块与性状关系热图" class="headerlink" title="模块与性状关系热图"></a>模块与性状关系热图</h2><p><img src="https://bu.dusays.com/2023/06/26/649977b34c5b4.png" alt="结果解读7.png"></p><h2 id="模块GS-vs-MM"><a href="#模块GS-vs-MM" class="headerlink" title="模块GS vs MM"></a>模块GS vs MM</h2><ul><li>GS: (Gene Significance) ，表示基因显著性，定义单个基因与外部信息的关联性，即基因与某个性状的相关性。</li><li>MM: (Module Membership) ，用于描述模块的指标，是基于GS值计算出来。</li><li>GS和MM高度相关, 与某个性状高度相关的基因所在的模块往往也与该性状相关。</li><li>图中的横坐标表示MM值，纵坐标表示GS值，可以看出在brown模块中GS值和MM值高度关联，从p值看也是显著相关的。 </li></ul><p><img src="https://bu.dusays.com/2023/06/26/649979963972f.png" alt="结果解读8.png" style="zoom:67%;" /></p><h2 id="网络拓扑结构的可视化"><a href="#网络拓扑结构的可视化" class="headerlink" title="网络拓扑结构的可视化"></a>网络拓扑结构的可视化</h2><p>图中是对网络模块拓扑结构的可视化，使用的数据是网络拓扑（TOM）矩阵，上侧和左侧表示层次聚类结果。从热图可以看出，热图的结果与聚类的树枝一一对应。 </p><p><img src="https://bu.dusays.com/2023/06/26/64997a4b6359e.png" alt="结果解读9.png" style="zoom:67%;" /></p><h1 id="数据要求"><a href="#数据要求" class="headerlink" title="数据要求"></a>数据要求</h1><ul><li>表达矩阵</li><li>表型信息</li></ul><p><img src="https://bu.dusays.com/2023/06/26/6498fe959360d.png" alt="数据要求.png"></p><h1 id="分析手段"><a href="#分析手段" class="headerlink" title="分析手段"></a>分析手段</h1><p>在线工具</p><ul><li><a href="http://bioinformatics.sdstate.edu/idep/">iDEP</a></li><li><a href="https://bmbls.bmi.osumc.edu/IRIS/">IRIS</a></li></ul><p>R包：</p><ul><li>WGCNA包</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;背景知识&quot;&gt;&lt;a href=&quot;#背景知识&quot; class=&quot;headerlink&quot; title=&quot;背景知识&quot;&gt;&lt;/a&gt;背景知识&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;权重(weghted)：基因之间不仅仅是相关与否，还记录着它们的相关性数值，数值就是基因之间的联系的权重(相关性</summary>
      
    
    
    
    <category term="生物信息学" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="聚类分析" scheme="https://smileszh.github.io/tags/%E8%81%9A%E7%B1%BB%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>富集分析在线工具</title>
    <link href="https://smileszh.github.io/posts/e0208d09.html"/>
    <id>https://smileszh.github.io/posts/e0208d09.html</id>
    <published>2023-06-21T17:52:00.000Z</published>
    <updated>2023-06-21T18:05:12.116Z</updated>
    
    <content type="html"><![CDATA[<p><em>小苏碎碎念</em></p><p><em>随着测序数据和方法不断出现，对于不同的基因类型和不同类型的测序数据，进行信息查询和富集分析是生物信息学的一大方面，越来越多在在线网站提供各种各样的分析流程和结果。本文主要收集主要的富集分析在线工具，且随着学习的逐步深入，也在逐步完善此文档～。</em></p><h1 id="KOBAS"><a href="#KOBAS" class="headerlink" title="KOBAS"></a><a href="http://kobas.cbi.pku.edu.cn/">KOBAS</a></h1><ul><li><p>基因/蛋白功能注释（注释模块）和功能基因集富集（富集模块）的在线工具</p></li><li><p>注释模块：输入基因列表，从通路、疾病、基因本体论等多个数据库中提取基因功能注释信息</p></li><li><p>富集模块：输入基因列表或基因表达数据，根据多种方法生成富集的基因集、对应的名称、P值或富集概率和富集分数 </p></li><li><p>支持microarray和RNA-Seq数据的分析</p></li></ul><h1 id="WebGestalt"><a href="#WebGestalt" class="headerlink" title="WebGestalt"></a><a href="https://www.webgestalt.org/">WebGestalt</a></h1><ul><li>功能富集分析在线工具</li><li>支持三种富集分析方法：ORA、GSEA、NTA</li></ul><h1 id="Enrichr"><a href="#Enrichr" class="headerlink" title="Enrichr"></a><a href="https://maayanlab.cloud/Enrichr/">Enrichr</a></h1><ul><li>综合性基因富集分析在线工具</li><li>支持BED格式和基因列表的输入</li><li>富集分析的数据库包括Transcription（转录）, Pathways（通路）, Ontologies（GO）, Diseases/Drugs（疾病/药物）, Cell types（细胞类型）, Misc（未分类数据集）, Legacy, Crowd</li></ul><h1 id="TAM2-0"><a href="#TAM2-0" class="headerlink" title="TAM2.0"></a><a href="http://www.lirmed.com/tam2/">TAM2.0</a></h1><ul><li>miRNA富集网站</li><li>将miRNA分为六大类：miRNA-family sets（miRNA家族），miRNA cluster sets（miRNA聚类），miRNA-disease（miRNA疾病），miRNA-function sets（miRNA功能），miRNA-TF sets（miRNA与转录因子），tissue specificity sets（组织特异性）。</li><li>“Analysis”：对一个miRNA列表，以数据库miRNA集为背景进行富集分析</li><li>“Comparison”：对一组上调和下调的miRNA列表，评估上下调的miRNA与疾病发生或抑制的关系</li><li>“Query”：通过关键词查询相关的miRNA集</li></ul><h1 id="SCPortalen"><a href="#SCPortalen" class="headerlink" title="SCPortalen"></a><a href="http://single-cell.riken.jp/SCPortalen_Database/Home/">SCPortalen</a></h1><ul><li>单细胞分析在线工具</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;em&gt;小苏碎碎念&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;随着测序数据和方法不断出现，对于不同的基因类型和不同类型的测序数据，进行信息查询和富集分析是生物信息学的一大方面，越来越多在在线网站提供各种各样的分析流程和结果。本文主要收集主要的富集分析在线工具，且随着学习的逐步深入，也</summary>
      
    
    
    
    <category term="生物信息学" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="数据库" scheme="https://smileszh.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    <category term="富集分析" scheme="https://smileszh.github.io/tags/%E5%AF%8C%E9%9B%86%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>GO/KEGG富集分析</title>
    <link href="https://smileszh.github.io/posts/b3231218.html"/>
    <id>https://smileszh.github.io/posts/b3231218.html</id>
    <published>2023-06-20T16:28:00.000Z</published>
    <updated>2023-06-20T17:25:26.336Z</updated>
    
    <content type="html"><![CDATA[<p>注：<a href="https://yun.console.xlj0.com/s/yDbsk">模拟数据</a></p><p><em>基因富集分析(Gene Sets Enrichment Analysis): 是将基因或蛋白集合通过一定的方法，将其分成多个部分，从而减少分析的复杂程度。</em></p><h1 id="基因功能富集分析方法"><a href="#基因功能富集分析方法" class="headerlink" title="基因功能富集分析方法"></a>基因功能富集分析方法</h1><p><img src="https://bu.dusays.com/2023/06/13/64885e43e32b2.png" alt="基因富集方法.png" style="zoom: 50%;" /></p><h2 id="ORA-过代表分析"><a href="#ORA-过代表分析" class="headerlink" title="ORA: 过代表分析"></a>ORA: 过代表分析</h2><blockquote><p>over-representation analysis: 先计数基因列表与基因功能集共同的基因,并利用2×2列联表,进行Fisher精确检验</p></blockquote><p>优点：</p><ul><li>比较完备的统计学理论,输出结果比较稳健、可靠</li></ul><p>缺点：</p><ul><li>它仅仅使用了基因的数目信息，而没有利用基因表达水平或表达差异值</li><li>通常仅使用最显著的基因序列，而忽略差异不显著的基因, 导致检测灵敏性的降低</li><li>将每一个基因进行同等对待，它忽视了基因在通路内部生物学意义的不同，以及基因间复杂的相互作用</li><li>假设通路与通路间是独立的，但这个前提假设是不太准确的</li></ul><h2 id="FCS-功能分类打分"><a href="#FCS-功能分类打分" class="headerlink" title="FCS: 功能分类打分"></a>FCS: 功能分类打分</h2><blockquote><p>functional class scoring: 以GSEA为例, 对基因表达谱中的所有基因按照与表型的差异表达程度排序,再利用KS检验对待测功能基因集打分,利用随机重排得到背景分布,找出显著富集的功能基因集</p></blockquote><p>优点：</p><ul><li>考虑到了基因表达值的属性信息问题</li><li>以待测基因功能集为对象来进行检验，使得检测结果更加灵敏及更有针对性</li></ul><p>缺点：</p><ul><li><p>独立分析每一条通路，但同一个基因可能涉及多条通路，不同通路间的基因出现重叠，所以可能会导致别的通路由于重叠基因问题，也出现显著富集现象</p></li><li><p>仍把待测基因功能集中的每个基因作为独立的个体, 忽略了基因的生物学属性和基因间的复杂相互作用关系。 </p></li></ul><h2 id="PT-通路拓扑结构分析"><a href="#PT-通路拓扑结构分析" class="headerlink" title="PT:  通路拓扑结构分析"></a>PT:  通路拓扑结构分析</h2><blockquote><p>pathway topology: 以Pathway-Express为例,根据上下游关系对通路进行打分,上游通路影响因子较大,对待测基因功能集根据影响因子进行打分,然后根据统计检验模型计算显著程度</p></blockquote><p>优点：</p><ul><li>基于PT的基因功能富集算法对研究一些比较完善、拓扑结构完整的通路会有更强的显著性。</li></ul><p>缺点：</p><ul><li>研究较少，信息不完善的通路稳健型较差</li></ul><h2 id="NT-网络拓扑结构分析"><a href="#NT-网络拓扑结构分析" class="headerlink" title="NT:  网络拓扑结构分析"></a>NT:  网络拓扑结构分析</h2><blockquote><p>network topology: 以NEA为例,将基因列表或基因表达谱和待测基因功能集放入生物网络中,计算感兴趣的基因与待测基因功能集在网络之间的最短距离,通过对网络重调得到背景分布,找出显著富集的基因功能集。</p></blockquote><p>优点：</p><ul><li>加入了系统层面的基因重要性程度及关联信息等属性数据，使得预测结果更加准确可靠</li></ul><p>缺点：</p><ul><li>更多信息的加入也容易导致算法过于复杂，计算速度较慢，实现难度也就更大。</li></ul><h1 id="GO-KEGG富集分析原理及实现"><a href="#GO-KEGG富集分析原理及实现" class="headerlink" title="GO/KEGG富集分析原理及实现"></a>GO/KEGG富集分析原理及实现</h1><blockquote><ol><li><p>使用GO富集分析工具 </p></li><li><p>输出解释结果表</p></li><li><p>GO富集分析结果输出 </p></li><li><p>KEGG分析 </p></li></ol></blockquote><p>GO/KEGG富集分析，是一个典型的ORA分析方法应用。</p><h2 id="GO"><a href="#GO" class="headerlink" title="GO"></a><a href="http://geneontology.org/">GO</a></h2><blockquote><p>Gene Ontology: GO的初衷就是希望提供一个能对基因和基因产物特性相关的术语或词义 进行描绘及解释的工作平台，从而使生物信息学研究者对基因和基因产物的数据能够进行统一的归纳、处理、解释和共享，便于我们理解和沟通。 基因本体涉及的基因和基因产物词汇分为三大类，涵盖生物学的三个方面。</p></blockquote><h3 id="GO-term-分类"><a href="#GO-term-分类" class="headerlink" title="GO term 分类"></a>GO term 分类</h3><ul><li><p><strong>细胞组分</strong>（cellular component）：细胞的每个部分和细胞外环境。「<em>在哪里发挥作用</em>」</p></li><li><p><strong>分子功能</strong>（molecular function）：可以描述为分子水平的活性（activity），如催化（catalytic）或结合（binding）活性等。「<em>做什么工作</em>」</p></li><li><p><strong>生物过程</strong>（biological process）：是指由一个或多个分子功能有序组合而产生的系列事件，一般一个过程是由多个不同的步骤组成。「<em>目的是什么</em>」</p></li></ul><h2 id="KEGG"><a href="#KEGG" class="headerlink" title="KEGG"></a><a href="https://www.genome.jp/kegg/">KEGG</a></h2><blockquote><p>KEGG能够对富集分析结果进行生物学解释，它是一个整合了基因组、化学和系统功能信息的数据库，可以对更高层次和更复杂细胞活动和生物体行为做出计算推测。把从已经完整测序的基因组中得到的基因目录与更高级别的细胞、物种和生态系统水平的系统功能关联起来。</p></blockquote><p><em>注：KEGG其实是一个综合数据库，它大致分为系统信息、基因组信息和化学信息三大类，进一步可细分为16个主要的数据库。</em>如：</p><p>PATHWAY 数据库: 整合当前分子互动网络，存储了一些更高级的功能信息，包括细胞生化过程如代谢、膜转运、信号传递、细胞周期，还 包括同系保守的子通路等信息通道。</p><p>GENES、SSDB、KO 等数据库可以提供关于在基因组计划中发现的基因和蛋白质的相关知识，其中基因组信息存储在KEGG的GENES数据库里，包括完整和部分测序的基因组序列，而KO这个系统通过把分子网络的相关信息连接到基因组中，从而发展和促进了跨物种注释流程，实现了跨物种分析基因信息。</p><p>COMPOUND、GLYCAN、REACTION等数据库则提供生化复合物及反应方面的知识。</p><p>补充数据库：如LIGAND，里面还包含有化学物质、酶分子、酶反应等信息。</p><p> <img src="https://bu.dusays.com/2023/06/13/64886b742075e.png" alt="KEGG.png" style="zoom:50%;" /></p><h1 id="单基因GO-KEGG富集分析"><a href="#单基因GO-KEGG富集分析" class="headerlink" title="单基因GO/KEGG富集分析"></a>单基因GO/KEGG富集分析</h1><h2 id="通路数据库-KEGG"><a href="#通路数据库-KEGG" class="headerlink" title="通路数据库 KEGG"></a>通路数据库 KEGG</h2><h3 id="选择GENES数据库"><a href="#选择GENES数据库" class="headerlink" title="选择GENES数据库"></a>选择GENES数据库</h3><p><img src="https://bu.dusays.com/2023/06/13/64887f9303e67.png" alt="单基因1.png"  /></p><h3 id="输入查询单个基因信息"><a href="#输入查询单个基因信息" class="headerlink" title="输入查询单个基因信息"></a>输入查询单个基因信息</h3><p><img src="https://bu.dusays.com/2023/06/13/648880cd8c041.png" alt="单基因2——tets.png"  /></p><h3 id="查看输出结果"><a href="#查看输出结果" class="headerlink" title="查看输出结果"></a>查看输出结果</h3><p><img src="https://bu.dusays.com/2023/06/20/6491b9e2a8e95.png" alt="Screenshot 2023-06-20 at 22.38.04.png"></p><h3 id="可选择涉及通路具体查看"><a href="#可选择涉及通路具体查看" class="headerlink" title="可选择涉及通路具体查看"></a>可选择涉及通路具体查看</h3><p><img src="https://bu.dusays.com/2023/06/13/64887f9307fcd.png" alt="单基因4.png" style="zoom:50%;" /></p><h3 id="可返回主页搜索基因名查看多物种基因富集信息"><a href="#可返回主页搜索基因名查看多物种基因富集信息" class="headerlink" title="可返回主页搜索基因名查看多物种基因富集信息"></a>可返回主页搜索基因名查看多物种基因富集信息</h3><p><img src="https://bu.dusays.com/2023/06/13/64887f930f999.png" alt="单基因5.png"  /></p><p><img src="https://bu.dusays.com/2023/06/13/64887f9303eeb.png" alt="单基因6.png"  /></p><h2 id="通路数据库-Reactome"><a href="#通路数据库-Reactome" class="headerlink" title="通路数据库 Reactome"></a>通路数据库 <a href="https://reactome.org/">Reactome</a></h2><blockquote><p>通路知识的可视化、解释和分析提供直观的生物信息学工具。</p><p>Reactome是reaction（反应）+ ome（组）的合成词，反应可以被视为途径的“步骤”。Reactome将“反应”定义为生物学中任何改变生物分子状态的事件， 涉及催化剂的结合、活化、易位、降解和经典生物化学事件。因此，Reactome数据模型的核心单元是反应（reaction），参与反应的实体（核酸、蛋白质、复合物剂和小分子）形成生物相互作用的网络并被分组成通路。</p></blockquote><h3 id="进入官网，选择Pathway-Browser"><a href="#进入官网，选择Pathway-Browser" class="headerlink" title="进入官网，选择Pathway Browser"></a>进入官网，选择Pathway Browser</h3><p><img src="https://bu.dusays.com/2023/06/18/648de316e5c13.png" alt="react_4.png"></p><h3 id="输入相关信息查看结果"><a href="#输入相关信息查看结果" class="headerlink" title="输入相关信息查看结果"></a>输入相关信息查看结果</h3><p><img src="https://bu.dusays.com/2023/06/18/648de316e5bca.png" alt="react_5.png"></p><h3 id="也可进入Analysis-Tools进行多个基因通路查看"><a href="#也可进入Analysis-Tools进行多个基因通路查看" class="headerlink" title="也可进入Analysis Tools进行多个基因通路查看"></a>也可进入Analysis Tools进行多个基因通路查看</h3><p><img src="https://bu.dusays.com/2023/06/18/648de316e5cad.png" alt="reacctome_1.png"></p><p><img src="https://bu.dusays.com/2023/06/18/648de316e654f.png" alt="reactome_2.png"></p><p><img src="https://bu.dusays.com/2023/06/18/648de316e9490.png" alt="reactome_3.png"></p><h2 id="GeneCards数据库"><a href="#GeneCards数据库" class="headerlink" title="GeneCards数据库"></a><a href="https://www.genecards.org/">GeneCards</a>数据库</h2><blockquote><p>人类基因数据库</p></blockquote><p><img src="https://bu.dusays.com/2023/06/18/648de5698bf4d.png" alt="Screenshot 2023-06-18 at 00.52.36.png"></p><p><img src="https://bu.dusays.com/2023/06/18/648de5698bf4d.png" alt="Screenshot 2023-06-18 at 00.53.16.png"></p><h2 id="Uniprot"><a href="#Uniprot" class="headerlink" title="Uniprot"></a><a href="https://www.uniprot.org/">Uniprot</a></h2><h3 id="输入基因"><a href="#输入基因" class="headerlink" title="输入基因"></a>输入基因</h3><p><img src="https://bu.dusays.com/2023/06/18/648de75d8f607.png" alt="Screenshot 2023-06-18 at 00.57.30.png"></p><h3 id="选择需要的结果"><a href="#选择需要的结果" class="headerlink" title="选择需要的结果"></a>选择需要的结果</h3><p><img src="https://bu.dusays.com/2023/06/18/648de75d330d0.png" alt="Screenshot 2023-06-18 at 00.57.45.png"></p><h3 id="详细查看需要的信息"><a href="#详细查看需要的信息" class="headerlink" title="详细查看需要的信息"></a>详细查看需要的信息</h3><p><img src="https://bu.dusays.com/2023/06/18/648de75d330d0.png" alt="Screenshot 2023-06-18 at 01.01.44.png"></p><h1 id="多基因GO-KEGG分析"><a href="#多基因GO-KEGG分析" class="headerlink" title="多基因GO/KEGG分析"></a>多基因GO/KEGG分析</h1><h2 id="DAVID数据库"><a href="#DAVID数据库" class="headerlink" title="DAVID数据库"></a><a href="https://david.ncifcrf.gov/">DAVID</a>数据库</h2><blockquote><p>主要用于差异基因的功能和通路富集分析</p></blockquote><h3 id="打开官网，选择Functional-Annotation"><a href="#打开官网，选择Functional-Annotation" class="headerlink" title="打开官网，选择Functional Annotation"></a>打开官网，选择Functional Annotation</h3><p><img src="https://bu.dusays.com/2023/06/18/648df0cbddbc9.png" alt="Screenshot 2023-06-18 at 01.23.01.png"  /></p><h3 id="输入需要分析的基因集"><a href="#输入需要分析的基因集" class="headerlink" title="输入需要分析的基因集"></a>输入需要分析的基因集</h3><p><img src="https://bu.dusays.com/2023/06/18/648df0cbbc11c.png" alt="Screenshot 2023-06-18 at 01.19.19.png"  /></p><h3 id="选择物种"><a href="#选择物种" class="headerlink" title="选择物种"></a>选择物种</h3><p><img src="https://bu.dusays.com/2023/06/18/648df0cbb80e7.png" alt="Screenshot 2023-06-18 at 01.19.57.png"  /></p><h3 id="选择背景基因集"><a href="#选择背景基因集" class="headerlink" title="选择背景基因集"></a>选择背景基因集</h3><p><img src="https://bu.dusays.com/2023/06/18/648df0cbb82c3.png" alt="Screenshot 2023-06-18 at 01.20.37.png"  /></p><h3 id="查看结果信息"><a href="#查看结果信息" class="headerlink" title="查看结果信息"></a>查看结果信息</h3><p><img src="https://bu.dusays.com/2023/06/18/648df0cbb80e7.png" alt="Screenshot 2023-06-18 at 01.21.32.png"  /></p><h2 id="Metascape数据库"><a href="#Metascape数据库" class="headerlink" title="Metascape数据库"></a><a href="https://metascape.org/gp/#/main/step1">Metascape</a>数据库</h2><h3 id="输入基因集"><a href="#输入基因集" class="headerlink" title="输入基因集"></a>输入基因集</h3><p><img src="https://bu.dusays.com/2023/06/20/6491bc5b88978.png" alt="Screenshot 2023-06-20 at 22.43.07.png"></p><h3 id="选择物种信息"><a href="#选择物种信息" class="headerlink" title="选择物种信息"></a>选择物种信息</h3><p><img src="https://bu.dusays.com/2023/06/20/6491bc5b85776.png" alt="Screenshot 2023-06-20 at 22.43.51.png"></p><h3 id="查看分析结果"><a href="#查看分析结果" class="headerlink" title="查看分析结果"></a>查看分析结果</h3><p><img src="https://bu.dusays.com/2023/06/20/6491bc5b7e12d.png" alt="Screenshot 2023-06-20 at 22.45.32.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;注：&lt;a href=&quot;https://yun.console.xlj0.com/s/yDbsk&quot;&gt;模拟数据&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;基因富集分析(Gene Sets Enrichment Analysis): 是将基因或蛋白集合通过一定的方法，将其分成多个部分，从而减</summary>
      
    
    
    
    <category term="生物信息学" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="数据库" scheme="https://smileszh.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    <category term="R语言" scheme="https://smileszh.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
    <category term="富集分析" scheme="https://smileszh.github.io/tags/%E5%AF%8C%E9%9B%86%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>生物数据库基因ID</title>
    <link href="https://smileszh.github.io/posts/df5af0f1.html"/>
    <id>https://smileszh.github.io/posts/df5af0f1.html</id>
    <published>2023-06-11T14:00:00.000Z</published>
    <updated>2023-06-11T14:54:55.643Z</updated>
    
    <content type="html"><![CDATA[<p><em>小苏碎碎念：</em></p><p><em>科研分析中经常会遇到各种各样的基因ID类型，了解各种命名的来源和规则有助于我们在不同的数据库之间进行转换和使用。同时因各种各样的数据库越来越多，本文档也会持续完善和更新～～～🍊。</em></p><h1 id="背景知识"><a href="#背景知识" class="headerlink" title="背景知识"></a>背景知识</h1><ul><li><p>NCBI：National Center for Biotechnology Information, 即美国国家生物技术信息中心，是一个机构名称，不是数据库。</p></li><li><p><a href="https://www.ncbi.nlm.nih.gov/">Entrez</a> 是一个归属于 NCBI 的综合性的生物信息数据检索引擎系统，这个搜索引擎整合了包含核酸、蛋白质、基因、基因组、GEO 等在内的很多常用数据库。</p></li><li>HGNC: HUGO Gene Nomenclature Committee, 即人类基因命名委员会。人类大多基因的命名，是有HGNC完成的。</li><li>小鼠（mouse）的基因命名来源于MGNC；大鼠（rat）基因命名来源于RGNC；斑马鱼（zebrafish）基因命名来源于ZFIN</li><li><a href="https://www.ensembl.org/index.html">Ensembl</a> 基因组数据库项目，是 1999 年启动的，来应对当时即将完成的人类基因组计划的一个科学项目，是科研人员用于检索基因组信息的最常用数据库之一。</li><li>refseq参考序列数据库，是NCBI提供的具有生物学意义上的非冗余的基因和蛋 白等片段序列的数据库。它是目前世界上比较权威的序列数据库，一般可信度是比较高的。</li></ul><h1 id="Entrez-Gene-ID"><a href="#Entrez-Gene-ID" class="headerlink" title="Entrez Gene ID"></a>Entrez Gene ID</h1><blockquote><p>Entrez ID</p></blockquote><p>Entrez gene ID 来源于 Entrez gene 数据库的编号系统。Entrez 基因数据库其实就是我们现在指的 NCBI 中的 Gene 数据库，这两个名字指的是同一个数据库</p><p><img src="https://bu.dusays.com/2023/06/11/6485cd2ea5710.png" alt="GENE database.png" style="zoom:50%;" /></p><p>Entrez Gene ID编号的格式就是一串数字。比如说像 <a href="https://www.ncbi.nlm.nih.gov/gene/7157">TP53</a>，他下面的 gene ID:7157</p><p><img src="https://bu.dusays.com/2023/06/11/6485ce4cac856.png" alt="TP53 gene id.png" style="zoom: 67%;" /></p><h1 id="Gene-Symbol"><a href="#Gene-Symbol" class="headerlink" title="Gene Symbol"></a>Gene Symbol</h1><blockquote><p>official Symbol,  HGNC symbol</p></blockquote><ul><li>Office symbol: 是HGNC组织对基因进行命名的描述的一个缩写标识符</li><li>Office Full Name: 是经HGNC批准的基因名全称</li><li>HGNC ID：是HGNC数据库分配的基因编号，每个标准的symbol都有对应的HGNC ID</li></ul><p><img src="https://bu.dusays.com/2023/06/11/6485d13d7e1d7.png" alt="symbol.png"></p><p><em>注：并不是所有的基因都有Official Symbol。如果基因缺少基因命名委员会命名的Gene Symbol，Entez Gene数据库中的Official symbol 就会变为Gene Symbol, 并且Gene Symbol的编号会变为LOC前缀加Entrez ID。</em>如：</p><p><img src="https://bu.dusays.com/2023/06/11/6485d3fde40a0.png" alt="LOC.png"></p><h1 id="Ensemble-ID"><a href="#Ensemble-ID" class="headerlink" title="Ensemble ID"></a>Ensemble ID</h1><blockquote><p>Ensembl Stable ID </p></blockquote><p>命名规则：ENS[根据不同物种设置的前缀][数据所指类型（如基因，蛋白等）][一段特定的数字] . [版本]</p><p><img src="https://bu.dusays.com/2023/06/11/6485d81a96f6c.png" alt="ENS .png"></p><h1 id="RefSeq-Accession-Number"><a href="#RefSeq-Accession-Number" class="headerlink" title="RefSeq Accession Number"></a>RefSeq Accession Number</h1><blockquote><p>RefSeq ID</p></blockquote><p>命名的格式以两个字母开头，后面跟一个下划线和六个或多个字母</p><p><img src="https://bu.dusays.com/2023/06/11/6485db197eb94.png" alt="前缀.png" style="zoom: 67%;" /></p><p><em>注：在 NCBI 的这个检索结果里，refseq status 这一行会显示这条 refseq 的状态。主要状态有:MODEL 指自动被 NCBI 提供的，没有被审核过，INFERRED 指由序列分析预测得到，没有经过实验验证，PREDICTED 指没有经过人工审核，REVIEWED 指已被人工审 核等等，可以根据这条信息认定序列的可信度。</em></p><p><img src="https://bu.dusays.com/2023/06/11/6485d9504d3a7.png" alt="ref.png"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;em&gt;小苏碎碎念：&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;科研分析中经常会遇到各种各样的基因ID类型，了解各种命名的来源和规则有助于我们在不同的数据库之间进行转换和使用。同时因各种各样的数据库越来越多，本文档也会持续完善和更新～～～🍊。&lt;/em&gt;&lt;/p&gt;
&lt;h1 id=&quot;背景</summary>
      
    
    
    
    <category term="科研知识" scheme="https://smileszh.github.io/categories/%E7%A7%91%E7%A0%94%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="基因ID" scheme="https://smileszh.github.io/tags/%E5%9F%BA%E5%9B%A0ID/"/>
    
    <category term="生物数据库" scheme="https://smileszh.github.io/tags/%E7%94%9F%E7%89%A9%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>定量引物设计</title>
    <link href="https://smileszh.github.io/posts/e7e9fba0.html"/>
    <id>https://smileszh.github.io/posts/e7e9fba0.html</id>
    <published>2023-06-10T16:00:00.000Z</published>
    <updated>2023-06-11T14:07:35.982Z</updated>
    
    <content type="html"><![CDATA[<h1 id="查找基因"><a href="#查找基因" class="headerlink" title="查找基因"></a>查找基因</h1><h2 id="进入NCBI官网"><a href="#进入NCBI官网" class="headerlink" title="进入NCBI官网"></a>进入<a href="https://www.ncbi.nlm.nih.gov/">NCBI官网</a></h2><p><img src="https://bu.dusays.com/2023/06/11/6484a6b1c4eae.png" alt="官网.png" style="zoom: 35%;" /></p><h2 id="查找序列"><a href="#查找序列" class="headerlink" title="查找序列"></a>查找序列</h2><p><img src="https://bu.dusays.com/2023/06/11/6484a6b1d340a.png" alt="查找基因1.png" style="zoom:35%;" /></p><h2 id="查找基因ID"><a href="#查找基因ID" class="headerlink" title="查找基因ID"></a>查找基因ID</h2><p><img src="https://bu.dusays.com/2023/06/11/6484a6b1d0f51.png" alt="查找基因2.png" style="zoom:35%;" /></p><h1 id="引物设计"><a href="#引物设计" class="headerlink" title="引物设计"></a>引物设计</h1><h2 id="打开Prime-BLAST"><a href="#打开Prime-BLAST" class="headerlink" title="打开Prime-BLAST"></a>打开<a href="https://www.ncbi.nlm.nih.gov/tools/primer-blast/index.cgi?LINK_LOC=BlastHome">Prime-BLAST</a></h2><p><img src="https://bu.dusays.com/2023/06/11/6484a6b1c5396.png" alt="引物1.png" style="zoom:35%;" /></p><h2 id="根据需求填写参数"><a href="#根据需求填写参数" class="headerlink" title="根据需求填写参数"></a>根据需求填写参数</h2><p><img src="https://bu.dusays.com/2023/06/11/6484a6b1dbb3c.png" alt="引物2.png" style="zoom:35%;" /></p><h1 id="结果筛选"><a href="#结果筛选" class="headerlink" title="结果筛选"></a>结果筛选</h1><p><img src="https://bu.dusays.com/2023/06/11/6484a6b1c5b30.png" alt="结果.png" style="zoom:40%;" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;查找基因&quot;&gt;&lt;a href=&quot;#查找基因&quot; class=&quot;headerlink&quot; title=&quot;查找基因&quot;&gt;&lt;/a&gt;查找基因&lt;/h1&gt;&lt;h2 id=&quot;进入NCBI官网&quot;&gt;&lt;a href=&quot;#进入NCBI官网&quot; class=&quot;headerlink&quot; title=&quot;进</summary>
      
    
    
    
    <category term="科研知识" scheme="https://smileszh.github.io/categories/%E7%A7%91%E7%A0%94%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="引物设计" scheme="https://smileszh.github.io/tags/%E5%BC%95%E7%89%A9%E8%AE%BE%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>tidyverse：处理关系数据</title>
    <link href="https://smileszh.github.io/posts/7218365e.html"/>
    <id>https://smileszh.github.io/posts/7218365e.html</id>
    <published>2023-06-10T15:00:00.000Z</published>
    <updated>2023-06-11T02:59:56.574Z</updated>
    
    <content type="html"><![CDATA[<p><em>写在前面的话</em>：</p><p><em>当有多个数据框时，我们需要根据数据框之间的相关变量，对数据进行整理，合并，筛选。生信分析中对关系数据进行处理时，常使用tidyverse包中dplyr进行处理</em>。</p><p>注：文档中举例除了使用自建数据外，我们需要使用 nycflights13。这个数据包含了 2013 年从纽约市出发的所有 336 776次航班的信息。该数据来自于美国交通统计局， 可以使用?nycflights13 查看其说明文档。包括flights, airports, planes, weather, airline五个数据框。 文档中如出现此类数据对象，不再另行说明。</p><ul><li>flights: 包含航班信息</li><li>airlines:可以根据航空公司的缩写码查到公司全名。</li><li>airports:给出了每个机场的信息，通过 faa 机场编码进行标识。</li><li>planes:给出了每架飞机的信息，通过 tailnum 进行标识。</li><li>weather:给出了纽约机场每小时的天气状况。</li></ul><p><img src="https://bu.dusays.com/2023/06/10/64847e2f85887.png" alt="数据关系.png" style="zoom: 25%;" /></p><p>R包使用：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>tidyverse<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>nycflights13<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h1 id="相关概念"><a href="#相关概念" class="headerlink" title="相关概念"></a>相关概念</h1><ul><li><strong>键</strong>：用于连接每对数据表对变量称为键，键是能唯一标识观测的变量（或变量集合）</li><li><strong>主键</strong>：唯一标识其所在数据框的观测</li><li><strong>外键</strong>：唯一标识另一个数据表中的观测</li><li><strong>代理键</strong>：一个表格没有主键时，使用mutate()和row_number()函数人为添加的一个主键称为代理键</li></ul><h1 id="合并连接"><a href="#合并连接" class="headerlink" title="合并连接"></a>合并连接</h1><blockquote><p>合并连接将两个表格中的变量进行组合，通过两个表格中键匹配观测，然后将一个表格中的变量复制到另一个表格中。</p></blockquote><h2 id="内连接-inner-join"><a href="#内连接-inner-join" class="headerlink" title="内连接 inner_join()"></a>内连接 inner_join()</h2><blockquote><p>保留X和Y中共有的观测</p></blockquote><p><img src="https://bu.dusays.com/2023/06/10/64843c3112eed.png" alt="内连接.png" style="zoom:50%;" /></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数据构造</span></span><br><span class="line"></span><br><span class="line">x <span class="operator">&lt;-</span> tribble<span class="punctuation">(</span></span><br><span class="line">  <span class="operator">~</span>key<span class="punctuation">,</span> <span class="operator">~</span>val_x<span class="punctuation">,</span></span><br><span class="line">  <span class="number">1</span><span class="punctuation">,</span> <span class="string">&quot;x1&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="number">2</span><span class="punctuation">,</span> <span class="string">&quot;x2&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="number">3</span><span class="punctuation">,</span> <span class="string">&quot;x3&quot;</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">y <span class="operator">&lt;-</span> tribble<span class="punctuation">(</span></span><br><span class="line">  <span class="operator">~</span>key<span class="punctuation">,</span> <span class="operator">~</span>val_x<span class="punctuation">,</span></span><br><span class="line">  <span class="number">1</span><span class="punctuation">,</span> <span class="string">&quot;y1&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="number">2</span><span class="punctuation">,</span> <span class="string">&quot;y2&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="number">4</span><span class="punctuation">,</span> <span class="string">&quot;y3&quot;</span></span><br><span class="line"><span class="punctuation">)</span>  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 内连接</span></span><br><span class="line"></span><br><span class="line">x <span class="operator">%&gt;%</span></span><br><span class="line">  inner_join<span class="punctuation">(</span>y<span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&quot;key&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A tibble: 2 × 3</span></span><br><span class="line">    key val_x.x val_x.y</span><br><span class="line">  <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span> <span class="operator">&lt;</span>chr<span class="operator">&gt;</span>   <span class="operator">&lt;</span>chr<span class="operator">&gt;</span>  </span><br><span class="line"><span class="number">1</span>     <span class="number">1</span> x1      y1     </span><br><span class="line"><span class="number">2</span>     <span class="number">2</span> x2      y2  </span><br></pre></td></tr></table></figure><h2 id="外连接"><a href="#外连接" class="headerlink" title="外连接"></a>外连接</h2><blockquote><ul><li>左连接：保留x中的所有观测</li><li>右连接：保留Y中的所有观测</li><li>全连接，保留X和Y中所有观测</li></ul></blockquote><p><img src="https://bu.dusays.com/2023/06/10/64843d25c12d6.png" alt="外连接.png" style="zoom:50%;" /></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 左连接</span></span><br><span class="line">left_join<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 右连接</span></span><br><span class="line">right_join<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 全连接</span></span><br><span class="line">full_join<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h1 id="筛选连接"><a href="#筛选连接" class="headerlink" title="筛选连接"></a>筛选连接</h1><blockquote><p>根据匹配的键，筛选数据表中的观测</p></blockquote><h2 id="半连接-semi-join-x-y"><a href="#半连接-semi-join-x-y" class="headerlink" title="半连接 semi_join(x, y)"></a>半连接 semi_join(x, y)</h2><blockquote><p><strong>保留</strong>X表中与Y表中的观测相匹配的所有观测</p></blockquote><p><img src="https://bu.dusays.com/2023/06/10/648475b9ac49d.png" alt="半连接.png" style="zoom:50%;" /></p><p><img src="https://bu.dusays.com/2023/06/10/648475b9ac49d.png" alt="半连接1.png" style="zoom:50%;" /></p><p>例：根据表flights找出飞往最受欢迎的10个目的地的航班信息</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 找出最受欢迎的10个目的地 -----------------------------------------------------------</span></span><br><span class="line">top_dest <span class="operator">&lt;-</span> flights <span class="operator">%&gt;%</span> </span><br><span class="line">  count<span class="punctuation">(</span>dest<span class="punctuation">,</span> sort <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  head<span class="punctuation">(</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">top_dest</span><br><span class="line"></span><br><span class="line"><span class="comment"># # A tibble: 10 × 2</span></span><br><span class="line"><span class="comment"># dest      n</span></span><br><span class="line"><span class="comment"># &lt;chr&gt; &lt;int&gt;</span></span><br><span class="line"><span class="comment">#   1 ORD   17283</span></span><br><span class="line"><span class="comment"># 2 ATL   17215</span></span><br><span class="line"><span class="comment"># 3 LAX   16174</span></span><br><span class="line"><span class="comment"># 4 BOS   15508</span></span><br><span class="line"><span class="comment"># 5 MCO   14082</span></span><br><span class="line"><span class="comment"># 6 CLT   14064</span></span><br><span class="line"><span class="comment"># 7 SFO   13331</span></span><br><span class="line"><span class="comment"># 8 FLL   12055</span></span><br><span class="line"><span class="comment"># 9 MIA   11728</span></span><br><span class="line"><span class="comment"># 10 DCA    9705</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 找出飞往这些目的地的航班 ------------------------------------------------------------</span></span><br><span class="line">flights <span class="operator">%&gt;%</span></span><br><span class="line">  semi_join<span class="punctuation">(</span>top_dest<span class="punctuation">)</span> <span class="comment"># 默认值by = NULL, 会使用存在于两个表中的所有变量，这种方式称为自然连接</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="反连接-anti-join-x-y"><a href="#反连接-anti-join-x-y" class="headerlink" title="反连接 anti_join(x, y)"></a>反连接 anti_join(x, y)</h2><blockquote><p><strong>丢弃</strong>X表中与Y表中的观测相匹配的所有观测</p></blockquote><p><img src="https://bu.dusays.com/2023/06/10/648475b9ac49d.png" alt="反连接.png" style="zoom:50%;" /></p><p>例：找出flights 中在 planes 中没有匹配的记录</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flights <span class="operator">%&gt;%</span></span><br><span class="line">  anti_join<span class="punctuation">(</span>planes<span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&quot;tailnum&quot;</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span></span><br><span class="line">  count<span class="punctuation">(</span>tailnum<span class="punctuation">,</span> sort <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h1 id="集合操作"><a href="#集合操作" class="headerlink" title="集合操作"></a>集合操作</h1><blockquote><p>集合操作要求X和Y具有相同的变量</p></blockquote><p>模拟数据构建:</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">df1 <span class="operator">&lt;-</span> tribble<span class="punctuation">(</span></span><br><span class="line">  <span class="operator">~</span>x<span class="punctuation">,</span> <span class="operator">~</span>y<span class="punctuation">,</span></span><br><span class="line">  <span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">  <span class="number">2</span><span class="punctuation">,</span> <span class="number">1</span> </span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">df2 <span class="operator">&lt;-</span> tribble<span class="punctuation">(</span></span><br><span class="line">  <span class="operator">~</span>x<span class="punctuation">,</span> <span class="operator">~</span>y<span class="punctuation">,</span></span><br><span class="line">  <span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">  <span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span> </span><br><span class="line"><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h2 id="intersect-x-y"><a href="#intersect-x-y" class="headerlink" title="intersect(x, y)"></a>intersect(x, y)</h2><blockquote><p>返回既在 x 表，又在 y 表中的观测。 </p></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">intersect<span class="punctuation">(</span>df1<span class="punctuation">,</span> df2<span class="punctuation">)</span> </span><br><span class="line"><span class="comment"># # A tibble: 1 × 2</span></span><br><span class="line"><span class="comment">#      x     y</span></span><br><span class="line"><span class="comment">#    &lt;dbl&gt; &lt;dbl&gt;</span></span><br><span class="line"><span class="comment"># 1    1     1</span></span><br></pre></td></tr></table></figure><h2 id="union-x-y"><a href="#union-x-y" class="headerlink" title="union(x, y)"></a>union(x, y)</h2><blockquote><p>返回 x 表或 y 表中的唯一观测。</p></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 注意，我们得到了3行，而不是4行 </span></span><br><span class="line">union<span class="punctuation">(</span>df1<span class="punctuation">,</span> df2<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># # A tibble: 3 × 2</span></span><br><span class="line"><span class="comment">#       x     y</span></span><br><span class="line"><span class="comment">#     &lt;dbl&gt; &lt;dbl&gt;</span></span><br><span class="line"><span class="comment"># 1     1     1</span></span><br><span class="line"><span class="comment"># 2     2     1</span></span><br><span class="line"><span class="comment"># 3     1     2</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="setdiff-x-y"><a href="#setdiff-x-y" class="headerlink" title="setdiff(x, y)"></a>setdiff(x, y)</h2><blockquote><p>返回在 x 表，但不在 y 表中的观测，或反之。</p></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">setdiff<span class="punctuation">(</span>df1<span class="punctuation">,</span> df2<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># # A tibble: 1 × 2</span></span><br><span class="line"><span class="comment">#       x     y</span></span><br><span class="line"><span class="comment">#     &lt;dbl&gt; &lt;dbl&gt;</span></span><br><span class="line"><span class="comment"># 1     2     1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">setdiff<span class="punctuation">(</span>df2<span class="punctuation">,</span> df1<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># A tibble: 1 × 2</span></span><br><span class="line"><span class="comment">#       x     y</span></span><br><span class="line"><span class="comment">#     &lt;dbl&gt; &lt;dbl&gt;</span></span><br><span class="line"><span class="comment"># 1     1     2</span></span><br></pre></td></tr></table></figure><h1 id="相关问题"><a href="#相关问题" class="headerlink" title="相关问题"></a>相关问题</h1><h2 id="验证主键是否是唯一标识"><a href="#验证主键是否是唯一标识" class="headerlink" title="验证主键是否是唯一标识"></a>验证主键是否是唯一标识</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 验证tailnum是否为planes表中的唯一标识</span></span><br><span class="line">planes <span class="operator">%&gt;%</span></span><br><span class="line">  count<span class="punctuation">(</span>tailnum<span class="punctuation">)</span> <span class="operator">%&gt;%</span>  </span><br><span class="line">  filter<span class="punctuation">(</span>n<span class="operator">&gt;</span><span class="number">1</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证组合变量是否为唯一标识</span></span><br><span class="line">flights <span class="operator">%&gt;%</span></span><br><span class="line">  count<span class="punctuation">(</span>year<span class="punctuation">,</span> month<span class="punctuation">,</span> day<span class="punctuation">,</span> flight<span class="punctuation">)</span> <span class="operator">%&gt;%</span></span><br><span class="line">  filter<span class="punctuation">(</span>n <span class="operator">&gt;</span> <span class="number">1</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h2 id="两个表中变量名不同如何进行连接"><a href="#两个表中变量名不同如何进行连接" class="headerlink" title="两个表中变量名不同如何进行连接"></a>两个表中变量名不同如何进行连接</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 by = c(&quot;a&quot; = &quot;b&quot;) 形式进行连接</span></span><br><span class="line">flights2 <span class="operator">%&gt;%</span></span><br><span class="line">  left_join<span class="punctuation">(</span>airports<span class="punctuation">,</span> by <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;dest&quot;</span> <span class="operator">=</span> <span class="string">&quot;faa&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h1 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h1><ol><li>找出能唯一标识的主键</li><li>确保主键中没有缺失值</li><li>检查外键是否与另一张表主键匹配</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;em&gt;写在前面的话&lt;/em&gt;：&lt;/p&gt;
&lt;p&gt;&lt;em&gt;当有多个数据框时，我们需要根据数据框之间的相关变量，对数据进行整理，合并，筛选。生信分析中对关系数据进行处理时，常使用tidyverse包中dplyr进行处理&lt;/em&gt;。&lt;/p&gt;
&lt;p&gt;注：文档中举例除了使用自建数据外</summary>
      
    
    
    
    <category term="生物信息学" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="数据分析" scheme="https://smileszh.github.io/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/"/>
    
    <category term="tidyverse" scheme="https://smileszh.github.io/tags/tidyverse/"/>
    
    <category term="R 语言" scheme="https://smileszh.github.io/tags/R-%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>GEO数据库</title>
    <link href="https://smileszh.github.io/posts/56308c9.html"/>
    <id>https://smileszh.github.io/posts/56308c9.html</id>
    <published>2023-06-08T05:00:00.000Z</published>
    <updated>2023-06-11T03:00:01.053Z</updated>
    
    <content type="html"><![CDATA[<h1 id="GEO数据库"><a href="#GEO数据库" class="headerlink" title="GEO数据库"></a><a href="https://www.ncbi.nlm.nih.gov/geo/">GEO数据库</a></h1><p> <em>写在前面的话</em></p><p><em>GEO 数据库是 NCBI 网站下的子数据库，主要收录基于芯片和测序技术的数据，来源于全球众多研究者的上传数据。GEO数据库一直是进行生信挖掘的重要数据库，了解GEO数据库的数据形式，组织类型及下载方式进行数据挖掘的必备技能。</em></p><h2 id="数据存储格式"><a href="#数据存储格式" class="headerlink" title="数据存储格式"></a>数据存储格式</h2><h3 id="SOFT-格式"><a href="#SOFT-格式" class="headerlink" title="SOFT 格式"></a>SOFT 格式</h3><p>SOFT (Simple Omnibus in Text Format)格式，是一种紧凑、简单、基于行的 ASCII(美国信息交换标准代码)文本格式， 包含实验数据和注释数据。</p><h3 id="MINiML-格式"><a href="#MINiML-格式" class="headerlink" title="MINiML 格式"></a>MINiML 格式</h3><p>MINiML (MIAME Notation in Markup Language, pronounced minimal)格式，与 SOFT 格式文件的包含信息完全相同，仅格式不同，为 XML 格式。 XML(eXtensible Markup Language)又称为可扩展标记语言，极其简单，使其易于在任何应用程序中读写数据。MIAME 和 MINSEQE 分别是芯片和测序数据上传的标准指南，指出上传的芯片或测序数据最起码应包含的数据内容。</p><h3 id="Series-Matrix-files"><a href="#Series-Matrix-files" class="headerlink" title="Series Matrix files"></a>Series Matrix files</h3><p>Series Matrix files，是以制表符分隔的包含每个样本具体数值(比如基因表达量) 的文本文件，以包含GSM和GSE描述信息的数据开头，然后是样本为列、探针或者基因为行的表达矩阵。若来源于不同平台则分割为数个单独的文件。</p><h3 id="Supplementary-files"><a href="#Supplementary-files" class="headerlink" title="Supplementary files"></a>Supplementary files</h3><p>Supplementary files，即补充文件，列出 GSM 原始数据或上传者分享的(如临床信息 等)相关文件;GEO 数据库鼓励但不强制要求上传补充文件。GEO 中不同的数据类型，具体 对应的文件格式也有所不同。GEO 存储的数据一般都是 gzip 压缩文件，文件后缀名.gz 或 者.tgz，常用的解压缩工具一般都可以打开。</p><h2 id="数据组织形式-Data-organiation"><a href="#数据组织形式-Data-organiation" class="headerlink" title="数据组织形式(Data organiation)"></a>数据组织形式(Data organiation)</h2><h3 id="GPL-GEO-platform"><a href="#GPL-GEO-platform" class="headerlink" title="GPL(GEO platform)"></a>GPL(GEO platform)</h3><p>GPL,是 GEO platform 的简称，也就是平台，所有的数据都是通过芯片或者测序数据商的平 台产生的，平台数据包括了该平台的主要描述信息，芯片平台数据还包括了芯片涉及的注 释信息。GEO 中包含了 2 万多个平台数据，编号以 GPL 开头，GPL 数据页面列出了 GEO 数据 库中使用该平台的所有样本 GSM 编号和系列 GSE 编号。</p><blockquote><p>GPL 数据主要有四种对应的存储格式。最常用的是 annotation 注释表格文件，将芯片探针名转换为基因名时需 要用到这个文件。然后就是 SOFT 格式和 MINiML 格式的平台数据，存储了使用该平台所有 GSM、GSE 的编号信息，一般文件较大，一般分析不常用到这个数据。部分平台由补充数据文件。比如常见的 <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GPL571">GPL571</a>，有前三种数据格式。</p><ul><li>GPLxxx.annot.gz, 基因序列的注释信息表格文件，不定期更新</li><li>GPLxxx.family.xml.tgz, 压缩的MINIML格式文件，包含使用该平台的所有GSM，GSE的信息</li><li>GPLxxx_soft.gz, 压缩的Soft格式文件，包含使用该平台的所有GSM，GSE的信息</li><li>GPLxxx.xxx.gz, 补充文件，部分数据无补充文件</li></ul></blockquote><p><img src="https://bu.dusays.com/2023/06/08/64815da7310fe.png" alt="GPL.png"></p><h3 id="GSM-GEO-sample"><a href="#GSM-GEO-sample" class="headerlink" title="GSM(GEO sample)"></a>GSM(GEO sample)</h3><p>GSM，全称 GEO sample，即样本数据，记录了单个样本的生物学信息、处理流程以及该样 本在平台上产生的原始数据，编号以 GSM 开头，一个 GSM 样本仅对应一个平台。即使同一 个生物样本在同一个平台或者多个平台内多次检测，就产生多个 GSM 样本数据，每个平台 的每一次检测就会产生一个新的 GSM 样本数据。</p><blockquote><p>GSM 数据对应的是一个单独的压缩文件，列在补充文件条目下。记录了该样本的描述信息和原始数据(raw data)，根据产生数据平台的不同，原 始数据的文件格式有所不同，CEL 格式就是 Affymetrix 芯片的原始数据格式。GSM 原始数据的文件名也反应了一些信息，比如 <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM18423">GSM18423_PA-D_132.cel.gz</a>，表示:gzip 压缩的 CEL 文件，GSM18423 为样本编号，“PA-D_132”为该样本的简要分组信息。</p><ul><li>GSMxxxxxx.xxx.gz, 单个样本的gzip压缩文件，位于补充文件类别下</li></ul></blockquote><p><img src="https://bu.dusays.com/2023/06/08/64815da72f531.png" alt="GSM.png"></p><h3 id="GSE-GEO-series"><a href="#GSE-GEO-series" class="headerlink" title="GSE(GEO series)"></a>GSE(GEO series)</h3><p>GSE，是 GEO series 的简称，系列数据是把相关联的 GSM 样本数据集合在一起，通常是一 项研究中的所有样本数据的集合，编号以 GSE 开头。一个 GSE 系列数据中包含的样本可能 来源于不同平台，同一个样本的数据也可以出现在多个 GSE 中。</p><blockquote><p>GSE 文件的下载链接，一般在 GSE 网页的 下方。如<a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE1145">GSE1145</a></p><ul><li>GSExxx_series_matrix.txt.gz 或 GSExxx- GPLxxx_series_matrix.txt.gz，包含该 GSE 的样本表达矩阵及简要样本、平台信息; 若一 个 GSE 内应用了多个平台则按平台分割为多个 series matrix 文本文件，并按第二种方式 命名。</li><li>GSExxx_family.soft.gz, SOFT格式，包含GSE所涉及的所有样本及平台数据</li><li>GSExxx_family.xml.tgz, MINiML格式，包含该GSE所涉及的所有样本及平台数据</li><li>GSExxx_RAW.tar，该 GSE 所涉及的所有样本的原始数据，如所有样本 的 CEL 压缩文件，或其他补充文件</li></ul></blockquote><p><img src="https://bu.dusays.com/2023/06/08/64815da72dee9.png" alt="GSE.png"></p><h3 id="GDS-GEO-DataSet"><a href="#GDS-GEO-DataSet" class="headerlink" title="GDS(GEO DataSet)"></a>GDS(GEO DataSet)</h3><p>GDS，是 GEO DataSet 的简称，是经 GEO 数据库的工作人员挑选整理后的数据集记录，是对很少一部分 GSE 原始数据进行背景校正、均一化等处理后得到的。编号以 GDS 开头，每个 GDS 的数据对应一个平台，使得数据在 GDS 内部具有直接的可比性。</p><blockquote><p>GDS 数据的格式一般为 soft 格式，分为 soft 和 full.soft 文件，其中 full.soft 文件中增加了该 GDS 对应平台的最新基因注释信息。GDS 页面同时还整合了该 GDS 对应的 GSE 和 GPL annotation 数据下载链接。如<a href="https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS2225">GDS2225</a></p><ul><li>GDSxxx.soft.gz, 来源于原始的GSE数据，经GEO处理，具有GDS内数值可比性的数据</li><li>GDSxxx_full.soft.gz, SOFT格式，在GDSxxx.soft.gz基础上，增加了该GDS对应平台的最新基因注释</li></ul></blockquote><p><img src="https://bu.dusays.com/2023/06/08/64815da72ea63.png" alt="GDS.png"></p><h3 id="GEO-Profile"><a href="#GEO-Profile" class="headerlink" title="GEO Profile"></a>GEO Profile</h3><p>GEO Profile 数据，直接来源于 GDS 数据，只是呈现的形式不同，重点关注单个基因的水平。从单个基因角度直观地以图表展示特定基因在 GDS 不同分组、所有样本中的表达水 平，网页内可以直接下载整理好 Profile 数据。</p><blockquote><p> GEO profile 文件下载的文件命名为 profile_data.txt，没有特定的编号，文件内包含了所查询基因的信息以及在各个样本中的表达值数据，推荐用 Excel 打开这个文本文件。如<a href="https://www.ncbi.nlm.nih.gov/geoprofiles/28483590">GDS2225中Herpud1基因的profile数据</a></p><p>Profile_data.txt, 包含所查询基因的信息及在各个样本中的表达值数据</p></blockquote><p><img src="https://bu.dusays.com/2023/06/08/64815da72db57.png" alt="GEO profile.png"></p><h2 id="数据下载"><a href="#数据下载" class="headerlink" title="数据下载"></a>数据下载</h2><h3 id="网页链接下载"><a href="#网页链接下载" class="headerlink" title="网页链接下载"></a>网页链接下载</h3><p><a href="https://www.ncbi.nlm.nih.gov/geo/">GEO数据库主页</a></p><h3 id="构建ftp链接下载"><a href="#构建ftp链接下载" class="headerlink" title="构建ftp链接下载"></a>构建ftp链接下载</h3><p><a href="ftp://ftp.ncbi.nlm.nih.gov/geo/">GEO数据库ftp站点</a></p><blockquote><p>4种数据类型的子目</p><ul><li>datasets</li><li>platforms</li><li>sample</li><li>Series</li></ul></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;GEO数据库&quot;&gt;&lt;a href=&quot;#GEO数据库&quot; class=&quot;headerlink&quot; title=&quot;GEO数据库&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://www.ncbi.nlm.nih.gov/geo/&quot;&gt;GEO数据库&lt;/a&gt;&lt;/h1&gt;&lt;p&gt; &lt;em&gt;写</summary>
      
    
    
    
    <category term="生物信息学" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="数据库" scheme="https://smileszh.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>R绘图-热图</title>
    <link href="https://smileszh.github.io/posts/5c21bb3.html"/>
    <id>https://smileszh.github.io/posts/5c21bb3.html</id>
    <published>2023-06-07T08:00:00.000Z</published>
    <updated>2023-06-24T02:24:28.593Z</updated>
    
    <content type="html"><![CDATA[<h1 id="热图"><a href="#热图" class="headerlink" title="热图"></a>热图</h1><h2 id="普通热图"><a href="#普通热图" class="headerlink" title="普通热图"></a>普通热图</h2><h3 id="热图效果"><a href="#热图效果" class="headerlink" title="热图效果"></a>热图效果</h3><blockquote><p>横轴为样本类型，纵向为基因ID</p></blockquote><h3 id="数据准备"><a href="#数据准备" class="headerlink" title="数据准备"></a>数据准备</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">GeneSample1Sample2Sample3Sample4Sample5Sample6Sample7Sample8Sample9Sample10</span><br><span class="line">Gene10.601.060.000.250.782.050.420.570.410.57</span><br><span class="line">Gene24.034.050.940.004.494.101.940.690.230.98</span><br><span class="line">Gene30.060.190.360.610.640.390.150.200.520.20</span><br><span class="line">Gene42.551.860.160.421.164.390.420.000.350.00</span><br><span class="line">Gene50.890.910.000.000.101.250.350.280.480.28</span><br><span class="line">Gene62.755.020.040.001.415.762.080.000.980.00</span><br><span class="line">Gene70.660.900.000.530.340.590.750.390.400.18</span><br><span class="line">Gene80.902.870.360.170.060.060.970.080.000.26</span><br><span class="line">Gene97.155.970.000.001.708.463.499.880.120.27</span><br><span class="line">Gene103.123.410.520.150.363.440.902.090.152.08</span><br><span class="line">Gene110.240.640.000.000.150.880.310.000.570.08</span><br><span class="line">Gene124.315.320.000.171.883.941.300.970.511.32</span><br><span class="line">Gene132.272.090.080.000.001.781.451.171.201.37</span><br><span class="line">Gene140.870.270.000.000.000.640.000.000.000.00</span><br><span class="line">Gene153.373.631.260.292.414.081.780.060.910.06</span><br><span class="line">Gene160.181.090.150.371.280.720.230.301.560.30</span><br><span class="line">Gene173.563.820.180.001.105.361.484.761.235.31</span><br><span class="line">Gene181.771.541.620.000.204.820.910.250.360.25</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加载包</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>pheatmap<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入数据</span></span><br><span class="line">data <span class="operator">&lt;-</span> as.matrix<span class="punctuation">(</span>read.table<span class="punctuation">(</span><span class="string">&quot;data.txt&quot;</span><span class="punctuation">,</span>row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 构建列注释信息</span></span><br><span class="line">annotation_col <span class="operator">=</span> data.frame<span class="punctuation">(</span>CellType <span class="operator">=</span> factor<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;A&quot;</span><span class="punctuation">,</span><span class="string">&quot;B&quot;</span><span class="punctuation">,</span><span class="string">&quot;C&quot;</span><span class="punctuation">,</span><span class="string">&quot;D&quot;</span><span class="punctuation">,</span><span class="string">&quot;E&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                                <span class="string">&quot;F&quot;</span><span class="punctuation">,</span><span class="string">&quot;G&quot;</span><span class="punctuation">,</span><span class="string">&quot;H&quot;</span><span class="punctuation">,</span><span class="string">&quot;I&quot;</span><span class="punctuation">,</span><span class="string">&quot;J&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">rownames<span class="punctuation">(</span>annotation_col<span class="punctuation">)</span> <span class="operator">&lt;-</span> colnames<span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>annotation_col<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 自定注释信息的颜色列表</span></span><br><span class="line">ann_colors <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span></span><br><span class="line">  CellType <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span>A <span class="operator">=</span> <span class="string">&quot;#65B99F&quot;</span><span class="punctuation">,</span> B <span class="operator">=</span> <span class="string">&quot;#F08961&quot;</span><span class="punctuation">,</span> C <span class="operator">=</span> <span class="string">&quot;#8A9BC3&quot;</span><span class="punctuation">,</span> D <span class="operator">=</span> <span class="string">&quot;#DA85B5&quot;</span><span class="punctuation">,</span> E <span class="operator">=</span> <span class="string">&quot;#A1CC56&quot;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="built_in">F</span> <span class="operator">=</span> <span class="string">&quot;#F5D239&quot;</span><span class="punctuation">,</span> G <span class="operator">=</span> <span class="string">&quot;#7CC07B&quot;</span><span class="punctuation">,</span> H <span class="operator">=</span> <span class="string">&quot;#BAABD0&quot;</span><span class="punctuation">,</span> I <span class="operator">=</span> <span class="string">&quot;#3766A4&quot;</span><span class="punctuation">,</span> J <span class="operator">=</span> <span class="string">&quot;#DF3078&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">head<span class="punctuation">(</span>ann_colors<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">pheatmap<span class="punctuation">(</span>data<span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># 去掉聚类树：</span></span><br><span class="line">         cluster_cols <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span></span><br><span class="line">         cluster_rows <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># 加color bar：列注释信息；</span></span><br><span class="line">         annotation_col <span class="operator">=</span> annotation_col<span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># color bar 颜色设定：</span></span><br><span class="line">         annotation_colors <span class="operator">=</span> ann_colors<span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># 设置单元格颜色渐变；(100)表示分100段渐变；</span></span><br><span class="line">         color <span class="operator">=</span> colorRampPalette<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#FDEBEA&quot;</span><span class="punctuation">,</span><span class="string">&quot;#D5281F&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">(</span><span class="number">100</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">         <span class="comment"># 行、列标签的字体大小</span></span><br><span class="line">         fontsize_col <span class="operator">=</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line">         fontsize_row <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># 是否显示行、列名</span></span><br><span class="line">         show_colnames <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># 设置每个单元格的宽度和高度</span></span><br><span class="line">         cellwidth <span class="operator">=</span> <span class="number">30</span><span class="punctuation">,</span> </span><br><span class="line">         cellheight <span class="operator">=</span> <span class="number">24</span><span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># 行、列聚类树的高度：</span></span><br><span class="line">         <span class="comment"># treeheight_row = 50, </span></span><br><span class="line">         <span class="comment"># treeheight_col = 30,</span></span><br><span class="line">         <span class="comment"># display_numbers = TRUE参数设定在每个热图格子中显示相应的数值，</span></span><br><span class="line">         <span class="comment"># number_color参数设置数值字体的颜色</span></span><br><span class="line">         display_numbers <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span>number_color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># 设置标题：</span></span><br><span class="line">         main <span class="operator">=</span> <span class="string">&quot;Heatmap&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="circle-热图"><a href="#circle-热图" class="headerlink" title="circle 热图"></a>circle 热图</h2><h3 id="热图效果-1"><a href="#热图效果-1" class="headerlink" title="热图效果"></a>热图效果</h3><p><img src="https://s2.loli.net/2023/05/10/Okx86iFDLWtYlRw.png" alt="image-20230510124031974" style="zoom: 33%;" /></p><h3 id="数据准备-1"><a href="#数据准备-1" class="headerlink" title="数据准备"></a>数据准备</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">GeneSample1Sample2Sample3Sample4Sample5Sample6Sample7Sample8Sample9Sample10</span><br><span class="line">Gene10.601.060.000.250.782.050.420.570.410.57</span><br><span class="line">Gene24.034.050.940.004.494.101.940.690.230.98</span><br><span class="line">Gene30.060.190.360.610.640.390.150.200.520.20</span><br><span class="line">Gene42.551.860.160.421.164.390.420.000.350.00</span><br><span class="line">Gene50.890.910.000.000.101.250.350.280.480.28</span><br><span class="line">Gene62.755.020.040.001.415.762.080.000.980.00</span><br><span class="line">Gene70.660.900.000.530.340.590.750.390.400.18</span><br><span class="line">Gene80.902.870.360.170.060.060.970.080.000.26</span><br><span class="line">Gene97.155.970.000.001.708.463.499.880.120.27</span><br><span class="line">Gene103.123.410.520.150.363.440.902.090.152.08</span><br><span class="line">Gene110.240.640.000.000.150.880.310.000.570.08</span><br><span class="line">Gene124.315.320.000.171.883.941.300.970.511.32</span><br><span class="line">Gene132.272.090.080.000.001.781.451.171.201.37</span><br><span class="line">Gene140.870.270.000.000.000.640.000.000.000.00</span><br><span class="line">Gene153.373.631.260.292.414.081.780.060.910.06</span><br><span class="line">Gene160.181.090.150.371.280.720.230.301.560.30</span><br><span class="line">Gene173.563.820.180.001.105.361.484.761.235.31</span><br><span class="line">Gene181.771.541.620.000.204.820.910.250.360.25</span><br></pre></td></tr></table></figure><h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加载包</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggtree<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入数据</span></span><br><span class="line">data <span class="operator">&lt;-</span> as.matrix<span class="punctuation">(</span>read.table<span class="punctuation">(</span><span class="string">&quot;data.txt&quot;</span><span class="punctuation">,</span>row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 进行层次聚类</span></span><br><span class="line">df <span class="operator">&lt;-</span> hclust<span class="punctuation">(</span>dist<span class="punctuation">(</span>data<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制进化树</span></span><br><span class="line">p1 <span class="operator">&lt;-</span> ggtree<span class="punctuation">(</span>df<span class="punctuation">)</span></span><br><span class="line">p1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看是否合适</span></span><br><span class="line">gheatmap<span class="punctuation">(</span>p1<span class="punctuation">,</span>data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将进化树绘制成圆形</span></span><br><span class="line">p2 <span class="operator">&lt;-</span> ggtree<span class="punctuation">(</span>df<span class="punctuation">,</span>layout <span class="operator">=</span> <span class="string">&quot;circular&quot;</span><span class="punctuation">)</span></span><br><span class="line">p2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置开口方向：rotate_tree()</span></span><br><span class="line"><span class="comment"># 顺时针旋转100度</span></span><br><span class="line">p3 <span class="operator">&lt;-</span> rotate_tree<span class="punctuation">(</span>p2<span class="punctuation">,</span><span class="number">100</span><span class="punctuation">)</span></span><br><span class="line">P3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">gheatmap<span class="punctuation">(</span>p3 <span class="operator">+</span> geom_tiplab<span class="punctuation">(</span>offset <span class="operator">=</span> <span class="number">13</span><span class="punctuation">)</span><span class="punctuation">,</span>data<span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># 设置热图的宽度：</span></span><br><span class="line">         width <span class="operator">=</span> <span class="number">1.5</span><span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># 设置单元格的颜色：</span></span><br><span class="line">         low <span class="operator">=</span> <span class="string">&quot;#FDEBEA&quot;</span><span class="punctuation">,</span></span><br><span class="line">         high <span class="operator">=</span> <span class="string">&quot;#D5281F&quot;</span><span class="punctuation">,</span></span><br><span class="line">         font.size <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span></span><br><span class="line">         colnames_position <span class="operator">=</span> <span class="string">&quot;top&quot;</span><span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># 调整开口大小</span></span><br><span class="line">         colnames_offset_y <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># 调节列名和顶部之间的距离：</span></span><br><span class="line">         hjust <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">         <span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&quot;right&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 文字和图的位置后续可以在Ai中调整；</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;热图&quot;&gt;&lt;a href=&quot;#热图&quot; class=&quot;headerlink&quot; title=&quot;热图&quot;&gt;&lt;/a&gt;热图&lt;/h1&gt;&lt;h2 id=&quot;普通热图&quot;&gt;&lt;a href=&quot;#普通热图&quot; class=&quot;headerlink&quot; title=&quot;普通热图&quot;&gt;&lt;/a&gt;普通热图&lt;/h</summary>
      
    
    
    
    <category term="生物信息学" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="R语言" scheme="https://smileszh.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
    <category term="R绘图" scheme="https://smileszh.github.io/tags/R%E7%BB%98%E5%9B%BE/"/>
    
  </entry>
  
  <entry>
    <title>GO/KEGG</title>
    <link href="https://smileszh.github.io/posts/cc9b0903.html"/>
    <id>https://smileszh.github.io/posts/cc9b0903.html</id>
    <published>2023-06-05T12:00:00.000Z</published>
    <updated>2023-06-24T02:52:04.733Z</updated>
    
    <content type="html"><![CDATA[<h1 id="GO-KEGG"><a href="#GO-KEGG" class="headerlink" title="GO/KEGG"></a>GO/KEGG</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># load packages -----------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">library<span class="punctuation">(</span>tidyverse<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>clusterProfiler<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>org.Bt.eg.db<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>enrichplot<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>GOplot<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>readxl<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># load data ---------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">rna <span class="operator">&lt;-</span> read_xlsx<span class="punctuation">(</span><span class="string">&quot;gene.xlsx&quot;</span><span class="punctuation">)</span></span><br><span class="line">SYMBOL <span class="operator">&lt;-</span> unique<span class="punctuation">(</span>rna<span class="operator">$</span>SYMBOL<span class="punctuation">)</span></span><br><span class="line">rna <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>SYMBOL<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Id transition -----------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">gene.df <span class="operator">&lt;-</span> bitr<span class="punctuation">(</span>rna<span class="operator">$</span>SYMBOL<span class="punctuation">,</span></span><br><span class="line">                fromType <span class="operator">=</span> <span class="string">&quot;SYMBOL&quot;</span><span class="punctuation">,</span></span><br><span class="line">                toType <span class="operator">=</span> <span class="string">&quot;ENTREZID&quot;</span><span class="punctuation">,</span></span><br><span class="line">                OrgDb <span class="operator">=</span> org.Bt.eg.db<span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>gene.df<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># prepare analysis --------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">gene <span class="operator">&lt;-</span> gene.df<span class="operator">$</span>ENTREZID</span><br><span class="line"></span><br><span class="line"><span class="comment"># GO analysis -------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">go <span class="operator">&lt;-</span> enrichGO<span class="punctuation">(</span>gene <span class="operator">=</span> gene<span class="punctuation">,</span></span><br><span class="line">               OrgDb <span class="operator">=</span> org.Bt.eg.db<span class="punctuation">,</span></span><br><span class="line">               ont <span class="operator">=</span> <span class="string">&quot;ALL&quot;</span><span class="punctuation">,</span></span><br><span class="line">               readable <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">write.csv<span class="punctuation">(</span>go<span class="operator">@</span>result<span class="punctuation">,</span> file <span class="operator">=</span> <span class="string">&quot;go_enrichresults.csv&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># kegg analysis -----------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">kegg <span class="operator">&lt;-</span> enrichKEGG<span class="punctuation">(</span>gene <span class="operator">=</span> gene<span class="punctuation">,</span></span><br><span class="line">                   organism <span class="operator">=</span> <span class="string">&quot;bta&quot;</span><span class="punctuation">,</span></span><br><span class="line">                   pvalueCutoff <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">,</span></span><br><span class="line">                   qvalueCutoff <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">write.csv<span class="punctuation">(</span>kegg<span class="operator">@</span>result<span class="punctuation">,</span> file <span class="operator">=</span> <span class="string">&quot;kegg_enrichresults.csv&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;GO-KEGG&quot;&gt;&lt;a href=&quot;#GO-KEGG&quot; class=&quot;headerlink&quot; title=&quot;GO/KEGG&quot;&gt;&lt;/a&gt;GO/KEGG&lt;/h1&gt;&lt;figure class=&quot;highlight r&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gut</summary>
      
    
    
    
    <category term="生物信息学" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="基因注释" scheme="https://smileszh.github.io/tags/%E5%9F%BA%E5%9B%A0%E6%B3%A8%E9%87%8A/"/>
    
    <category term="R语言" scheme="https://smileszh.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>基因ID转换</title>
    <link href="https://smileszh.github.io/posts/cee7e62d.html"/>
    <id>https://smileszh.github.io/posts/cee7e62d.html</id>
    <published>2023-06-05T12:00:00.000Z</published>
    <updated>2023-06-24T02:41:12.393Z</updated>
    
    <content type="html"><![CDATA[<p><em>写在前面的话：</em></p><p><em>基因ID在不同的生信软件和数据库中有不同的命名规则。因此，将基因ID进行转换是必备的生信技能。此文章主要介绍几个常用的基因ID转换网站及R包转换工具</em></p><h1 id="BioMart工具"><a href="#BioMart工具" class="headerlink" title="BioMart工具"></a><a href="https://www.ensembl.org/biomart/martview/ccf8f9fdc5c9f83c988b1d4f24648cf5">BioMart工具</a></h1><blockquote><p>BioMart 是 Ensembl 网站提供的一个 web 工具。他的主要功能是进行基因功能的注释和跨数据库注释，还有就是基因ID的转换。</p></blockquote><h2 id="选择数据库和数据集"><a href="#选择数据库和数据集" class="headerlink" title="选择数据库和数据集"></a>选择数据库和数据集</h2><p><img src="https://bu.dusays.com/2023/06/13/64874d703b0f8.png" alt="第一步.png" style="zoom: 67%;" /></p><p><img src="https://bu.dusays.com/2023/06/13/64874d7042b11.png" alt="第二步.png" style="zoom:67%;" /></p><h2 id="输入ID类型及基因集"><a href="#输入ID类型及基因集" class="headerlink" title="输入ID类型及基因集"></a>输入ID类型及基因集</h2><blockquote><p>限制一次500个ID转换</p></blockquote><p><img src="https://bu.dusays.com/2023/06/13/64874d705049c.png" alt="第三步.png" style="zoom:67%;" /></p><p><img src="https://bu.dusays.com/2023/06/13/64874d703d705.png" alt="第四步.png" style="zoom:67%;" /></p><h2 id="选择输出基因ID类型"><a href="#选择输出基因ID类型" class="headerlink" title="选择输出基因ID类型"></a>选择输出基因ID类型</h2><p><img src="https://bu.dusays.com/2023/06/13/64874d703d1ab.png" alt="第五步.png" style="zoom:67%;" /></p><p><em>注：查看数据基因ID信息</em></p><p><img src="https://bu.dusays.com/2023/06/13/64874d70415b1.png" alt="第六步.png" style="zoom:67%;" /></p><h2 id="输出结果"><a href="#输出结果" class="headerlink" title="输出结果"></a>输出结果</h2><p><img src="https://bu.dusays.com/2023/06/13/64874d7039cdb.png" alt="第七步.png" style="zoom:67%;" /></p><h1 id="BioDBnet"><a href="#BioDBnet" class="headerlink" title="BioDBnet"></a><a href="https://biodbnet-abcc.ncifcrf.gov/">BioDBnet</a></h1><blockquote><p>biological DataBase network，一个集成了大量生物数据库的应用程序，比如Gene, UniProt, Ensembl, GO等，由ABCC进行维护。它实际上包括多个应用程序，如dbWork，dbFind等。主要功能包括基因ID转换，基因功能注释，基因信息查找，还可以将基因ID转换成其他物种的同源基因ID等。</p></blockquote><h2 id="选择输入和输出ID类型"><a href="#选择输入和输出ID类型" class="headerlink" title="选择输入和输出ID类型"></a>选择输入和输出ID类型</h2><p><img src="https://bu.dusays.com/2023/06/13/6487538f3c72e.png" alt="1.png" style="zoom: 50%;" /></p><h2 id="输入物种Taxon-ID"><a href="#输入物种Taxon-ID" class="headerlink" title="输入物种Taxon ID"></a>输入物种Taxon ID</h2><p><img src="https://bu.dusays.com/2023/06/13/6487538f572a5.png" alt="2.png" style="zoom:50%;" /></p><p><img src="https://bu.dusays.com/2023/06/13/6487538f3b159.png" alt="3.png" style="zoom: 50%;" /></p><h2 id="输入数据集并提交结果"><a href="#输入数据集并提交结果" class="headerlink" title="输入数据集并提交结果"></a>输入数据集并提交结果</h2><p><img src="https://bu.dusays.com/2023/06/13/6487538f55c2f.png" alt="4.png" style="zoom:50%;" /></p><h2 id="结果查看"><a href="#结果查看" class="headerlink" title="结果查看"></a>结果查看</h2><p><img src="https://bu.dusays.com/2023/06/13/6487538f55c2f.png" alt="5.png" style="zoom:50%;" /></p><h1 id="BioDBnet其他工具"><a href="#BioDBnet其他工具" class="headerlink" title="BioDBnet其他工具"></a>BioDBnet其他工具</h1><h2 id="dbWalk"><a href="#dbWalk" class="headerlink" title="dbWalk"></a>dbWalk</h2><blockquote><p>适用于需要转换为多种ID类型</p></blockquote><p><img src="https://bu.dusays.com/2023/06/13/64875ca1e3640.png" alt="6.png" style="zoom:50%;" /></p><p><img src="https://bu.dusays.com/2023/06/13/64875cd40ed8d.png" alt="7.png" style="zoom: 50%;" /></p><h2 id="dbFind"><a href="#dbFind" class="headerlink" title="dbFind"></a>dbFind</h2><blockquote><p>自动识别输入的基因ID类型，并转换为统一ID类型</p></blockquote><p><img src="https://bu.dusays.com/2023/06/13/64875ce4ac000.png" alt="8.png" style="zoom:50%;" /></p><p><img src="https://bu.dusays.com/2023/06/13/64875ce70ae86.png" alt="9.png" style="zoom:50%;" /></p><h1 id="DAVID"><a href="#DAVID" class="headerlink" title="DAVID"></a><a href="https://david.ncifcrf.gov/home.jsp">DAVID</a></h1><h2 id="打开官网，选择基因ID转换工具"><a href="#打开官网，选择基因ID转换工具" class="headerlink" title="打开官网，选择基因ID转换工具"></a>打开官网，选择基因ID转换工具</h2><p><img src="https://bu.dusays.com/2023/06/18/648df8d0b8414.png" alt="Screenshot 2023-06-18 at 01.55.47.png"></p><h2 id="上传基因List"><a href="#上传基因List" class="headerlink" title="上传基因List"></a>上传基因List</h2><p><img src="https://bu.dusays.com/2023/06/18/648df8a619dcc.png" alt="Screenshot 2023-06-18 at 01.57.47.png"></p><h2 id="填写选项"><a href="#填写选项" class="headerlink" title="填写选项"></a>填写选项</h2><p><img src="https://bu.dusays.com/2023/06/18/648df87d5e7a5.png" alt="David ID.png"></p><h2 id="结果查看-1"><a href="#结果查看-1" class="headerlink" title="结果查看"></a>结果查看</h2><p><img src="https://bu.dusays.com/2023/06/24/649657a4d9bec.png" alt="Screenshot 2023-06-18 at 02.04.12.png" style="zoom:100%;" /></p><h1 id="Uniprot"><a href="#Uniprot" class="headerlink" title="Uniprot"></a><a href="https://www.uniprot.org/">Uniprot</a></h1><h2 id="选择ID-mapping"><a href="#选择ID-mapping" class="headerlink" title="选择ID mapping"></a>选择ID mapping</h2><p><img src="https://bu.dusays.com/2023/06/20/6491c87ec0aff.png" alt="uniprot基因转化1.png"></p><h2 id="根据需求输入信息"><a href="#根据需求输入信息" class="headerlink" title="根据需求输入信息"></a>根据需求输入信息</h2><p><img src="https://bu.dusays.com/2023/06/20/6491c87e5b7fa.png" alt="uniprot基因转化2.png"></p><h2 id="选择Reviewed"><a href="#选择Reviewed" class="headerlink" title="选择Reviewed"></a>选择Reviewed</h2><p><img src="https://bu.dusays.com/2023/06/20/6491c87e61175.png" alt="uniprot基因转化3.png"></p><h2 id="结果查看和下载"><a href="#结果查看和下载" class="headerlink" title="结果查看和下载"></a>结果查看和下载</h2><p><img src="https://bu.dusays.com/2023/06/20/6491c87e61175.png" alt="uniprot基因转化4.png"></p><h1 id="使用R包进行转换"><a href="#使用R包进行转换" class="headerlink" title="使用R包进行转换"></a>使用R包进行转换</h1><div class="tabs" id="基因id转换"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#基因id转换-1">代码示例</button></li><li class="tab"><button type="button" data-href="#基因id转换-2">基因ID类型</button></li><li class="tab"><button type="button" data-href="#基因id转换-3">物种基因注释包</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="基因id转换-1"><p><strong><br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span><span class="string">&quot;clusterProfiler&quot;</span><span class="punctuation">)</span> </span><br><span class="line">library<span class="punctuation">(</span><span class="string">&quot;org.Bt.eg.db&quot;</span><span class="punctuation">)</span> <span class="comment"># 根据物种选择不同的物种基因注释包</span></span><br><span class="line"></span><br><span class="line">gene_name <span class="operator">&lt;-</span> bitr<span class="punctuation">(</span>sig_rna<span class="operator">$</span>ENSEMBLTRANS<span class="punctuation">,</span> <span class="comment"># 输入数据集</span></span><br><span class="line">                fromType <span class="operator">=</span> <span class="string">&quot;ENSEMBLTRANS&quot;</span><span class="punctuation">,</span> <span class="comment"># 输入ID类型</span></span><br><span class="line">                toType <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;SYMBOL&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="comment"># 输出ID类型</span></span><br><span class="line">                OrgDb <span class="operator">=</span> org.Bt.eg.db<span class="punctuation">)</span> <span class="comment"># 物种ID数据包</span></span><br></pre></td></tr></table></figure></strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div><div class="tab-item-content" id="基因id转换-2"><p><strong><br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytypes<span class="punctuation">(</span>org.Bt.eg.db<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><br>[1] “ACCNUM”       “ALIAS”        “ENSEMBL”<br>[4] “ENSEMBLPROT”  “ENSEMBLTRANS” “ENTREZID”<br>[7] “ENZYME”       “EVIDENCE”     “EVIDENCEALL”<br>[10] “GENENAME”     “GENETYPE”     “GO”<br>[13] “GOALL”        “IPI”          “ONTOLOGY”<br>[16] “ONTOLOGYALL”  “PATH”         “PFAM”<br>[19] “PMID”         “PROSITE”      “REFSEQ”<br>[22] “SYMBOL”       “UNIPROT” </strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div><div class="tab-item-content" id="基因id转换-3"><p><strong><br><a href="http://bioconductor.org/packages/release/BiocViews.html#___OrgDb">物种基因注释包</a></strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div></div>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;em&gt;写在前面的话：&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;基因ID在不同的生信软件和数据库中有不同的命名规则。因此，将基因ID进行转换是必备的生信技能。此文章主要介绍几个常用的基因ID转换网站及R包转换工具&lt;/em&gt;&lt;/p&gt;
&lt;h1 id=&quot;BioMart工具&quot;&gt;&lt;a hre</summary>
      
    
    
    
    <category term="生物信息学" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="R语言" scheme="https://smileszh.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
    <category term="基因ID" scheme="https://smileszh.github.io/tags/%E5%9F%BA%E5%9B%A0ID/"/>
    
  </entry>
  
  <entry>
    <title>conda管理生信软件</title>
    <link href="https://smileszh.github.io/posts/7aba474f.html"/>
    <id>https://smileszh.github.io/posts/7aba474f.html</id>
    <published>2023-06-04T19:00:00.000Z</published>
    <updated>2023-06-23T23:53:45.778Z</updated>
    
    <content type="html"><![CDATA[<h1 id="conda管理生信软件"><a href="#conda管理生信软件" class="headerlink" title="conda管理生信软件"></a>conda管理生信软件</h1><p><em>写在前面的话：</em></p><p><em>linux作为非图形化操作系统，软件下载及管理相对于windows更加复杂。对于生信分析，conda能够很好的解决大部分软件的下载、安装及管理。最重要的是conda能够解决不同软件间的环境冲突。（miniconda是anaconda的轻量级替代，足够我们使用）</em></p><h2 id="conda下载"><a href="#conda下载" class="headerlink" title="conda下载"></a>conda下载</h2><ol><li><p><a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/miniconda/">清华大学开源软件镜像站:miniconda安装包查找</a></p></li><li><p>根据不同的电脑系统选择所需要的版本(windows, linux, MacOSX)</p></li><li>下载最新的linux版本示例：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -c https://mirrors.tuna.tsinghua.edu.cn/anaconda/miniconda/Miniconda2-latest-Linux-x86_64.sh</span><br></pre></td></tr></table></figure><h2 id="miniconda安装"><a href="#miniconda安装" class="headerlink" title="miniconda安装"></a>miniconda安装</h2><p>安装最新版linux示例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash Miniconda2-latest-Linux-x86_64.sh</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">安装过程中可能会遇到下面的提示：</span><br><span class="line"></span><br><span class="line">Please, press ENTER to <span class="built_in">continue</span></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="comment"># 此处直接点击enter即可</span></span><br><span class="line">===================================</span><br><span class="line">Miniconda End User License Agreement</span><br><span class="line">===================================</span><br><span class="line">.......</span><br><span class="line"><span class="comment"># 这⾥点击好⼏次空格键，直到出现下⾯⾏</span></span><br><span class="line">Do you accept the license terms? [<span class="built_in">yes</span>|no]</span><br><span class="line">[no] &gt;&gt;&gt;</span><br><span class="line"><span class="comment"># 这⾥输⼊yes，点击enter</span></span><br><span class="line"><span class="comment"># 如果输⼊错误，⽐如输⼊yess，⼜删除不了，此时你应该按enter,重新输⼊yes即可</span></span><br><span class="line">[/home/you/miniconda2] &gt;&gt;&gt;</span><br><span class="line"><span class="comment"># 遇到此处时，直接enter即可</span></span><br><span class="line"><span class="comment"># 这⾥的绝对路径是指miniconda2的安装路径</span></span><br><span class="line">installation finished.</span><br><span class="line">Do you wish the installer to initialize Miniconda2</span><br><span class="line"><span class="keyword">in</span> your /home/you/.bashrc ? [<span class="built_in">yes</span>|no]</span><br><span class="line">[no] &gt;&gt;&gt;</span><br><span class="line"><span class="comment"># 这⾥输⼊yes</span></span><br><span class="line"><span class="comment"># 刚开始学的⼈最好输⼊yes，⽬的是让conda⾃动给你配置环境变量</span></span><br><span class="line"><span class="comment"># 输⼊yes的结果是：~/.bashrc这⾥⽂件⾥最后⼏⾏多了conda的配置信息</span></span><br><span class="line"><span class="comment"># less ~/.bashrc,多出来的配置信息第⼀⾏如下：</span></span><br><span class="line"><span class="comment"># added by Miniconda2 4.5.12 installer</span></span><br><span class="line">.......</span><br><span class="line">Thank you <span class="keyword">for</span> installing Miniconda2!</span><br><span class="line"><span class="comment"># 出现这个代表安装成功</span></span><br><span class="line"><span class="comment"># 执⾏下⾯语句</span></span><br><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure><h2 id="miniconda配置镜像"><a href="#miniconda配置镜像" class="headerlink" title="miniconda配置镜像"></a>miniconda配置镜像</h2><p>conda安装软件需要从就近的镜像中查找安装包，因此软件安装成功后必须<strong>配置镜像</strong>（这里用的是清华镜像源，也可以选择其他的镜像源，具体可百度）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free</span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge</span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda</span><br><span class="line">conda config --<span class="built_in">set</span> show_channel_urls <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p>配置信息保存在 <code>~/.condarc</code>里</p><h2 id="创建小环境"><a href="#创建小环境" class="headerlink" title="创建小环境"></a>创建小环境</h2><p>创建小环境相当于在屋子里安装一个柜子，可以把物品放在柜子里，柜子坏了可以直接丢掉。如果直接在大环境里安装软件如果破坏了主环境，恢复的代价就会更高。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.创建名为rna的小环境</span></span><br><span class="line">conda create -n rna</span><br><span class="line"><span class="comment"># 2.安装python2版本（可以根据需要选择python版本）</span></span><br><span class="line">conda install python=2</span><br><span class="line"><span class="comment">## 可以合并两个命令</span></span><br><span class="line">conda create -n rna python=2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看已经存在的小环境(多个命令都可实现)</span></span><br><span class="line">conda info -e</span><br><span class="line">conda inf0 --envs</span><br><span class="line">conda <span class="built_in">env</span> list</span><br></pre></td></tr></table></figure><h2 id="进入小环境"><a href="#进入小环境" class="headerlink" title="进入小环境"></a>进入小环境</h2><p>创建小环境后，安装软件或者使用小环境内软件进行分析，一定要<strong>进入/激活</strong>小环境，否则只会在当前账户环境下运行。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 激活名rna的小环境</span></span><br><span class="line"><span class="built_in">source</span> activate rna</span><br></pre></td></tr></table></figure><h2 id="查找软件"><a href="#查找软件" class="headerlink" title="查找软件"></a>查找软件</h2><p>软件会有不同的版本，不同版本之间也会有不同的环境要求，在安装之前可以进行查找。</p><ol><li><p><a href="https://bioconda.github.io/conda-package_index.html">在conda网页内查找</a></p></li><li><p>直接运行命令查询</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查找stringtie软件安装包</span></span><br><span class="line">conda search stringtie</span><br></pre></td></tr></table></figure></li></ol><h2 id="安装软件"><a href="#安装软件" class="headerlink" title="安装软件"></a>安装软件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装sra-tools、trim-galore两个软件，默认安装最新版</span></span><br><span class="line">conda install -y sra-tools trim-galore</span><br><span class="line"></span><br><span class="line"><span class="comment"># 选择安装版本</span></span><br><span class="line">conda install numpy=1.11 ：即安装能模糊匹配到numpy版本为1.11</span><br><span class="line">conda install numpy==1.11 ：即精确安装numpy为1.11的版本</span><br></pre></td></tr></table></figure><h2 id="卸载软件"><a href="#卸载软件" class="headerlink" title="　卸载软件"></a>　卸载软件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda uninstall bwa</span><br></pre></td></tr></table></figure><h2 id="更新软件"><a href="#更新软件" class="headerlink" title="更新软件"></a>更新软件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 更新conda</span></span><br><span class="line">conda update conda</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新bwa</span></span><br><span class="line">conda update bwa</span><br></pre></td></tr></table></figure><h2 id="查看当前环境已安装软件"><a href="#查看当前环境已安装软件" class="headerlink" title="查看当前环境已安装软件"></a>查看当前环境已安装软件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda list</span><br></pre></td></tr></table></figure><h2 id="退出小环境"><a href="#退出小环境" class="headerlink" title="退出小环境"></a>退出小环境</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda deactivate</span><br></pre></td></tr></table></figure><h2 id="移除小环境"><a href="#移除小环境" class="headerlink" title="移除小环境"></a>移除小环境</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 移除名为rna的小环境</span></span><br><span class="line">conda <span class="built_in">env</span> remove -n rna</span><br></pre></td></tr></table></figure><h2 id="镜像源"><a href="#镜像源" class="headerlink" title="镜像源"></a>镜像源</h2><p>国内访问国外conda官网较慢，所以需要替换国内镜像源</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示目前conda源信息</span></span><br><span class="line">conda info</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除并恢复默认的conda源</span></span><br><span class="line">conda config --remove-key channels</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置安装包时，显示镜像来源（个人需求）</span></span><br><span class="line">conda config --<span class="built_in">set</span> show_channel_urls <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p>设置<a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/">清华镜像源</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">conda config --add channels r </span><br><span class="line">conda config --add channels defaults</span><br><span class="line">conda config --add channels conda-forge</span><br><span class="line">conda config --add channels bioconda</span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/msys2/</span><br><span class="line"><span class="comment"># Anocanda 清华镜像</span></span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/</span><br><span class="line">conda config --add channels  https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/cond-forge</span><br><span class="line"><span class="comment"># 清华通道, 最高优先级</span></span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda/</span><br><span class="line">conda config --<span class="built_in">set</span> show_channel_urls <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p>如果镜像源出现问题，可还原使用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conda config --remove-key channels</span><br><span class="line">conda config --append channels conda-forge --append channels bioconda --append channels defaults</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;conda管理生信软件&quot;&gt;&lt;a href=&quot;#conda管理生信软件&quot; class=&quot;headerlink&quot; title=&quot;conda管理生信软件&quot;&gt;&lt;/a&gt;conda管理生信软件&lt;/h1&gt;&lt;p&gt;&lt;em&gt;写在前面的话：&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;linux作</summary>
      
    
    
    
    <category term="生物信息学" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="conda" scheme="https://smileszh.github.io/tags/conda/"/>
    
    <category term="软件管理" scheme="https://smileszh.github.io/tags/%E8%BD%AF%E4%BB%B6%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
</feed>
