<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>海底捞里没有鱼</title>
  
  <subtitle>平安喜乐, 万事胜意</subtitle>
  <link href="https://smileszh.github.io/atom.xml" rel="self"/>
  
  <link href="https://smileszh.github.io/"/>
  <updated>2023-06-10T16:54:36.237Z</updated>
  <id>https://smileszh.github.io/</id>
  
  <author>
    <name>小苏</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>引物设计</title>
    <link href="https://smileszh.github.io/posts/e7e9fba0.html"/>
    <id>https://smileszh.github.io/posts/e7e9fba0.html</id>
    <published>2023-06-10T16:00:00.000Z</published>
    <updated>2023-06-10T16:54:36.237Z</updated>
    
    <content type="html"><![CDATA[<h1 id="查找基因"><a href="#查找基因" class="headerlink" title="查找基因"></a>查找基因</h1><h2 id="进入NCBI官网"><a href="#进入NCBI官网" class="headerlink" title="进入NCBI官网"></a>进入<a href="https://www.ncbi.nlm.nih.gov/">NCBI官网</a></h2><p><img src="https://bu.dusays.com/2023/06/11/6484a6b1c4eae.png" alt="官网.png" style="zoom: 35%;" /></p><h2 id="查找序列"><a href="#查找序列" class="headerlink" title="查找序列"></a>查找序列</h2><p><img src="https://bu.dusays.com/2023/06/11/6484a6b1d340a.png" alt="查找基因1.png" style="zoom:35%;" /></p><h2 id="查找基因ID"><a href="#查找基因ID" class="headerlink" title="查找基因ID"></a>查找基因ID</h2><p><img src="https://bu.dusays.com/2023/06/11/6484a6b1d0f51.png" alt="查找基因2.png" style="zoom:35%;" /></p><h1 id="引物设计"><a href="#引物设计" class="headerlink" title="引物设计"></a>引物设计</h1><h2 id="打开Prime-BLAST"><a href="#打开Prime-BLAST" class="headerlink" title="打开Prime-BLAST"></a>打开<a href="https://www.ncbi.nlm.nih.gov/tools/primer-blast/index.cgi?LINK_LOC=BlastHome">Prime-BLAST</a></h2><p><img src="https://bu.dusays.com/2023/06/11/6484a6b1c5396.png" alt="引物1.png" style="zoom:35%;" /></p><h2 id="根据需求填写参数"><a href="#根据需求填写参数" class="headerlink" title="根据需求填写参数"></a>根据需求填写参数</h2><p><img src="https://bu.dusays.com/2023/06/11/6484a6b1dbb3c.png" alt="引物2.png" style="zoom:35%;" /></p><h1 id="结果筛选"><a href="#结果筛选" class="headerlink" title="结果筛选"></a>结果筛选</h1><p><img src="https://bu.dusays.com/2023/06/11/6484a6b1c5b30.png" alt="结果.png" style="zoom:40%;" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;查找基因&quot;&gt;&lt;a href=&quot;#查找基因&quot; class=&quot;headerlink&quot; title=&quot;查找基因&quot;&gt;&lt;/a&gt;查找基因&lt;/h1&gt;&lt;h2 id=&quot;进入NCBI官网&quot;&gt;&lt;a href=&quot;#进入NCBI官网&quot; class=&quot;headerlink&quot; title=&quot;进</summary>
      
    
    
    
    <category term="科研知识" scheme="https://smileszh.github.io/categories/%E7%A7%91%E7%A0%94%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="引物设计" scheme="https://smileszh.github.io/tags/%E5%BC%95%E7%89%A9%E8%AE%BE%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>tidyverse：处理关系数据</title>
    <link href="https://smileszh.github.io/posts/7218365e.html"/>
    <id>https://smileszh.github.io/posts/7218365e.html</id>
    <published>2023-06-10T15:00:00.000Z</published>
    <updated>2023-06-10T15:03:28.927Z</updated>
    
    <content type="html"><![CDATA[<p><em>写在前面的话</em>：</p><p><em>当有多个数据框时，我们需要根据数据框之间的相关变量，对数据进行整理，合并，筛选。生信分析中对关系数据进行处理时，常使用tidyverse包中dplyr进行处理</em>。</p><p>注：文档中举例除了使用自建数据外，我们需要使用 nycflights13。这个数据包含了 2013 年从纽约市出发的所有 336 776次航班的信息。该数据来自于美国交通统计局， 可以使用?nycflights13 查看其说明文档。包括flights, airports, planes, weather, airline五个数据框。 文档中如出现此类数据对象，不再另行说明。</p><ul><li>flights: 包含航班信息</li><li>airlines:可以根据航空公司的缩写码查到公司全名。</li><li>airports:给出了每个机场的信息，通过 faa 机场编码进行标识。</li><li>planes:给出了每架飞机的信息，通过 tailnum 进行标识。</li><li>weather:给出了纽约机场每小时的天气状况。</li></ul><p><img src="https://bu.dusays.com/2023/06/10/64847e2f85887.png" alt="数据关系.png" style="zoom: 25%;" /></p><p>R包使用：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>tidyverse<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>nycflights13<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h1 id="相关概念"><a href="#相关概念" class="headerlink" title="相关概念"></a>相关概念</h1><ul><li><strong>键</strong>：用于连接每对数据表对变量称为键，键是能唯一标识观测的变量（或变量集合）</li><li><strong>主键</strong>：唯一标识其所在数据框的观测</li><li><strong>外键</strong>：唯一标识另一个数据表中的观测</li><li><strong>代理键</strong>：一个表格没有主键时，使用mutate()和row_number()函数人为添加的一个主键称为代理键</li></ul><h1 id="合并连接"><a href="#合并连接" class="headerlink" title="合并连接"></a>合并连接</h1><blockquote><p>合并连接将两个表格中的变量进行组合，通过两个表格中键匹配观测，然后将一个表格中的变量复制到另一个表格中。</p></blockquote><h2 id="内连接-inner-join"><a href="#内连接-inner-join" class="headerlink" title="内连接 inner_join()"></a>内连接 inner_join()</h2><blockquote><p>保留X和Y中共有的观测</p></blockquote><p><img src="https://bu.dusays.com/2023/06/10/64843c3112eed.png" alt="内连接.png" style="zoom:50%;" /></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数据构造</span></span><br><span class="line"></span><br><span class="line">x <span class="operator">&lt;-</span> tribble<span class="punctuation">(</span></span><br><span class="line">  <span class="operator">~</span>key<span class="punctuation">,</span> <span class="operator">~</span>val_x<span class="punctuation">,</span></span><br><span class="line">  <span class="number">1</span><span class="punctuation">,</span> <span class="string">&quot;x1&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="number">2</span><span class="punctuation">,</span> <span class="string">&quot;x2&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="number">3</span><span class="punctuation">,</span> <span class="string">&quot;x3&quot;</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">y <span class="operator">&lt;-</span> tribble<span class="punctuation">(</span></span><br><span class="line">  <span class="operator">~</span>key<span class="punctuation">,</span> <span class="operator">~</span>val_x<span class="punctuation">,</span></span><br><span class="line">  <span class="number">1</span><span class="punctuation">,</span> <span class="string">&quot;y1&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="number">2</span><span class="punctuation">,</span> <span class="string">&quot;y2&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="number">4</span><span class="punctuation">,</span> <span class="string">&quot;y3&quot;</span></span><br><span class="line"><span class="punctuation">)</span>  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 内连接</span></span><br><span class="line"></span><br><span class="line">x <span class="operator">%&gt;%</span></span><br><span class="line">  inner_join<span class="punctuation">(</span>y<span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&quot;key&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A tibble: 2 × 3</span></span><br><span class="line">    key val_x.x val_x.y</span><br><span class="line">  <span class="operator">&lt;</span>dbl<span class="operator">&gt;</span> <span class="operator">&lt;</span>chr<span class="operator">&gt;</span>   <span class="operator">&lt;</span>chr<span class="operator">&gt;</span>  </span><br><span class="line"><span class="number">1</span>     <span class="number">1</span> x1      y1     </span><br><span class="line"><span class="number">2</span>     <span class="number">2</span> x2      y2  </span><br></pre></td></tr></table></figure><h2 id="外连接"><a href="#外连接" class="headerlink" title="外连接"></a>外连接</h2><blockquote><ul><li>左连接：保留x中的所有观测</li><li>右连接：保留Y中的所有观测</li><li>全连接，保留X和Y中所有观测</li></ul></blockquote><p><img src="https://bu.dusays.com/2023/06/10/64843d25c12d6.png" alt="外连接.png" style="zoom:50%;" /></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 左连接</span></span><br><span class="line">left_join<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 右连接</span></span><br><span class="line">right_join<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 全连接</span></span><br><span class="line">full_join<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h1 id="筛选连接"><a href="#筛选连接" class="headerlink" title="筛选连接"></a>筛选连接</h1><blockquote><p>根据匹配的键，筛选数据表中的观测</p></blockquote><h2 id="半连接-semi-join-x-y"><a href="#半连接-semi-join-x-y" class="headerlink" title="半连接 semi_join(x, y)"></a>半连接 semi_join(x, y)</h2><blockquote><p><strong>保留</strong>X表中与Y表中的观测相匹配的所有观测</p></blockquote><p><img src="https://bu.dusays.com/2023/06/10/648475b9ac49d.png" alt="半连接.png" style="zoom:50%;" /></p><p><img src="https://bu.dusays.com/2023/06/10/648475b9ac49d.png" alt="半连接1.png" style="zoom:50%;" /></p><p>例：根据表flights找出飞往最受欢迎的10个目的地的航班信息</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 找出最受欢迎的10个目的地 -----------------------------------------------------------</span></span><br><span class="line">top_dest <span class="operator">&lt;-</span> flights <span class="operator">%&gt;%</span> </span><br><span class="line">  count<span class="punctuation">(</span>dest<span class="punctuation">,</span> sort <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  head<span class="punctuation">(</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">top_dest</span><br><span class="line"></span><br><span class="line"><span class="comment"># # A tibble: 10 × 2</span></span><br><span class="line"><span class="comment"># dest      n</span></span><br><span class="line"><span class="comment"># &lt;chr&gt; &lt;int&gt;</span></span><br><span class="line"><span class="comment">#   1 ORD   17283</span></span><br><span class="line"><span class="comment"># 2 ATL   17215</span></span><br><span class="line"><span class="comment"># 3 LAX   16174</span></span><br><span class="line"><span class="comment"># 4 BOS   15508</span></span><br><span class="line"><span class="comment"># 5 MCO   14082</span></span><br><span class="line"><span class="comment"># 6 CLT   14064</span></span><br><span class="line"><span class="comment"># 7 SFO   13331</span></span><br><span class="line"><span class="comment"># 8 FLL   12055</span></span><br><span class="line"><span class="comment"># 9 MIA   11728</span></span><br><span class="line"><span class="comment"># 10 DCA    9705</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 找出飞往这些目的地的航班 ------------------------------------------------------------</span></span><br><span class="line">flights <span class="operator">%&gt;%</span></span><br><span class="line">  semi_join<span class="punctuation">(</span>top_dest<span class="punctuation">)</span> <span class="comment"># 默认值by = NULL, 会使用存在于两个表中的所有变量，这种方式称为自然连接</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="反连接-anti-join-x-y"><a href="#反连接-anti-join-x-y" class="headerlink" title="反连接 anti_join(x, y)"></a>反连接 anti_join(x, y)</h2><blockquote><p><strong>丢弃</strong>X表中与Y表中的观测相匹配的所有观测</p></blockquote><p><img src="https://bu.dusays.com/2023/06/10/648475b9ac49d.png" alt="反连接.png" style="zoom:50%;" /></p><p>例：找出flights 中在 planes 中没有匹配的记录</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flights <span class="operator">%&gt;%</span></span><br><span class="line">  anti_join<span class="punctuation">(</span>planes<span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&quot;tailnum&quot;</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span></span><br><span class="line">  count<span class="punctuation">(</span>tailnum<span class="punctuation">,</span> sort <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h1 id="集合操作"><a href="#集合操作" class="headerlink" title="集合操作"></a>集合操作</h1><blockquote><p>集合操作要求X和Y具有相同的变量</p></blockquote><p>模拟数据构建:</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">df1 <span class="operator">&lt;-</span> tribble<span class="punctuation">(</span></span><br><span class="line">  <span class="operator">~</span>x<span class="punctuation">,</span> <span class="operator">~</span>y<span class="punctuation">,</span></span><br><span class="line">  <span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">  <span class="number">2</span><span class="punctuation">,</span> <span class="number">1</span> </span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">df2 <span class="operator">&lt;-</span> tribble<span class="punctuation">(</span></span><br><span class="line">  <span class="operator">~</span>x<span class="punctuation">,</span> <span class="operator">~</span>y<span class="punctuation">,</span></span><br><span class="line">  <span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">  <span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span> </span><br><span class="line"><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h2 id="intersect-x-y"><a href="#intersect-x-y" class="headerlink" title="intersect(x, y)"></a>intersect(x, y)</h2><blockquote><p>返回既在 x 表，又在 y 表中的观测。 </p></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">intersect<span class="punctuation">(</span>df1<span class="punctuation">,</span> df2<span class="punctuation">)</span> </span><br><span class="line"><span class="comment"># # A tibble: 1 × 2</span></span><br><span class="line"><span class="comment">#      x     y</span></span><br><span class="line"><span class="comment">#    &lt;dbl&gt; &lt;dbl&gt;</span></span><br><span class="line"><span class="comment"># 1    1     1</span></span><br></pre></td></tr></table></figure><h2 id="union-x-y"><a href="#union-x-y" class="headerlink" title="union(x, y)"></a>union(x, y)</h2><blockquote><p>返回 x 表或 y 表中的唯一观测。</p></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 注意，我们得到了3行，而不是4行 </span></span><br><span class="line">union<span class="punctuation">(</span>df1<span class="punctuation">,</span> df2<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># # A tibble: 3 × 2</span></span><br><span class="line"><span class="comment">#       x     y</span></span><br><span class="line"><span class="comment">#     &lt;dbl&gt; &lt;dbl&gt;</span></span><br><span class="line"><span class="comment"># 1     1     1</span></span><br><span class="line"><span class="comment"># 2     2     1</span></span><br><span class="line"><span class="comment"># 3     1     2</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="setdiff-x-y"><a href="#setdiff-x-y" class="headerlink" title="setdiff(x, y)"></a>setdiff(x, y)</h2><blockquote><p>返回在 x 表，但不在 y 表中的观测，或反之。</p></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">setdiff<span class="punctuation">(</span>df1<span class="punctuation">,</span> df2<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># # A tibble: 1 × 2</span></span><br><span class="line"><span class="comment">#       x     y</span></span><br><span class="line"><span class="comment">#     &lt;dbl&gt; &lt;dbl&gt;</span></span><br><span class="line"><span class="comment"># 1     2     1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">setdiff<span class="punctuation">(</span>df2<span class="punctuation">,</span> df1<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># A tibble: 1 × 2</span></span><br><span class="line"><span class="comment">#       x     y</span></span><br><span class="line"><span class="comment">#     &lt;dbl&gt; &lt;dbl&gt;</span></span><br><span class="line"><span class="comment"># 1     1     2</span></span><br></pre></td></tr></table></figure><h1 id="相关问题"><a href="#相关问题" class="headerlink" title="相关问题"></a>相关问题</h1><h2 id="验证主键是否是唯一标识"><a href="#验证主键是否是唯一标识" class="headerlink" title="验证主键是否是唯一标识"></a>验证主键是否是唯一标识</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 验证tailnum是否为planes表中的唯一标识</span></span><br><span class="line">planes <span class="operator">%&gt;%</span></span><br><span class="line">  count<span class="punctuation">(</span>tailnum<span class="punctuation">)</span> <span class="operator">%&gt;%</span>  </span><br><span class="line">  filter<span class="punctuation">(</span>n<span class="operator">&gt;</span><span class="number">1</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证组合变量是否为唯一标识</span></span><br><span class="line">flights <span class="operator">%&gt;%</span></span><br><span class="line">  count<span class="punctuation">(</span>year<span class="punctuation">,</span> month<span class="punctuation">,</span> day<span class="punctuation">,</span> flight<span class="punctuation">)</span> <span class="operator">%&gt;%</span></span><br><span class="line">  filter<span class="punctuation">(</span>n <span class="operator">&gt;</span> <span class="number">1</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h2 id="两个表中变量名不同如何进行连接"><a href="#两个表中变量名不同如何进行连接" class="headerlink" title="两个表中变量名不同如何进行连接"></a>两个表中变量名不同如何进行连接</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 by = c(&quot;a&quot; = &quot;b&quot;) 形式进行连接</span></span><br><span class="line">flights2 <span class="operator">%&gt;%</span></span><br><span class="line">  left_join<span class="punctuation">(</span>airports<span class="punctuation">,</span> by <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;dest&quot;</span> <span class="operator">=</span> <span class="string">&quot;faa&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><h1 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h1><ol><li>找出能唯一标识的主键</li><li>确保主键中没有缺失值</li><li>检查外键是否与另一张表主键匹配</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;em&gt;写在前面的话&lt;/em&gt;：&lt;/p&gt;
&lt;p&gt;&lt;em&gt;当有多个数据框时，我们需要根据数据框之间的相关变量，对数据进行整理，合并，筛选。生信分析中对关系数据进行处理时，常使用tidyverse包中dplyr进行处理&lt;/em&gt;。&lt;/p&gt;
&lt;p&gt;注：文档中举例除了使用自建数据外</summary>
      
    
    
    
    <category term="R语言" scheme="https://smileszh.github.io/categories/R%E8%AF%AD%E8%A8%80/"/>
    
    
    <category term="数据分析" scheme="https://smileszh.github.io/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/"/>
    
    <category term="tidyverse" scheme="https://smileszh.github.io/tags/tidyverse/"/>
    
  </entry>
  
  <entry>
    <title>GEO数据库</title>
    <link href="https://smileszh.github.io/posts/56308c9.html"/>
    <id>https://smileszh.github.io/posts/56308c9.html</id>
    <published>2023-06-08T05:00:00.000Z</published>
    <updated>2023-06-08T14:00:06.713Z</updated>
    
    <content type="html"><![CDATA[<h1 id="GEO数据库"><a href="#GEO数据库" class="headerlink" title="GEO数据库"></a><a href="https://www.ncbi.nlm.nih.gov/geo/">GEO数据库</a></h1><p> <em>写在前面的话</em></p><p><em>GEO 数据库是 NCBI 网站下的子数据库，主要收录基于芯片和测序技术的数据，来源于全球众多研究者的上传数据。GEO数据库一直是进行生信挖掘的重要数据库，了解GEO数据库的数据形式，组织类型及下载方式进行数据挖掘的必备技能。</em></p><h2 id="数据存储格式"><a href="#数据存储格式" class="headerlink" title="数据存储格式"></a>数据存储格式</h2><h3 id="SOFT-格式"><a href="#SOFT-格式" class="headerlink" title="SOFT 格式"></a>SOFT 格式</h3><p>SOFT (Simple Omnibus in Text Format)格式，是一种紧凑、简单、基于行的 ASCII(美国信息交换标准代码)文本格式， 包含实验数据和注释数据。</p><h3 id="MINiML-格式"><a href="#MINiML-格式" class="headerlink" title="MINiML 格式"></a>MINiML 格式</h3><p>MINiML (MIAME Notation in Markup Language, pronounced minimal)格式，与 SOFT 格式文件的包含信息完全相同，仅格式不同，为 XML 格式。 XML(eXtensible Markup Language)又称为可扩展标记语言，极其简单，使其易于在任何应用程序中读写数据。MIAME 和 MINSEQE 分别是芯片和测序数据上传的标准指南，指出上传的芯片或测序数据最起码应包含的数据内容。</p><h3 id="Series-Matrix-files"><a href="#Series-Matrix-files" class="headerlink" title="Series Matrix files"></a>Series Matrix files</h3><p>Series Matrix files，是以制表符分隔的包含每个样本具体数值(比如基因表达量) 的文本文件，以包含GSM和GSE描述信息的数据开头，然后是样本为列、探针或者基因为行的表达矩阵。若来源于不同平台则分割为数个单独的文件。</p><h3 id="Supplementary-files"><a href="#Supplementary-files" class="headerlink" title="Supplementary files"></a>Supplementary files</h3><p>Supplementary files，即补充文件，列出 GSM 原始数据或上传者分享的(如临床信息 等)相关文件;GEO 数据库鼓励但不强制要求上传补充文件。GEO 中不同的数据类型，具体 对应的文件格式也有所不同。GEO 存储的数据一般都是 gzip 压缩文件，文件后缀名.gz 或 者.tgz，常用的解压缩工具一般都可以打开。</p><h2 id="数据组织形式-Data-organiation"><a href="#数据组织形式-Data-organiation" class="headerlink" title="数据组织形式(Data organiation)"></a>数据组织形式(Data organiation)</h2><h3 id="GPL-GEO-platform"><a href="#GPL-GEO-platform" class="headerlink" title="GPL(GEO platform)"></a>GPL(GEO platform)</h3><p>GPL,是 GEO platform 的简称，也就是平台，所有的数据都是通过芯片或者测序数据商的平 台产生的，平台数据包括了该平台的主要描述信息，芯片平台数据还包括了芯片涉及的注 释信息。GEO 中包含了 2 万多个平台数据，编号以 GPL 开头，GPL 数据页面列出了 GEO 数据 库中使用该平台的所有样本 GSM 编号和系列 GSE 编号。</p><blockquote><p>GPL 数据主要有四种对应的存储格式。最常用的是 annotation 注释表格文件，将芯片探针名转换为基因名时需 要用到这个文件。然后就是 SOFT 格式和 MINiML 格式的平台数据，存储了使用该平台所有 GSM、GSE 的编号信息，一般文件较大，一般分析不常用到这个数据。部分平台由补充数据文件。比如常见的 <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GPL571">GPL571</a>，有前三种数据格式。</p><ul><li>GPLxxx.annot.gz, 基因序列的注释信息表格文件，不定期更新</li><li>GPLxxx.family.xml.tgz, 压缩的MINIML格式文件，包含使用该平台的所有GSM，GSE的信息</li><li>GPLxxx_soft.gz, 压缩的Soft格式文件，包含使用该平台的所有GSM，GSE的信息</li><li>GPLxxx.xxx.gz, 补充文件，部分数据无补充文件</li></ul></blockquote><p><img src="https://bu.dusays.com/2023/06/08/64815da7310fe.png" alt="GPL.png"></p><h3 id="GSM-GEO-sample"><a href="#GSM-GEO-sample" class="headerlink" title="GSM(GEO sample)"></a>GSM(GEO sample)</h3><p>GSM，全称 GEO sample，即样本数据，记录了单个样本的生物学信息、处理流程以及该样 本在平台上产生的原始数据，编号以 GSM 开头，一个 GSM 样本仅对应一个平台。即使同一 个生物样本在同一个平台或者多个平台内多次检测，就产生多个 GSM 样本数据，每个平台 的每一次检测就会产生一个新的 GSM 样本数据。</p><blockquote><p>GSM 数据对应的是一个单独的压缩文件，列在补充文件条目下。记录了该样本的描述信息和原始数据(raw data)，根据产生数据平台的不同，原 始数据的文件格式有所不同，CEL 格式就是 Affymetrix 芯片的原始数据格式。GSM 原始数据的文件名也反应了一些信息，比如 <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM18423">GSM18423_PA-D_132.cel.gz</a>，表示:gzip 压缩的 CEL 文件，GSM18423 为样本编号，“PA-D_132”为该样本的简要分组信息。</p><ul><li>GSMxxxxxx.xxx.gz, 单个样本的gzip压缩文件，位于补充文件类别下</li></ul></blockquote><p><img src="https://bu.dusays.com/2023/06/08/64815da72f531.png" alt="GSM.png"></p><h3 id="GSE-GEO-series"><a href="#GSE-GEO-series" class="headerlink" title="GSE(GEO series)"></a>GSE(GEO series)</h3><p>GSE，是 GEO series 的简称，系列数据是把相关联的 GSM 样本数据集合在一起，通常是一 项研究中的所有样本数据的集合，编号以 GSE 开头。一个 GSE 系列数据中包含的样本可能 来源于不同平台，同一个样本的数据也可以出现在多个 GSE 中。</p><blockquote><p>GSE 文件的下载链接，一般在 GSE 网页的 下方。如<a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE1145">GSE1145</a></p><ul><li>GSExxx_series_matrix.txt.gz 或 GSExxx- GPLxxx_series_matrix.txt.gz，包含该 GSE 的样本表达矩阵及简要样本、平台信息; 若一 个 GSE 内应用了多个平台则按平台分割为多个 series matrix 文本文件，并按第二种方式 命名。</li><li>GSExxx_family.soft.gz, SOFT格式，包含GSE所涉及的所有样本及平台数据</li><li>GSExxx_family.xml.tgz, MINiML格式，包含该GSE所涉及的所有样本及平台数据</li><li>GSExxx_RAW.tar，该 GSE 所涉及的所有样本的原始数据，如所有样本 的 CEL 压缩文件，或其他补充文件</li></ul></blockquote><p><img src="https://bu.dusays.com/2023/06/08/64815da72dee9.png" alt="GSE.png"></p><h3 id="GDS-GEO-DataSet"><a href="#GDS-GEO-DataSet" class="headerlink" title="GDS(GEO DataSet)"></a>GDS(GEO DataSet)</h3><p>GDS，是 GEO DataSet 的简称，是经 GEO 数据库的工作人员挑选整理后的数据集记录，是对很少一部分 GSE 原始数据进行背景校正、均一化等处理后得到的。编号以 GDS 开头，每个 GDS 的数据对应一个平台，使得数据在 GDS 内部具有直接的可比性。</p><blockquote><p>GDS 数据的格式一般为 soft 格式，分为 soft 和 full.soft 文件，其中 full.soft 文件中增加了该 GDS 对应平台的最新基因注释信息。GDS 页面同时还整合了该 GDS 对应的 GSE 和 GPL annotation 数据下载链接。如<a href="https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS2225">GDS2225</a></p><ul><li>GDSxxx.soft.gz, 来源于原始的GSE数据，经GEO处理，具有GDS内数值可比性的数据</li><li>GDSxxx_full.soft.gz, SOFT格式，在GDSxxx.soft.gz基础上，增加了该GDS对应平台的最新基因注释</li></ul></blockquote><p><img src="https://bu.dusays.com/2023/06/08/64815da72ea63.png" alt="GDS.png"></p><h3 id="GEO-Profile"><a href="#GEO-Profile" class="headerlink" title="GEO Profile"></a>GEO Profile</h3><p>GEO Profile 数据，直接来源于 GDS 数据，只是呈现的形式不同，重点关注单个基因的水平。从单个基因角度直观地以图表展示特定基因在 GDS 不同分组、所有样本中的表达水 平，网页内可以直接下载整理好 Profile 数据。</p><blockquote><p> GEO profile 文件下载的文件命名为 profile_data.txt，没有特定的编号，文件内包含了所查询基因的信息以及在各个样本中的表达值数据，推荐用 Excel 打开这个文本文件。如<a href="https://www.ncbi.nlm.nih.gov/geoprofiles/28483590">GDS2225中Herpud1基因的profile数据</a></p><p>Profile_data.txt, 包含所查询基因的信息及在各个样本中的表达值数据</p></blockquote><p><img src="https://bu.dusays.com/2023/06/08/64815da72db57.png" alt="GEO profile.png"></p><h2 id="数据下载"><a href="#数据下载" class="headerlink" title="数据下载"></a>数据下载</h2><h3 id="网页链接下载"><a href="#网页链接下载" class="headerlink" title="网页链接下载"></a>网页链接下载</h3><p><a href="https://www.ncbi.nlm.nih.gov/geo/">GEO数据库主页</a></p><h3 id="构建ftp链接下载"><a href="#构建ftp链接下载" class="headerlink" title="构建ftp链接下载"></a>构建ftp链接下载</h3><p><a href="ftp://ftp.ncbi.nlm.nih.gov/geo/">GEO数据库ftp站点</a></p><blockquote><p>4种数据类型的子目</p><ul><li>datasets</li><li>platforms</li><li>sample</li><li>Series</li></ul></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;GEO数据库&quot;&gt;&lt;a href=&quot;#GEO数据库&quot; class=&quot;headerlink&quot; title=&quot;GEO数据库&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://www.ncbi.nlm.nih.gov/geo/&quot;&gt;GEO数据库&lt;/a&gt;&lt;/h1&gt;&lt;p&gt; &lt;em&gt;写</summary>
      
    
    
    
    <category term="生物信息学" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    <category term="科研知识" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/%E7%A7%91%E7%A0%94%E7%9F%A5%E8%AF%86/"/>
    
    
    <category term="数据库" scheme="https://smileszh.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>R绘图-热图</title>
    <link href="https://smileszh.github.io/posts/5c21bb3.html"/>
    <id>https://smileszh.github.io/posts/5c21bb3.html</id>
    <published>2023-06-07T08:00:00.000Z</published>
    <updated>2023-06-07T08:28:19.502Z</updated>
    
    <content type="html"><![CDATA[<h1 id="热图"><a href="#热图" class="headerlink" title="热图"></a>热图</h1><h2 id="普通热图"><a href="#普通热图" class="headerlink" title="普通热图"></a>普通热图</h2><h3 id="热图效果"><a href="#热图效果" class="headerlink" title="热图效果"></a>热图效果</h3><blockquote><p>横轴为样本类型，纵向为基因ID</p></blockquote><h3 id="数据准备"><a href="#数据准备" class="headerlink" title="数据准备"></a>数据准备</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">GeneSample1Sample2Sample3Sample4Sample5Sample6Sample7Sample8Sample9Sample10</span><br><span class="line">Gene10.601.060.000.250.782.050.420.570.410.57</span><br><span class="line">Gene24.034.050.940.004.494.101.940.690.230.98</span><br><span class="line">Gene30.060.190.360.610.640.390.150.200.520.20</span><br><span class="line">Gene42.551.860.160.421.164.390.420.000.350.00</span><br><span class="line">Gene50.890.910.000.000.101.250.350.280.480.28</span><br><span class="line">Gene62.755.020.040.001.415.762.080.000.980.00</span><br><span class="line">Gene70.660.900.000.530.340.590.750.390.400.18</span><br><span class="line">Gene80.902.870.360.170.060.060.970.080.000.26</span><br><span class="line">Gene97.155.970.000.001.708.463.499.880.120.27</span><br><span class="line">Gene103.123.410.520.150.363.440.902.090.152.08</span><br><span class="line">Gene110.240.640.000.000.150.880.310.000.570.08</span><br><span class="line">Gene124.315.320.000.171.883.941.300.970.511.32</span><br><span class="line">Gene132.272.090.080.000.001.781.451.171.201.37</span><br><span class="line">Gene140.870.270.000.000.000.640.000.000.000.00</span><br><span class="line">Gene153.373.631.260.292.414.081.780.060.910.06</span><br><span class="line">Gene160.181.090.150.371.280.720.230.301.560.30</span><br><span class="line">Gene173.563.820.180.001.105.361.484.761.235.31</span><br><span class="line">Gene181.771.541.620.000.204.820.910.250.360.25</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加载包</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>pheatmap<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入数据</span></span><br><span class="line">data <span class="operator">&lt;-</span> as.matrix<span class="punctuation">(</span>read.table<span class="punctuation">(</span><span class="string">&quot;data.txt&quot;</span><span class="punctuation">,</span>row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 构建列注释信息</span></span><br><span class="line">annotation_col <span class="operator">=</span> data.frame<span class="punctuation">(</span>CellType <span class="operator">=</span> factor<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;A&quot;</span><span class="punctuation">,</span><span class="string">&quot;B&quot;</span><span class="punctuation">,</span><span class="string">&quot;C&quot;</span><span class="punctuation">,</span><span class="string">&quot;D&quot;</span><span class="punctuation">,</span><span class="string">&quot;E&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                                <span class="string">&quot;F&quot;</span><span class="punctuation">,</span><span class="string">&quot;G&quot;</span><span class="punctuation">,</span><span class="string">&quot;H&quot;</span><span class="punctuation">,</span><span class="string">&quot;I&quot;</span><span class="punctuation">,</span><span class="string">&quot;J&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">rownames<span class="punctuation">(</span>annotation_col<span class="punctuation">)</span> <span class="operator">&lt;-</span> colnames<span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>annotation_col<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 自定注释信息的颜色列表</span></span><br><span class="line">ann_colors <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span></span><br><span class="line">  CellType <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span>A <span class="operator">=</span> <span class="string">&quot;#65B99F&quot;</span><span class="punctuation">,</span> B <span class="operator">=</span> <span class="string">&quot;#F08961&quot;</span><span class="punctuation">,</span> C <span class="operator">=</span> <span class="string">&quot;#8A9BC3&quot;</span><span class="punctuation">,</span> D <span class="operator">=</span> <span class="string">&quot;#DA85B5&quot;</span><span class="punctuation">,</span> E <span class="operator">=</span> <span class="string">&quot;#A1CC56&quot;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="built_in">F</span> <span class="operator">=</span> <span class="string">&quot;#F5D239&quot;</span><span class="punctuation">,</span> G <span class="operator">=</span> <span class="string">&quot;#7CC07B&quot;</span><span class="punctuation">,</span> H <span class="operator">=</span> <span class="string">&quot;#BAABD0&quot;</span><span class="punctuation">,</span> I <span class="operator">=</span> <span class="string">&quot;#3766A4&quot;</span><span class="punctuation">,</span> J <span class="operator">=</span> <span class="string">&quot;#DF3078&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">head<span class="punctuation">(</span>ann_colors<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">pheatmap<span class="punctuation">(</span>data<span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># 去掉聚类树：</span></span><br><span class="line">         cluster_cols <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span></span><br><span class="line">         cluster_rows <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># 加color bar：列注释信息；</span></span><br><span class="line">         annotation_col <span class="operator">=</span> annotation_col<span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># color bar 颜色设定：</span></span><br><span class="line">         annotation_colors <span class="operator">=</span> ann_colors<span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># 设置单元格颜色渐变；(100)表示分100段渐变；</span></span><br><span class="line">         color <span class="operator">=</span> colorRampPalette<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#FDEBEA&quot;</span><span class="punctuation">,</span><span class="string">&quot;#D5281F&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">(</span><span class="number">100</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">         <span class="comment"># 行、列标签的字体大小</span></span><br><span class="line">         fontsize_col <span class="operator">=</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line">         fontsize_row <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># 是否显示行、列名</span></span><br><span class="line">         show_colnames <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># 设置每个单元格的宽度和高度</span></span><br><span class="line">         cellwidth <span class="operator">=</span> <span class="number">30</span><span class="punctuation">,</span> </span><br><span class="line">         cellheight <span class="operator">=</span> <span class="number">24</span><span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># 行、列聚类树的高度：</span></span><br><span class="line">         <span class="comment"># treeheight_row = 50, </span></span><br><span class="line">         <span class="comment"># treeheight_col = 30,</span></span><br><span class="line">         <span class="comment"># display_numbers = TRUE参数设定在每个热图格子中显示相应的数值，</span></span><br><span class="line">         <span class="comment"># number_color参数设置数值字体的颜色</span></span><br><span class="line">         display_numbers <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span>number_color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># 设置标题：</span></span><br><span class="line">         main <span class="operator">=</span> <span class="string">&quot;Heatmap&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="circle-热图"><a href="#circle-热图" class="headerlink" title="circle 热图"></a>circle 热图</h2><h3 id="热图效果-1"><a href="#热图效果-1" class="headerlink" title="热图效果"></a>热图效果</h3><p><img src="https://s2.loli.net/2023/05/10/Okx86iFDLWtYlRw.png" alt="image-20230510124031974" style="zoom: 33%;" /></p><h3 id="数据准备-1"><a href="#数据准备-1" class="headerlink" title="数据准备"></a>数据准备</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">GeneSample1Sample2Sample3Sample4Sample5Sample6Sample7Sample8Sample9Sample10</span><br><span class="line">Gene10.601.060.000.250.782.050.420.570.410.57</span><br><span class="line">Gene24.034.050.940.004.494.101.940.690.230.98</span><br><span class="line">Gene30.060.190.360.610.640.390.150.200.520.20</span><br><span class="line">Gene42.551.860.160.421.164.390.420.000.350.00</span><br><span class="line">Gene50.890.910.000.000.101.250.350.280.480.28</span><br><span class="line">Gene62.755.020.040.001.415.762.080.000.980.00</span><br><span class="line">Gene70.660.900.000.530.340.590.750.390.400.18</span><br><span class="line">Gene80.902.870.360.170.060.060.970.080.000.26</span><br><span class="line">Gene97.155.970.000.001.708.463.499.880.120.27</span><br><span class="line">Gene103.123.410.520.150.363.440.902.090.152.08</span><br><span class="line">Gene110.240.640.000.000.150.880.310.000.570.08</span><br><span class="line">Gene124.315.320.000.171.883.941.300.970.511.32</span><br><span class="line">Gene132.272.090.080.000.001.781.451.171.201.37</span><br><span class="line">Gene140.870.270.000.000.000.640.000.000.000.00</span><br><span class="line">Gene153.373.631.260.292.414.081.780.060.910.06</span><br><span class="line">Gene160.181.090.150.371.280.720.230.301.560.30</span><br><span class="line">Gene173.563.820.180.001.105.361.484.761.235.31</span><br><span class="line">Gene181.771.541.620.000.204.820.910.250.360.25</span><br></pre></td></tr></table></figure><h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加载包</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggtree<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入数据</span></span><br><span class="line">data <span class="operator">&lt;-</span> as.matrix<span class="punctuation">(</span>read.table<span class="punctuation">(</span><span class="string">&quot;data.txt&quot;</span><span class="punctuation">,</span>row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 进行层次聚类</span></span><br><span class="line">df <span class="operator">&lt;-</span> hclust<span class="punctuation">(</span>dist<span class="punctuation">(</span>data<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制进化树</span></span><br><span class="line">p1 <span class="operator">&lt;-</span> ggtree<span class="punctuation">(</span>df<span class="punctuation">)</span></span><br><span class="line">p1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看是否合适</span></span><br><span class="line">gheatmap<span class="punctuation">(</span>p1<span class="punctuation">,</span>data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将进化树绘制成圆形</span></span><br><span class="line">p2 <span class="operator">&lt;-</span> ggtree<span class="punctuation">(</span>df<span class="punctuation">,</span>layout <span class="operator">=</span> <span class="string">&quot;circular&quot;</span><span class="punctuation">)</span></span><br><span class="line">p2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置开口方向：rotate_tree()</span></span><br><span class="line"><span class="comment"># 顺时针旋转100度</span></span><br><span class="line">p3 <span class="operator">&lt;-</span> rotate_tree<span class="punctuation">(</span>p2<span class="punctuation">,</span><span class="number">100</span><span class="punctuation">)</span></span><br><span class="line">P3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">gheatmap<span class="punctuation">(</span>p3 <span class="operator">+</span> geom_tiplab<span class="punctuation">(</span>offset <span class="operator">=</span> <span class="number">13</span><span class="punctuation">)</span><span class="punctuation">,</span>data<span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># 设置热图的宽度：</span></span><br><span class="line">         width <span class="operator">=</span> <span class="number">1.5</span><span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># 设置单元格的颜色：</span></span><br><span class="line">         low <span class="operator">=</span> <span class="string">&quot;#FDEBEA&quot;</span><span class="punctuation">,</span></span><br><span class="line">         high <span class="operator">=</span> <span class="string">&quot;#D5281F&quot;</span><span class="punctuation">,</span></span><br><span class="line">         font.size <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span></span><br><span class="line">         colnames_position <span class="operator">=</span> <span class="string">&quot;top&quot;</span><span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># 调整开口大小</span></span><br><span class="line">         colnames_offset_y <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">         <span class="comment"># 调节列名和顶部之间的距离：</span></span><br><span class="line">         hjust <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">         <span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&quot;right&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 文字和图的位置后续可以在Ai中调整；</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;热图&quot;&gt;&lt;a href=&quot;#热图&quot; class=&quot;headerlink&quot; title=&quot;热图&quot;&gt;&lt;/a&gt;热图&lt;/h1&gt;&lt;h2 id=&quot;普通热图&quot;&gt;&lt;a href=&quot;#普通热图&quot; class=&quot;headerlink&quot; title=&quot;普通热图&quot;&gt;&lt;/a&gt;普通热图&lt;/h</summary>
      
    
    
    
    <category term="生物信息学" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    <category term="R语言" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/R%E8%AF%AD%E8%A8%80/"/>
    
    
    <category term="R语言" scheme="https://smileszh.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
    <category term="R绘图" scheme="https://smileszh.github.io/tags/R%E7%BB%98%E5%9B%BE/"/>
    
  </entry>
  
  <entry>
    <title>GO/KEGG</title>
    <link href="https://smileszh.github.io/posts/cc9b0903.html"/>
    <id>https://smileszh.github.io/posts/cc9b0903.html</id>
    <published>2023-06-05T12:00:00.000Z</published>
    <updated>2023-06-07T08:39:31.897Z</updated>
    
    <content type="html"><![CDATA[<h1 id="GO-KEGG"><a href="#GO-KEGG" class="headerlink" title="GO/KEGG"></a>GO/KEGG</h1><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># load packages -----------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">library<span class="punctuation">(</span>tidyverse<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>clusterProfiler<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>org.Bt.eg.db<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>enrichplot<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>GOplot<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>readxl<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># load data ---------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">rna <span class="operator">&lt;-</span> read_xlsx<span class="punctuation">(</span><span class="string">&quot;gene.xlsx&quot;</span><span class="punctuation">)</span></span><br><span class="line">SYMBOL <span class="operator">&lt;-</span> unique<span class="punctuation">(</span>rna<span class="operator">$</span>SYMBOL<span class="punctuation">)</span></span><br><span class="line">rna <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>SYMBOL<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Id transition -----------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">gene.df <span class="operator">&lt;-</span> bitr<span class="punctuation">(</span>rna<span class="operator">$</span>SYMBOL<span class="punctuation">,</span></span><br><span class="line">                fromType <span class="operator">=</span> <span class="string">&quot;SYMBOL&quot;</span><span class="punctuation">,</span></span><br><span class="line">                toType <span class="operator">=</span> <span class="string">&quot;ENTREZID&quot;</span><span class="punctuation">,</span></span><br><span class="line">                OrgDb <span class="operator">=</span> org.Bt.eg.db<span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>gene.df<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># prepare analysis --------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">gene <span class="operator">&lt;-</span> gene.df<span class="operator">$</span>ENTREZID</span><br><span class="line"></span><br><span class="line"><span class="comment"># GO analysis -------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">go <span class="operator">&lt;-</span> enrichGO<span class="punctuation">(</span>gene <span class="operator">=</span> gene<span class="punctuation">,</span></span><br><span class="line">               OrgDb <span class="operator">=</span> org.Bt.eg.db<span class="punctuation">,</span></span><br><span class="line">               ont <span class="operator">=</span> <span class="string">&quot;ALL&quot;</span><span class="punctuation">,</span></span><br><span class="line">               readable <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">write.csv<span class="punctuation">(</span>go<span class="operator">@</span>result<span class="punctuation">,</span> file <span class="operator">=</span> <span class="string">&quot;go_enrichresults.csv&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># kegg analysis -----------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">kegg <span class="operator">&lt;-</span> enrichKEGG<span class="punctuation">(</span>gene <span class="operator">=</span> gene<span class="punctuation">,</span></span><br><span class="line">                   organism <span class="operator">=</span> <span class="string">&quot;bta&quot;</span><span class="punctuation">,</span></span><br><span class="line">                   pvalueCutoff <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">,</span></span><br><span class="line">                   qvalueCutoff <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">write.csv<span class="punctuation">(</span>kegg<span class="operator">@</span>result<span class="punctuation">,</span> file <span class="operator">=</span> <span class="string">&quot;kegg_enrichresults.csv&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;GO-KEGG&quot;&gt;&lt;a href=&quot;#GO-KEGG&quot; class=&quot;headerlink&quot; title=&quot;GO/KEGG&quot;&gt;&lt;/a&gt;GO/KEGG&lt;/h1&gt;&lt;figure class=&quot;highlight r&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gut</summary>
      
    
    
    
    <category term="生物信息学" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    <category term="R语言" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/R%E8%AF%AD%E8%A8%80/"/>
    
    
    <category term="基因注释" scheme="https://smileszh.github.io/tags/%E5%9F%BA%E5%9B%A0%E6%B3%A8%E9%87%8A/"/>
    
  </entry>
  
  <entry>
    <title>基因ID转化</title>
    <link href="https://smileszh.github.io/posts/cee7e62d.html"/>
    <id>https://smileszh.github.io/posts/cee7e62d.html</id>
    <published>2023-06-05T12:00:00.000Z</published>
    <updated>2023-06-06T16:20:40.308Z</updated>
    
    <content type="html"><![CDATA[<h1 id="基因ID转化"><a href="#基因ID转化" class="headerlink" title="基因ID转化"></a>基因ID转化</h1><p><em>写在前面的话：</em></p><p><em>基因ID在不同的生信软件和数据库中有不同的命名规则。因此，将基因ID进行转换是必备的生信技能。</em></p><h2 id="1-使用R包进行转换"><a href="#1-使用R包进行转换" class="headerlink" title="1.使用R包进行转换"></a>1.使用R包进行转换</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span><span class="string">&quot;clusterProfiler&quot;</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span><span class="string">&quot;org.Bt.eg.db&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">gene_name <span class="operator">&lt;-</span> bitr<span class="punctuation">(</span>sig_rna<span class="operator">$</span>ENSEMBLTRANS<span class="punctuation">,</span> </span><br><span class="line">                fromType <span class="operator">=</span> <span class="string">&quot;ENSEMBLTRANS&quot;</span><span class="punctuation">,</span></span><br><span class="line">                toType <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;SYMBOL&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                OrgDb <span class="operator">=</span> org.Bt.eg.db<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看基因名类型</span></span><br><span class="line">keytypes<span class="punctuation">(</span>org.Bt.eg.db<span class="punctuation">)</span></span><br><span class="line"> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="string">&quot;ACCNUM&quot;</span>       <span class="string">&quot;ALIAS&quot;</span>        <span class="string">&quot;ENSEMBL&quot;</span>     </span><br><span class="line"> <span class="punctuation">[</span><span class="number">4</span><span class="punctuation">]</span> <span class="string">&quot;ENSEMBLPROT&quot;</span>  <span class="string">&quot;ENSEMBLTRANS&quot;</span> <span class="string">&quot;ENTREZID&quot;</span>    </span><br><span class="line"> <span class="punctuation">[</span><span class="number">7</span><span class="punctuation">]</span> <span class="string">&quot;ENZYME&quot;</span>       <span class="string">&quot;EVIDENCE&quot;</span>     <span class="string">&quot;EVIDENCEALL&quot;</span> </span><br><span class="line"><span class="punctuation">[</span><span class="number">10</span><span class="punctuation">]</span> <span class="string">&quot;GENENAME&quot;</span>     <span class="string">&quot;GENETYPE&quot;</span>     <span class="string">&quot;GO&quot;</span>          </span><br><span class="line"><span class="punctuation">[</span><span class="number">13</span><span class="punctuation">]</span> <span class="string">&quot;GOALL&quot;</span>        <span class="string">&quot;IPI&quot;</span>          <span class="string">&quot;ONTOLOGY&quot;</span>    </span><br><span class="line"><span class="punctuation">[</span><span class="number">16</span><span class="punctuation">]</span> <span class="string">&quot;ONTOLOGYALL&quot;</span>  <span class="string">&quot;PATH&quot;</span>         <span class="string">&quot;PFAM&quot;</span>        </span><br><span class="line"><span class="punctuation">[</span><span class="number">19</span><span class="punctuation">]</span> <span class="string">&quot;PMID&quot;</span>         <span class="string">&quot;PROSITE&quot;</span>      <span class="string">&quot;REFSEQ&quot;</span>      </span><br><span class="line"><span class="punctuation">[</span><span class="number">22</span><span class="punctuation">]</span> <span class="string">&quot;SYMBOL&quot;</span>       <span class="string">&quot;UNIPROT&quot;</span> </span><br></pre></td></tr></table></figure><p>注：<a href="http://bioconductor.org/packages/release/BiocViews.html#___OrgDb">物种基因组注释</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;基因ID转化&quot;&gt;&lt;a href=&quot;#基因ID转化&quot; class=&quot;headerlink&quot; title=&quot;基因ID转化&quot;&gt;&lt;/a&gt;基因ID转化&lt;/h1&gt;&lt;p&gt;&lt;em&gt;写在前面的话：&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;基因ID在不同的生信软件和数据库中有不同的命名规则。</summary>
      
    
    
    
    <category term="生物信息学" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    <category term="R语言" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/R%E8%AF%AD%E8%A8%80/"/>
    
    
    <category term="R语言" scheme="https://smileszh.github.io/tags/R%E8%AF%AD%E8%A8%80/"/>
    
    <category term="基因ID" scheme="https://smileszh.github.io/tags/%E5%9F%BA%E5%9B%A0ID/"/>
    
  </entry>
  
  <entry>
    <title>conda管理生信软件</title>
    <link href="https://smileszh.github.io/posts/7aba474f.html"/>
    <id>https://smileszh.github.io/posts/7aba474f.html</id>
    <published>2023-06-04T19:00:00.000Z</published>
    <updated>2023-06-06T16:20:23.032Z</updated>
    
    <content type="html"><![CDATA[<h1 id="conda管理生信软件"><a href="#conda管理生信软件" class="headerlink" title="conda管理生信软件"></a>conda管理生信软件</h1><p><em>写在前面的话：</em></p><p><em>linux作为非图形化操作系统，软件下载及管理相对于windows更加复杂。对于生信分析，conda能够很好的解决大部分软件的下载、安装及管理。最重要的是conda能够解决不同软件间的环境冲突。（miniconda是anaconda的轻量级替代，足够我们使用）</em></p><h2 id="conda下载"><a href="#conda下载" class="headerlink" title="conda下载"></a>conda下载</h2><ol><li><p><a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/miniconda/">清华大学开源软件镜像站:miniconda安装包查找</a></p></li><li><p>根据不同的电脑系统选择所需要的版本(windows, linux, MacOSX)</p></li><li>下载最新的linux版本示例：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -c https://mirrors.tuna.tsinghua.edu.cn/anaconda/miniconda/Miniconda2-latest-Linux-x86_64.sh</span><br></pre></td></tr></table></figure><h2 id="miniconda安装"><a href="#miniconda安装" class="headerlink" title="miniconda安装"></a>miniconda安装</h2><p>安装最新版linux示例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash Miniconda2-latest-Linux-x86_64.sh</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">安装过程中可能会遇到下面的提示：</span><br><span class="line"></span><br><span class="line">Please, press ENTER to <span class="built_in">continue</span></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="comment"># 此处直接点击enter即可</span></span><br><span class="line">===================================</span><br><span class="line">Miniconda End User License Agreement</span><br><span class="line">===================================</span><br><span class="line">.......</span><br><span class="line"><span class="comment"># 这⾥点击好⼏次空格键，直到出现下⾯⾏</span></span><br><span class="line">Do you accept the license terms? [<span class="built_in">yes</span>|no]</span><br><span class="line">[no] &gt;&gt;&gt;</span><br><span class="line"><span class="comment"># 这⾥输⼊yes，点击enter</span></span><br><span class="line"><span class="comment"># 如果输⼊错误，⽐如输⼊yess，⼜删除不了，此时你应该按enter,重新输⼊yes即可</span></span><br><span class="line">[/home/you/miniconda2] &gt;&gt;&gt;</span><br><span class="line"><span class="comment"># 遇到此处时，直接enter即可</span></span><br><span class="line"><span class="comment"># 这⾥的绝对路径是指miniconda2的安装路径</span></span><br><span class="line">installation finished.</span><br><span class="line">Do you wish the installer to initialize Miniconda2</span><br><span class="line"><span class="keyword">in</span> your /home/you/.bashrc ? [<span class="built_in">yes</span>|no]</span><br><span class="line">[no] &gt;&gt;&gt;</span><br><span class="line"><span class="comment"># 这⾥输⼊yes</span></span><br><span class="line"><span class="comment"># 刚开始学的⼈最好输⼊yes，⽬的是让conda⾃动给你配置环境变量</span></span><br><span class="line"><span class="comment"># 输⼊yes的结果是：~/.bashrc这⾥⽂件⾥最后⼏⾏多了conda的配置信息</span></span><br><span class="line"><span class="comment"># less ~/.bashrc,多出来的配置信息第⼀⾏如下：</span></span><br><span class="line"><span class="comment"># added by Miniconda2 4.5.12 installer</span></span><br><span class="line">.......</span><br><span class="line">Thank you <span class="keyword">for</span> installing Miniconda2!</span><br><span class="line"><span class="comment"># 出现这个代表安装成功</span></span><br><span class="line"><span class="comment"># 执⾏下⾯语句</span></span><br><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure><h2 id="miniconda配置镜像"><a href="#miniconda配置镜像" class="headerlink" title="miniconda配置镜像"></a>miniconda配置镜像</h2><p>conda安装软件需要从就近的镜像中查找安装包，因此软件安装成功后必须<strong>配置镜像</strong>（这里用的是清华镜像源，也可以选择其他的镜像源，具体可百度）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free</span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge</span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda</span><br><span class="line">conda config --<span class="built_in">set</span> show_channel_urls <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p>配置信息保存在 <code>~/.condarc</code>里</p><h2 id="创建小环境"><a href="#创建小环境" class="headerlink" title="创建小环境"></a>创建小环境</h2><p>创建小环境相当于在屋子里安装一个柜子，可以把物品放在柜子里，柜子坏了可以直接丢掉。如果直接在大环境里安装软件如果破坏了主环境，恢复的代价就会更高。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.创建名为rna的小环境</span></span><br><span class="line">conda create -n rna</span><br><span class="line"><span class="comment"># 2.安装python2版本（可以根据需要选择python版本）</span></span><br><span class="line">conda install python=2</span><br><span class="line"><span class="comment">## 可以合并两个命令</span></span><br><span class="line">conda create -n rna python=2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看已经存在的小环境(多个命令都可实现)</span></span><br><span class="line">conda info -e</span><br><span class="line">conda inf0 --envs</span><br><span class="line">conda <span class="built_in">env</span> list</span><br></pre></td></tr></table></figure><h2 id="进入小环境"><a href="#进入小环境" class="headerlink" title="进入小环境"></a>进入小环境</h2><p>创建小环境后，安装软件或者使用小环境内软件进行分析，一定要<strong>进入/激活</strong>小环境，否则只会在当前账户环境下运行。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 激活名rna的小环境</span></span><br><span class="line"><span class="built_in">source</span> activate rna</span><br></pre></td></tr></table></figure><h2 id="查找软件"><a href="#查找软件" class="headerlink" title="查找软件"></a>查找软件</h2><p>软件会有不同的版本，不同版本之间也会有不同的环境要求，在安装之前可以进行查找。</p><ol><li><p><a href="https://bioconda.github.io/conda-package_index.html">在conda网页内查找</a></p></li><li><p>直接运行命令查询</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查找stringtie软件安装包</span></span><br><span class="line">conda search stringtie</span><br></pre></td></tr></table></figure></li></ol><h2 id="安装软件"><a href="#安装软件" class="headerlink" title="安装软件"></a>安装软件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装sra-tools、trim-galore两个软件，默认安装最新版</span></span><br><span class="line">conda install -y sra-tools trim-galore</span><br><span class="line"></span><br><span class="line"><span class="comment"># 选择安装版本</span></span><br><span class="line">conda install numpy=1.11 ：即安装能模糊匹配到numpy版本为1.11</span><br><span class="line">conda install numpy==1.11 ：即精确安装numpy为1.11的版本</span><br></pre></td></tr></table></figure><h2 id="卸载软件"><a href="#卸载软件" class="headerlink" title="　卸载软件"></a>　卸载软件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda uninstall bwa</span><br></pre></td></tr></table></figure><h2 id="更新软件"><a href="#更新软件" class="headerlink" title="更新软件"></a>更新软件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 更新conda</span></span><br><span class="line">conda update conda</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新bwa</span></span><br><span class="line">conda update bwa</span><br></pre></td></tr></table></figure><h2 id="查看当前环境已安装软件"><a href="#查看当前环境已安装软件" class="headerlink" title="查看当前环境已安装软件"></a>查看当前环境已安装软件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda list</span><br></pre></td></tr></table></figure><h2 id="退出小环境"><a href="#退出小环境" class="headerlink" title="退出小环境"></a>退出小环境</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda deactivate</span><br></pre></td></tr></table></figure><h2 id="移除小环境"><a href="#移除小环境" class="headerlink" title="移除小环境"></a>移除小环境</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 移除名为rna的小环境</span></span><br><span class="line">conda <span class="built_in">env</span> remove -n rna</span><br></pre></td></tr></table></figure><h2 id="镜像源"><a href="#镜像源" class="headerlink" title="镜像源"></a>镜像源</h2><p>国内访问国外conda官网较慢，所以需要替换国内镜像源</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示目前conda源信息</span></span><br><span class="line">conda info</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除并恢复默认的conda源</span></span><br><span class="line">conda config --remove-key channels</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置安装包时，显示镜像来源（个人需求）</span></span><br><span class="line">conda config --<span class="built_in">set</span> show_channel_urls <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p>设置<a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/">清华镜像源</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">conda config --add channels r </span><br><span class="line">conda config --add channels defaults</span><br><span class="line">conda config --add channels conda-forge</span><br><span class="line">conda config --add channels bioconda</span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/msys2/</span><br><span class="line"><span class="comment"># Anocanda 清华镜像</span></span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/</span><br><span class="line">conda config --add channels  https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/cond-forge</span><br><span class="line"><span class="comment"># 清华通道, 最高优先级</span></span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda/</span><br><span class="line">conda config --<span class="built_in">set</span> show_channel_urls <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p>如果镜像源出现问题，可还原使用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conda config --remove-key channels</span><br><span class="line">conda config --append channels conda-forge --append channels bioconda --append channels defaults</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;conda管理生信软件&quot;&gt;&lt;a href=&quot;#conda管理生信软件&quot; class=&quot;headerlink&quot; title=&quot;conda管理生信软件&quot;&gt;&lt;/a&gt;conda管理生信软件&lt;/h1&gt;&lt;p&gt;&lt;em&gt;写在前面的话：&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;linux作</summary>
      
    
    
    
    <category term="生物信息学" scheme="https://smileszh.github.io/categories/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/"/>
    
    
    <category term="conda" scheme="https://smileszh.github.io/tags/conda/"/>
    
    <category term="软件管理" scheme="https://smileszh.github.io/tags/%E8%BD%AF%E4%BB%B6%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
</feed>
